{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4128>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 40, "timesteps_since_restore": 42911, "timesteps_total": 42911, "timesteps_this_iter": 42911, "time_since_restore": 31.37377643585205, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "episode_reward_mean": -732.0211234680972, "iterations_since_restore": 1, "episode_reward_max": -509.126903026944, "policy_reward_mean": {}, "timestamp": 1558583040, "num_metric_batches_dropped": 0, "time_this_iter_s": 31.37377643585205, "episodes_total": 40, "time_total_s": 31.37377643585205, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-44-00", "custom_metrics": {"cost2_min": -77.11393488435074, "cost1_mean": 122.38358217723894, "system_level_velocity_max": 11.801597729810998, "outflow_rate_min": 396.0424186046512, "cost1_max": 144.9266937251785, "outflow_rate_max": 922.8761230799429, "system_level_velocity_min": 8.359958974461556, "cost2_max": -33.443491810548714, "cost1_min": 99.85339145657727, "system_level_velocity_mean": 10.155947464342518, "outflow_rate_mean": 739.5156762707472, "cost2_mean": -49.905548702565774}, "training_iteration": 1, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.4160122871398926, "cur_kl_coeff": 0.20000004768371582, "kl": 0.003959094174206257, "vf_explained_var": 0.5218561887741089, "vf_loss": 17.593660354614258, "total_loss": 17.592077255249023, "policy_loss": -0.0023753023706376553}, "sample_time_ms": 20221.263, "num_steps_sampled": 42911, "num_steps_trained": 42911, "update_time_ms": 778.07, "load_time_ms": 71.275, "grad_time_ms": 10136.835}, "episode_reward_min": -1010.6721714423763}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4b38>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 40, "timesteps_since_restore": 84279, "timesteps_total": 84279, "timesteps_this_iter": 41368, "time_since_restore": 57.32448887825012, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "episode_reward_mean": -699.5508638157312, "iterations_since_restore": 2, "episode_reward_max": -420.12228192140344, "policy_reward_mean": {}, "timestamp": 1558583066, "num_metric_batches_dropped": 0, "time_this_iter_s": 25.95071244239807, "episodes_total": 80, "time_total_s": 57.32448887825012, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-44-26", "custom_metrics": {"cost2_min": -77.11393488435074, "cost1_mean": 124.71344347554745, "system_level_velocity_max": 12.369033885396524, "outflow_rate_min": 396.0424186046512, "cost1_max": 148.68883635317445, "outflow_rate_max": 927.6148304056213, "system_level_velocity_min": 8.359958974461556, "cost2_max": -21.138566564098387, "cost1_min": 99.85339145657727, "system_level_velocity_mean": 10.359584789183177, "outflow_rate_mean": 761.0016259170163, "cost2_mean": -47.08768820305683}, "training_iteration": 2, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.4022022485733032, "cur_kl_coeff": 0.10000000894069672, "kl": 0.010747892782092094, "vf_explained_var": 0.6121501922607422, "vf_loss": 30.526247024536133, "total_loss": 30.522197723388672, "policy_loss": -0.005121108144521713}, "sample_time_ms": 18938.01, "num_steps_sampled": 84279, "num_steps_trained": 84279, "update_time_ms": 393.888, "load_time_ms": 40.708, "grad_time_ms": 9172.374}, "episode_reward_min": -1010.6721714423763}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badc18>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 41, "timesteps_since_restore": 126890, "timesteps_total": 126890, "timesteps_this_iter": 42611, "time_since_restore": 85.56004476547241, "node_ip": "10.138.0.2", "episode_len_mean": 322.02, "hostname": "flow-main", "episode_reward_mean": -659.2218518143095, "iterations_since_restore": 3, "episode_reward_max": -23.57984982150595, "policy_reward_mean": {}, "timestamp": 1558583095, "num_metric_batches_dropped": 0, "time_this_iter_s": 28.23555588722229, "episodes_total": 121, "time_total_s": 85.56004476547241, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-44-55", "custom_metrics": {"cost2_min": -77.36140032598382, "cost1_mean": 129.70349412361463, "system_level_velocity_max": 17.27040353244418, "outflow_rate_min": 396.0424186046512, "cost1_max": 165.1631351905384, "outflow_rate_max": 1116.6887804878052, "system_level_velocity_min": 8.359958974461556, "cost2_max": -18.645091040177483, "cost1_min": 17.660826000620087, "system_level_velocity_mean": 10.924178274839313, "outflow_rate_mean": 791.9936262671405, "cost2_mean": -47.787876526429024}, "training_iteration": 3, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.3909327983856201, "cur_kl_coeff": 0.10000001639127731, "kl": 0.01351816114038229, "vf_explained_var": 0.7407865524291992, "vf_loss": 34.45921325683594, "total_loss": 34.45554733276367, "policy_loss": -0.005017340648919344}, "sample_time_ms": 18794.187, "num_steps_sampled": 126890, "num_steps_trained": 126890, "update_time_ms": 265.138, "load_time_ms": 29.177, "grad_time_ms": 9327.369}, "episode_reward_min": -939.9754485814011}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad588>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 60, "timesteps_since_restore": 168044, "timesteps_total": 168044, "timesteps_this_iter": 41154, "time_since_restore": 114.9163110256195, "node_ip": "10.138.0.2", "episode_len_mean": 322.02, "hostname": "flow-main", "episode_reward_mean": -572.5855642936606, "iterations_since_restore": 4, "episode_reward_max": -23.57984982150595, "policy_reward_mean": {}, "timestamp": 1558583124, "num_metric_batches_dropped": 0, "time_this_iter_s": 29.356266260147095, "episodes_total": 181, "time_total_s": 114.9163110256195, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-45-24", "custom_metrics": {"cost2_min": -95.76691423969294, "cost1_mean": 151.72627088746583, "system_level_velocity_max": 17.27040353244418, "outflow_rate_min": 458.76434288027593, "cost1_max": 182.4767211254699, "outflow_rate_max": 1199.73178829783, "system_level_velocity_min": 9.51854562061705, "cost2_max": -18.645091040177483, "cost1_min": 17.660826000620087, "system_level_velocity_mean": 12.646492810349951, "outflow_rate_mean": 954.4585374352486, "cost2_mean": -62.236706370597915}, "training_iteration": 4, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.386727213859558, "cur_kl_coeff": 0.10000001639127731, "kl": 0.0114382803440094, "vf_explained_var": 0.7741490602493286, "vf_loss": 36.08346176147461, "total_loss": 36.07826614379883, "policy_loss": -0.006341597065329552}, "sample_time_ms": 18913.689, "num_steps_sampled": 168044, "num_steps_trained": 168044, "update_time_ms": 200.839, "load_time_ms": 23.218, "grad_time_ms": 9495.062}, "episode_reward_min": -826.7986856811572}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4b38>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 40, "timesteps_since_restore": 208404, "timesteps_total": 208404, "timesteps_this_iter": 40360, "time_since_restore": 141.54455590248108, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "episode_reward_mean": -515.0933475623765, "iterations_since_restore": 5, "episode_reward_max": -345.05975962459246, "policy_reward_mean": {}, "timestamp": 1558583151, "num_metric_batches_dropped": 0, "time_this_iter_s": 26.628244876861572, "episodes_total": 221, "time_total_s": 141.54455590248108, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-45-51", "custom_metrics": {"cost2_min": -110.05728141338025, "cost1_mean": 168.1449105965114, "system_level_velocity_max": 16.67540314279984, "outflow_rate_min": 719.7355102040818, "cost1_max": 201.28076648462675, "outflow_rate_max": 1276.6398257243936, "system_level_velocity_min": 10.858356939866297, "cost2_max": -30.43344617669959, "cost1_min": 128.33954761501133, "system_level_velocity_mean": 13.81505385093127, "outflow_rate_mean": 1075.87164333498, "cost2_mean": -73.62959945027303}, "training_iteration": 5, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.379333734512329, "cur_kl_coeff": 0.10000000894069672, "kl": 0.01252408791333437, "vf_explained_var": 0.8157219886779785, "vf_loss": 27.625030517578125, "total_loss": 27.62013816833496, "policy_loss": -0.0061468095518648624}, "sample_time_ms": 18687.944, "num_steps_sampled": 208404, "num_steps_trained": 208404, "update_time_ms": 162.243, "load_time_ms": 19.765, "grad_time_ms": 9348.057}, "episode_reward_min": -750.6645719561252}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4e10>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 41, "timesteps_since_restore": 248925, "timesteps_total": 248925, "timesteps_this_iter": 40521, "time_since_restore": 170.47393989562988, "node_ip": "10.138.0.2", "episode_len_mean": 322.1, "hostname": "flow-main", "episode_reward_mean": -468.0154686903645, "iterations_since_restore": 6, "episode_reward_max": -28.82244062407374, "policy_reward_mean": {}, "timestamp": 1558583180, "num_metric_batches_dropped": 0, "time_this_iter_s": 28.929383993148804, "episodes_total": 262, "time_total_s": 170.47393989562988, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-46-20", "custom_metrics": {"cost2_min": -114.09584981976901, "cost1_mean": 176.28177752526986, "system_level_velocity_max": 18.47241975661065, "outflow_rate_min": 508.5086992818612, "cost1_max": 212.30540466715706, "outflow_rate_max": 1353.3352718478748, "system_level_velocity_min": 10.858356939866297, "cost2_max": -21.58338389893006, "cost1_min": 22.823684217165695, "system_level_velocity_mean": 14.650353609208459, "outflow_rate_mean": 1140.212100302532, "cost2_mean": -80.21700468510589}, "training_iteration": 6, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.3605191707611084, "cur_kl_coeff": 0.10000001639127731, "kl": 0.009996146894991398, "vf_explained_var": 0.834265410900116, "vf_loss": 24.607831954956055, "total_loss": 24.602657318115234, "policy_loss": -0.0061767566949129105}, "sample_time_ms": 18640.562, "num_steps_sampled": 248925, "num_steps_trained": 248925, "update_time_ms": 136.28, "load_time_ms": 17.349, "grad_time_ms": 9529.781}, "episode_reward_min": -750.6645719561252}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad3c8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 60, "timesteps_since_restore": 287860, "timesteps_total": 287860, "timesteps_this_iter": 38935, "time_since_restore": 199.45691776275635, "node_ip": "10.138.0.2", "episode_len_mean": 322.1, "hostname": "flow-main", "episode_reward_mean": -432.8165466110903, "iterations_since_restore": 7, "episode_reward_max": -28.82244062407374, "policy_reward_mean": {}, "timestamp": 1558583209, "num_metric_batches_dropped": 0, "time_this_iter_s": 28.982977867126465, "episodes_total": 322, "time_total_s": 199.45691776275635, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-46-49", "custom_metrics": {"cost2_min": -114.09584981976901, "cost1_mean": 185.09748355990192, "system_level_velocity_max": 18.47241975661065, "outflow_rate_min": 508.5086992818612, "cost1_max": 213.01726796365543, "outflow_rate_max": 1391.7285396463296, "system_level_velocity_min": 9.782510304589643, "cost2_max": -21.58338389893006, "cost1_min": 22.823684217165695, "system_level_velocity_mean": 15.406112996348742, "outflow_rate_mean": 1209.0910025878743, "cost2_mean": -88.0660480593974}, "training_iteration": 7, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.357530951499939, "cur_kl_coeff": 0.10000000894069672, "kl": 0.013396100141108036, "vf_explained_var": 0.8108820915222168, "vf_loss": 25.56983757019043, "total_loss": 25.56377601623535, "policy_loss": -0.007401210721582174}, "sample_time_ms": 18842.422, "num_steps_sampled": 287860, "num_steps_trained": 287860, "update_time_ms": 118.138, "load_time_ms": 16.342, "grad_time_ms": 9430.43}, "episode_reward_min": -758.4265167821917}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4ac8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 40, "timesteps_since_restore": 326601, "timesteps_total": 326601, "timesteps_this_iter": 38741, "time_since_restore": 225.22828674316406, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "episode_reward_mean": -437.71568404237206, "iterations_since_restore": 8, "episode_reward_max": -302.30612175640306, "policy_reward_mean": {}, "timestamp": 1558583235, "num_metric_batches_dropped": 0, "time_this_iter_s": 25.771368980407715, "episodes_total": 362, "time_total_s": 225.22828674316406, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-47-15", "custom_metrics": {"cost2_min": -112.109178492594, "cost1_mean": 185.57327462251308, "system_level_velocity_max": 17.851663007997896, "outflow_rate_min": 848.6370231600617, "cost1_max": 213.2469300209118, "outflow_rate_max": 1391.7285396463296, "system_level_velocity_min": 9.782510304589643, "cost2_max": -56.46517249489747, "cost1_min": 117.38257481952334, "system_level_velocity_mean": 15.329362968864507, "outflow_rate_mean": 1215.4481047866057, "cost2_mean": -86.6046215729008}, "training_iteration": 8, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.3589016199111938, "cur_kl_coeff": 0.10000001639127731, "kl": 0.013180027715861797, "vf_explained_var": 0.8595584034919739, "vf_loss": 18.462472915649414, "total_loss": 18.456111907958984, "policy_loss": -0.007681889459490776}, "sample_time_ms": 18520.797, "num_steps_sampled": 326601, "num_steps_trained": 326601, "update_time_ms": 104.431, "load_time_ms": 15.112, "grad_time_ms": 9428.952}, "episode_reward_min": -758.4265167821917}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb53c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb50f0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 42, "timesteps_since_restore": 365498, "timesteps_total": 365498, "timesteps_this_iter": 38897, "time_since_restore": 252.58652567863464, "node_ip": "10.138.0.2", "episode_len_mean": 322.8, "hostname": "flow-main", "episode_reward_mean": -448.2336717452323, "iterations_since_restore": 9, "episode_reward_max": -188.89942424436285, "policy_reward_mean": {}, "timestamp": 1558583262, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.35823893547058, "episodes_total": 404, "time_total_s": 252.58652567863464, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-47-42", "custom_metrics": {"cost2_min": -112.109178492594, "cost1_mean": 179.65611373154047, "system_level_velocity_max": 18.075219726834007, "outflow_rate_min": 835.3977058002789, "cost1_max": 214.3912978859732, "outflow_rate_max": 1404.4171465510672, "system_level_velocity_min": 8.932590584457955, "cost2_max": -56.46517249489747, "cost1_min": 108.44414805906678, "system_level_velocity_mean": 14.951037109789864, "outflow_rate_mean": 1188.1533582101445, "cost2_mean": -85.2600669717372}, "training_iteration": 9, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.347102403640747, "cur_kl_coeff": 0.10000002384185791, "kl": 0.013339702039957047, "vf_explained_var": 0.8617051839828491, "vf_loss": 20.86520767211914, "total_loss": 20.859113693237305, "policy_loss": -0.007428940385580063}, "sample_time_ms": 18369.725, "num_steps_sampled": 365498, "num_steps_trained": 365498, "update_time_ms": 93.863, "load_time_ms": 13.927, "grad_time_ms": 9504.743}, "episode_reward_min": -736.8121065425061}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad5f8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 56, "timesteps_since_restore": 403900, "timesteps_total": 403900, "timesteps_this_iter": 38402, "time_since_restore": 279.81675386428833, "node_ip": "10.138.0.2", "episode_len_mean": 320.72, "hostname": "flow-main", "episode_reward_mean": -443.0634383978455, "iterations_since_restore": 10, "episode_reward_max": -96.88506764621044, "policy_reward_mean": {}, "timestamp": 1558583289, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.230228185653687, "episodes_total": 460, "time_total_s": 279.81675386428833, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-48-09", "custom_metrics": {"cost2_min": -107.47309478111838, "cost1_mean": 178.10111605405828, "system_level_velocity_max": 18.561226374605024, "outflow_rate_min": 768.4467692861858, "cost1_max": 218.514892322807, "outflow_rate_max": 1418.5957545168606, "system_level_velocity_min": 8.932590584457955, "cost2_max": -53.894578194577626, "cost1_min": 78.96613400476495, "system_level_velocity_mean": 14.968447817077536, "outflow_rate_mean": 1177.642565248799, "cost2_mean": -87.07284807021584}, "training_iteration": 10, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.3279240131378174, "cur_kl_coeff": 0.10000001639127731, "kl": 0.012172053568065166, "vf_explained_var": 0.8471937775611877, "vf_loss": 28.075559616088867, "total_loss": 28.070995330810547, "policy_loss": -0.0057785226963460445}, "sample_time_ms": 18260.613, "num_steps_sampled": 403900, "num_steps_trained": 403900, "update_time_ms": 85.426, "load_time_ms": 13.208, "grad_time_ms": 9540.685}, "episode_reward_min": -750.6153120497696}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba46d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4ac8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 43, "timesteps_since_restore": 439411, "timesteps_total": 439411, "timesteps_this_iter": 35511, "time_since_restore": 307.18599939346313, "node_ip": "10.138.0.2", "episode_len_mean": 320.94, "hostname": "flow-main", "episode_reward_mean": -420.40531802617306, "iterations_since_restore": 11, "episode_reward_max": -96.88506764621044, "policy_reward_mean": {}, "timestamp": 1558583317, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.369245529174805, "episodes_total": 503, "time_total_s": 307.18599939346313, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-48-37", "custom_metrics": {"cost2_min": -106.62069943978359, "cost1_mean": 180.37554120733625, "system_level_velocity_max": 18.561226374605024, "outflow_rate_min": 768.4467692861858, "cost1_max": 218.514892322807, "outflow_rate_max": 1418.5957545168606, "system_level_velocity_min": 10.527856585021166, "cost2_max": -53.32267130550889, "cost1_min": 78.96613400476495, "system_level_velocity_mean": 15.24244386790736, "outflow_rate_mean": 1177.8202164784284, "cost2_mean": -84.15715675970245}, "training_iteration": 11, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.3166940212249756, "cur_kl_coeff": 0.10000000149011612, "kl": 0.01691766269505024, "vf_explained_var": 0.8863861560821533, "vf_loss": 18.712858200073242, "total_loss": 18.703575134277344, "policy_loss": -0.010976427234709263}, "sample_time_ms": 17896.576, "num_steps_sampled": 439411, "num_steps_trained": 439411, "update_time_ms": 8.564, "load_time_ms": 6.664, "grad_time_ms": 9596.633}, "episode_reward_min": -750.6153120497696}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb52b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5048>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 473958, "timesteps_total": 473958, "timesteps_this_iter": 34547, "time_since_restore": 333.3732736110687, "node_ip": "10.138.0.2", "episode_len_mean": 318.86, "hostname": "flow-main", "episode_reward_mean": -411.96206498711166, "iterations_since_restore": 12, "episode_reward_max": -96.51345983688537, "policy_reward_mean": {}, "timestamp": 1558583343, "num_metric_batches_dropped": 0, "time_this_iter_s": 26.18727421760559, "episodes_total": 547, "time_total_s": 333.3732736110687, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-49-03", "custom_metrics": {"cost2_min": -103.0074190994218, "cost1_mean": 173.5697579910542, "system_level_velocity_max": 18.561226374605024, "outflow_rate_min": 768.4467692861858, "cost1_max": 218.7212831378325, "outflow_rate_max": 1414.4164844792042, "system_level_velocity_min": 10.527856585021166, "cost2_max": -48.68477893721033, "cost1_min": 78.55000466817087, "system_level_velocity_mean": 14.86861771206366, "outflow_rate_mean": 1126.019631419404, "cost2_mean": -76.41373500334568}, "training_iteration": 12, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.3195812702178955, "cur_kl_coeff": 0.10000000894069672, "kl": 0.015378016047179699, "vf_explained_var": 0.9021832346916199, "vf_loss": 18.233797073364258, "total_loss": 18.226049423217773, "policy_loss": -0.009286625310778618}, "sample_time_ms": 17728.021, "num_steps_sampled": 473958, "num_steps_trained": 473958, "update_time_ms": 8.437, "load_time_ms": 6.208, "grad_time_ms": 9789.227}, "episode_reward_min": -750.6153120497696}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad4e0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 56, "timesteps_since_restore": 507621, "timesteps_total": 507621, "timesteps_this_iter": 33663, "time_since_restore": 359.5324532985687, "node_ip": "10.138.0.2", "episode_len_mean": 315.07, "hostname": "flow-main", "episode_reward_mean": -390.51144880560935, "iterations_since_restore": 13, "episode_reward_max": -21.87651208261801, "policy_reward_mean": {}, "timestamp": 1558583369, "num_metric_batches_dropped": 0, "time_this_iter_s": 26.1591796875, "episodes_total": 603, "time_total_s": 359.5324532985687, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-49-29", "custom_metrics": {"cost2_min": -102.96279785169966, "cost1_mean": 170.48822157990955, "system_level_velocity_max": 18.631053327969394, "outflow_rate_min": 497.50056700217027, "cost1_max": 218.7212831378325, "outflow_rate_max": 1389.8717891853366, "system_level_velocity_min": 11.319442973319605, "cost2_max": -19.18449954866958, "cost1_min": 18.66070798102429, "system_level_velocity_mean": 14.90025440369431, "outflow_rate_mean": 1101.29161870613, "cost2_mean": -69.83170815026772}, "training_iteration": 13, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.3005270957946777, "cur_kl_coeff": 0.10000000894069672, "kl": 0.013602503575384617, "vf_explained_var": 0.8894714117050171, "vf_loss": 19.696977615356445, "total_loss": 19.690231323242188, "policy_loss": -0.00810398068279028}, "sample_time_ms": 17508.014, "num_steps_sampled": 507621, "num_steps_trained": 507621, "update_time_ms": 8.412, "load_time_ms": 6.249, "grad_time_ms": 9802.121}, "episode_reward_min": -518.3129485065944}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb57b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5400>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 42, "timesteps_since_restore": 541792, "timesteps_total": 541792, "timesteps_this_iter": 34171, "time_since_restore": 385.33954191207886, "node_ip": "10.138.0.2", "episode_len_mean": 317.15, "hostname": "flow-main", "episode_reward_mean": -378.8669783939975, "iterations_since_restore": 14, "episode_reward_max": -21.87651208261801, "policy_reward_mean": {}, "timestamp": 1558583395, "num_metric_batches_dropped": 0, "time_this_iter_s": 25.807088613510132, "episodes_total": 645, "time_total_s": 385.33954191207886, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-49-55", "custom_metrics": {"cost2_min": -102.96279785169966, "cost1_mean": 175.50673604337035, "system_level_velocity_max": 18.631053327969394, "outflow_rate_min": 497.50056700217027, "cost1_max": 214.19672986467236, "outflow_rate_max": 1380.0743022692402, "system_level_velocity_min": 11.005585264464688, "cost2_max": -19.18449954866958, "cost1_min": 18.66070798102429, "system_level_velocity_mean": 15.244915362454964, "outflow_rate_mean": 1120.4826161787169, "cost2_mean": -67.84827613492602}, "training_iteration": 14, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.2952297925949097, "cur_kl_coeff": 0.10000000894069672, "kl": 0.015157552435994148, "vf_explained_var": 0.9122580885887146, "vf_loss": 15.864492416381836, "total_loss": 15.85727310180664, "policy_loss": -0.008734619244933128}, "sample_time_ms": 17147.171, "num_steps_sampled": 541792, "num_steps_trained": 541792, "update_time_ms": 8.668, "load_time_ms": 6.226, "grad_time_ms": 9807.085}, "episode_reward_min": -578.4531826079052}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb50f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5048>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 42, "timesteps_since_restore": 576458, "timesteps_total": 576458, "timesteps_this_iter": 34666, "time_since_restore": 408.77859568595886, "node_ip": "10.138.0.2", "episode_len_mean": 321.9, "hostname": "flow-main", "episode_reward_mean": -385.0803750725663, "iterations_since_restore": 15, "episode_reward_max": -109.6184150167065, "policy_reward_mean": {}, "timestamp": 1558583418, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.439053773880005, "episodes_total": 687, "time_total_s": 408.77859568595886, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-50-18", "custom_metrics": {"cost2_min": -101.83262828738424, "cost1_mean": 178.0489242267306, "system_level_velocity_max": 18.303241825716885, "outflow_rate_min": 802.4595368760507, "cost1_max": 214.19672986467236, "outflow_rate_max": 1380.0743022692402, "system_level_velocity_min": 10.36029208390873, "cost2_max": -44.24704038162518, "cost1_min": 82.74183904729234, "system_level_velocity_mean": 15.195553624339945, "outflow_rate_mean": 1129.8129974413364, "cost2_mean": -67.73165698598729}, "training_iteration": 15, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.2915339469909668, "cur_kl_coeff": 0.10000001639127731, "kl": 0.013704386539757252, "vf_explained_var": 0.9199992418289185, "vf_loss": 16.021697998046875, "total_loss": 16.015823364257812, "policy_loss": -0.00724471639841795}, "sample_time_ms": 16894.394, "num_steps_sampled": 576458, "num_steps_trained": 576458, "update_time_ms": 8.777, "load_time_ms": 6.112, "grad_time_ms": 9740.65}, "episode_reward_min": -578.4531826079052}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad828>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 609943, "timesteps_total": 609943, "timesteps_this_iter": 33485, "time_since_restore": 433.0821895599365, "node_ip": "10.138.0.2", "episode_len_mean": 323.9, "hostname": "flow-main", "episode_reward_mean": -384.89772506162336, "iterations_since_restore": 16, "episode_reward_max": -196.48329513321676, "policy_reward_mean": {}, "timestamp": 1558583443, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.30359387397766, "episodes_total": 731, "time_total_s": 433.0821895599365, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-50-43", "custom_metrics": {"cost2_min": -101.83262828738424, "cost1_mean": 179.28063161786034, "system_level_velocity_max": 17.970630592177304, "outflow_rate_min": 878.1570233662192, "cost1_max": 211.72397957044114, "outflow_rate_max": 1341.1322017195394, "system_level_velocity_min": 10.36029208390873, "cost2_max": -44.24704038162518, "cost1_min": 126.90485392091138, "system_level_velocity_mean": 15.206584601286874, "outflow_rate_mean": 1134.8065217818323, "cost2_mean": -67.60648320268984}, "training_iteration": 16, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.2720390558242798, "cur_kl_coeff": 0.10000000894069672, "kl": 0.015584008768200874, "vf_explained_var": 0.9032325148582458, "vf_loss": 16.25481605529785, "total_loss": 16.247541427612305, "policy_loss": -0.008832789957523346}, "sample_time_ms": 16607.843, "num_steps_sampled": 609943, "num_steps_trained": 609943, "update_time_ms": 8.844, "load_time_ms": 6.323, "grad_time_ms": 9564.523}, "episode_reward_min": -642.747476540185}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb54e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5eb8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 55, "timesteps_since_restore": 642266, "timesteps_total": 642266, "timesteps_this_iter": 32323, "time_since_restore": 457.6935555934906, "node_ip": "10.138.0.2", "episode_len_mean": 323.54, "hostname": "flow-main", "episode_reward_mean": -361.102075248875, "iterations_since_restore": 17, "episode_reward_max": -241.44854449098492, "policy_reward_mean": {}, "timestamp": 1558583467, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.611366033554077, "episodes_total": 786, "time_total_s": 457.6935555934906, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-51-07", "custom_metrics": {"cost2_min": -98.21774382410516, "cost1_mean": 182.47281740358673, "system_level_velocity_max": 17.970630592177304, "outflow_rate_min": 897.068767840917, "cost1_max": 211.72397957044114, "outflow_rate_max": 1341.1322017195394, "system_level_velocity_min": 10.36029208390873, "cost2_max": -45.4926075390113, "cost1_min": 117.44069234527859, "system_level_velocity_mean": 15.587866645400329, "outflow_rate_mean": 1135.8633705115355, "cost2_mean": -62.71927357279749}, "training_iteration": 17, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.2715665102005005, "cur_kl_coeff": 0.10000000894069672, "kl": 0.012783406302332878, "vf_explained_var": 0.8775017857551575, "vf_loss": 16.492237091064453, "total_loss": 16.48472023010254, "policy_loss": -0.008795959874987602}, "sample_time_ms": 16220.284, "num_steps_sampled": 642266, "num_steps_trained": 642266, "update_time_ms": 8.916, "load_time_ms": 6.096, "grad_time_ms": 9515.956}, "episode_reward_min": -642.747476540185}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5da0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 41, "timesteps_since_restore": 676001, "timesteps_total": 676001, "timesteps_this_iter": 33735, "time_since_restore": 483.96593475341797, "node_ip": "10.138.0.2", "episode_len_mean": 323.26, "hostname": "flow-main", "episode_reward_mean": -353.509425526291, "iterations_since_restore": 18, "episode_reward_max": -241.44854449098492, "policy_reward_mean": {}, "timestamp": 1558583494, "num_metric_batches_dropped": 0, "time_this_iter_s": 26.272379159927368, "episodes_total": 827, "time_total_s": 483.96593475341797, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-51-34", "custom_metrics": {"cost2_min": -87.50712554362516, "cost1_mean": 183.9344518799905, "system_level_velocity_max": 17.778935413930224, "outflow_rate_min": 897.068767840917, "cost1_max": 207.6118270832838, "outflow_rate_max": 1269.9408003326723, "system_level_velocity_min": 11.11216688391178, "cost2_max": -45.4926075390113, "cost1_min": 117.44069234527859, "system_level_velocity_mean": 15.755441455250732, "outflow_rate_mean": 1137.0255148118385, "cost2_mean": -61.57227221475327}, "training_iteration": 18, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.2673962116241455, "cur_kl_coeff": 0.10000000894069672, "kl": 0.017601056024432182, "vf_explained_var": 0.9131720066070557, "vf_loss": 14.709207534790039, "total_loss": 14.702046394348145, "policy_loss": -0.008919688872992992}, "sample_time_ms": 16211.047, "num_steps_sampled": 676001, "num_steps_trained": 676001, "update_time_ms": 9.054, "load_time_ms": 6.044, "grad_time_ms": 9575.258}, "episode_reward_min": -548.2566248215456}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb56d8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 708616, "timesteps_total": 708616, "timesteps_this_iter": 32615, "time_since_restore": 508.2931134700775, "node_ip": "10.138.0.2", "episode_len_mean": 324.72, "hostname": "flow-main", "episode_reward_mean": -358.1811629877518, "iterations_since_restore": 19, "episode_reward_max": -269.9212786914407, "policy_reward_mean": {}, "timestamp": 1558583518, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.327178716659546, "episodes_total": 871, "time_total_s": 508.2931134700775, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-51-58", "custom_metrics": {"cost2_min": -97.19249793791596, "cost1_mean": 183.82874619742333, "system_level_velocity_max": 17.778935413930224, "outflow_rate_min": 907.1455693779903, "cost1_max": 207.6118270832838, "outflow_rate_max": 1265.609062561688, "system_level_velocity_min": 11.11216688391178, "cost2_max": -43.89678143820436, "cost1_min": 133.65290752778347, "system_level_velocity_mean": 15.628479473355357, "outflow_rate_mean": 1132.3808407508434, "cost2_mean": -62.51543409605123}, "training_iteration": 19, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.272283673286438, "cur_kl_coeff": 0.10000000894069672, "kl": 0.016418423503637314, "vf_explained_var": 0.9116774201393127, "vf_loss": 13.307616233825684, "total_loss": 13.298559188842773, "policy_loss": -0.010698881931602955}, "sample_time_ms": 16065.911, "num_steps_sampled": 708616, "num_steps_trained": 708616, "update_time_ms": 8.962, "load_time_ms": 6.138, "grad_time_ms": 9417.809}, "episode_reward_min": -573.0669761655406}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb57b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb59e8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 56, "timesteps_since_restore": 741178, "timesteps_total": 741178, "timesteps_this_iter": 32562, "time_since_restore": 535.3121695518494, "node_ip": "10.138.0.2", "episode_len_mean": 319.94, "hostname": "flow-main", "episode_reward_mean": -344.51985206028473, "iterations_since_restore": 20, "episode_reward_max": -22.96066467718289, "policy_reward_mean": {}, "timestamp": 1558583545, "num_metric_batches_dropped": 0, "time_this_iter_s": 27.01905608177185, "episodes_total": 927, "time_total_s": 535.3121695518494, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-52-25", "custom_metrics": {"cost2_min": -97.19249793791596, "cost1_mean": 182.98877251803935, "system_level_velocity_max": 18.021711162959903, "outflow_rate_min": 444.6769763958757, "cost1_max": 208.70521422502287, "outflow_rate_max": 1296.723165275916, "system_level_velocity_min": 11.97665277387293, "cost2_max": -20.878773491922157, "cost1_min": 18.00187934372244, "system_level_velocity_mean": 15.80831396686694, "outflow_rate_mean": 1129.1430324510704, "cost2_mean": -60.61463324984602}, "training_iteration": 20, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.2703737020492554, "cur_kl_coeff": 0.10000000894069672, "kl": 0.016736047342419624, "vf_explained_var": 0.8914433121681213, "vf_loss": 15.381686210632324, "total_loss": 15.373671531677246, "policy_loss": -0.009687156416475773}, "sample_time_ms": 16053.236, "num_steps_sampled": 741178, "num_steps_trained": 741178, "update_time_ms": 8.965, "load_time_ms": 5.837, "grad_time_ms": 9409.271}, "episode_reward_min": -573.0669761655406}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bada58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badf28>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 42, "timesteps_since_restore": 773367, "timesteps_total": 773367, "timesteps_this_iter": 32189, "time_since_restore": 558.9966771602631, "node_ip": "10.138.0.2", "episode_len_mean": 318.61, "hostname": "flow-main", "episode_reward_mean": -334.60764419177707, "iterations_since_restore": 21, "episode_reward_max": -22.96066467718289, "policy_reward_mean": {}, "timestamp": 1558583569, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.684507608413696, "episodes_total": 969, "time_total_s": 558.9966771602631, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-52-49", "custom_metrics": {"cost2_min": -76.2068625373241, "cost1_mean": 183.2068222129916, "system_level_velocity_max": 18.021711162959903, "outflow_rate_min": 444.6769763958757, "cost1_max": 208.70521422502287, "outflow_rate_max": 1296.723165275916, "system_level_velocity_min": 11.97665277387293, "cost2_max": -20.878773491922157, "cost1_min": 18.00187934372244, "system_level_velocity_mean": 15.910932911298737, "outflow_rate_mean": 1128.2763573456616, "cost2_mean": -58.828388606837315}, "training_iteration": 21, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.2436050176620483, "cur_kl_coeff": 0.10000000894069672, "kl": 0.016002051532268524, "vf_explained_var": 0.8870993256568909, "vf_loss": 13.730642318725586, "total_loss": 13.72355842590332, "policy_loss": -0.008683037012815475}, "sample_time_ms": 15947.168, "num_steps_sampled": 773367, "num_steps_trained": 773367, "update_time_ms": 8.825, "load_time_ms": 6.039, "grad_time_ms": 9147.617}, "episode_reward_min": -517.1075330013643}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb58d0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 805197, "timesteps_total": 805197, "timesteps_this_iter": 31830, "time_since_restore": 582.7683324813843, "node_ip": "10.138.0.2", "episode_len_mean": 323.67, "hostname": "flow-main", "episode_reward_mean": -329.4537591597701, "iterations_since_restore": 22, "episode_reward_max": -193.87275016778102, "policy_reward_mean": {}, "timestamp": 1558583593, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.771655321121216, "episodes_total": 1013, "time_total_s": 582.7683324813843, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-53-13", "custom_metrics": {"cost2_min": -76.13280700470824, "cost1_mean": 188.12705434668987, "system_level_velocity_max": 17.930222993542237, "outflow_rate_min": 988.0592916148563, "cost1_max": 209.5076649390079, "outflow_rate_max": 1296.7859740259744, "system_level_velocity_min": 13.617715284770467, "cost2_max": -36.47217462621204, "cost1_min": 134.15411313776374, "system_level_velocity_mean": 16.10011054673141, "outflow_rate_mean": 1146.43287818476, "cost2_mean": -57.50239897059769}, "training_iteration": 22, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.2476903200149536, "cur_kl_coeff": 0.10000000894069672, "kl": 0.01592624932527542, "vf_explained_var": 0.8820741772651672, "vf_loss": 12.1868314743042, "total_loss": 12.179902076721191, "policy_loss": -0.008521308191120625}, "sample_time_ms": 15893.027, "num_steps_sampled": 805197, "num_steps_trained": 805197, "update_time_ms": 8.725, "load_time_ms": 5.823, "grad_time_ms": 8959.084}, "episode_reward_min": -467.9221609894372}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5748>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 52, "timesteps_since_restore": 837895, "timesteps_total": 837895, "timesteps_this_iter": 32698, "time_since_restore": 607.6642918586731, "node_ip": "10.138.0.2", "episode_len_mean": 321.07, "hostname": "flow-main", "episode_reward_mean": -323.4273271501429, "iterations_since_restore": 23, "episode_reward_max": -30.872934787227685, "policy_reward_mean": {}, "timestamp": 1558583618, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.89595937728882, "episodes_total": 1065, "time_total_s": 607.6642918586731, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-53-38", "custom_metrics": {"cost2_min": -82.50466829531875, "cost1_mean": 188.13886913844436, "system_level_velocity_max": 18.71688064742293, "outflow_rate_min": 489.56319047111253, "cost1_max": 209.5521933730501, "outflow_rate_max": 1320.3656915352267, "system_level_velocity_min": 13.0577066914194, "cost2_max": -22.470890544007386, "cost1_min": 24.340740388119062, "system_level_velocity_mean": 16.266018126096707, "outflow_rate_mean": 1146.545664805616, "cost2_mean": -57.3508643443903}, "training_iteration": 23, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.2290996313095093, "cur_kl_coeff": 0.10000000894069672, "kl": 0.015627693384885788, "vf_explained_var": 0.8931772112846375, "vf_loss": 13.947762489318848, "total_loss": 13.94039249420166, "policy_loss": -0.00893374066799879}, "sample_time_ms": 15883.524, "num_steps_sampled": 837895, "num_steps_trained": 837895, "update_time_ms": 8.948, "load_time_ms": 5.612, "grad_time_ms": 8842.61}, "episode_reward_min": -449.45387032419853}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5470>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 43, "timesteps_since_restore": 870757, "timesteps_total": 870757, "timesteps_this_iter": 32862, "time_since_restore": 630.981439113617, "node_ip": "10.138.0.2", "episode_len_mean": 321.84, "hostname": "flow-main", "episode_reward_mean": -333.6800851906573, "iterations_since_restore": 24, "episode_reward_max": -30.872934787227685, "policy_reward_mean": {}, "timestamp": 1558583641, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.317147254943848, "episodes_total": 1108, "time_total_s": 630.981439113617, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-54-01", "custom_metrics": {"cost2_min": -82.50466829531875, "cost1_mean": 186.74004482796656, "system_level_velocity_max": 18.71688064742293, "outflow_rate_min": 489.56319047111253, "cost1_max": 210.36386934713522, "outflow_rate_max": 1320.3656915352267, "system_level_velocity_min": 11.612057828972963, "cost2_max": -22.470890544007386, "cost1_min": 24.340740388119062, "system_level_velocity_mean": 16.042867755052352, "outflow_rate_mean": 1141.31084439397, "cost2_mean": -59.27667305619733}, "training_iteration": 24, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.2359507083892822, "cur_kl_coeff": 0.10000001639127731, "kl": 0.017920617014169693, "vf_explained_var": 0.9087504148483276, "vf_loss": 11.977566719055176, "total_loss": 11.969219207763672, "policy_loss": -0.01013969350606203}, "sample_time_ms": 15843.875, "num_steps_sampled": 870757, "num_steps_trained": 870757, "update_time_ms": 8.681, "load_time_ms": 5.592, "grad_time_ms": 8634.402}, "episode_reward_min": -521.6154685531676}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5eb8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 47, "timesteps_since_restore": 903323, "timesteps_total": 903323, "timesteps_this_iter": 32566, "time_since_restore": 654.6526675224304, "node_ip": "10.138.0.2", "episode_len_mean": 320.38, "hostname": "flow-main", "episode_reward_mean": -332.44320011346855, "iterations_since_restore": 25, "episode_reward_max": -30.872934787227685, "policy_reward_mean": {}, "timestamp": 1558583665, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.671228408813477, "episodes_total": 1155, "time_total_s": 654.6526675224304, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-54-25", "custom_metrics": {"cost2_min": -82.50466829531875, "cost1_mean": 185.9425601111809, "system_level_velocity_max": 18.71688064742293, "outflow_rate_min": 489.56319047111253, "cost1_max": 210.36386934713522, "outflow_rate_max": 1320.3656915352267, "system_level_velocity_min": 11.612057828972963, "cost2_max": -22.470890544007386, "cost1_min": 24.340740388119062, "system_level_velocity_mean": 16.047048581284383, "outflow_rate_mean": 1136.2392849979435, "cost2_mean": -58.019219518192564}, "training_iteration": 25, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.2267671823501587, "cur_kl_coeff": 0.10000000894069672, "kl": 0.019604887813329697, "vf_explained_var": 0.8969419002532959, "vf_loss": 12.5890474319458, "total_loss": 12.58009147644043, "policy_loss": -0.010916275903582573}, "sample_time_ms": 15867.262, "num_steps_sampled": 903323, "num_steps_trained": 903323, "update_time_ms": 8.814, "load_time_ms": 5.735, "grad_time_ms": 8634.05}, "episode_reward_min": -521.6154685531676}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5ac8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 50, "timesteps_since_restore": 935556, "timesteps_total": 935556, "timesteps_this_iter": 32233, "time_since_restore": 678.3826565742493, "node_ip": "10.138.0.2", "episode_len_mean": 322.36, "hostname": "flow-main", "episode_reward_mean": -328.4259387069819, "iterations_since_restore": 26, "episode_reward_max": -171.36047832252547, "policy_reward_mean": {}, "timestamp": 1558583689, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.729989051818848, "episodes_total": 1205, "time_total_s": 678.3826565742493, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-54-49", "custom_metrics": {"cost2_min": -74.62351777199, "cost1_mean": 188.17671554973927, "system_level_velocity_max": 18.024203565561386, "outflow_rate_min": 888.0168619262959, "cost1_max": 208.0996898120638, "outflow_rate_max": 1266.9924895113184, "system_level_velocity_min": 11.947991801567838, "cost2_max": -42.92331216564428, "cost1_min": 119.35325169860377, "system_level_velocity_mean": 16.135557121114207, "outflow_rate_mean": 1145.9070323630924, "cost2_mean": -56.79720025192979}, "training_iteration": 26, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.2238479852676392, "cur_kl_coeff": 0.10000000894069672, "kl": 0.018001684918999672, "vf_explained_var": 0.8899404406547546, "vf_loss": 12.33098030090332, "total_loss": 12.322823524475098, "policy_loss": -0.009957216680049896}, "sample_time_ms": 15851.309, "num_steps_sampled": 935556, "num_steps_trained": 935556, "update_time_ms": 8.789, "load_time_ms": 5.37, "grad_time_ms": 8593.545}, "episode_reward_min": -499.18513697522565}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc60f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc60b8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 969276, "timesteps_total": 969276, "timesteps_this_iter": 33720, "time_since_restore": 702.6210432052612, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "episode_reward_mean": -339.2080951042585, "iterations_since_restore": 27, "episode_reward_max": -171.36047832252547, "policy_reward_mean": {}, "timestamp": 1558583713, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.238386631011963, "episodes_total": 1249, "time_total_s": 702.6210432052612, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-55-13", "custom_metrics": {"cost2_min": -76.55168930552927, "cost1_mean": 187.8701917810261, "system_level_velocity_max": 18.024203565561386, "outflow_rate_min": 915.3333592318727, "cost1_max": 208.41533766782976, "outflow_rate_max": 1266.9924895113184, "system_level_velocity_min": 11.947991801567838, "cost2_max": -42.92331216564428, "cost1_min": 132.9322394462254, "system_level_velocity_mean": 15.97846427623766, "outflow_rate_mean": 1145.1868391045352, "cost2_mean": -59.69845247399689}, "training_iteration": 27, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.2040879726409912, "cur_kl_coeff": 0.10000000894069672, "kl": 0.016529938206076622, "vf_explained_var": 0.8860408067703247, "vf_loss": 15.150529861450195, "total_loss": 15.143271446228027, "policy_loss": -0.008911345154047012}, "sample_time_ms": 15809.259, "num_steps_sampled": 969276, "num_steps_trained": 969276, "update_time_ms": 8.525, "load_time_ms": 5.102, "grad_time_ms": 8599.046}, "episode_reward_min": -480.0362611713592}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd5c0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 1001482, "timesteps_total": 1001482, "timesteps_this_iter": 32206, "time_since_restore": 726.2148201465607, "node_ip": "10.138.0.2", "episode_len_mean": 322.72, "hostname": "flow-main", "episode_reward_mean": -336.2356122839494, "iterations_since_restore": 28, "episode_reward_max": -171.36047832252547, "policy_reward_mean": {}, "timestamp": 1558583737, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.59377694129944, "episodes_total": 1293, "time_total_s": 726.2148201465607, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-55-37", "custom_metrics": {"cost2_min": -76.55168930552927, "cost1_mean": 187.5479482137871, "system_level_velocity_max": 18.137315377919553, "outflow_rate_min": 938.93975, "cost1_max": 208.4176604282066, "outflow_rate_max": 1265.03589418693, "system_level_velocity_min": 12.38658302453292, "cost2_max": -43.24496398025458, "cost1_min": 132.9322394462254, "system_level_velocity_mean": 16.019755018785997, "outflow_rate_mean": 1143.7735470884352, "cost2_mean": -59.73424605700919}, "training_iteration": 28, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.2029577493667603, "cur_kl_coeff": 0.10000000894069672, "kl": 0.01867586001753807, "vf_explained_var": 0.8984453678131104, "vf_loss": 10.757801055908203, "total_loss": 10.749579429626465, "policy_loss": -0.010088703595101833}, "sample_time_ms": 15739.374, "num_steps_sampled": 1001482, "num_steps_trained": 1001482, "update_time_ms": 8.316, "load_time_ms": 5.001, "grad_time_ms": 8399.838}, "episode_reward_min": -482.3863410571268}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5b70>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 46, "timesteps_since_restore": 1033573, "timesteps_total": 1033573, "timesteps_this_iter": 32091, "time_since_restore": 749.4477415084839, "node_ip": "10.138.0.2", "episode_len_mean": 322.82, "hostname": "flow-main", "episode_reward_mean": -329.17412681875686, "iterations_since_restore": 29, "episode_reward_max": -177.47517759600964, "policy_reward_mean": {}, "timestamp": 1558583760, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.232921361923218, "episodes_total": 1339, "time_total_s": 749.4477415084839, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-56-00", "custom_metrics": {"cost2_min": -76.55168930552927, "cost1_mean": 187.83319834241604, "system_level_velocity_max": 18.23341261592574, "outflow_rate_min": 938.93975, "cost1_max": 211.45272066884345, "outflow_rate_max": 1265.03589418693, "system_level_velocity_min": 12.38658302453292, "cost2_max": -40.07296159381367, "cost1_min": 136.33388980839538, "system_level_velocity_mean": 16.05987203486548, "outflow_rate_mean": 1140.7586611492181, "cost2_mean": -57.1017737508681}, "training_iteration": 29, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.186995506286621, "cur_kl_coeff": 0.10000001639127731, "kl": 0.017894422635436058, "vf_explained_var": 0.8731797933578491, "vf_loss": 13.018052101135254, "total_loss": 13.011568069458008, "policy_loss": -0.008272215723991394}, "sample_time_ms": 15690.19, "num_steps_sampled": 1033573, "num_steps_trained": 1033573, "update_time_ms": 8.41, "load_time_ms": 5.069, "grad_time_ms": 8339.111}, "episode_reward_min": -482.3863410571268}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc64e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6198>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 50, "timesteps_since_restore": 1065730, "timesteps_total": 1065730, "timesteps_this_iter": 32157, "time_since_restore": 774.2050702571869, "node_ip": "10.138.0.2", "episode_len_mean": 320.94, "hostname": "flow-main", "episode_reward_mean": -322.59239466775716, "iterations_since_restore": 30, "episode_reward_max": -21.068320563979732, "policy_reward_mean": {}, "timestamp": 1558583785, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.757328748703003, "episodes_total": 1389, "time_total_s": 774.2050702571869, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-56-25", "custom_metrics": {"cost2_min": -78.60593210983446, "cost1_mean": 187.4535329368877, "system_level_velocity_max": 18.23341261592574, "outflow_rate_min": 492.0625426222078, "cost1_max": 211.45272066884345, "outflow_rate_max": 1257.3396393059684, "system_level_velocity_min": 12.778856054935428, "cost2_max": -18.499446157947173, "cost1_min": 18.001968376806815, "system_level_velocity_mean": 16.171580684845186, "outflow_rate_mean": 1130.8452988028707, "cost2_mean": -55.26495462267187}, "training_iteration": 30, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1779435873031616, "cur_kl_coeff": 0.10000000894069672, "kl": 0.01932789385318756, "vf_explained_var": 0.8969234228134155, "vf_loss": 11.582219123840332, "total_loss": 11.57477855682373, "policy_loss": -0.009372783824801445}, "sample_time_ms": 15662.532, "num_steps_sampled": 1065730, "num_steps_trained": 1065730, "update_time_ms": 8.233, "load_time_ms": 5.21, "grad_time_ms": 8141.121}, "episode_reward_min": -471.66368887403166}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdc50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd630>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 43, "timesteps_since_restore": 1098074, "timesteps_total": 1098074, "timesteps_this_iter": 32344, "time_since_restore": 798.7315652370453, "node_ip": "10.138.0.2", "episode_len_mean": 321.74, "hostname": "flow-main", "episode_reward_mean": -324.1822953222547, "iterations_since_restore": 31, "episode_reward_max": -21.068320563979732, "policy_reward_mean": {}, "timestamp": 1558583809, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.5264949798584, "episodes_total": 1432, "time_total_s": 798.7315652370453, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-56-49", "custom_metrics": {"cost2_min": -78.60593210983446, "cost1_mean": 187.31906041839179, "system_level_velocity_max": 18.104720632858776, "outflow_rate_min": 492.0625426222078, "cost1_max": 210.71239621285144, "outflow_rate_max": 1247.9318496485953, "system_level_velocity_min": 12.255367435082288, "cost2_max": -18.499446157947173, "cost1_min": 18.001968376806815, "system_level_velocity_mean": 16.132456704825014, "outflow_rate_mean": 1129.411973015663, "cost2_mean": -54.757066641196595}, "training_iteration": 31, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1765574216842651, "cur_kl_coeff": 0.10000000894069672, "kl": 0.018952108919620514, "vf_explained_var": 0.9129028916358948, "vf_loss": 10.645744323730469, "total_loss": 10.636781692504883, "policy_loss": -0.010856439359486103}, "sample_time_ms": 15762.098, "num_steps_sampled": 1098074, "num_steps_trained": 1098074, "update_time_ms": 8.325, "load_time_ms": 4.935, "grad_time_ms": 8126.094}, "episode_reward_min": -487.7537898164983}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5780>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 47, "timesteps_since_restore": 1129172, "timesteps_total": 1129172, "timesteps_this_iter": 31098, "time_since_restore": 821.6680853366852, "node_ip": "10.138.0.2", "episode_len_mean": 322.36, "hostname": "flow-main", "episode_reward_mean": -317.39276843890315, "iterations_since_restore": 32, "episode_reward_max": -165.73088752136084, "policy_reward_mean": {}, "timestamp": 1558583832, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.936520099639893, "episodes_total": 1479, "time_total_s": 821.6680853366852, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-57-12", "custom_metrics": {"cost2_min": -77.20538284975731, "cost1_mean": 189.36003564601143, "system_level_velocity_max": 18.074449918740513, "outflow_rate_min": 896.8653510108916, "cost1_max": 207.95361614421589, "outflow_rate_max": 1247.9318496485953, "system_level_velocity_min": 12.242937073300963, "cost2_max": -37.87309657056233, "cost1_min": 121.23741088323911, "system_level_velocity_mean": 16.306171044541433, "outflow_rate_mean": 1135.9897067230602, "cost2_mean": -52.96438917368704}, "training_iteration": 32, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1849602460861206, "cur_kl_coeff": 0.10000001639127731, "kl": 0.017559390515089035, "vf_explained_var": 0.8860106468200684, "vf_loss": 9.996753692626953, "total_loss": 9.991386413574219, "policy_loss": -0.007124054711312056}, "sample_time_ms": 15719.746, "num_steps_sampled": 1129172, "num_steps_trained": 1129172, "update_time_ms": 8.297, "load_time_ms": 5.252, "grad_time_ms": 8086.643}, "episode_reward_min": -487.7537898164983}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6400>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 50, "timesteps_since_restore": 1160235, "timesteps_total": 1160235, "timesteps_this_iter": 31063, "time_since_restore": 844.9795141220093, "node_ip": "10.138.0.2", "episode_len_mean": 322.46, "hostname": "flow-main", "episode_reward_mean": -305.1059243119703, "iterations_since_restore": 33, "episode_reward_max": -165.73088752136084, "policy_reward_mean": {}, "timestamp": 1558583856, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.311428785324097, "episodes_total": 1529, "time_total_s": 844.9795141220093, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-57-36", "custom_metrics": {"cost2_min": -68.56633630079679, "cost1_mean": 191.45190557474223, "system_level_velocity_max": 18.08471920578877, "outflow_rate_min": 896.8653510108916, "cost1_max": 208.3000553757559, "outflow_rate_max": 1228.6258305531069, "system_level_velocity_min": 12.242937073300963, "cost2_max": -37.87309657056233, "cost1_min": 121.23741088323911, "system_level_velocity_mean": 16.518025834119673, "outflow_rate_mean": 1137.9332337518308, "cost2_mean": -50.319568710541944}, "training_iteration": 33, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.189650535583496, "cur_kl_coeff": 0.10000001639127731, "kl": 0.018556050956249237, "vf_explained_var": 0.8914452195167542, "vf_loss": 10.389018058776855, "total_loss": 10.380119323730469, "policy_loss": -0.010755551047623158}, "sample_time_ms": 15639.777, "num_steps_sampled": 1160235, "num_steps_trained": 1160235, "update_time_ms": 8.255, "load_time_ms": 5.33, "grad_time_ms": 8008.621}, "episode_reward_min": -487.2108597697407}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdcf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdc50>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 1191694, "timesteps_total": 1191694, "timesteps_this_iter": 31459, "time_since_restore": 868.6578710079193, "node_ip": "10.138.0.2", "episode_len_mean": 323.64, "hostname": "flow-main", "episode_reward_mean": -304.12348529647545, "iterations_since_restore": 34, "episode_reward_max": -165.73088752136084, "policy_reward_mean": {}, "timestamp": 1558583879, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.678356885910034, "episodes_total": 1574, "time_total_s": 868.6578710079193, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-57-59", "custom_metrics": {"cost2_min": -68.56633630079679, "cost1_mean": 191.9386971413577, "system_level_velocity_max": 18.28946576133327, "outflow_rate_min": 932.0117791040267, "cost1_max": 208.7517177013905, "outflow_rate_max": 1241.8896924851047, "system_level_velocity_min": 13.081582040939368, "cost2_max": -37.87309657056233, "cost1_min": 131.2713633103256, "system_level_velocity_mean": 16.49573405309664, "outflow_rate_mean": 1138.7342841558013, "cost2_mean": -50.20071052540273}, "training_iteration": 34, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1862354278564453, "cur_kl_coeff": 0.10000002384185791, "kl": 0.018315808847546577, "vf_explained_var": 0.9054099917411804, "vf_loss": 9.077949523925781, "total_loss": 9.070385932922363, "policy_loss": -0.009396429173648357}, "sample_time_ms": 15667.196, "num_steps_sampled": 1191694, "num_steps_trained": 1191694, "update_time_ms": 8.259, "load_time_ms": 5.387, "grad_time_ms": 8017.024}, "episode_reward_min": -429.0395744280593}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4ba8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 1223035, "timesteps_total": 1223035, "timesteps_this_iter": 31341, "time_since_restore": 892.0669481754303, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "episode_reward_mean": -300.63550076252477, "iterations_since_restore": 35, "episode_reward_max": -218.30146638677616, "policy_reward_mean": {}, "timestamp": 1558583903, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.409077167510986, "episodes_total": 1618, "time_total_s": 892.0669481754303, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-58-23", "custom_metrics": {"cost2_min": -66.4400531598118, "cost1_mean": 193.46438519116532, "system_level_velocity_max": 18.28946576133327, "outflow_rate_min": 892.4216302027843, "cost1_max": 210.5446243184388, "outflow_rate_max": 1241.8896924851047, "system_level_velocity_min": 13.258434002550823, "cost2_max": -38.89492603464461, "cost1_min": 119.85985048168851, "system_level_velocity_mean": 16.594721651088935, "outflow_rate_mean": 1147.7904311561592, "cost2_mean": -51.340223053837555}, "training_iteration": 35, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1848084926605225, "cur_kl_coeff": 0.10000002384185791, "kl": 0.016797762364149094, "vf_explained_var": 0.8971914052963257, "vf_loss": 9.100564956665039, "total_loss": 9.095287322998047, "policy_loss": -0.006958457175642252}, "sample_time_ms": 15663.406, "num_steps_sampled": 1223035, "num_steps_trained": 1223035, "update_time_ms": 8.065, "load_time_ms": 5.276, "grad_time_ms": 7994.894}, "episode_reward_min": -417.22013751346356}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f536adf2898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6f98>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 47, "timesteps_since_restore": 1254397, "timesteps_total": 1254397, "timesteps_this_iter": 31362, "time_since_restore": 915.9152038097382, "node_ip": "10.138.0.2", "episode_len_mean": 320.84, "hostname": "flow-main", "episode_reward_mean": -297.02472573640944, "iterations_since_restore": 36, "episode_reward_max": -22.147942485246222, "policy_reward_mean": {}, "timestamp": 1558583927, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.84825563430786, "episodes_total": 1665, "time_total_s": 915.9152038097382, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-58-47", "custom_metrics": {"cost2_min": -66.4400531598118, "cost1_mean": 192.41796435822928, "system_level_velocity_max": 18.46951673612551, "outflow_rate_min": 477.24354782665716, "cost1_max": 211.54388764621808, "outflow_rate_max": 1245.8644218206273, "system_level_velocity_min": 13.666113926219467, "cost2_max": -16.9332456597598, "cost1_min": 17.77351830460073, "system_level_velocity_mean": 16.654495283864073, "outflow_rate_mean": 1144.506028952281, "cost2_mean": -52.101352460342326}, "training_iteration": 36, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1796560287475586, "cur_kl_coeff": 0.10000002384185791, "kl": 0.017721498385071754, "vf_explained_var": 0.8839106559753418, "vf_loss": 9.826067924499512, "total_loss": 9.820067405700684, "policy_loss": -0.007773242890834808}, "sample_time_ms": 15706.719, "num_steps_sampled": 1254397, "num_steps_trained": 1254397, "update_time_ms": 8.104, "load_time_ms": 5.682, "grad_time_ms": 7963.074}, "episode_reward_min": -405.6259588842431}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6dd8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 49, "timesteps_since_restore": 1286143, "timesteps_total": 1286143, "timesteps_this_iter": 31746, "time_since_restore": 939.3334858417511, "node_ip": "10.138.0.2", "episode_len_mean": 320.64, "hostname": "flow-main", "episode_reward_mean": -301.19805210764355, "iterations_since_restore": 37, "episode_reward_max": -22.147942485246222, "policy_reward_mean": {}, "timestamp": 1558583950, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.41828203201294, "episodes_total": 1714, "time_total_s": 939.3334858417511, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-59-10", "custom_metrics": {"cost2_min": -62.52342431686971, "cost1_mean": 191.3556260758209, "system_level_velocity_max": 18.46951673612551, "outflow_rate_min": 477.24354782665716, "cost1_max": 211.54388764621808, "outflow_rate_max": 1245.8644218206273, "system_level_velocity_min": 13.666113926219467, "cost2_max": -16.9332456597598, "cost1_min": 17.77351830460073, "system_level_velocity_mean": 16.568391392861685, "outflow_rate_mean": 1142.488087699011, "cost2_mean": -52.6793079278585}, "training_iteration": 37, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.165313959121704, "cur_kl_coeff": 0.10000000894069672, "kl": 0.019656503573060036, "vf_explained_var": 0.9061523675918579, "vf_loss": 8.912028312683105, "total_loss": 8.904147148132324, "policy_loss": -0.009847191162407398}, "sample_time_ms": 15676.413, "num_steps_sampled": 1286143, "num_steps_trained": 1286143, "update_time_ms": 8.044, "load_time_ms": 5.54, "grad_time_ms": 7910.984}, "episode_reward_min": -405.6259588842431}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f536adf2898>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 46, "timesteps_since_restore": 1317489, "timesteps_total": 1317489, "timesteps_this_iter": 31346, "time_since_restore": 963.1113669872284, "node_ip": "10.138.0.2", "episode_len_mean": 323.35, "hostname": "flow-main", "episode_reward_mean": -309.4635040159133, "iterations_since_restore": 38, "episode_reward_max": -171.37035538791977, "policy_reward_mean": {}, "timestamp": 1558583974, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.777881145477295, "episodes_total": 1760, "time_total_s": 963.1113669872284, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-59-34", "custom_metrics": {"cost2_min": -76.11170029021952, "cost1_mean": 191.18976905808518, "system_level_velocity_max": 18.327869030733478, "outflow_rate_min": 972.285757482782, "cost1_max": 209.91091498566485, "outflow_rate_max": 1245.4722295145982, "system_level_velocity_min": 12.724940574099316, "cost2_max": -39.562876966239955, "cost1_min": 128.9452487095347, "system_level_velocity_mean": 16.409940148610136, "outflow_rate_mean": 1143.6067828568325, "cost2_mean": -53.76179843068137}, "training_iteration": 38, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1730897426605225, "cur_kl_coeff": 0.10000002384185791, "kl": 0.02070106565952301, "vf_explained_var": 0.8967277407646179, "vf_loss": 9.89489459991455, "total_loss": 9.887493133544922, "policy_loss": -0.00947201531380415}, "sample_time_ms": 15660.205, "num_steps_sampled": 1317489, "num_steps_trained": 1317489, "update_time_ms": 8.102, "load_time_ms": 5.853, "grad_time_ms": 7947.529}, "episode_reward_min": -513.1655082772033}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdb38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbddd8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 1348574, "timesteps_total": 1348574, "timesteps_this_iter": 31085, "time_since_restore": 986.6869053840637, "node_ip": "10.138.0.2", "episode_len_mean": 323.27, "hostname": "flow-main", "episode_reward_mean": -311.43655235895943, "iterations_since_restore": 39, "episode_reward_max": -159.93603933101843, "policy_reward_mean": {}, "timestamp": 1558583998, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.575538396835327, "episodes_total": 1805, "time_total_s": 986.6869053840637, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_03-59-58", "custom_metrics": {"cost2_min": -76.11170029021952, "cost1_mean": 190.27975054955087, "system_level_velocity_max": 18.328057520489203, "outflow_rate_min": 957.7860131928121, "cost1_max": 209.70430261226403, "outflow_rate_max": 1245.4722295145982, "system_level_velocity_min": 12.724940574099316, "cost2_max": -39.11522482605737, "cost1_min": 134.0214495802818, "system_level_velocity_mean": 16.36572217171552, "outflow_rate_mean": 1134.236892769592, "cost2_mean": -53.37649303494218}, "training_iteration": 39, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.171025276184082, "cur_kl_coeff": 0.14999999105930328, "kl": 0.016223179176449776, "vf_explained_var": 0.8952959775924683, "vf_loss": 9.602553367614746, "total_loss": 9.597539901733398, "policy_loss": -0.0074457130394876}, "sample_time_ms": 15715.458, "num_steps_sampled": 1348574, "num_steps_trained": 1348574, "update_time_ms": 7.892, "load_time_ms": 6.119, "grad_time_ms": 7927.634}, "episode_reward_min": -513.1655082772033}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6c88>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 51, "timesteps_since_restore": 1379667, "timesteps_total": 1379667, "timesteps_this_iter": 31093, "time_since_restore": 1010.0718853473663, "node_ip": "10.138.0.2", "episode_len_mean": 322.09, "hostname": "flow-main", "episode_reward_mean": -301.7258578061928, "iterations_since_restore": 40, "episode_reward_max": -155.8591418798671, "policy_reward_mean": {}, "timestamp": 1558584021, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.384979963302612, "episodes_total": 1856, "time_total_s": 1010.0718853473663, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-00-21", "custom_metrics": {"cost2_min": -68.05226128453822, "cost1_mean": 191.16575548397486, "system_level_velocity_max": 18.647516110737733, "outflow_rate_min": 957.7860131928121, "cost1_max": 212.26326411861098, "outflow_rate_max": 1245.156119894248, "system_level_velocity_min": 13.522607921265797, "cost2_max": -39.11522482605737, "cost1_min": 133.30539624954903, "system_level_velocity_mean": 16.530532200416815, "outflow_rate_mean": 1134.4286249643283, "cost2_mean": -52.11761129236661}, "training_iteration": 40, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1776372194290161, "cur_kl_coeff": 0.14999999105930328, "kl": 0.0157069843262434, "vf_explained_var": 0.8969053030014038, "vf_loss": 9.690268516540527, "total_loss": 9.684792518615723, "policy_loss": -0.007832123897969723}, "sample_time_ms": 15584.633, "num_steps_sampled": 1379667, "num_steps_trained": 1379667, "update_time_ms": 7.809, "load_time_ms": 5.985, "grad_time_ms": 7921.636}, "episode_reward_min": -445.7095797293178}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6978>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 1410173, "timesteps_total": 1410173, "timesteps_this_iter": 30506, "time_since_restore": 1034.3532445430756, "node_ip": "10.138.0.2", "episode_len_mean": 320.84, "hostname": "flow-main", "episode_reward_mean": -292.9277096338133, "iterations_since_restore": 41, "episode_reward_max": -22.614765704711942, "policy_reward_mean": {}, "timestamp": 1558584045, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.28135919570923, "episodes_total": 1901, "time_total_s": 1034.3532445430756, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-00-45", "custom_metrics": {"cost2_min": -68.05226128453822, "cost1_mean": 192.10367849621488, "system_level_velocity_max": 18.647516110737733, "outflow_rate_min": 448.5093812448499, "cost1_max": 212.26326411861098, "outflow_rate_max": 1245.156119894248, "system_level_velocity_min": 13.35870306604939, "cost2_max": -19.038975027364327, "cost1_min": 17.714090572828997, "system_level_velocity_mean": 16.730374648597987, "outflow_rate_mean": 1127.7500862844486, "cost2_mean": -50.16867653765412}, "training_iteration": 41, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1801260709762573, "cur_kl_coeff": 0.14999999105930328, "kl": 0.016785239800810814, "vf_explained_var": 0.8847000598907471, "vf_loss": 10.233651161193848, "total_loss": 10.227295875549316, "policy_loss": -0.008871226571500301}, "sample_time_ms": 15597.198, "num_steps_sampled": 1410173, "num_steps_trained": 1410173, "update_time_ms": 7.633, "load_time_ms": 5.903, "grad_time_ms": 7884.904}, "episode_reward_min": -430.0247577507136}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd2b0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 43, "timesteps_since_restore": 1440458, "timesteps_total": 1440458, "timesteps_this_iter": 30285, "time_since_restore": 1057.5885803699493, "node_ip": "10.138.0.2", "episode_len_mean": 320.56, "hostname": "flow-main", "episode_reward_mean": -288.6694485452861, "iterations_since_restore": 42, "episode_reward_max": -22.614765704711942, "policy_reward_mean": {}, "timestamp": 1558584069, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.23533582687378, "episodes_total": 1944, "time_total_s": 1057.5885803699493, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-01-09", "custom_metrics": {"cost2_min": -61.139402213993094, "cost1_mean": 192.2384951290803, "system_level_velocity_max": 18.647516110737733, "outflow_rate_min": 448.5093812448499, "cost1_max": 212.26326411861098, "outflow_rate_max": 1239.4207268873774, "system_level_velocity_min": 13.35870306604939, "cost2_max": -19.038975027364327, "cost1_min": 17.714090572828997, "system_level_velocity_mean": 16.780742684562803, "outflow_rate_mean": 1120.7560239874601, "cost2_mean": -48.35464619146747}, "training_iteration": 42, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1641569137573242, "cur_kl_coeff": 0.14999999105930328, "kl": 0.01610632613301277, "vf_explained_var": 0.8809845447540283, "vf_loss": 9.767985343933105, "total_loss": 9.763705253601074, "policy_loss": -0.006696399301290512}, "sample_time_ms": 15628.444, "num_steps_sampled": 1440458, "num_steps_trained": 1440458, "update_time_ms": 7.577, "load_time_ms": 5.584, "grad_time_ms": 7884.038}, "episode_reward_min": -419.869233928765}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd710>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 52, "timesteps_since_restore": 1470968, "timesteps_total": 1470968, "timesteps_this_iter": 30510, "time_since_restore": 1080.8476672172546, "node_ip": "10.138.0.2", "episode_len_mean": 322.47, "hostname": "flow-main", "episode_reward_mean": -290.6779205481893, "iterations_since_restore": 43, "episode_reward_max": -156.18842308386758, "policy_reward_mean": {}, "timestamp": 1558584092, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.259086847305298, "episodes_total": 1996, "time_total_s": 1080.8476672172546, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-01-32", "custom_metrics": {"cost2_min": -68.08233958546177, "cost1_mean": 192.18489022307483, "system_level_velocity_max": 18.371447906357616, "outflow_rate_min": 892.1424094488186, "cost1_max": 210.57223597857427, "outflow_rate_max": 1228.7495746729758, "system_level_velocity_min": 13.277916826291419, "cost2_max": -36.15638980965567, "cost1_min": 127.01446650650784, "system_level_velocity_mean": 16.652958121152547, "outflow_rate_mean": 1118.5575110363427, "cost2_mean": -48.59113662814636}, "training_iteration": 43, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1725987195968628, "cur_kl_coeff": 0.14999999105930328, "kl": 0.01753624714910984, "vf_explained_var": 0.8964819312095642, "vf_loss": 9.987592697143555, "total_loss": 9.979952812194824, "policy_loss": -0.010271226987242699}, "sample_time_ms": 15632.873, "num_steps_sampled": 1470968, "num_steps_trained": 1470968, "update_time_ms": 7.401, "load_time_ms": 5.469, "grad_time_ms": 7874.539}, "episode_reward_min": -460.5352466845778}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4b70>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 1501253, "timesteps_total": 1501253, "timesteps_this_iter": 30285, "time_since_restore": 1106.3266379833221, "node_ip": "10.138.0.2", "episode_len_mean": 319.37, "hostname": "flow-main", "episode_reward_mean": -286.5740208281932, "iterations_since_restore": 44, "episode_reward_max": -31.094849126545547, "policy_reward_mean": {}, "timestamp": 1558584117, "num_metric_batches_dropped": 0, "time_this_iter_s": 25.478970766067505, "episodes_total": 2041, "time_total_s": 1106.3266379833221, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-01-57", "custom_metrics": {"cost2_min": -68.08233958546177, "cost1_mean": 191.07408414154918, "system_level_velocity_max": 18.4208539910867, "outflow_rate_min": 462.43348918263234, "cost1_max": 210.57223597857427, "outflow_rate_max": 1228.7495746729758, "system_level_velocity_min": 13.277916826291419, "cost2_max": -21.967583731150395, "cost1_min": 22.441114676393425, "system_level_velocity_mean": 16.747503388975524, "outflow_rate_mean": 1110.2019132077676, "cost2_mean": -48.15006217063167}, "training_iteration": 44, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1553157567977905, "cur_kl_coeff": 0.14999999105930328, "kl": 0.01699117012321949, "vf_explained_var": 0.8766579031944275, "vf_loss": 10.797801971435547, "total_loss": 10.7877836227417, "policy_loss": -0.01256719883531332}, "sample_time_ms": 15674.258, "num_steps_sampled": 1501253, "num_steps_trained": 1501253, "update_time_ms": 7.335, "load_time_ms": 5.416, "grad_time_ms": 8014.113}, "episode_reward_min": -460.5352466845778}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd550>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 43, "timesteps_since_restore": 1530913, "timesteps_total": 1530913, "timesteps_this_iter": 29660, "time_since_restore": 1130.5097258090973, "node_ip": "10.138.0.2", "episode_len_mean": 319.54, "hostname": "flow-main", "episode_reward_mean": -283.94775476105474, "iterations_since_restore": 45, "episode_reward_max": -31.094849126545547, "policy_reward_mean": {}, "timestamp": 1558584142, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.183087825775146, "episodes_total": 2084, "time_total_s": 1130.5097258090973, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-02-22", "custom_metrics": {"cost2_min": -68.08233958546177, "cost1_mean": 191.75807757708282, "system_level_velocity_max": 18.4208539910867, "outflow_rate_min": 462.43348918263234, "cost1_max": 210.22904539420261, "outflow_rate_max": 1228.4932671065314, "system_level_velocity_min": 13.277916826291419, "cost2_max": -21.967583731150395, "cost1_min": 22.441114676393425, "system_level_velocity_mean": 16.83808548720126, "outflow_rate_mean": 1106.315914250874, "cost2_mean": -47.061588433195595}, "training_iteration": 45, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1740084886550903, "cur_kl_coeff": 0.1499999761581421, "kl": 0.018369317054748535, "vf_explained_var": 0.8990827202796936, "vf_loss": 8.900481224060059, "total_loss": 8.888875007629395, "policy_loss": -0.014361647889018059}, "sample_time_ms": 15624.301, "num_steps_sampled": 1530913, "num_steps_trained": 1530913, "update_time_ms": 7.343, "load_time_ms": 5.28, "grad_time_ms": 8141.759}, "episode_reward_min": -460.5352466845778}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6908>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 51, "timesteps_since_restore": 1561021, "timesteps_total": 1561021, "timesteps_this_iter": 30108, "time_since_restore": 1154.933791399002, "node_ip": "10.138.0.2", "episode_len_mean": 323.54, "hostname": "flow-main", "episode_reward_mean": -289.575034159266, "iterations_since_restore": 46, "episode_reward_max": -160.92009273600902, "policy_reward_mean": {}, "timestamp": 1558584166, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.424065589904785, "episodes_total": 2135, "time_total_s": 1154.933791399002, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-02-46", "custom_metrics": {"cost2_min": -58.61360863984105, "cost1_mean": 192.77316387376453, "system_level_velocity_max": 18.411830864660956, "outflow_rate_min": 733.0507438016529, "cost1_max": 211.01898774109372, "outflow_rate_max": 1217.9134933792425, "system_level_velocity_min": 11.745125762586918, "cost2_max": -36.18605869727661, "cost1_min": 131.3923135791001, "system_level_velocity_mean": 16.697269281794057, "outflow_rate_mean": 1106.1720554183446, "cost2_mean": -47.44881401570358}, "training_iteration": 46, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.157022476196289, "cur_kl_coeff": 0.15000000596046448, "kl": 0.018062526360154152, "vf_explained_var": 0.8925804495811462, "vf_loss": 10.554797172546387, "total_loss": 10.546656608581543, "policy_loss": -0.01085032057017088}, "sample_time_ms": 15557.797, "num_steps_sampled": 1561021, "num_steps_trained": 1561021, "update_time_ms": 7.394, "load_time_ms": 4.904, "grad_time_ms": 8266.205}, "episode_reward_min": -468.80094846725905}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc68d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6160>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 1591118, "timesteps_total": 1591118, "timesteps_this_iter": 30097, "time_since_restore": 1177.651300907135, "node_ip": "10.138.0.2", "episode_len_mean": 324.72, "hostname": "flow-main", "episode_reward_mean": -290.4689809376746, "iterations_since_restore": 47, "episode_reward_max": -226.26904616970876, "policy_reward_mean": {}, "timestamp": 1558584189, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.717509508132935, "episodes_total": 2180, "time_total_s": 1177.651300907135, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-03-09", "custom_metrics": {"cost2_min": -60.39674208816558, "cost1_mean": 193.38422197596498, "system_level_velocity_max": 18.477168437193455, "outflow_rate_min": 733.0507438016529, "cost1_max": 211.01898774109372, "outflow_rate_max": 1219.1488187132538, "system_level_velocity_min": 11.745125762586918, "cost2_max": -36.50383719874906, "cost1_min": 137.04386124218175, "system_level_velocity_mean": 16.698037460099552, "outflow_rate_mean": 1110.6382107164773, "cost2_mean": -48.09266992957733}, "training_iteration": 47, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1531449556350708, "cur_kl_coeff": 0.15000000596046448, "kl": 0.018058670684695244, "vf_explained_var": 0.9159717559814453, "vf_loss": 8.443290710449219, "total_loss": 8.434882164001465, "policy_loss": -0.011117598973214626}, "sample_time_ms": 15513.874, "num_steps_sampled": 1591118, "num_steps_trained": 1591118, "update_time_ms": 7.565, "load_time_ms": 4.781, "grad_time_ms": 8240.762}, "episode_reward_min": -468.80094846725905}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbddd8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 1621575, "timesteps_total": 1621575, "timesteps_this_iter": 30457, "time_since_restore": 1201.8747754096985, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "episode_reward_mean": -287.81483921224077, "iterations_since_restore": 48, "episode_reward_max": -210.7401621725679, "policy_reward_mean": {}, "timestamp": 1558584213, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.223474502563477, "episodes_total": 2224, "time_total_s": 1201.8747754096985, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-03-33", "custom_metrics": {"cost2_min": -63.99889571749842, "cost1_mean": 194.32395133012125, "system_level_velocity_max": 18.477168437193455, "outflow_rate_min": 788.919, "cost1_max": 210.50578523690888, "outflow_rate_max": 1232.322192728901, "system_level_velocity_min": 13.100037340799272, "cost2_max": -36.50383719874906, "cost1_min": 120.64378956604429, "system_level_velocity_mean": 16.82117639104046, "outflow_rate_mean": 1122.2833022827028, "cost2_mean": -49.114004986925856}, "training_iteration": 48, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1362779140472412, "cur_kl_coeff": 0.1499999761581421, "kl": 0.017397822812199593, "vf_explained_var": 0.8981251120567322, "vf_loss": 8.981159210205078, "total_loss": 8.973556518554688, "policy_loss": -0.010212271474301815}, "sample_time_ms": 15493.594, "num_steps_sampled": 1621575, "num_steps_trained": 1621575, "update_time_ms": 7.766, "load_time_ms": 4.407, "grad_time_ms": 8304.791}, "episode_reward_min": -385.2295756000637}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6da0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 47, "timesteps_since_restore": 1652104, "timesteps_total": 1652104, "timesteps_this_iter": 30529, "time_since_restore": 1226.6859545707703, "node_ip": "10.138.0.2", "episode_len_mean": 322.64, "hostname": "flow-main", "episode_reward_mean": -287.47993875354564, "iterations_since_restore": 49, "episode_reward_max": -162.05688556627655, "policy_reward_mean": {}, "timestamp": 1558584238, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.811179161071777, "episodes_total": 2271, "time_total_s": 1226.6859545707703, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-03-58", "custom_metrics": {"cost2_min": -63.99889571749842, "cost1_mean": 194.0052696138383, "system_level_velocity_max": 18.423244718016242, "outflow_rate_min": 878.247818181818, "cost1_max": 210.43088886036503, "outflow_rate_max": 1232.322192728901, "system_level_velocity_min": 14.378905317840456, "cost2_max": -36.50383719874906, "cost1_min": 120.64378956604429, "system_level_velocity_mean": 16.81862082225665, "outflow_rate_mean": 1131.9899274515803, "cost2_mean": -50.26629974065021}, "training_iteration": 49, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1274763345718384, "cur_kl_coeff": 0.14999999105930328, "kl": 0.018208656460046768, "vf_explained_var": 0.8851131200790405, "vf_loss": 9.916036605834961, "total_loss": 9.90871524810791, "policy_loss": -0.010052136145532131}, "sample_time_ms": 15481.688, "num_steps_sampled": 1652104, "num_steps_trained": 1652104, "update_time_ms": 7.923, "load_time_ms": 4.047, "grad_time_ms": 8439.115}, "episode_reward_min": -378.2324950003568}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6e10>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 48, "timesteps_since_restore": 1682800, "timesteps_total": 1682800, "timesteps_this_iter": 30696, "time_since_restore": 1251.659826040268, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "episode_reward_mean": -290.9708232897497, "iterations_since_restore": 50, "episode_reward_max": -162.05688556627655, "policy_reward_mean": {}, "timestamp": 1558584263, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.97387146949768, "episodes_total": 2319, "time_total_s": 1251.659826040268, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-04-23", "custom_metrics": {"cost2_min": -66.43920356260031, "cost1_mean": 194.7932617716505, "system_level_velocity_max": 18.387548608991544, "outflow_rate_min": 923.4442314049584, "cost1_max": 210.5394950369403, "outflow_rate_max": 1234.198503640269, "system_level_velocity_min": 13.540062134175034, "cost2_max": -39.49809228162613, "cost1_min": 132.06256586029423, "system_level_velocity_mean": 16.811999518849163, "outflow_rate_mean": 1137.195192006919, "cost2_mean": -51.3989725611488}, "training_iteration": 50, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1334894895553589, "cur_kl_coeff": 0.14999999105930328, "kl": 0.016745779663324356, "vf_explained_var": 0.9003908634185791, "vf_loss": 8.937865257263184, "total_loss": 8.930154800415039, "policy_loss": -0.010223581455647945}, "sample_time_ms": 15487.897, "num_steps_sampled": 1682800, "num_steps_trained": 1682800, "update_time_ms": 8.377, "load_time_ms": 4.192, "grad_time_ms": 8591.025}, "episode_reward_min": -411.7938780225762}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4f60>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 46, "timesteps_since_restore": 1713416, "timesteps_total": 1713416, "timesteps_this_iter": 30616, "time_since_restore": 1274.8057861328125, "node_ip": "10.138.0.2", "episode_len_mean": 319.76, "hostname": "flow-main", "episode_reward_mean": -286.96803450028756, "iterations_since_restore": 51, "episode_reward_max": -29.623180451744247, "policy_reward_mean": {}, "timestamp": 1558584286, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.145960092544556, "episodes_total": 2365, "time_total_s": 1274.8057861328125, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-04-46", "custom_metrics": {"cost2_min": -66.43920356260031, "cost1_mean": 192.87852578891182, "system_level_velocity_max": 18.874846355521136, "outflow_rate_min": 518.6392970701784, "cost1_max": 210.5394950369403, "outflow_rate_max": 1234.198503640269, "system_level_velocity_min": 12.63550436977672, "cost2_max": -20.88309346132026, "cost1_min": 24.219165464266414, "system_level_velocity_mean": 16.907742204868462, "outflow_rate_mean": 1132.775466096506, "cost2_mean": -51.30784209249712}, "training_iteration": 51, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.131386637687683, "cur_kl_coeff": 0.14999999105930328, "kl": 0.018519660457968712, "vf_explained_var": 0.8867253661155701, "vf_loss": 10.206603050231934, "total_loss": 10.20083999633789, "policy_loss": -0.008541148155927658}, "sample_time_ms": 15361.987, "num_steps_sampled": 1713416, "num_steps_trained": 1713416, "update_time_ms": 8.474, "load_time_ms": 4.179, "grad_time_ms": 8603.216}, "episode_reward_min": -411.7938780225762}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdb70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbde48>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 47, "timesteps_since_restore": 1744138, "timesteps_total": 1744138, "timesteps_this_iter": 30722, "time_since_restore": 1297.6730828285217, "node_ip": "10.138.0.2", "episode_len_mean": 319.48, "hostname": "flow-main", "episode_reward_mean": -285.6192322721713, "iterations_since_restore": 52, "episode_reward_max": -29.623180451744247, "policy_reward_mean": {}, "timestamp": 1558584309, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.86729669570923, "episodes_total": 2412, "time_total_s": 1297.6730828285217, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-05-09", "custom_metrics": {"cost2_min": -66.4099196160358, "cost1_mean": 192.9638219958029, "system_level_velocity_max": 18.874846355521136, "outflow_rate_min": 518.6392970701784, "cost1_max": 212.03816331886947, "outflow_rate_max": 1245.5734143365833, "system_level_velocity_min": 11.741767501435072, "cost2_max": -20.88309346132026, "cost1_min": 24.219165464266414, "system_level_velocity_mean": 16.930363431902943, "outflow_rate_mean": 1136.2134689506645, "cost2_mean": -51.973621512305336}, "training_iteration": 52, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1089107990264893, "cur_kl_coeff": 0.15000000596046448, "kl": 0.01745983399450779, "vf_explained_var": 0.8990581631660461, "vf_loss": 8.817590713500977, "total_loss": 8.810247421264648, "policy_loss": -0.009961100295186043}, "sample_time_ms": 15340.027, "num_steps_sampled": 1744138, "num_steps_trained": 1744138, "update_time_ms": 8.628, "load_time_ms": 4.3, "grad_time_ms": 8588.146}, "episode_reward_min": -436.52791970949113}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5a58>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 49, "timesteps_since_restore": 1774743, "timesteps_total": 1774743, "timesteps_this_iter": 30605, "time_since_restore": 1320.7702932357788, "node_ip": "10.138.0.2", "episode_len_mean": 324.72, "hostname": "flow-main", "episode_reward_mean": -291.4668999019548, "iterations_since_restore": 53, "episode_reward_max": -224.685665455881, "policy_reward_mean": {}, "timestamp": 1558584332, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.09721040725708, "episodes_total": 2461, "time_total_s": 1320.7702932357788, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-05-32", "custom_metrics": {"cost2_min": -66.4099196160358, "cost1_mean": 196.6162067743489, "system_level_velocity_max": 18.7261218664296, "outflow_rate_min": 881.1658582677164, "cost1_max": 214.12923989184873, "outflow_rate_max": 1250.056413884661, "system_level_velocity_min": 11.741767501435072, "cost2_max": -43.41481091175619, "cost1_min": 142.56812624417108, "system_level_velocity_mean": 16.92536913931725, "outflow_rate_mean": 1148.7053812614217, "cost2_mean": -53.7091620838102}, "training_iteration": 53, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1222254037857056, "cur_kl_coeff": 0.14999999105930328, "kl": 0.018887536600232124, "vf_explained_var": 0.9028040766716003, "vf_loss": 8.678078651428223, "total_loss": 8.670197486877441, "policy_loss": -0.010714256204664707}, "sample_time_ms": 15308.076, "num_steps_sampled": 1774743, "num_steps_trained": 1774743, "update_time_ms": 8.685, "load_time_ms": 4.281, "grad_time_ms": 8604.126}, "episode_reward_min": -436.52791970949113}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badf98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bada58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badef0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 1805375, "timesteps_total": 1805375, "timesteps_this_iter": 30632, "time_since_restore": 1343.5749928951263, "node_ip": "10.138.0.2", "episode_len_mean": 324.72, "hostname": "flow-main", "episode_reward_mean": -293.45648726356495, "iterations_since_restore": 54, "episode_reward_max": -232.0475132982476, "policy_reward_mean": {}, "timestamp": 1558584355, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.804699659347534, "episodes_total": 2505, "time_total_s": 1343.5749928951263, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-05-55", "custom_metrics": {"cost2_min": -73.81969562880431, "cost1_mean": 195.9700878376468, "system_level_velocity_max": 18.7261218664296, "outflow_rate_min": 868.7224350205194, "cost1_max": 214.12923989184873, "outflow_rate_max": 1250.056413884661, "system_level_velocity_min": 11.741767501435072, "cost2_max": -44.21498455676668, "cost1_min": 142.56812624417108, "system_level_velocity_mean": 16.83478340176905, "outflow_rate_mean": 1146.4412341834573, "cost2_mean": -54.742441828307655}, "training_iteration": 54, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1148720979690552, "cur_kl_coeff": 0.14999999105930328, "kl": 0.017073040828108788, "vf_explained_var": 0.9030574560165405, "vf_loss": 9.393634796142578, "total_loss": 9.385382652282715, "policy_loss": -0.010813293978571892}, "sample_time_ms": 15225.459, "num_steps_sampled": 1805375, "num_steps_trained": 1805375, "update_time_ms": 8.682, "load_time_ms": 4.236, "grad_time_ms": 8418.188}, "episode_reward_min": -466.89055065386134}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbda58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd7f0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 46, "timesteps_since_restore": 1835926, "timesteps_total": 1835926, "timesteps_this_iter": 30551, "time_since_restore": 1366.5074036121368, "node_ip": "10.138.0.2", "episode_len_mean": 319.18, "hostname": "flow-main", "episode_reward_mean": -282.5107632000891, "iterations_since_restore": 55, "episode_reward_max": -28.79700217185998, "policy_reward_mean": {}, "timestamp": 1558584378, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.932410717010498, "episodes_total": 2551, "time_total_s": 1366.5074036121368, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-06-18", "custom_metrics": {"cost2_min": -73.81969562880431, "cost1_mean": 194.8375661084069, "system_level_velocity_max": 18.7261218664296, "outflow_rate_min": 511.17688865063195, "cost1_max": 214.12923989184873, "outflow_rate_max": 1250.056413884661, "system_level_velocity_min": 13.981733474464507, "cost2_max": -20.77390711788651, "cost1_min": 22.779819562312433, "system_level_velocity_mean": 17.069107935549344, "outflow_rate_mean": 1145.3782149108126, "cost2_mean": -53.402220602455934}, "training_iteration": 55, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1025526523590088, "cur_kl_coeff": 0.14999999105930328, "kl": 0.01952560432255268, "vf_explained_var": 0.8926002979278564, "vf_loss": 8.804738998413086, "total_loss": 8.799269676208496, "policy_loss": -0.008397831581532955}, "sample_time_ms": 15254.549, "num_steps_sampled": 1835926, "num_steps_trained": 1835926, "update_time_ms": 8.526, "load_time_ms": 4.312, "grad_time_ms": 8263.834}, "episode_reward_min": -466.89055065386134}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb55c0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 53, "timesteps_since_restore": 1866585, "timesteps_total": 1866585, "timesteps_this_iter": 30659, "time_since_restore": 1390.5038607120514, "node_ip": "10.138.0.2", "episode_len_mean": 313.38, "hostname": "flow-main", "episode_reward_mean": -276.87504458496096, "iterations_since_restore": 56, "episode_reward_max": -22.162282321820605, "policy_reward_mean": {}, "timestamp": 1558584402, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.99645709991455, "episodes_total": 2604, "time_total_s": 1390.5038607120514, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-06-42", "custom_metrics": {"cost2_min": -63.875642747768865, "cost1_mean": 191.2573644460184, "system_level_velocity_max": 18.773775567355685, "outflow_rate_min": 474.3699846082663, "cost1_max": 213.3900399023786, "outflow_rate_max": 1250.9019157910316, "system_level_velocity_min": 14.072055771579414, "cost2_max": -16.91449584423319, "cost1_min": 17.762939556930196, "system_level_velocity_mean": 17.064598360962687, "outflow_rate_mean": 1131.8438778390475, "cost2_mean": -52.52232892578183}, "training_iteration": 56, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.102041482925415, "cur_kl_coeff": 0.14999999105930328, "kl": 0.016190530732274055, "vf_explained_var": 0.8752696514129639, "vf_loss": 10.350187301635742, "total_loss": 10.345453262329102, "policy_loss": -0.007164355833083391}, "sample_time_ms": 15368.48, "num_steps_sampled": 1866585, "num_steps_trained": 1866585, "update_time_ms": 8.88, "load_time_ms": 4.426, "grad_time_ms": 8104.128}, "episode_reward_min": -376.4870959432254}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badf28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badc18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badf98>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 43, "timesteps_since_restore": 1897300, "timesteps_total": 1897300, "timesteps_this_iter": 30715, "time_since_restore": 1415.1059193611145, "node_ip": "10.138.0.2", "episode_len_mean": 317.46, "hostname": "flow-main", "episode_reward_mean": -280.3684093418546, "iterations_since_restore": 57, "episode_reward_max": -22.162282321820605, "policy_reward_mean": {}, "timestamp": 1558584427, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.60205864906311, "episodes_total": 2647, "time_total_s": 1415.1059193611145, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-07-07", "custom_metrics": {"cost2_min": -66.77283645533947, "cost1_mean": 194.05360857199636, "system_level_velocity_max": 18.773775567355685, "outflow_rate_min": 474.3699846082663, "cost1_max": 213.29204566227298, "outflow_rate_max": 1250.9019157910316, "system_level_velocity_min": 14.572691972745423, "cost2_max": -16.91449584423319, "cost1_min": 17.762939556930196, "system_level_velocity_mean": 17.09155090310639, "outflow_rate_mean": 1140.9579948444446, "cost2_mean": -53.40149346510861}, "training_iteration": 57, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0989595651626587, "cur_kl_coeff": 0.14999999105930328, "kl": 0.01915116421878338, "vf_explained_var": 0.8849135041236877, "vf_loss": 9.059245109558105, "total_loss": 9.050605773925781, "policy_loss": -0.011512547731399536}, "sample_time_ms": 15506.347, "num_steps_sampled": 1897300, "num_steps_trained": 1897300, "update_time_ms": 8.856, "load_time_ms": 4.539, "grad_time_ms": 8154.451}, "episode_reward_min": -369.7858596452304}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb59b0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 47, "timesteps_since_restore": 1928303, "timesteps_total": 1928303, "timesteps_this_iter": 31003, "time_since_restore": 1439.0582723617554, "node_ip": "10.138.0.2", "episode_len_mean": 316.98, "hostname": "flow-main", "episode_reward_mean": -284.64589265113045, "iterations_since_restore": 58, "episode_reward_max": -22.145085619216943, "policy_reward_mean": {}, "timestamp": 1558584451, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.95235300064087, "episodes_total": 2694, "time_total_s": 1439.0582723617554, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-07-31", "custom_metrics": {"cost2_min": -76.38512074890187, "cost1_mean": 192.90516551882297, "system_level_velocity_max": 18.642394541019975, "outflow_rate_min": 477.24354782665716, "cost1_max": 213.28037887187642, "outflow_rate_max": 1251.1694908325373, "system_level_velocity_min": 13.85058904661501, "cost2_max": -17.06001288562148, "cost1_min": 17.780105197360925, "system_level_velocity_mean": 17.018590170247766, "outflow_rate_mean": 1141.962090650459, "cost2_mean": -54.64468315756443}, "training_iteration": 58, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0941991806030273, "cur_kl_coeff": 0.14999999105930328, "kl": 0.019626842811703682, "vf_explained_var": 0.8775990009307861, "vf_loss": 10.553077697753906, "total_loss": 10.547014236450195, "policy_loss": -0.00900739524513483}, "sample_time_ms": 15553.734, "num_steps_sampled": 1928303, "num_steps_trained": 1928303, "update_time_ms": 8.827, "load_time_ms": 4.605, "grad_time_ms": 8078.829}, "episode_reward_min": -469.32188982586797}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb50f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5e10>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 51, "timesteps_since_restore": 1959484, "timesteps_total": 1959484, "timesteps_this_iter": 31181, "time_since_restore": 1462.4839968681335, "node_ip": "10.138.0.2", "episode_len_mean": 315.1, "hostname": "flow-main", "episode_reward_mean": -288.9335653245794, "iterations_since_restore": 59, "episode_reward_max": -22.145085619216943, "policy_reward_mean": {}, "timestamp": 1558584474, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.425724506378174, "episodes_total": 2745, "time_total_s": 1462.4839968681335, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-07-54", "custom_metrics": {"cost2_min": -76.38512074890187, "cost1_mean": 190.43217712229517, "system_level_velocity_max": 18.595245273669608, "outflow_rate_min": 477.24354782665716, "cost1_max": 213.0908618571851, "outflow_rate_max": 1259.6881744391974, "system_level_velocity_min": 13.85058904661501, "cost2_max": -17.06001288562148, "cost1_min": 17.780105197360925, "system_level_velocity_mean": 16.89111292046074, "outflow_rate_mean": 1132.7634311344054, "cost2_mean": -55.385023214846434}, "training_iteration": 59, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.086050033569336, "cur_kl_coeff": 0.14999999105930328, "kl": 0.02125789411365986, "vf_explained_var": 0.8750833868980408, "vf_loss": 10.412508964538574, "total_loss": 10.405155181884766, "policy_loss": -0.010542853735387325}, "sample_time_ms": 15535.467, "num_steps_sampled": 1959484, "num_steps_trained": 1959484, "update_time_ms": 8.754, "load_time_ms": 4.485, "grad_time_ms": 7958.656}, "episode_reward_min": -469.32188982586797}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badc18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badf98>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 1990307, "timesteps_total": 1990307, "timesteps_this_iter": 30823, "time_since_restore": 1485.9591195583344, "node_ip": "10.138.0.2", "episode_len_mean": 322.64, "hostname": "flow-main", "episode_reward_mean": -294.09688051488746, "iterations_since_restore": 60, "episode_reward_max": -156.12964320290047, "policy_reward_mean": {}, "timestamp": 1558584498, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.475122690200806, "episodes_total": 2789, "time_total_s": 1485.9591195583344, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-08-18", "custom_metrics": {"cost2_min": -75.81365339461784, "cost1_mean": 195.54607828052286, "system_level_velocity_max": 18.652215238771024, "outflow_rate_min": 963.285968033174, "cost1_max": 214.38507402956174, "outflow_rate_max": 1259.6881744391974, "system_level_velocity_min": 14.097543674193506, "cost2_max": -43.87500732326771, "cost1_min": 132.171662349355, "system_level_velocity_mean": 16.945870146819562, "outflow_rate_mean": 1152.377826117544, "cost2_mean": -56.34965441631754}, "training_iteration": 60, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.1011731624603271, "cur_kl_coeff": 0.22499996423721313, "kl": 0.014343228191137314, "vf_explained_var": 0.888735830783844, "vf_loss": 8.900248527526855, "total_loss": 8.89543628692627, "policy_loss": -0.008038287982344627}, "sample_time_ms": 15508.729, "num_steps_sampled": 1990307, "num_steps_trained": 1990307, "update_time_ms": 8.586, "load_time_ms": 4.39, "grad_time_ms": 7836.075}, "episode_reward_min": -458.45738577021353}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb59b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5470>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 2021620, "timesteps_total": 2021620, "timesteps_this_iter": 31313, "time_since_restore": 1509.2046959400177, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "episode_reward_mean": -295.95278566448405, "iterations_since_restore": 61, "episode_reward_max": -240.99205219344285, "policy_reward_mean": {}, "timestamp": 1558584521, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.24557638168335, "episodes_total": 2833, "time_total_s": 1509.2046959400177, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-08-41", "custom_metrics": {"cost2_min": -81.00113047233222, "cost1_mean": 197.96604745812888, "system_level_velocity_max": 18.652215238771024, "outflow_rate_min": 998.3392164600504, "cost1_max": 214.38507402956174, "outflow_rate_max": 1259.2563472283293, "system_level_velocity_min": 13.69318922456289, "cost2_max": -43.87500732326771, "cost1_min": 159.30367543222468, "system_level_velocity_mean": 17.06893098414218, "outflow_rate_mean": 1162.5185720063753, "cost2_mean": -57.30726054944646}, "training_iteration": 61, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.08738112449646, "cur_kl_coeff": 0.22499997913837433, "kl": 0.01586175337433815, "vf_explained_var": 0.8734179735183716, "vf_loss": 11.106230735778809, "total_loss": 11.099723815917969, "policy_loss": -0.010078133083879948}, "sample_time_ms": 15516.801, "num_steps_sampled": 2021620, "num_steps_trained": 2021620, "update_time_ms": 8.751, "load_time_ms": 4.514, "grad_time_ms": 7836.068}, "episode_reward_min": -489.23986013233935}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb53c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5c50>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 49, "timesteps_since_restore": 2052874, "timesteps_total": 2052874, "timesteps_this_iter": 31254, "time_since_restore": 1534.4873325824738, "node_ip": "10.138.0.2", "episode_len_mean": 323.93, "hostname": "flow-main", "episode_reward_mean": -301.0434009390361, "iterations_since_restore": 62, "episode_reward_max": -163.41792664514506, "policy_reward_mean": {}, "timestamp": 1558584546, "num_metric_batches_dropped": 0, "time_this_iter_s": 25.282636642456055, "episodes_total": 2882, "time_total_s": 1534.4873325824738, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-09-06", "custom_metrics": {"cost2_min": -81.00113047233222, "cost1_mean": 195.31170791425495, "system_level_velocity_max": 18.644439704437147, "outflow_rate_min": 944.1231977240398, "cost1_max": 213.69398375249793, "outflow_rate_max": 1256.2259514662342, "system_level_velocity_min": 12.761590206633846, "cost2_max": -39.31109113267763, "cost1_min": 141.82769714962592, "system_level_velocity_mean": 16.843577217886, "outflow_rate_mean": 1151.797996313064, "cost2_mean": -57.07483617927187}, "training_iteration": 62, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0933305025100708, "cur_kl_coeff": 0.22499997913837433, "kl": 0.016697879880666733, "vf_explained_var": 0.8894669413566589, "vf_loss": 10.15865707397461, "total_loss": 10.153302192687988, "policy_loss": -0.009112640284001827}, "sample_time_ms": 15593.155, "num_steps_sampled": 2052874, "num_steps_trained": 2052874, "update_time_ms": 8.755, "load_time_ms": 4.444, "grad_time_ms": 8000.645}, "episode_reward_min": -502.9441380403832}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad4a8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 48, "timesteps_since_restore": 2084460, "timesteps_total": 2084460, "timesteps_this_iter": 31586, "time_since_restore": 1558.730431318283, "node_ip": "10.138.0.2", "episode_len_mean": 322.75, "hostname": "flow-main", "episode_reward_mean": -305.8965241377899, "iterations_since_restore": 63, "episode_reward_max": -151.39902020125757, "policy_reward_mean": {}, "timestamp": 1558584571, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.243098735809326, "episodes_total": 2930, "time_total_s": 1558.730431318283, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-09-31", "custom_metrics": {"cost2_min": -77.44502944508974, "cost1_mean": 192.69490313422452, "system_level_velocity_max": 18.535501988015866, "outflow_rate_min": 944.1231977240398, "cost1_max": 213.02756855974087, "outflow_rate_max": 1251.4723834230629, "system_level_velocity_min": 12.761590206633846, "cost2_max": -39.31109113267763, "cost1_min": 136.91119074518528, "system_level_velocity_mean": 16.667160707058983, "outflow_rate_mean": 1140.2499985857291, "cost2_mean": -57.19934186454881}, "training_iteration": 63, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0912131071090698, "cur_kl_coeff": 0.22499997913837433, "kl": 0.016231315210461617, "vf_explained_var": 0.8926323652267456, "vf_loss": 10.973711967468262, "total_loss": 10.968110084533691, "policy_loss": -0.009254513308405876}, "sample_time_ms": 15696.517, "num_steps_sampled": 2084460, "num_steps_trained": 2084460, "update_time_ms": 8.9, "load_time_ms": 4.78, "grad_time_ms": 8010.635}, "episode_reward_min": -502.9441380403832}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb54a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb50b8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 41, "timesteps_since_restore": 2115545, "timesteps_total": 2115545, "timesteps_this_iter": 31085, "time_since_restore": 1581.564157962799, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "episode_reward_mean": -304.03533650408247, "iterations_since_restore": 64, "episode_reward_max": -151.39902020125757, "policy_reward_mean": {}, "timestamp": 1558584594, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.83372664451599, "episodes_total": 2971, "time_total_s": 1581.564157962799, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-09-54", "custom_metrics": {"cost2_min": -77.44502944508974, "cost1_mean": 194.0000302039351, "system_level_velocity_max": 18.63715788385256, "outflow_rate_min": 986.3445714285716, "cost1_max": 213.7982760152292, "outflow_rate_max": 1252.598014291806, "system_level_velocity_min": 13.541484833128482, "cost2_max": -44.95314334503281, "cost1_min": 136.91119074518528, "system_level_velocity_mean": 16.73818899508617, "outflow_rate_mean": 1139.6014261786713, "cost2_mean": -57.25812526312916}, "training_iteration": 64, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0822052955627441, "cur_kl_coeff": 0.22499996423721313, "kl": 0.015008124522864819, "vf_explained_var": 0.882421612739563, "vf_loss": 11.10210132598877, "total_loss": 11.097013473510742, "policy_loss": -0.008463998325169086}, "sample_time_ms": 15687.402, "num_steps_sampled": 2115545, "num_steps_trained": 2115545, "update_time_ms": 9.206, "load_time_ms": 4.792, "grad_time_ms": 8022.276}, "episode_reward_min": -479.808331680067}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb50f0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 48, "timesteps_since_restore": 2146771, "timesteps_total": 2146771, "timesteps_this_iter": 31226, "time_since_restore": 1604.614280462265, "node_ip": "10.138.0.2", "episode_len_mean": 322.64, "hostname": "flow-main", "episode_reward_mean": -299.27931362058877, "iterations_since_restore": 65, "episode_reward_max": -156.3559305768377, "policy_reward_mean": {}, "timestamp": 1558584617, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.050122499465942, "episodes_total": 3019, "time_total_s": 1604.614280462265, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-10-17", "custom_metrics": {"cost2_min": -77.38194926282907, "cost1_mean": 193.94553340841037, "system_level_velocity_max": 18.716647824692796, "outflow_rate_min": 889.0964108836747, "cost1_max": 214.76252562199912, "outflow_rate_max": 1252.598014291806, "system_level_velocity_min": 13.541484833128482, "cost2_max": -40.96331374980514, "cost1_min": 121.62759653357455, "system_level_velocity_mean": 16.772806037529058, "outflow_rate_mean": 1140.244679556557, "cost2_mean": -56.41923685531414}, "training_iteration": 65, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.070751428604126, "cur_kl_coeff": 0.22499997913837433, "kl": 0.01726503297686577, "vf_explained_var": 0.8784841299057007, "vf_loss": 11.208145141601562, "total_loss": 11.202128410339355, "policy_loss": -0.00990250427275896}, "sample_time_ms": 15684.767, "num_steps_sampled": 2146771, "num_steps_trained": 2146771, "update_time_ms": 9.348, "load_time_ms": 4.723, "grad_time_ms": 8037.293}, "episode_reward_min": -469.15322601451356}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb54a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badf98>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 50, "timesteps_since_restore": 2178172, "timesteps_total": 2178172, "timesteps_this_iter": 31401, "time_since_restore": 1629.857914686203, "node_ip": "10.138.0.2", "episode_len_mean": 321.18, "hostname": "flow-main", "episode_reward_mean": -300.637320710276, "iterations_since_restore": 66, "episode_reward_max": -151.89051161560369, "policy_reward_mean": {}, "timestamp": 1558584642, "num_metric_batches_dropped": 0, "time_this_iter_s": 25.24363422393799, "episodes_total": 3069, "time_total_s": 1629.857914686203, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-10-42", "custom_metrics": {"cost2_min": -74.68726369775237, "cost1_mean": 192.14118751020737, "system_level_velocity_max": 18.73609299284104, "outflow_rate_min": 819.1812339566594, "cost1_max": 214.76252562199912, "outflow_rate_max": 1253.131547195579, "system_level_velocity_min": 13.058371649527384, "cost2_max": -40.96331374980514, "cost1_min": 121.62759653357455, "system_level_velocity_mean": 16.68296178272302, "outflow_rate_mean": 1136.8913893505485, "cost2_mean": -57.23997401011384}, "training_iteration": 66, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0739384889602661, "cur_kl_coeff": 0.22499996423721313, "kl": 0.017098670825362206, "vf_explained_var": 0.8879826664924622, "vf_loss": 11.197978973388672, "total_loss": 11.190237998962402, "policy_loss": -0.011589638888835907}, "sample_time_ms": 15626.074, "num_steps_sampled": 2178172, "num_steps_trained": 2178172, "update_time_ms": 8.942, "load_time_ms": 4.776, "grad_time_ms": 8221.719}, "episode_reward_min": -443.4393279882939}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd18d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1160>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 2209100, "timesteps_total": 2209100, "timesteps_this_iter": 30928, "time_since_restore": 1653.4999725818634, "node_ip": "10.138.0.2", "episode_len_mean": 321.18, "hostname": "flow-main", "episode_reward_mean": -298.99389012317096, "iterations_since_restore": 67, "episode_reward_max": -151.89051161560369, "policy_reward_mean": {}, "timestamp": 1558584666, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.6420578956604, "episodes_total": 3113, "time_total_s": 1653.4999725818634, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-11-06", "custom_metrics": {"cost2_min": -74.68726369775237, "cost1_mean": 193.14020071255018, "system_level_velocity_max": 18.73609299284104, "outflow_rate_min": 819.1812339566594, "cost1_max": 214.48792549502156, "outflow_rate_max": 1283.555655483884, "system_level_velocity_min": 13.058371649527384, "cost2_max": -40.96331374980514, "cost1_min": 121.62759653357455, "system_level_velocity_mean": 16.800396898982072, "outflow_rate_mean": 1141.221217495365, "cost2_mean": -58.06802704703429}, "training_iteration": 67, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0710922479629517, "cur_kl_coeff": 0.22499996423721313, "kl": 0.015522024594247341, "vf_explained_var": 0.8898045420646667, "vf_loss": 9.552200317382812, "total_loss": 9.547922134399414, "policy_loss": -0.0077700684778392315}, "sample_time_ms": 15541.907, "num_steps_sampled": 2209100, "num_steps_trained": 2209100, "update_time_ms": 9.152, "load_time_ms": 4.859, "grad_time_ms": 8209.367}, "episode_reward_min": -451.4682770508995}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd12e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1f28>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 46, "timesteps_since_restore": 2241107, "timesteps_total": 2241107, "timesteps_this_iter": 32007, "time_since_restore": 1677.0421838760376, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "episode_reward_mean": -305.3133075265109, "iterations_since_restore": 68, "episode_reward_max": -157.52064496795413, "policy_reward_mean": {}, "timestamp": 1558584689, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.542211294174194, "episodes_total": 3159, "time_total_s": 1677.0421838760376, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-11-29", "custom_metrics": {"cost2_min": -74.25987108061518, "cost1_mean": 194.04906173176173, "system_level_velocity_max": 18.773067820576706, "outflow_rate_min": 819.1812339566594, "cost1_max": 214.48792549502156, "outflow_rate_max": 1283.555655483884, "system_level_velocity_min": 13.058371649527384, "cost2_max": -41.28307373234312, "cost1_min": 133.54174560696075, "system_level_velocity_mean": 16.741262618191694, "outflow_rate_mean": 1142.1681457172044, "cost2_mean": -58.65218655920357}, "training_iteration": 68, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0700469017028809, "cur_kl_coeff": 0.22499999403953552, "kl": 0.017689598724246025, "vf_explained_var": 0.89323890209198, "vf_loss": 11.083547592163086, "total_loss": 11.077568054199219, "policy_loss": -0.009958979673683643}, "sample_time_ms": 15533.036, "num_steps_sampled": 2241107, "num_steps_trained": 2241107, "update_time_ms": 8.889, "load_time_ms": 4.841, "grad_time_ms": 8179.281}, "episode_reward_min": -451.4682770508995}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1710>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 52, "timesteps_since_restore": 2272472, "timesteps_total": 2272472, "timesteps_this_iter": 31365, "time_since_restore": 1701.415272474289, "node_ip": "10.138.0.2", "episode_len_mean": 319.28, "hostname": "flow-main", "episode_reward_mean": -304.79349840701707, "iterations_since_restore": 69, "episode_reward_max": -32.14452071420065, "policy_reward_mean": {}, "timestamp": 1558584714, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.373088598251343, "episodes_total": 3211, "time_total_s": 1701.415272474289, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-11-54", "custom_metrics": {"cost2_min": -74.77595176317871, "cost1_mean": 191.35763538012577, "system_level_velocity_max": 18.773067820576706, "outflow_rate_min": 500.8216993545232, "cost1_max": 214.71894015481595, "outflow_rate_max": 1258.356982459287, "system_level_velocity_min": 13.70626277960087, "cost2_max": -20.187886051998568, "cost1_min": 24.704171003160933, "system_level_velocity_mean": 16.775247974161186, "outflow_rate_mean": 1136.0181063192153, "cost2_mean": -59.63454045053394}, "training_iteration": 69, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0984243154525757, "cur_kl_coeff": 0.22499996423721313, "kl": 0.015275648795068264, "vf_explained_var": 0.8700340390205383, "vf_loss": 12.37984848022461, "total_loss": 12.370726585388184, "policy_loss": -0.01255876012146473}, "sample_time_ms": 15613.115, "num_steps_sampled": 2272472, "num_steps_trained": 2272472, "update_time_ms": 8.905, "load_time_ms": 4.847, "grad_time_ms": 8194.168}, "episode_reward_min": -445.08741401345293}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdc88>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 43, "timesteps_since_restore": 2303589, "timesteps_total": 2303589, "timesteps_this_iter": 31117, "time_since_restore": 1725.4215970039368, "node_ip": "10.138.0.2", "episode_len_mean": 319.28, "hostname": "flow-main", "episode_reward_mean": -295.7659248815666, "iterations_since_restore": 70, "episode_reward_max": -32.14452071420065, "policy_reward_mean": {}, "timestamp": 1558584738, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.006324529647827, "episodes_total": 3254, "time_total_s": 1725.4215970039368, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-12-18", "custom_metrics": {"cost2_min": -74.77595176317871, "cost1_mean": 193.43398349244467, "system_level_velocity_max": 18.741795674087985, "outflow_rate_min": 500.8216993545232, "cost1_max": 214.92601974871155, "outflow_rate_max": 1258.356982459287, "system_level_velocity_min": 13.70626277960087, "cost2_max": -20.187886051998568, "cost1_min": 24.704171003160933, "system_level_velocity_mean": 16.965200972284777, "outflow_rate_mean": 1144.6240436490514, "cost2_mean": -59.222359797292896}, "training_iteration": 70, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0758850574493408, "cur_kl_coeff": 0.22499997913837433, "kl": 0.016894999891519547, "vf_explained_var": 0.8882678151130676, "vf_loss": 9.875757217407227, "total_loss": 9.870551109313965, "policy_loss": -0.009007631801068783}, "sample_time_ms": 15675.84, "num_steps_sampled": 2303589, "num_steps_trained": 2303589, "update_time_ms": 8.931, "load_time_ms": 4.911, "grad_time_ms": 8182.408}, "episode_reward_min": -445.08741401345293}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd13c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1978>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 2334571, "timesteps_total": 2334571, "timesteps_this_iter": 30982, "time_since_restore": 1749.7878549098969, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "episode_reward_mean": -298.8014499203939, "iterations_since_restore": 71, "episode_reward_max": -235.8306311060021, "policy_reward_mean": {}, "timestamp": 1558584762, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.366257905960083, "episodes_total": 3299, "time_total_s": 1749.7878549098969, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-12-42", "custom_metrics": {"cost2_min": -73.92575063223967, "cost1_mean": 196.62222781635433, "system_level_velocity_max": 18.80663310195542, "outflow_rate_min": 987.7602775774518, "cost1_max": 215.79346734286145, "outflow_rate_max": 1269.2184568538398, "system_level_velocity_min": 14.073544445085446, "cost2_max": -40.432131856331424, "cost1_min": 164.46868776983032, "system_level_velocity_mean": 16.91133558911958, "outflow_rate_mean": 1154.77412976042, "cost2_mean": -59.223704999219756}, "training_iteration": 71, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.078211784362793, "cur_kl_coeff": 0.22499996423721313, "kl": 0.015733005478978157, "vf_explained_var": 0.8845083117485046, "vf_loss": 10.5886869430542, "total_loss": 10.582143783569336, "policy_loss": -0.010081547312438488}, "sample_time_ms": 15651.758, "num_steps_sampled": 2334571, "num_steps_trained": 2334571, "update_time_ms": 8.692, "load_time_ms": 4.793, "grad_time_ms": 8320.306}, "episode_reward_min": -445.08741401345293}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd10f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1c50>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 49, "timesteps_since_restore": 2365106, "timesteps_total": 2365106, "timesteps_this_iter": 30535, "time_since_restore": 1772.6945979595184, "node_ip": "10.138.0.2", "episode_len_mean": 324.8, "hostname": "flow-main", "episode_reward_mean": -290.3889294772547, "iterations_since_restore": 72, "episode_reward_max": -225.8816075348556, "policy_reward_mean": {}, "timestamp": 1558584785, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.906743049621582, "episodes_total": 3348, "time_total_s": 1772.6945979595184, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-13-05", "custom_metrics": {"cost2_min": -72.13719519236754, "cost1_mean": 197.75278663167214, "system_level_velocity_max": 18.80663310195542, "outflow_rate_min": 979.9205116624571, "cost1_max": 215.79346734286145, "outflow_rate_max": 1269.2184568538398, "system_level_velocity_min": 13.980936381495424, "cost2_max": -40.432131856331424, "cost1_min": 162.20544720450116, "system_level_velocity_mean": 17.044369720638077, "outflow_rate_mean": 1153.266339934742, "cost2_mean": -57.39533943873326}, "training_iteration": 72, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0614564418792725, "cur_kl_coeff": 0.22499997913837433, "kl": 0.01718531921505928, "vf_explained_var": 0.8941077589988708, "vf_loss": 8.776272773742676, "total_loss": 8.771188735961914, "policy_loss": -0.008949855342507362}, "sample_time_ms": 15570.645, "num_steps_sampled": 2365106, "num_steps_trained": 2365106, "update_time_ms": 8.821, "load_time_ms": 4.89, "grad_time_ms": 8162.444}, "episode_reward_min": -434.4638697102505}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5710>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 2395690, "timesteps_total": 2395690, "timesteps_this_iter": 30584, "time_since_restore": 1795.044275045395, "node_ip": "10.138.0.2", "episode_len_mean": 324.8, "hostname": "flow-main", "episode_reward_mean": -289.0495636344755, "iterations_since_restore": 73, "episode_reward_max": -225.8816075348556, "policy_reward_mean": {}, "timestamp": 1558584808, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.349677085876465, "episodes_total": 3393, "time_total_s": 1795.044275045395, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-13-28", "custom_metrics": {"cost2_min": -71.69004286574847, "cost1_mean": 197.15435444960232, "system_level_velocity_max": 18.8074524303741, "outflow_rate_min": 863.8030413223138, "cost1_max": 215.79346734286145, "outflow_rate_max": 1270.2377944342836, "system_level_velocity_min": 13.980936381495424, "cost2_max": -41.805126573360404, "cost1_min": 162.20544720450116, "system_level_velocity_mean": 16.972588762708916, "outflow_rate_mean": 1148.44042874274, "cost2_mean": -56.148291881022594}, "training_iteration": 73, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0814095735549927, "cur_kl_coeff": 0.22499997913837433, "kl": 0.01661352999508381, "vf_explained_var": 0.8917514681816101, "vf_loss": 9.35081958770752, "total_loss": 9.34411907196045, "policy_loss": -0.0104369493201375}, "sample_time_ms": 15434.947, "num_steps_sampled": 2395690, "num_steps_trained": 2395690, "update_time_ms": 8.841, "load_time_ms": 4.535, "grad_time_ms": 8109.604}, "episode_reward_min": -434.4638697102505}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1208>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 47, "timesteps_since_restore": 2425734, "timesteps_total": 2425734, "timesteps_this_iter": 30044, "time_since_restore": 1818.9471020698547, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "episode_reward_mean": -287.4412962306109, "iterations_since_restore": 74, "episode_reward_max": -155.93551724262588, "policy_reward_mean": {}, "timestamp": 1558584831, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.90282702445984, "episodes_total": 3440, "time_total_s": 1818.9471020698547, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-13-51", "custom_metrics": {"cost2_min": -71.69004286574847, "cost1_mean": 196.33214973281972, "system_level_velocity_max": 18.8074524303741, "outflow_rate_min": 838.3956752339923, "cost1_max": 214.83419138644285, "outflow_rate_max": 1270.2377944342836, "system_level_velocity_min": 12.483386813384335, "cost2_max": -38.261607408486086, "cost1_min": 133.65196525570485, "system_level_velocity_mean": 16.993855342656204, "outflow_rate_mean": 1140.9667008919123, "cost2_mean": -54.637463509751804}, "training_iteration": 74, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0886505842208862, "cur_kl_coeff": 0.22499997913837433, "kl": 0.018913501873612404, "vf_explained_var": 0.8981011509895325, "vf_loss": 8.428587913513184, "total_loss": 8.41745662689209, "policy_loss": -0.015386783517897129}, "sample_time_ms": 15423.614, "num_steps_sampled": 2425734, "num_steps_trained": 2425734, "update_time_ms": 8.762, "load_time_ms": 4.544, "grad_time_ms": 8228.18}, "episode_reward_min": -434.4638697102505}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1a90>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 2455859, "timesteps_total": 2455859, "timesteps_this_iter": 30125, "time_since_restore": 1842.8799290657043, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "episode_reward_mean": -283.4258896318031, "iterations_since_restore": 75, "episode_reward_max": -155.93551724262588, "policy_reward_mean": {}, "timestamp": 1558584855, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.93282699584961, "episodes_total": 3485, "time_total_s": 1842.8799290657043, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-14-15", "custom_metrics": {"cost2_min": -66.76894998467897, "cost1_mean": 197.07945472873485, "system_level_velocity_max": 18.8074524303741, "outflow_rate_min": 838.3956752339923, "cost1_max": 214.83419138644285, "outflow_rate_max": 1247.7053315554388, "system_level_velocity_min": 12.483386813384335, "cost2_max": -38.261607408486086, "cost1_min": 133.65196525570485, "system_level_velocity_mean": 17.093833794404492, "outflow_rate_mean": 1141.702286202643, "cost2_mean": -54.080150885382636}, "training_iteration": 75, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.081382155418396, "cur_kl_coeff": 0.22499996423721313, "kl": 0.018543900921940804, "vf_explained_var": 0.8986566066741943, "vf_loss": 8.66029167175293, "total_loss": 8.653087615966797, "policy_loss": -0.011375531554222107}, "sample_time_ms": 15397.118, "num_steps_sampled": 2455859, "num_steps_trained": 2455859, "update_time_ms": 9.029, "load_time_ms": 4.616, "grad_time_ms": 8342.551}, "episode_reward_min": -420.5150725816679}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5d30>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 47, "timesteps_since_restore": 2486114, "timesteps_total": 2486114, "timesteps_this_iter": 30255, "time_since_restore": 1866.717741727829, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "episode_reward_mean": -281.1854776135305, "iterations_since_restore": 76, "episode_reward_max": -233.0287774106266, "policy_reward_mean": {}, "timestamp": 1558584879, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.837812662124634, "episodes_total": 3532, "time_total_s": 1866.717741727829, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-14-39", "custom_metrics": {"cost2_min": -66.59104504331918, "cost1_mean": 198.0723390428269, "system_level_velocity_max": 18.73136987506984, "outflow_rate_min": 908.4331545759746, "cost1_max": 213.7561555523112, "outflow_rate_max": 1245.3424937888544, "system_level_velocity_min": 13.552119258374558, "cost2_max": -41.07568085060834, "cost1_min": 160.03689542639415, "system_level_velocity_mean": 17.106032934899893, "outflow_rate_mean": 1144.4632603631526, "cost2_mean": -53.91989377627848}, "training_iteration": 76, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.080520749092102, "cur_kl_coeff": 0.22499997913837433, "kl": 0.019563021138310432, "vf_explained_var": 0.897935152053833, "vf_loss": 8.990141868591309, "total_loss": 8.982810020446777, "policy_loss": -0.011733245104551315}, "sample_time_ms": 15311.258, "num_steps_sampled": 2486114, "num_steps_trained": 2486114, "update_time_ms": 9.179, "load_time_ms": 4.505, "grad_time_ms": 8290.065}, "episode_reward_min": -416.4978125151144}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bade10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badc18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad4e0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 2516741, "timesteps_total": 2516741, "timesteps_this_iter": 30627, "time_since_restore": 1889.289127111435, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "episode_reward_mean": -285.232568476079, "iterations_since_restore": 77, "episode_reward_max": -234.3282110940894, "policy_reward_mean": {}, "timestamp": 1558584902, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.571385383605957, "episodes_total": 3577, "time_total_s": 1889.289127111435, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-15-02", "custom_metrics": {"cost2_min": -63.510835404132706, "cost1_mean": 197.3864252943224, "system_level_velocity_max": 18.73136987506984, "outflow_rate_min": 908.4331545759746, "cost1_max": 213.7561555523112, "outflow_rate_max": 1246.7614009287115, "system_level_velocity_min": 13.714706807069575, "cost2_max": -42.66494099218424, "cost1_min": 163.03218617065016, "system_level_velocity_mean": 17.034234953543972, "outflow_rate_mean": 1143.6727074898317, "cost2_mean": -54.473473553661606}, "training_iteration": 77, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0596368312835693, "cur_kl_coeff": 0.22499997913837433, "kl": 0.01730439066886902, "vf_explained_var": 0.9010403156280518, "vf_loss": 8.790427207946777, "total_loss": 8.784576416015625, "policy_loss": -0.009745030663907528}, "sample_time_ms": 15255.853, "num_steps_sampled": 2516741, "num_steps_trained": 2516741, "update_time_ms": 8.953, "load_time_ms": 4.554, "grad_time_ms": 8238.756}, "episode_reward_min": -416.4978125151144}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1898>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 46, "timesteps_since_restore": 2547096, "timesteps_total": 2547096, "timesteps_this_iter": 30355, "time_since_restore": 1913.1059882640839, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "episode_reward_mean": -290.4905710523001, "iterations_since_restore": 78, "episode_reward_max": -209.83198440694412, "policy_reward_mean": {}, "timestamp": 1558584926, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.816861152648926, "episodes_total": 3623, "time_total_s": 1913.1059882640839, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-15-26", "custom_metrics": {"cost2_min": -67.4638211994766, "cost1_mean": 194.6415049223696, "system_level_velocity_max": 18.646066866467905, "outflow_rate_min": 891.0296218091081, "cost1_max": 212.87933681835847, "outflow_rate_max": 1246.7614009287115, "system_level_velocity_min": 13.732139683752063, "cost2_max": -39.50151972028494, "cost1_min": 121.26219968800284, "system_level_velocity_mean": 16.846612211410417, "outflow_rate_mean": 1132.299087729454, "cost2_mean": -54.22871870613389}, "training_iteration": 78, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0720630884170532, "cur_kl_coeff": 0.22499999403953552, "kl": 0.01596648246049881, "vf_explained_var": 0.8828442692756653, "vf_loss": 10.218741416931152, "total_loss": 10.212437629699707, "policy_loss": -0.00989621039479971}, "sample_time_ms": 15196.496, "num_steps_sampled": 2547096, "num_steps_trained": 2547096, "update_time_ms": 8.948, "load_time_ms": 4.577, "grad_time_ms": 8324.142}, "episode_reward_min": -412.26031455759335}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad550>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 48, "timesteps_since_restore": 2577571, "timesteps_total": 2577571, "timesteps_this_iter": 30475, "time_since_restore": 1937.39630651474, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "episode_reward_mean": -289.91594812653443, "iterations_since_restore": 79, "episode_reward_max": -209.83198440694412, "policy_reward_mean": {}, "timestamp": 1558584950, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.290318250656128, "episodes_total": 3671, "time_total_s": 1937.39630651474, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-15-50", "custom_metrics": {"cost2_min": -67.4638211994766, "cost1_mean": 195.64275117192793, "system_level_velocity_max": 18.774694483234914, "outflow_rate_min": 891.0296218091081, "cost1_max": 213.831009442773, "outflow_rate_max": 1249.3158810529549, "system_level_velocity_min": 13.732139683752063, "cost2_max": -39.50151972028494, "cost1_min": 121.26219968800284, "system_level_velocity_mean": 16.929711156492644, "outflow_rate_mean": 1137.248284980337, "cost2_mean": -54.45501790040748}, "training_iteration": 79, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.038672685623169, "cur_kl_coeff": 0.22499997913837433, "kl": 0.018379218876361847, "vf_explained_var": 0.8969812393188477, "vf_loss": 8.582823753356934, "total_loss": 8.577483177185059, "policy_loss": -0.00947746355086565}, "sample_time_ms": 15087.641, "num_steps_sampled": 2577571, "num_steps_trained": 2577571, "update_time_ms": 8.994, "load_time_ms": 4.639, "grad_time_ms": 8425.152}, "episode_reward_min": -412.26031455759335}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd828>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 2608160, "timesteps_total": 2608160, "timesteps_this_iter": 30589, "time_since_restore": 1959.7705192565918, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "episode_reward_mean": -283.677398276009, "iterations_since_restore": 80, "episode_reward_max": -233.1909658763615, "policy_reward_mean": {}, "timestamp": 1558584973, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.374212741851807, "episodes_total": 3715, "time_total_s": 1959.7705192565918, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-16-13", "custom_metrics": {"cost2_min": -66.02987050130056, "cost1_mean": 198.87993441550233, "system_level_velocity_max": 18.825380652138165, "outflow_rate_min": 1021.171306518724, "cost1_max": 213.831009442773, "outflow_rate_max": 1251.5627904024157, "system_level_velocity_min": 14.163692989437507, "cost2_max": -42.75341146364947, "cost1_min": 165.77593947433164, "system_level_velocity_mean": 17.168689083199837, "outflow_rate_mean": 1154.6269733339097, "cost2_mean": -54.888139943404504}, "training_iteration": 80, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0493130683898926, "cur_kl_coeff": 0.22499997913837433, "kl": 0.01604922115802765, "vf_explained_var": 0.8932108879089355, "vf_loss": 8.931736946105957, "total_loss": 8.925758361816406, "policy_loss": -0.009588672779500484}, "sample_time_ms": 14963.272, "num_steps_sampled": 2608160, "num_steps_trained": 2608160, "update_time_ms": 8.792, "load_time_ms": 4.486, "grad_time_ms": 8387.905}, "episode_reward_min": -392.11808260862625}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1cc0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 47, "timesteps_since_restore": 2638803, "timesteps_total": 2638803, "timesteps_this_iter": 30643, "time_since_restore": 1982.5434606075287, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "episode_reward_mean": -289.08639972256873, "iterations_since_restore": 81, "episode_reward_max": -149.6604678564754, "policy_reward_mean": {}, "timestamp": 1558584995, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.77294135093689, "episodes_total": 3762, "time_total_s": 1982.5434606075287, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-16-35", "custom_metrics": {"cost2_min": -63.3293353982609, "cost1_mean": 196.38301799049117, "system_level_velocity_max": 18.825380652138165, "outflow_rate_min": 995.3750859523205, "cost1_max": 214.3987931085495, "outflow_rate_max": 1251.5627904024157, "system_level_velocity_min": 14.163692989437507, "cost2_max": -42.75341146364947, "cost1_min": 136.05843842610489, "system_level_velocity_mean": 16.995257663610417, "outflow_rate_mean": 1146.339283620629, "cost2_mean": -55.04554691644823}, "training_iteration": 81, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.031425952911377, "cur_kl_coeff": 0.22499997913837433, "kl": 0.01708388514816761, "vf_explained_var": 0.8826248049736023, "vf_loss": 9.654033660888672, "total_loss": 9.648317337036133, "policy_loss": -0.009560220874845982}, "sample_time_ms": 14954.742, "num_steps_sampled": 2638803, "num_steps_trained": 2638803, "update_time_ms": 9.066, "load_time_ms": 4.625, "grad_time_ms": 8237.02}, "episode_reward_min": -396.3518258797173}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb50f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5358>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 49, "timesteps_since_restore": 2669469, "timesteps_total": 2669469, "timesteps_this_iter": 30666, "time_since_restore": 2006.5846099853516, "node_ip": "10.138.0.2", "episode_len_mean": 322.36, "hostname": "flow-main", "episode_reward_mean": -291.5484614040645, "iterations_since_restore": 82, "episode_reward_max": -149.6604678564754, "policy_reward_mean": {}, "timestamp": 1558585020, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.041149377822876, "episodes_total": 3811, "time_total_s": 2006.5846099853516, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-17-00", "custom_metrics": {"cost2_min": -64.52125788990493, "cost1_mean": 193.83392358011565, "system_level_velocity_max": 18.71912818086182, "outflow_rate_min": 961.40336835206, "cost1_max": 214.3987931085495, "outflow_rate_max": 1248.639651300074, "system_level_velocity_min": 14.194833019860845, "cost2_max": -40.618903169373, "cost1_min": 130.23436256451083, "system_level_velocity_mean": 16.819861109836424, "outflow_rate_mean": 1139.0466388107827, "cost2_mean": -55.29291560355828}, "training_iteration": 82, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.035266399383545, "cur_kl_coeff": 0.22499997913837433, "kl": 0.017607610672712326, "vf_explained_var": 0.8938387036323547, "vf_loss": 9.224654197692871, "total_loss": 9.219840049743652, "policy_loss": -0.008776572532951832}, "sample_time_ms": 14936.465, "num_steps_sampled": 2669469, "num_steps_trained": 2669469, "update_time_ms": 9.041, "load_time_ms": 4.493, "grad_time_ms": 8370.194}, "episode_reward_min": -396.3518258797173}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbda20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd4e0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 43, "timesteps_since_restore": 2699682, "timesteps_total": 2699682, "timesteps_this_iter": 30213, "time_since_restore": 2030.8199150562286, "node_ip": "10.138.0.2", "episode_len_mean": 322.47, "hostname": "flow-main", "episode_reward_mean": -285.049016816978, "iterations_since_restore": 83, "episode_reward_max": -160.17093836789041, "policy_reward_mean": {}, "timestamp": 1558585044, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.235305070877075, "episodes_total": 3854, "time_total_s": 2030.8199150562286, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-17-24", "custom_metrics": {"cost2_min": -64.52125788990493, "cost1_mean": 196.147787884698, "system_level_velocity_max": 18.799030580372566, "outflow_rate_min": 911.5973687857036, "cost1_max": 214.247590190963, "outflow_rate_max": 1244.0384404236436, "system_level_velocity_min": 13.988877776984358, "cost2_max": -40.618903169373, "cost1_min": 128.429783782839, "system_level_velocity_mean": 17.055129571677654, "outflow_rate_mean": 1140.8887018793353, "cost2_mean": -54.243207461218226}, "training_iteration": 83, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0386790037155151, "cur_kl_coeff": 0.22499997913837433, "kl": 0.017144011333584785, "vf_explained_var": 0.8940080404281616, "vf_loss": 7.9963908195495605, "total_loss": 7.989704608917236, "policy_loss": -0.010543120093643665}, "sample_time_ms": 15005.086, "num_steps_sampled": 2699682, "num_steps_trained": 2699682, "update_time_ms": 9.054, "load_time_ms": 4.605, "grad_time_ms": 8490.055}, "episode_reward_min": -389.28649888350793}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd16a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1320>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 50, "timesteps_since_restore": 2729849, "timesteps_total": 2729849, "timesteps_this_iter": 30167, "time_since_restore": 2053.6304235458374, "node_ip": "10.138.0.2", "episode_len_mean": 322.75, "hostname": "flow-main", "episode_reward_mean": -280.7736304947898, "iterations_since_restore": 84, "episode_reward_max": -153.60946559123028, "policy_reward_mean": {}, "timestamp": 1558585067, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.810508489608765, "episodes_total": 3904, "time_total_s": 2053.6304235458374, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-17-47", "custom_metrics": {"cost2_min": -70.86998150768002, "cost1_mean": 197.76797023019301, "system_level_velocity_max": 18.807949744579247, "outflow_rate_min": 911.5973687857036, "cost1_max": 214.76599126292115, "outflow_rate_max": 1242.1241583767342, "system_level_velocity_min": 13.957645404798848, "cost2_max": -41.095502943652136, "cost1_min": 128.429783782839, "system_level_velocity_mean": 17.22150938164353, "outflow_rate_mean": 1142.7159627092828, "cost2_mean": -53.51086035687503}, "training_iteration": 84, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0688203573226929, "cur_kl_coeff": 0.22499996423721313, "kl": 0.018547093495726585, "vf_explained_var": 0.8957023620605469, "vf_loss": 8.798280715942383, "total_loss": 8.792032241821289, "policy_loss": -0.010420857928693295}, "sample_time_ms": 15038.89, "num_steps_sampled": 2729849, "num_steps_trained": 2729849, "update_time_ms": 8.958, "load_time_ms": 5.079, "grad_time_ms": 8347.942}, "episode_reward_min": -429.07945230039974}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5e48>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 2760287, "timesteps_total": 2760287, "timesteps_this_iter": 30438, "time_since_restore": 2076.0351095199585, "node_ip": "10.138.0.2", "episode_len_mean": 322.75, "hostname": "flow-main", "episode_reward_mean": -282.27182624403156, "iterations_since_restore": 85, "episode_reward_max": -153.60946559123028, "policy_reward_mean": {}, "timestamp": 1558585089, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.404685974121094, "episodes_total": 3949, "time_total_s": 2076.0351095199585, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-18-09", "custom_metrics": {"cost2_min": -70.86998150768002, "cost1_mean": 196.49654467886705, "system_level_velocity_max": 18.807949744579247, "outflow_rate_min": 911.5715244815667, "cost1_max": 214.76599126292115, "outflow_rate_max": 1242.5401717300463, "system_level_velocity_min": 13.59289029187159, "cost2_max": -41.095502943652136, "cost1_min": 128.429783782839, "system_level_velocity_mean": 17.08999077284252, "outflow_rate_mean": 1138.0094970118412, "cost2_mean": -53.62569507613238}, "training_iteration": 85, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.054333209991455, "cur_kl_coeff": 0.22499999403953552, "kl": 0.016971712931990623, "vf_explained_var": 0.9091225266456604, "vf_loss": 8.174461364746094, "total_loss": 8.16812801361084, "policy_loss": -0.010152566246688366}, "sample_time_ms": 15021.674, "num_steps_sampled": 2760287, "num_steps_trained": 2760287, "update_time_ms": 8.582, "load_time_ms": 5.006, "grad_time_ms": 8212.295}, "episode_reward_min": -429.07945230039974}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1b70>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 2790892, "timesteps_total": 2790892, "timesteps_this_iter": 30605, "time_since_restore": 2100.0571110248566, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "episode_reward_mean": -287.41180220608146, "iterations_since_restore": 86, "episode_reward_max": -152.0929529068035, "policy_reward_mean": {}, "timestamp": 1558585113, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.02200150489807, "episodes_total": 3994, "time_total_s": 2100.0571110248566, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-18-33", "custom_metrics": {"cost2_min": -67.37887999806476, "cost1_mean": 195.1882675730749, "system_level_velocity_max": 18.752869095916648, "outflow_rate_min": 911.5715244815667, "cost1_max": 213.53409903160198, "outflow_rate_max": 1242.5401717300463, "system_level_velocity_min": 13.59289029187159, "cost2_max": -43.87543648105374, "cost1_min": 136.534517269229, "system_level_velocity_mean": 16.87693871151232, "outflow_rate_mean": 1138.2860232203589, "cost2_mean": -54.59704147987652}, "training_iteration": 86, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0344910621643066, "cur_kl_coeff": 0.22499997913837433, "kl": 0.017284413799643517, "vf_explained_var": 0.9005997180938721, "vf_loss": 8.897146224975586, "total_loss": 8.890778541564941, "policy_loss": -0.010257948189973831}, "sample_time_ms": 15022.147, "num_steps_sampled": 2790892, "num_steps_trained": 2790892, "update_time_ms": 8.487, "load_time_ms": 4.943, "grad_time_ms": 8228.378}, "episode_reward_min": -408.2590570630777}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd1d0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 50, "timesteps_since_restore": 2821665, "timesteps_total": 2821665, "timesteps_this_iter": 30773, "time_since_restore": 2123.414357662201, "node_ip": "10.138.0.2", "episode_len_mean": 323.54, "hostname": "flow-main", "episode_reward_mean": -290.41400965805695, "iterations_since_restore": 87, "episode_reward_max": -152.0929529068035, "policy_reward_mean": {}, "timestamp": 1558585137, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.35724663734436, "episodes_total": 4044, "time_total_s": 2123.414357662201, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-18-57", "custom_metrics": {"cost2_min": -69.55138203455974, "cost1_mean": 194.44688632590498, "system_level_velocity_max": 18.752869095916648, "outflow_rate_min": 953.8742301343259, "cost1_max": 212.90430532304214, "outflow_rate_max": 1233.3544295746628, "system_level_velocity_min": 11.98924338373946, "cost2_max": -43.48176637738399, "cost1_min": 136.534517269229, "system_level_velocity_mean": 16.80159529361456, "outflow_rate_mean": 1140.1322256425908, "cost2_mean": -55.65603228515472}, "training_iteration": 87, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0140082836151123, "cur_kl_coeff": 0.22499996423721313, "kl": 0.017294365912675858, "vf_explained_var": 0.8928902745246887, "vf_loss": 8.976792335510254, "total_loss": 8.971550941467285, "policy_loss": -0.009133249521255493}, "sample_time_ms": 15075.67, "num_steps_sampled": 2821665, "num_steps_trained": 2821665, "update_time_ms": 8.478, "load_time_ms": 4.951, "grad_time_ms": 8253.164}, "episode_reward_min": -432.8569675504953}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb50f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5b38>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 43, "timesteps_since_restore": 2852113, "timesteps_total": 2852113, "timesteps_this_iter": 30448, "time_since_restore": 2146.218358516693, "node_ip": "10.138.0.2", "episode_len_mean": 324.72, "hostname": "flow-main", "episode_reward_mean": -292.34916381576505, "iterations_since_restore": 88, "episode_reward_max": -232.82852525494002, "policy_reward_mean": {}, "timestamp": 1558585159, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.804000854492188, "episodes_total": 4087, "time_total_s": 2146.218358516693, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-19-19", "custom_metrics": {"cost2_min": -69.55138203455974, "cost1_mean": 195.25425107147595, "system_level_velocity_max": 18.865286100728202, "outflow_rate_min": 883.1197095299816, "cost1_max": 214.58985450078984, "outflow_rate_max": 1236.8584406841082, "system_level_velocity_min": 11.98924338373946, "cost2_max": -43.48176637738399, "cost1_min": 144.46348210812894, "system_level_velocity_mean": 16.800055044093032, "outflow_rate_mean": 1143.0622272748876, "cost2_mean": -56.36022307146607}, "training_iteration": 88, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0236237049102783, "cur_kl_coeff": 0.22499999403953552, "kl": 0.017943385988473892, "vf_explained_var": 0.8957144021987915, "vf_loss": 8.708125114440918, "total_loss": 8.701361656188965, "policy_loss": -0.010800805874168873}, "sample_time_ms": 15092.028, "num_steps_sampled": 2852113, "num_steps_trained": 2852113, "update_time_ms": 8.579, "load_time_ms": 4.782, "grad_time_ms": 8137.144}, "episode_reward_min": -432.8569675504953}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6860>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 47, "timesteps_since_restore": 2882549, "timesteps_total": 2882549, "timesteps_this_iter": 30436, "time_since_restore": 2171.6829574108124, "node_ip": "10.138.0.2", "episode_len_mean": 320.84, "hostname": "flow-main", "episode_reward_mean": -281.9249600678952, "iterations_since_restore": 89, "episode_reward_max": -22.37913683320019, "policy_reward_mean": {}, "timestamp": 1558585185, "num_metric_batches_dropped": 0, "time_this_iter_s": 25.464598894119263, "episodes_total": 4134, "time_total_s": 2171.6829574108124, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-19-45", "custom_metrics": {"cost2_min": -68.07747320318813, "cost1_mean": 195.92341330518298, "system_level_velocity_max": 18.865286100728202, "outflow_rate_min": 448.5093812448499, "cost1_max": 215.42921364092086, "outflow_rate_max": 1251.9634166909573, "system_level_velocity_min": 12.960284110654628, "cost2_max": -19.31796049224948, "cost1_min": 17.821728351746597, "system_level_velocity_mean": 17.128559143278107, "outflow_rate_mean": 1146.755180456646, "cost2_mean": -55.835183105209126}, "training_iteration": 89, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0198590755462646, "cur_kl_coeff": 0.22499999403953552, "kl": 0.01740902289748192, "vf_explained_var": 0.8848735094070435, "vf_loss": 9.12741756439209, "total_loss": 9.123774528503418, "policy_loss": -0.007560870610177517}, "sample_time_ms": 15206.958, "num_steps_sampled": 2882549, "num_steps_trained": 2882549, "update_time_ms": 8.491, "load_time_ms": 4.683, "grad_time_ms": 8139.569}, "episode_reward_min": -421.94519612824513}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd748>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 48, "timesteps_since_restore": 2913102, "timesteps_total": 2913102, "timesteps_this_iter": 30553, "time_since_restore": 2196.5505969524384, "node_ip": "10.138.0.2", "episode_len_mean": 320.84, "hostname": "flow-main", "episode_reward_mean": -279.2932442967514, "iterations_since_restore": 90, "episode_reward_max": -22.37913683320019, "policy_reward_mean": {}, "timestamp": 1558585210, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.867639541625977, "episodes_total": 4182, "time_total_s": 2196.5505969524384, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-20-10", "custom_metrics": {"cost2_min": -68.07747320318813, "cost1_mean": 197.32571115668884, "system_level_velocity_max": 18.795619710976883, "outflow_rate_min": 448.5093812448499, "cost1_max": 215.42921364092086, "outflow_rate_max": 1251.9634166909573, "system_level_velocity_min": 13.961927871209596, "cost2_max": -19.31796049224948, "cost1_min": 17.821728351746597, "system_level_velocity_mean": 17.280744200443557, "outflow_rate_mean": 1152.2680158345572, "cost2_mean": -56.047672933231006}, "training_iteration": 90, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.036668062210083, "cur_kl_coeff": 0.22499997913837433, "kl": 0.020137233659625053, "vf_explained_var": 0.9044931530952454, "vf_loss": 8.349784851074219, "total_loss": 8.341538429260254, "policy_loss": -0.012776635587215424}, "sample_time_ms": 15292.145, "num_steps_sampled": 2913102, "num_steps_trained": 2913102, "update_time_ms": 8.44, "load_time_ms": 4.783, "grad_time_ms": 8304.425}, "episode_reward_min": -421.94519612824513}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb50f0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 47, "timesteps_since_restore": 2943833, "timesteps_total": 2943833, "timesteps_this_iter": 30731, "time_since_restore": 2219.4028282165527, "node_ip": "10.138.0.2", "episode_len_mean": 320.72, "hostname": "flow-main", "episode_reward_mean": -283.0632429685225, "iterations_since_restore": 91, "episode_reward_max": -30.568951345241643, "policy_reward_mean": {}, "timestamp": 1558585233, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.85223126411438, "episodes_total": 4229, "time_total_s": 2219.4028282165527, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-20-33", "custom_metrics": {"cost2_min": -65.71684872988982, "cost1_mean": 195.77874948867372, "system_level_velocity_max": 18.794980226293927, "outflow_rate_min": 493.2509405449511, "cost1_max": 214.90734320849447, "outflow_rate_max": 1250.4965615973747, "system_level_velocity_min": 13.95032253004992, "cost2_max": -18.942592961796294, "cost1_min": 22.49290065310198, "system_level_velocity_mean": 17.135216151498867, "outflow_rate_mean": 1142.5999372344531, "cost2_mean": -55.859352572420875}, "training_iteration": 91, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.023418664932251, "cur_kl_coeff": 0.33750006556510925, "kl": 0.014784809201955795, "vf_explained_var": 0.9005194306373596, "vf_loss": 8.737561225891113, "total_loss": 8.732145309448242, "policy_loss": -0.010405919514596462}, "sample_time_ms": 15300.778, "num_steps_sampled": 2943833, "num_steps_trained": 2943833, "update_time_ms": 8.256, "load_time_ms": 4.677, "grad_time_ms": 8303.49}, "episode_reward_min": -412.40869206973014}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1438>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 2974715, "timesteps_total": 2974715, "timesteps_this_iter": 30882, "time_since_restore": 2243.3407230377197, "node_ip": "10.138.0.2", "episode_len_mean": 320.54, "hostname": "flow-main", "episode_reward_mean": -284.45232200036645, "iterations_since_restore": 92, "episode_reward_max": -30.568951345241643, "policy_reward_mean": {}, "timestamp": 1558585257, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.937894821166992, "episodes_total": 4274, "time_total_s": 2243.3407230377197, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-20-57", "custom_metrics": {"cost2_min": -65.29593908469282, "cost1_mean": 194.88240535112925, "system_level_velocity_max": 18.75247457500877, "outflow_rate_min": 493.2509405449511, "cost1_max": 214.50988540030343, "outflow_rate_max": 1251.763926946975, "system_level_velocity_min": 13.95032253004992, "cost2_max": -18.942592961796294, "cost1_min": 22.49290065310198, "system_level_velocity_mean": 17.0345615149915, "outflow_rate_mean": 1140.3896522440646, "cost2_mean": -56.21861240267971}, "training_iteration": 92, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0030505657196045, "cur_kl_coeff": 0.33750006556510925, "kl": 0.015642300248146057, "vf_explained_var": 0.9026781916618347, "vf_loss": 8.176840782165527, "total_loss": 8.171879768371582, "policy_loss": -0.010239701718091965}, "sample_time_ms": 15296.266, "num_steps_sampled": 2974715, "num_steps_trained": 2974715, "update_time_ms": 8.172, "load_time_ms": 4.751, "grad_time_ms": 8297.562}, "episode_reward_min": -388.21101981032706}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd6d8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 3005713, "timesteps_total": 3005713, "timesteps_this_iter": 30998, "time_since_restore": 2267.4081819057465, "node_ip": "10.138.0.2", "episode_len_mean": 321.92, "hostname": "flow-main", "episode_reward_mean": -293.6157182899434, "iterations_since_restore": 93, "episode_reward_max": -30.568951345241643, "policy_reward_mean": {}, "timestamp": 1558585281, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.067458868026733, "episodes_total": 4319, "time_total_s": 2267.4081819057465, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-21-21", "custom_metrics": {"cost2_min": -68.16329512493937, "cost1_mean": 194.06177306371868, "system_level_velocity_max": 18.75247457500877, "outflow_rate_min": 493.2509405449511, "cost1_max": 214.50988540030343, "outflow_rate_max": 1251.763926946975, "system_level_velocity_min": 13.98172614708866, "cost2_max": -18.942592961796294, "cost1_min": 22.49290065310198, "system_level_velocity_mean": 16.862780200664744, "outflow_rate_mean": 1139.2152652052057, "cost2_mean": -57.6020281067514}, "training_iteration": 93, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0056796073913574, "cur_kl_coeff": 0.33750006556510925, "kl": 0.014590362086892128, "vf_explained_var": 0.9035059213638306, "vf_loss": 8.408662796020508, "total_loss": 8.40291690826416, "policy_loss": -0.010670213028788567}, "sample_time_ms": 15234.433, "num_steps_sampled": 3005713, "num_steps_trained": 3005713, "update_time_ms": 8.038, "load_time_ms": 4.976, "grad_time_ms": 8342.446}, "episode_reward_min": -408.50419296758645}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6908>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 49, "timesteps_since_restore": 3036192, "timesteps_total": 3036192, "timesteps_this_iter": 30479, "time_since_restore": 2292.143168926239, "node_ip": "10.138.0.2", "episode_len_mean": 324.72, "hostname": "flow-main", "episode_reward_mean": -293.3803348060216, "iterations_since_restore": 94, "episode_reward_max": -232.25038903486796, "policy_reward_mean": {}, "timestamp": 1558585306, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.734987020492554, "episodes_total": 4368, "time_total_s": 2292.143168926239, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-21-46", "custom_metrics": {"cost2_min": -68.16329512493937, "cost1_mean": 196.6330238434206, "system_level_velocity_max": 18.822111040789746, "outflow_rate_min": 944.1482653435445, "cost1_max": 214.21801742620275, "outflow_rate_max": 1253.1943235617946, "system_level_velocity_min": 13.76967136037848, "cost2_max": -43.49054168709742, "cost1_min": 160.1377700203035, "system_level_velocity_mean": 16.937492958908635, "outflow_rate_mean": 1152.8098874891316, "cost2_mean": -58.14861310530443}, "training_iteration": 94, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0159125328063965, "cur_kl_coeff": 0.33750012516975403, "kl": 0.01436799019575119, "vf_explained_var": 0.8986958861351013, "vf_loss": 8.426186561584473, "total_loss": 8.42113971710205, "policy_loss": -0.009895809926092625}, "sample_time_ms": 15250.383, "num_steps_sampled": 3036192, "num_steps_trained": 3036192, "update_time_ms": 7.94, "load_time_ms": 4.437, "grad_time_ms": 8519.008}, "episode_reward_min": -408.50419296758645}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd16d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1358>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 3067240, "timesteps_total": 3067240, "timesteps_this_iter": 31048, "time_since_restore": 2315.0506987571716, "node_ip": "10.138.0.2", "episode_len_mean": 324.44, "hostname": "flow-main", "episode_reward_mean": -288.78250553245766, "iterations_since_restore": 95, "episode_reward_max": -231.32158482615344, "policy_reward_mean": {}, "timestamp": 1558585329, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.907529830932617, "episodes_total": 4412, "time_total_s": 2315.0506987571716, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-22-09", "custom_metrics": {"cost2_min": -69.97197646719589, "cost1_mean": 197.77186358451306, "system_level_velocity_max": 18.822111040789746, "outflow_rate_min": 944.1482653435445, "cost1_max": 214.51358303067096, "outflow_rate_max": 1257.518113041502, "system_level_velocity_min": 13.713812890071722, "cost2_max": -43.49054168709742, "cost1_min": 159.74936319494867, "system_level_velocity_mean": 17.06209765425349, "outflow_rate_mean": 1158.306525206837, "cost2_mean": -57.948438011878764}, "training_iteration": 95, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0129427909851074, "cur_kl_coeff": 0.33750006556510925, "kl": 0.014024891890585423, "vf_explained_var": 0.9091926217079163, "vf_loss": 8.380863189697266, "total_loss": 8.374608993530273, "policy_loss": -0.010988743975758553}, "sample_time_ms": 15293.074, "num_steps_sampled": 3067240, "num_steps_trained": 3067240, "update_time_ms": 7.979, "load_time_ms": 4.534, "grad_time_ms": 8526.901}, "episode_reward_min": -411.53534356409506}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd550>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 47, "timesteps_since_restore": 3098044, "timesteps_total": 3098044, "timesteps_this_iter": 30804, "time_since_restore": 2341.4739611148834, "node_ip": "10.138.0.2", "episode_len_mean": 323.54, "hostname": "flow-main", "episode_reward_mean": -292.0295354119372, "iterations_since_restore": 96, "episode_reward_max": -152.83097619878797, "policy_reward_mean": {}, "timestamp": 1558585355, "num_metric_batches_dropped": 0, "time_this_iter_s": 26.423262357711792, "episodes_total": 4459, "time_total_s": 2341.4739611148834, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-22-35", "custom_metrics": {"cost2_min": -71.15973502153457, "cost1_mean": 195.46672470626004, "system_level_velocity_max": 18.83067048240271, "outflow_rate_min": 871.0700487804878, "cost1_max": 215.18131726830433, "outflow_rate_max": 1257.518113041502, "system_level_velocity_min": 13.570541730791877, "cost2_max": -41.88470565130578, "cost1_min": 134.12446181060446, "system_level_velocity_mean": 16.895895239736895, "outflow_rate_mean": 1148.431431554256, "cost2_mean": -58.16979486367623}, "training_iteration": 96, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0145729780197144, "cur_kl_coeff": 0.33750006556510925, "kl": 0.014562377706170082, "vf_explained_var": 0.8868234157562256, "vf_loss": 10.141939163208008, "total_loss": 10.135927200317383, "policy_loss": -0.010926765389740467}, "sample_time_ms": 15329.608, "num_steps_sampled": 3098044, "num_steps_trained": 3098044, "update_time_ms": 7.979, "load_time_ms": 4.576, "grad_time_ms": 8731.749}, "episode_reward_min": -411.53534356409506}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb50b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5eb8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 50, "timesteps_since_restore": 3129193, "timesteps_total": 3129193, "timesteps_this_iter": 31149, "time_since_restore": 2366.3996868133545, "node_ip": "10.138.0.2", "episode_len_mean": 317.66, "hostname": "flow-main", "episode_reward_mean": -291.6120997008587, "iterations_since_restore": 97, "episode_reward_max": -21.21270564641633, "policy_reward_mean": {}, "timestamp": 1558585380, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.92572569847107, "episodes_total": 4509, "time_total_s": 2366.3996868133545, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-23-00", "custom_metrics": {"cost2_min": -71.15973502153457, "cost1_mean": 190.83137188123288, "system_level_velocity_max": 18.844941602197093, "outflow_rate_min": 492.0625426222078, "cost1_max": 215.18131726830433, "outflow_rate_max": 1253.0070724985867, "system_level_velocity_min": 13.570541730791877, "cost2_max": -18.37886158840909, "cost1_min": 17.943041529263105, "system_level_velocity_mean": 16.821393464432827, "outflow_rate_mean": 1126.9305138182774, "cost2_mean": -57.23817262338864}, "training_iteration": 97, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.030839204788208, "cur_kl_coeff": 0.33750009536743164, "kl": 0.014700465835630894, "vf_explained_var": 0.88239586353302, "vf_loss": 11.127479553222656, "total_loss": 11.12164306640625, "policy_loss": -0.010797714814543724}, "sample_time_ms": 15330.525, "num_steps_sampled": 3129193, "num_steps_trained": 3129193, "update_time_ms": 8.151, "load_time_ms": 4.815, "grad_time_ms": 8887.013}, "episode_reward_min": -419.02154622883467}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd4e0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 3159421, "timesteps_total": 3159421, "timesteps_this_iter": 30228, "time_since_restore": 2389.1450226306915, "node_ip": "10.138.0.2", "episode_len_mean": 319.12, "hostname": "flow-main", "episode_reward_mean": -290.8309255941657, "iterations_since_restore": 98, "episode_reward_max": -21.21270564641633, "policy_reward_mean": {}, "timestamp": 1558585403, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.745335817337036, "episodes_total": 4553, "time_total_s": 2389.1450226306915, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-23-23", "custom_metrics": {"cost2_min": -70.3862334377639, "cost1_mean": 192.41113647900082, "system_level_velocity_max": 18.911476957618692, "outflow_rate_min": 492.0625426222078, "cost1_max": 214.53266999186945, "outflow_rate_max": 1241.3292267642298, "system_level_velocity_min": 14.004317778151439, "cost2_max": -18.37886158840909, "cost1_min": 17.943041529263105, "system_level_velocity_mean": 16.892080383579707, "outflow_rate_mean": 1131.3265067632985, "cost2_mean": -57.13802845350914}, "training_iteration": 98, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0081058740615845, "cur_kl_coeff": 0.33750009536743164, "kl": 0.015625305473804474, "vf_explained_var": 0.9012606143951416, "vf_loss": 7.867959022521973, "total_loss": 7.862345218658447, "policy_loss": -0.010888035409152508}, "sample_time_ms": 15292.583, "num_steps_sampled": 3159421, "num_steps_trained": 3159421, "update_time_ms": 8.327, "load_time_ms": 4.882, "grad_time_ms": 8916.752}, "episode_reward_min": -424.6844994944825}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd0b8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 46, "timesteps_since_restore": 3189775, "timesteps_total": 3189775, "timesteps_this_iter": 30354, "time_since_restore": 2411.766704559326, "node_ip": "10.138.0.2", "episode_len_mean": 322.02, "hostname": "flow-main", "episode_reward_mean": -284.0555026937038, "iterations_since_restore": 99, "episode_reward_max": -21.21270564641633, "policy_reward_mean": {}, "timestamp": 1558585425, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.621681928634644, "episodes_total": 4599, "time_total_s": 2411.766704559326, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-23-45", "custom_metrics": {"cost2_min": -69.06586528689728, "cost1_mean": 196.47772274117315, "system_level_velocity_max": 18.911476957618692, "outflow_rate_min": 492.0625426222078, "cost1_max": 214.78812368164415, "outflow_rate_max": 1254.053602430711, "system_level_velocity_min": 14.004317778151439, "cost2_max": -18.37886158840909, "cost1_min": 17.943041529263105, "system_level_velocity_mean": 17.107629586110146, "outflow_rate_mean": 1148.9831938370069, "cost2_mean": -56.993714316973026}, "training_iteration": 99, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.010941505432129, "cur_kl_coeff": 0.33750006556510925, "kl": 0.014361854642629623, "vf_explained_var": 0.8920170664787292, "vf_loss": 8.814486503601074, "total_loss": 8.809038162231445, "policy_loss": -0.010295992717146873}, "sample_time_ms": 15159.455, "num_steps_sampled": 3189775, "num_steps_trained": 3189775, "update_time_ms": 8.364, "load_time_ms": 4.94, "grad_time_ms": 8766.036}, "episode_reward_min": -424.6844994944825}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6828>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 50, "timesteps_since_restore": 3219965, "timesteps_total": 3219965, "timesteps_this_iter": 30190, "time_since_restore": 2435.182426214218, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "episode_reward_mean": -279.45317850927376, "iterations_since_restore": 100, "episode_reward_max": -234.1128625984296, "policy_reward_mean": {}, "timestamp": 1558585449, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.415721654891968, "episodes_total": 4649, "time_total_s": 2435.182426214218, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-24-09", "custom_metrics": {"cost2_min": -69.06586528689728, "cost1_mean": 199.62635659906718, "system_level_velocity_max": 18.84366580236453, "outflow_rate_min": 930.3089852216748, "cost1_max": 214.78812368164415, "outflow_rate_max": 1254.053602430711, "system_level_velocity_min": 14.133553278306774, "cost2_max": -43.33395691088482, "cost1_min": 165.93871614348583, "system_level_velocity_mean": 17.246039414267806, "outflow_rate_mean": 1155.527828235711, "cost2_mean": -55.732652230786044}, "training_iteration": 100, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0270951986312866, "cur_kl_coeff": 0.33750006556510925, "kl": 0.01521220151335001, "vf_explained_var": 0.8937569260597229, "vf_loss": 9.064480781555176, "total_loss": 9.055880546569824, "policy_loss": -0.013735502026975155}, "sample_time_ms": 15084.909, "num_steps_sampled": 3219965, "num_steps_trained": 3219965, "update_time_ms": 8.898, "load_time_ms": 4.865, "grad_time_ms": 8695.73}, "episode_reward_min": -407.636260064492}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc61d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6128>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 3250326, "timesteps_total": 3250326, "timesteps_this_iter": 30361, "time_since_restore": 2457.756369113922, "node_ip": "10.138.0.2", "episode_len_mean": 322.1, "hostname": "flow-main", "episode_reward_mean": -283.96069923922244, "iterations_since_restore": 101, "episode_reward_max": -28.48169290476733, "policy_reward_mean": {}, "timestamp": 1558585472, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.57394289970398, "episodes_total": 4693, "time_total_s": 2457.756369113922, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-24-32", "custom_metrics": {"cost2_min": -66.42115428708432, "cost1_mean": 194.67785336362093, "system_level_velocity_max": 18.884223773999565, "outflow_rate_min": 509.94648962732464, "cost1_max": 214.12581298496664, "outflow_rate_max": 1247.0457079584503, "system_level_velocity_min": 13.928673721809146, "cost2_max": -20.890276614850773, "cost1_min": 22.81093419525394, "system_level_velocity_mean": 16.95988152814239, "outflow_rate_mean": 1130.1230114584266, "cost2_mean": -54.71071103032727}, "training_iteration": 101, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0362402200698853, "cur_kl_coeff": 0.33750006556510925, "kl": 0.015071756206452847, "vf_explained_var": 0.9013589024543762, "vf_loss": 9.075257301330566, "total_loss": 9.069478034973145, "policy_loss": -0.01086555328220129}, "sample_time_ms": 15031.263, "num_steps_sampled": 3250326, "num_steps_trained": 3250326, "update_time_ms": 8.865, "load_time_ms": 4.889, "grad_time_ms": 8721.379}, "episode_reward_min": -382.60057610700176}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5320>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 46, "timesteps_since_restore": 3280534, "timesteps_total": 3280534, "timesteps_this_iter": 30208, "time_since_restore": 2481.3603162765503, "node_ip": "10.138.0.2", "episode_len_mean": 319.22, "hostname": "flow-main", "episode_reward_mean": -287.01499882620107, "iterations_since_restore": 102, "episode_reward_max": -28.48169290476733, "policy_reward_mean": {}, "timestamp": 1558585495, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.603947162628174, "episodes_total": 4739, "time_total_s": 2481.3603162765503, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-24-55", "custom_metrics": {"cost2_min": -65.91045318085487, "cost1_mean": 191.12558973147551, "system_level_velocity_max": 18.884223773999565, "outflow_rate_min": 509.94648962732464, "cost1_max": 214.12581298496664, "outflow_rate_max": 1247.0457079584503, "system_level_velocity_min": 13.601859697424919, "cost2_max": -20.890276614850773, "cost1_min": 22.81093419525394, "system_level_velocity_mean": 16.806708189790335, "outflow_rate_mean": 1111.5993499489064, "cost2_mean": -54.28761931132885}, "training_iteration": 102, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0313869714736938, "cur_kl_coeff": 0.33750009536743164, "kl": 0.016895785927772522, "vf_explained_var": 0.8950417637825012, "vf_loss": 9.275146484375, "total_loss": 9.268310546875, "policy_loss": -0.012537720613181591}, "sample_time_ms": 15029.605, "num_steps_sampled": 3280534, "num_steps_trained": 3280534, "update_time_ms": 9.061, "load_time_ms": 4.818, "grad_time_ms": 8689.516}, "episode_reward_min": -382.60057610700176}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd17b8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 50, "timesteps_since_restore": 3311181, "timesteps_total": 3311181, "timesteps_this_iter": 30647, "time_since_restore": 2504.2795989513397, "node_ip": "10.138.0.2", "episode_len_mean": 321.07, "hostname": "flow-main", "episode_reward_mean": -290.4101981245685, "iterations_since_restore": 103, "episode_reward_max": -29.9377429358012, "policy_reward_mean": {}, "timestamp": 1558585518, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.91928267478943, "episodes_total": 4789, "time_total_s": 2504.2795989513397, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-25-18", "custom_metrics": {"cost2_min": -65.91045318085487, "cost1_mean": 192.5570988685292, "system_level_velocity_max": 18.812746865197497, "outflow_rate_min": 512.3531863872981, "cost1_max": 214.203662429924, "outflow_rate_max": 1244.104880476888, "system_level_velocity_min": 13.601859697424919, "cost2_max": -21.17409174444846, "cost1_min": 24.085058860540165, "system_level_velocity_mean": 16.80318697381651, "outflow_rate_mean": 1118.845893842944, "cost2_mean": -54.86728771672672}, "training_iteration": 103, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.005746603012085, "cur_kl_coeff": 0.33750009536743164, "kl": 0.016396209597587585, "vf_explained_var": 0.8811681270599365, "vf_loss": 10.998492240905762, "total_loss": 10.993762969970703, "policy_loss": -0.010264161042869091}, "sample_time_ms": 15061.468, "num_steps_sampled": 3311181, "num_steps_trained": 3311181, "update_time_ms": 9.098, "load_time_ms": 4.637, "grad_time_ms": 8543.152}, "episode_reward_min": -380.35380315462805}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6898>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 3341254, "timesteps_total": 3341254, "timesteps_this_iter": 30073, "time_since_restore": 2526.485527038574, "node_ip": "10.138.0.2", "episode_len_mean": 321.07, "hostname": "flow-main", "episode_reward_mean": -284.35940845426563, "iterations_since_restore": 104, "episode_reward_max": -29.9377429358012, "policy_reward_mean": {}, "timestamp": 1558585540, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.205928087234497, "episodes_total": 4834, "time_total_s": 2526.485527038574, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-25-40", "custom_metrics": {"cost2_min": -67.04967227127212, "cost1_mean": 194.55224201821827, "system_level_velocity_max": 18.81734827359121, "outflow_rate_min": 512.3531863872981, "cost1_max": 214.46458151918813, "outflow_rate_max": 1245.189961631467, "system_level_velocity_min": 13.983614988524508, "cost2_max": -21.17409174444846, "cost1_min": 24.085058860540165, "system_level_velocity_mean": 17.01128272999628, "outflow_rate_mean": 1134.1536278887913, "cost2_mean": -54.44923316272688}, "training_iteration": 104, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0475481748580933, "cur_kl_coeff": 0.33750009536743164, "kl": 0.015708455815911293, "vf_explained_var": 0.9105340242385864, "vf_loss": 7.825860023498535, "total_loss": 7.81809139251709, "policy_loss": -0.013070240616798401}, "sample_time_ms": 14994.405, "num_steps_sampled": 3341254, "num_steps_trained": 3341254, "update_time_ms": 9.036, "load_time_ms": 4.728, "grad_time_ms": 8357.823}, "episode_reward_min": -395.33627388793167}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5278>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 49, "timesteps_since_restore": 3371428, "timesteps_total": 3371428, "timesteps_this_iter": 30174, "time_since_restore": 2550.156363964081, "node_ip": "10.138.0.2", "episode_len_mean": 314.55, "hostname": "flow-main", "episode_reward_mean": -274.8673428423272, "iterations_since_restore": 105, "episode_reward_max": -22.393696577393907, "policy_reward_mean": {}, "timestamp": 1558585564, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.670836925506592, "episodes_total": 4883, "time_total_s": 2550.156363964081, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-26-04", "custom_metrics": {"cost2_min": -67.04967227127212, "cost1_mean": 190.7676425452972, "system_level_velocity_max": 18.870004913062004, "outflow_rate_min": 431.75782487237836, "cost1_max": 214.90506846686674, "outflow_rate_max": 1249.0678721874717, "system_level_velocity_min": 12.609720966325026, "cost2_max": -21.455765343385455, "cost1_min": 17.89688348677289, "system_level_velocity_mean": 17.035511401860223, "outflow_rate_mean": 1121.4759002072624, "cost2_mean": -53.6435827206569}, "training_iteration": 105, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0150326490402222, "cur_kl_coeff": 0.33750006556510925, "kl": 0.013989911414682865, "vf_explained_var": 0.8901151418685913, "vf_loss": 9.33518123626709, "total_loss": 9.330404281616211, "policy_loss": -0.009499325416982174}, "sample_time_ms": 15087.173, "num_steps_sampled": 3371428, "num_steps_trained": 3371428, "update_time_ms": 9.263, "load_time_ms": 4.688, "grad_time_ms": 8341.232}, "episode_reward_min": -395.33627388793167}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc64a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc69b0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 3401667, "timesteps_total": 3401667, "timesteps_this_iter": 30239, "time_since_restore": 2572.5012407302856, "node_ip": "10.138.0.2", "episode_len_mean": 314.22, "hostname": "flow-main", "episode_reward_mean": -273.19301338604515, "iterations_since_restore": 106, "episode_reward_max": -22.393696577393907, "policy_reward_mean": {}, "timestamp": 1558585587, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.344876766204834, "episodes_total": 4928, "time_total_s": 2572.5012407302856, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-26-27", "custom_metrics": {"cost2_min": -70.15341256879748, "cost1_mean": 191.01952897928402, "system_level_velocity_max": 18.88369623656764, "outflow_rate_min": 431.75782487237836, "cost1_max": 214.90506846686674, "outflow_rate_max": 1249.0678721874717, "system_level_velocity_min": 12.609720966325026, "cost2_max": -21.455765343385455, "cost1_min": 17.89688348677289, "system_level_velocity_mean": 17.06593848154246, "outflow_rate_mean": 1126.1072580942002, "cost2_mean": -53.94700361062726}, "training_iteration": 106, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0039993524551392, "cur_kl_coeff": 0.33750009536743164, "kl": 0.015018036589026451, "vf_explained_var": 0.8939163684844971, "vf_loss": 8.380577087402344, "total_loss": 8.374783515930176, "policy_loss": -0.010862407274544239}, "sample_time_ms": 15048.514, "num_steps_sampled": 3401667, "num_steps_trained": 3401667, "update_time_ms": 9.231, "load_time_ms": 4.654, "grad_time_ms": 7970.816}, "episode_reward_min": -390.23140098503126}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd54a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6940>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 48, "timesteps_since_restore": 3432330, "timesteps_total": 3432330, "timesteps_this_iter": 30663, "time_since_restore": 2595.2544598579407, "node_ip": "10.138.0.2", "episode_len_mean": 323.44, "hostname": "flow-main", "episode_reward_mean": -284.1748834386296, "iterations_since_restore": 107, "episode_reward_max": -156.97194299295245, "policy_reward_mean": {}, "timestamp": 1558585609, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.75321912765503, "episodes_total": 4976, "time_total_s": 2595.2544598579407, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-26-49", "custom_metrics": {"cost2_min": -70.15341256879748, "cost1_mean": 196.7826260712931, "system_level_velocity_max": 18.88369623656764, "outflow_rate_min": 1012.2136421252623, "cost1_max": 214.78074313111986, "outflow_rate_max": 1249.1952559867877, "system_level_velocity_min": 14.388723017865162, "cost2_max": -40.89239088431607, "cost1_min": 140.69411851270908, "system_level_velocity_mean": 17.06281567207412, "outflow_rate_mean": 1147.7870771339988, "cost2_mean": -55.36488578271055}, "training_iteration": 107, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 0.9917340874671936, "cur_kl_coeff": 0.33750009536743164, "kl": 0.014907615259289742, "vf_explained_var": 0.9002169966697693, "vf_loss": 8.691755294799805, "total_loss": 8.687273025512695, "policy_loss": -0.009513061493635178}, "sample_time_ms": 14996.748, "num_steps_sampled": 3432330, "num_steps_trained": 3432330, "update_time_ms": 9.208, "load_time_ms": 4.383, "grad_time_ms": 7806.06}, "episode_reward_min": -390.23140098503126}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd52e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5860>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 3462822, "timesteps_total": 3462822, "timesteps_this_iter": 30492, "time_since_restore": 2618.3122594356537, "node_ip": "10.138.0.2", "episode_len_mean": 324.26, "hostname": "flow-main", "episode_reward_mean": -288.7935161908389, "iterations_since_restore": 108, "episode_reward_max": -226.19783696592674, "policy_reward_mean": {}, "timestamp": 1558585633, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.057799577713013, "episodes_total": 5021, "time_total_s": 2618.3122594356537, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-27-13", "custom_metrics": {"cost2_min": -69.40214222329439, "cost1_mean": 196.0783032348617, "system_level_velocity_max": 18.88369623656764, "outflow_rate_min": 958.6675658914726, "cost1_max": 214.85080379148025, "outflow_rate_max": 1249.1952559867877, "system_level_velocity_min": 14.113801505940716, "cost2_max": -43.10689311051454, "cost1_min": 166.26765394203431, "system_level_velocity_mean": 16.92540346605744, "outflow_rate_mean": 1145.651297173659, "cost2_mean": -56.268357649869124}, "training_iteration": 108, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0039780139923096, "cur_kl_coeff": 0.33750012516975403, "kl": 0.016530480235815048, "vf_explained_var": 0.9022961258888245, "vf_loss": 8.50766658782959, "total_loss": 8.505026817321777, "policy_loss": -0.008219236508011818}, "sample_time_ms": 15028.097, "num_steps_sampled": 3462822, "num_steps_trained": 3462822, "update_time_ms": 9.014, "load_time_ms": 4.423, "grad_time_ms": 7805.518}, "episode_reward_min": -404.53021504333907}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd358>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 48, "timesteps_since_restore": 3493874, "timesteps_total": 3493874, "timesteps_this_iter": 31052, "time_since_restore": 2642.2124156951904, "node_ip": "10.138.0.2", "episode_len_mean": 323.08, "hostname": "flow-main", "episode_reward_mean": -293.98545982319325, "iterations_since_restore": 109, "episode_reward_max": -200.69037913097768, "policy_reward_mean": {}, "timestamp": 1558585656, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.900156259536743, "episodes_total": 5069, "time_total_s": 2642.2124156951904, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-27-36", "custom_metrics": {"cost2_min": -69.40214222329439, "cost1_mean": 193.42766884666872, "system_level_velocity_max": 18.795314201185228, "outflow_rate_min": 888.0890652997509, "cost1_max": 215.43284666551222, "outflow_rate_max": 1254.1815169190645, "system_level_velocity_min": 11.789899715550536, "cost2_max": -43.286424359608255, "cost1_min": 122.06335107984827, "system_level_velocity_mean": 16.720874065432216, "outflow_rate_mean": 1137.9145404325432, "cost2_mean": -57.83058298468546}, "training_iteration": 109, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 0.995068371295929, "cur_kl_coeff": 0.33750006556510925, "kl": 0.016102317720651627, "vf_explained_var": 0.9034025073051453, "vf_loss": 9.47460651397705, "total_loss": 9.46703052520752, "policy_loss": -0.01300918497145176}, "sample_time_ms": 15053.486, "num_steps_sampled": 3493874, "num_steps_trained": 3493874, "update_time_ms": 9.007, "load_time_ms": 4.356, "grad_time_ms": 7906.574}, "episode_reward_min": -418.0690685630931}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6128>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 47, "timesteps_since_restore": 3524829, "timesteps_total": 3524829, "timesteps_this_iter": 30955, "time_since_restore": 2665.5637538433075, "node_ip": "10.138.0.2", "episode_len_mean": 319.66, "hostname": "flow-main", "episode_reward_mean": -290.8545183237476, "iterations_since_restore": 110, "episode_reward_max": -22.665273673917152, "policy_reward_mean": {}, "timestamp": 1558585680, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.351338148117065, "episodes_total": 5116, "time_total_s": 2665.5637538433075, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-28-00", "custom_metrics": {"cost2_min": -69.36392921433904, "cost1_mean": 193.03913762871923, "system_level_velocity_max": 18.84641455074142, "outflow_rate_min": 437.2949997643919, "cost1_max": 215.43284666551222, "outflow_rate_max": 1260.844427390791, "system_level_velocity_min": 11.789899715550536, "cost2_max": -21.228889141591104, "cost1_min": 17.779223999217006, "system_level_velocity_mean": 16.887279791672178, "outflow_rate_mean": 1138.3117279557287, "cost2_mean": -58.54919944823626}, "training_iteration": 110, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 0.9755678176879883, "cur_kl_coeff": 0.33750006556510925, "kl": 0.01597532629966736, "vf_explained_var": 0.8949536085128784, "vf_loss": 9.152819633483887, "total_loss": 9.146488189697266, "policy_loss": -0.011723392643034458}, "sample_time_ms": 15149.804, "num_steps_sampled": 3524829, "num_steps_trained": 3524829, "update_time_ms": 8.896, "load_time_ms": 4.49, "grad_time_ms": 7802.714}, "episode_reward_min": -418.0690685630931}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd55c0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 3555559, "timesteps_total": 3555559, "timesteps_this_iter": 30730, "time_since_restore": 2688.218649148941, "node_ip": "10.138.0.2", "episode_len_mean": 319.66, "hostname": "flow-main", "episode_reward_mean": -287.04470945436515, "iterations_since_restore": 111, "episode_reward_max": -22.665273673917152, "policy_reward_mean": {}, "timestamp": 1558585703, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.654895305633545, "episodes_total": 5161, "time_total_s": 2688.218649148941, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-28-23", "custom_metrics": {"cost2_min": -68.03188852621474, "cost1_mean": 194.47064006226253, "system_level_velocity_max": 18.88815213208876, "outflow_rate_min": 437.2949997643919, "cost1_max": 215.93292030072752, "outflow_rate_max": 1260.844427390791, "system_level_velocity_min": 13.942609674208944, "cost2_max": -21.228889141591104, "cost1_min": 17.779223999217006, "system_level_velocity_mean": 17.022976565097743, "outflow_rate_mean": 1146.462351801583, "cost2_mean": -58.617425469739345}, "training_iteration": 111, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 0.9621432423591614, "cur_kl_coeff": 0.33750006556510925, "kl": 0.016895277425646782, "vf_explained_var": 0.8935562968254089, "vf_loss": 8.69200325012207, "total_loss": 8.687334060668945, "policy_loss": -0.010371110402047634}, "sample_time_ms": 15166.591, "num_steps_sampled": 3555559, "num_steps_trained": 3555559, "update_time_ms": 9.122, "load_time_ms": 4.44, "grad_time_ms": 7793.663}, "episode_reward_min": -406.73721553731156}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd358>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 47, "timesteps_since_restore": 3586513, "timesteps_total": 3586513, "timesteps_this_iter": 30954, "time_since_restore": 2712.2058527469635, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "episode_reward_mean": -291.1005249405191, "iterations_since_restore": 112, "episode_reward_max": -148.037885175469, "policy_reward_mean": {}, "timestamp": 1558585727, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.98720359802246, "episodes_total": 5208, "time_total_s": 2712.2058527469635, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-28-47", "custom_metrics": {"cost2_min": -68.03188852621474, "cost1_mean": 196.98805318781626, "system_level_velocity_max": 18.899848173325633, "outflow_rate_min": 989.787750816829, "cost1_max": 215.93292030072752, "outflow_rate_max": 1260.1711349613836, "system_level_velocity_min": 14.187624525428344, "cost2_max": -45.76052662049962, "cost1_min": 136.63870500288556, "system_level_velocity_mean": 17.019134588659036, "outflow_rate_mean": 1159.5403697994584, "cost2_mean": -58.96023608108531}, "training_iteration": 112, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 0.9567735195159912, "cur_kl_coeff": 0.33750006556510925, "kl": 0.015863578766584396, "vf_explained_var": 0.884208083152771, "vf_loss": 10.001298904418945, "total_loss": 9.995672225952148, "policy_loss": -0.010979452170431614}, "sample_time_ms": 15166.48, "num_steps_sampled": 3586513, "num_steps_trained": 3586513, "update_time_ms": 8.867, "load_time_ms": 4.631, "grad_time_ms": 7832.221}, "episode_reward_min": -409.17975937982425}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc61d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc66a0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 48, "timesteps_since_restore": 3617612, "timesteps_total": 3617612, "timesteps_this_iter": 31099, "time_since_restore": 2737.1901350021362, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "episode_reward_mean": -291.7640575698492, "iterations_since_restore": 113, "episode_reward_max": -148.037885175469, "policy_reward_mean": {}, "timestamp": 1558585752, "num_metric_batches_dropped": 0, "time_this_iter_s": 24.98428225517273, "episodes_total": 5256, "time_total_s": 2737.1901350021362, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-29-12", "custom_metrics": {"cost2_min": -66.7751482468969, "cost1_mean": 196.74821090546754, "system_level_velocity_max": 18.899848173325633, "outflow_rate_min": 989.787750816829, "cost1_max": 215.46837928058926, "outflow_rate_max": 1260.1711349613836, "system_level_velocity_min": 14.187624525428344, "cost2_max": -45.903955184431254, "cost1_min": 136.63870500288556, "system_level_velocity_mean": 16.996950161768986, "outflow_rate_mean": 1157.6757302822853, "cost2_mean": -59.08613887273931}, "training_iteration": 113, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 0.9787417054176331, "cur_kl_coeff": 0.33750006556510925, "kl": 0.016339603811502457, "vf_explained_var": 0.8965911865234375, "vf_loss": 9.427042007446289, "total_loss": 9.421667098999023, "policy_loss": -0.010888982564210892}, "sample_time_ms": 15149.184, "num_steps_sampled": 3617612, "num_steps_trained": 3617612, "update_time_ms": 8.821, "load_time_ms": 4.586, "grad_time_ms": 8054.517}, "episode_reward_min": -409.17975937982425}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd208>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 42, "timesteps_since_restore": 3648507, "timesteps_total": 3648507, "timesteps_this_iter": 30895, "time_since_restore": 2759.787255525589, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "episode_reward_mean": -293.4641937082136, "iterations_since_restore": 114, "episode_reward_max": -147.70318875286122, "policy_reward_mean": {}, "timestamp": 1558585774, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.59712052345276, "episodes_total": 5298, "time_total_s": 2759.787255525589, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-29-34", "custom_metrics": {"cost2_min": -70.4077265670129, "cost1_mean": 195.96389100974665, "system_level_velocity_max": 18.84015481067366, "outflow_rate_min": 948.6465417355993, "cost1_max": 215.46837928058926, "outflow_rate_max": 1259.1675189745322, "system_level_velocity_min": 14.333937017541981, "cost2_max": -44.792926625437026, "cost1_min": 137.25805458508012, "system_level_velocity_mean": 16.92302536033818, "outflow_rate_mean": 1154.819010959319, "cost2_mean": -59.763086135030875}, "training_iteration": 114, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 0.9677456021308899, "cur_kl_coeff": 0.33750006556510925, "kl": 0.016335880383849144, "vf_explained_var": 0.8943197727203369, "vf_loss": 9.084298133850098, "total_loss": 9.079245567321777, "policy_loss": -0.010566343553364277}, "sample_time_ms": 15147.066, "num_steps_sampled": 3648507, "num_steps_trained": 3648507, "update_time_ms": 9.286, "load_time_ms": 4.522, "grad_time_ms": 8094.95}, "episode_reward_min": -404.7864249277338}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd15f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1240>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 51, "timesteps_since_restore": 3679070, "timesteps_total": 3679070, "timesteps_this_iter": 30563, "time_since_restore": 2785.188941001892, "node_ip": "10.138.0.2", "episode_len_mean": 317.66, "hostname": "flow-main", "episode_reward_mean": -285.0484285827061, "iterations_since_restore": 115, "episode_reward_max": -21.475934144574783, "policy_reward_mean": {}, "timestamp": 1558585800, "num_metric_batches_dropped": 0, "time_this_iter_s": 25.4016854763031, "episodes_total": 5349, "time_total_s": 2785.188941001892, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-30-00", "custom_metrics": {"cost2_min": -70.4077265670129, "cost1_mean": 193.03338566393506, "system_level_velocity_max": 18.84015481067366, "outflow_rate_min": 440.0050268646629, "cost1_max": 215.29464339586218, "outflow_rate_max": 1259.1675189745322, "system_level_velocity_min": 14.333937017541981, "cost2_max": -18.924421179921268, "cost1_min": 17.86479796018302, "system_level_velocity_mean": 17.018402296587734, "outflow_rate_mean": 1143.2139611504554, "cost2_mean": -58.72963771267707}, "training_iteration": 115, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 0.9499784708023071, "cur_kl_coeff": 0.33750012516975403, "kl": 0.01661732792854309, "vf_explained_var": 0.8941001296043396, "vf_loss": 8.659929275512695, "total_loss": 8.655134201049805, "policy_loss": -0.010402658022940159}, "sample_time_ms": 15333.745, "num_steps_sampled": 3679070, "num_steps_trained": 3679070, "update_time_ms": 9.196, "load_time_ms": 4.562, "grad_time_ms": 8081.997}, "episode_reward_min": -404.7864249277338}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5ac8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 47, "timesteps_since_restore": 3709891, "timesteps_total": 3709891, "timesteps_this_iter": 30821, "time_since_restore": 2808.6108133792877, "node_ip": "10.138.0.2", "episode_len_mean": 318.84, "hostname": "flow-main", "episode_reward_mean": -284.07640513489184, "iterations_since_restore": 116, "episode_reward_max": -21.475934144574783, "policy_reward_mean": {}, "timestamp": 1558585823, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.42187237739563, "episodes_total": 5396, "time_total_s": 2808.6108133792877, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-30-23", "custom_metrics": {"cost2_min": -67.23117562632534, "cost1_mean": 194.33262167569387, "system_level_velocity_max": 18.836711528240844, "outflow_rate_min": 440.0050268646629, "cost1_max": 214.97108499960322, "outflow_rate_max": 1255.0004267605257, "system_level_velocity_min": 14.23925795963355, "cost2_max": -18.924421179921268, "cost1_min": 17.86479796018302, "system_level_velocity_mean": 17.056361185670923, "outflow_rate_mean": 1143.890217730147, "cost2_mean": -58.061428950660854}, "training_iteration": 116, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 0.977185845375061, "cur_kl_coeff": 0.33750006556510925, "kl": 0.01705646514892578, "vf_explained_var": 0.8931351900100708, "vf_loss": 8.967324256896973, "total_loss": 8.96172046661377, "policy_loss": -0.011359384283423424}, "sample_time_ms": 15412.168, "num_steps_sampled": 3709891, "num_steps_trained": 3709891, "update_time_ms": 9.129, "load_time_ms": 4.704, "grad_time_ms": 8112.95}, "episode_reward_min": -369.6690833262182}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5390>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 45, "timesteps_since_restore": 3740455, "timesteps_total": 3740455, "timesteps_this_iter": 30564, "time_since_restore": 2831.491479873657, "node_ip": "10.138.0.2", "episode_len_mean": 317.86, "hostname": "flow-main", "episode_reward_mean": -278.95697546434064, "iterations_since_restore": 117, "episode_reward_max": -21.475934144574783, "policy_reward_mean": {}, "timestamp": 1558585846, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.880666494369507, "episodes_total": 5441, "time_total_s": 2831.491479873657, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-30-46", "custom_metrics": {"cost2_min": -67.23117562632534, "cost1_mean": 194.67514968981703, "system_level_velocity_max": 18.804694345190327, "outflow_rate_min": 440.0050268646629, "cost1_max": 215.14346499852394, "outflow_rate_max": 1255.0531555082846, "system_level_velocity_min": 14.23925795963355, "cost2_max": -18.924421179921268, "cost1_min": 17.86479796018302, "system_level_velocity_mean": 17.165400633909606, "outflow_rate_mean": 1144.9578386931341, "cost2_mean": -57.28184693930668}, "training_iteration": 117, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0039318799972534, "cur_kl_coeff": 0.33750012516975403, "kl": 0.015552489086985588, "vf_explained_var": 0.8965818881988525, "vf_loss": 8.626139640808105, "total_loss": 8.619668006896973, "policy_loss": -0.011720053851604462}, "sample_time_ms": 15427.582, "num_steps_sampled": 3740455, "num_steps_trained": 3740455, "update_time_ms": 8.957, "load_time_ms": 4.612, "grad_time_ms": 8108.394}, "episode_reward_min": -373.9738702648567}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd18d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1a20>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 46, "timesteps_since_restore": 3771352, "timesteps_total": 3771352, "timesteps_this_iter": 30897, "time_since_restore": 2854.2672424316406, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "episode_reward_mean": -284.26152783623286, "iterations_since_restore": 118, "episode_reward_max": -149.95136706155532, "policy_reward_mean": {}, "timestamp": 1558585869, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.7757625579834, "episodes_total": 5487, "time_total_s": 2854.2672424316406, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-31-09", "custom_metrics": {"cost2_min": -65.9274444676503, "cost1_mean": 198.72876566706998, "system_level_velocity_max": 18.819050192674002, "outflow_rate_min": 993.8281428309833, "cost1_max": 215.14346499852394, "outflow_rate_max": 1255.0531555082846, "system_level_velocity_min": 14.34066783781157, "cost2_max": -40.26009834022625, "cost1_min": 137.35073227450448, "system_level_velocity_mean": 17.1970260670897, "outflow_rate_mean": 1164.7411342465246, "cost2_mean": -58.9856086622266}, "training_iteration": 118, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 0.9644013047218323, "cur_kl_coeff": 0.33750006556510925, "kl": 0.016484081745147705, "vf_explained_var": 0.8930975794792175, "vf_loss": 8.916145324707031, "total_loss": 8.911561965942383, "policy_loss": -0.01014588214457035}, "sample_time_ms": 15458.451, "num_steps_sampled": 3771352, "num_steps_trained": 3771352, "update_time_ms": 9.029, "load_time_ms": 4.559, "grad_time_ms": 8051.93}, "episode_reward_min": -373.9738702648567}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1860>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 48, "timesteps_since_restore": 3802060, "timesteps_total": 3802060, "timesteps_this_iter": 30708, "time_since_restore": 2880.367908000946, "node_ip": "10.138.0.2", "episode_len_mean": 321.83, "hostname": "flow-main", "episode_reward_mean": -291.25735435395796, "iterations_since_restore": 119, "episode_reward_max": -22.06005425117712, "policy_reward_mean": {}, "timestamp": 1558585895, "num_metric_batches_dropped": 0, "time_this_iter_s": 26.10066556930542, "episodes_total": 5535, "time_total_s": 2880.367908000946, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-31-35", "custom_metrics": {"cost2_min": -66.39563696001291, "cost1_mean": 194.07197074197416, "system_level_velocity_max": 19.33533509336922, "outflow_rate_min": 497.50056700217027, "cost1_max": 214.80430230353033, "outflow_rate_max": 1262.5479255459913, "system_level_velocity_min": 14.158845222956975, "cost2_max": -18.786711725671097, "cost1_min": 18.57124515097765, "system_level_velocity_mean": 16.886121580985513, "outflow_rate_mean": 1142.3822712891058, "cost2_mean": -58.673529573976566}, "training_iteration": 119, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0422329902648926, "cur_kl_coeff": 0.33750009536743164, "kl": 0.016957905143499374, "vf_explained_var": 0.8914950489997864, "vf_loss": 10.240425109863281, "total_loss": 10.234254837036133, "policy_loss": -0.01189373154193163}, "sample_time_ms": 15597.388, "num_steps_sampled": 3802060, "num_steps_trained": 3802060, "update_time_ms": 8.98, "load_time_ms": 4.64, "grad_time_ms": 8133.953}, "episode_reward_min": -382.67278651615715}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1668>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 47, "timesteps_since_restore": 3832727, "timesteps_total": 3832727, "timesteps_this_iter": 30667, "time_since_restore": 2903.3565940856934, "node_ip": "10.138.0.2", "episode_len_mean": 320.73, "hostname": "flow-main", "episode_reward_mean": -288.1919918120833, "iterations_since_restore": 120, "episode_reward_max": -22.06005425117712, "policy_reward_mean": {}, "timestamp": 1558585918, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.988686084747314, "episodes_total": 5582, "time_total_s": 2903.3565940856934, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-31-58", "custom_metrics": {"cost2_min": -66.8992416508195, "cost1_mean": 193.54100241816758, "system_level_velocity_max": 19.33533509336922, "outflow_rate_min": 497.50056700217027, "cost1_max": 214.66232915527678, "outflow_rate_max": 1262.5479255459913, "system_level_velocity_min": 12.20744017884804, "cost2_max": -18.786711725671097, "cost1_min": 18.57124515097765, "system_level_velocity_mean": 16.9281185544921, "outflow_rate_mean": 1141.6467787491827, "cost2_mean": -58.16127388109402}, "training_iteration": 120, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.0008591413497925, "cur_kl_coeff": 0.33750009536743164, "kl": 0.0196320079267025, "vf_explained_var": 0.8984944224357605, "vf_loss": 8.945884704589844, "total_loss": 8.939423561096191, "policy_loss": -0.013086192309856415}, "sample_time_ms": 15531.139, "num_steps_sampled": 3832727, "num_steps_trained": 3832727, "update_time_ms": 8.584, "load_time_ms": 4.536, "grad_time_ms": 8164.722}, "episode_reward_min": -435.2724317171918}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd52b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5ac8>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 3863221, "timesteps_total": 3863221, "timesteps_this_iter": 30494, "time_since_restore": 2925.871495246887, "node_ip": "10.138.0.2", "episode_len_mean": 323.9, "hostname": "flow-main", "episode_reward_mean": -288.56484176002334, "iterations_since_restore": 121, "episode_reward_max": -157.44192295592984, "policy_reward_mean": {}, "timestamp": 1558585941, "num_metric_batches_dropped": 0, "time_this_iter_s": 22.514901161193848, "episodes_total": 5626, "time_total_s": 2925.871495246887, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-32-21", "custom_metrics": {"cost2_min": -66.8992416508195, "cost1_mean": 196.52059484929748, "system_level_velocity_max": 18.793587316699526, "outflow_rate_min": 733.2875879396986, "cost1_max": 214.774057206591, "outflow_rate_max": 1247.943127580512, "system_level_velocity_min": 12.20744017884804, "cost2_max": -38.1391366185028, "cost1_min": 141.74992238316332, "system_level_velocity_mean": 17.008299352595344, "outflow_rate_mean": 1153.5923901130616, "cost2_mean": -57.771144522191655}, "training_iteration": 121, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.002217411994934, "cur_kl_coeff": 0.33750012516975403, "kl": 0.01643355004489422, "vf_explained_var": 0.9040365815162659, "vf_loss": 8.246038436889648, "total_loss": 8.239998817443848, "policy_loss": -0.011586234904825687}, "sample_time_ms": 15529.521, "num_steps_sampled": 3863221, "num_steps_trained": 3863221, "update_time_ms": 8.259, "load_time_ms": 4.522, "grad_time_ms": 8151.965}, "episode_reward_min": -435.2724317171918}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc69b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6940>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 48, "timesteps_since_restore": 3893705, "timesteps_total": 3893705, "timesteps_this_iter": 30484, "time_since_restore": 2949.8087182044983, "node_ip": "10.138.0.2", "episode_len_mean": 319.97, "hostname": "flow-main", "episode_reward_mean": -285.0187997560491, "iterations_since_restore": 122, "episode_reward_max": -149.53853644955652, "policy_reward_mean": {}, "timestamp": 1558585965, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.937222957611084, "episodes_total": 5674, "time_total_s": 2949.8087182044983, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-32-45", "custom_metrics": {"cost2_min": -65.9110710872517, "cost1_mean": 193.49139048209005, "system_level_velocity_max": 18.810059799985897, "outflow_rate_min": 887.1398107986163, "cost1_max": 214.79140264219103, "outflow_rate_max": 1253.5257706809448, "system_level_velocity_min": 12.893584185058918, "cost2_max": -42.48107721842729, "cost1_min": 126.85929502659707, "system_level_velocity_mean": 16.941465473249302, "outflow_rate_mean": 1142.8476861444824, "cost2_mean": -56.77622554648013}, "training_iteration": 122, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.038209080696106, "cur_kl_coeff": 0.33750012516975403, "kl": 0.017616312950849533, "vf_explained_var": 0.9010297060012817, "vf_loss": 9.568161010742188, "total_loss": 9.560929298400879, "policy_loss": -0.013178755529224873}, "sample_time_ms": 15517.31, "num_steps_sampled": 3893705, "num_steps_trained": 3893705, "update_time_ms": 8.547, "load_time_ms": 4.409, "grad_time_ms": 8157.162}, "episode_reward_min": -428.4054386696583}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1cc0>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 48, "timesteps_since_restore": 3924662, "timesteps_total": 3924662, "timesteps_this_iter": 30957, "time_since_restore": 2975.1845910549164, "node_ip": "10.138.0.2", "episode_len_mean": 320.79, "hostname": "flow-main", "episode_reward_mean": -290.47588781801636, "iterations_since_restore": 123, "episode_reward_max": -149.53853644955652, "policy_reward_mean": {}, "timestamp": 1558585990, "num_metric_batches_dropped": 0, "time_this_iter_s": 25.37587285041809, "episodes_total": 5722, "time_total_s": 2975.1845910549164, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-33-10", "custom_metrics": {"cost2_min": -67.7161733976452, "cost1_mean": 192.7240598989086, "system_level_velocity_max": 18.82373669565871, "outflow_rate_min": 872.5418459510671, "cost1_max": 216.0319807184914, "outflow_rate_max": 1253.5257706809448, "system_level_velocity_min": 12.893584185058918, "cost2_max": -42.48107721842729, "cost1_min": 126.85929502659707, "system_level_velocity_mean": 16.815540793321553, "outflow_rate_mean": 1138.4006048709155, "cost2_mean": -57.80093099435977}, "training_iteration": 123, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 1.019264817237854, "cur_kl_coeff": 0.33750006556510925, "kl": 0.017844539135694504, "vf_explained_var": 0.924871563911438, "vf_loss": 7.393076419830322, "total_loss": 7.3852739334106445, "policy_loss": -0.013824637047946453}, "sample_time_ms": 15629.294, "num_steps_sampled": 3924662, "num_steps_trained": 3924662, "update_time_ms": 9.071, "load_time_ms": 4.306, "grad_time_ms": 8085.525}, "episode_reward_min": -434.0091334863227}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "framestack": true, "lstm_use_prev_action_reward": false, "custom_options": {}, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "conv_filters": null, "squash_to_range": false, "fcnet_activation": "tanh", "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "dim": 84, "free_log_std": false}, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "compress_observations": false, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd17f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd18d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6128>"}, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "episodes_this_iter": 44, "timesteps_since_restore": 3956110, "timesteps_total": 3956110, "timesteps_this_iter": 31448, "time_since_restore": 2998.457366704941, "node_ip": "10.138.0.2", "episode_len_mean": 323.54, "hostname": "flow-main", "episode_reward_mean": -297.38564315969967, "iterations_since_restore": 124, "episode_reward_max": -149.53853644955652, "policy_reward_mean": {}, "timestamp": 1558586013, "num_metric_batches_dropped": 0, "time_this_iter_s": 23.272775650024414, "episodes_total": 5766, "time_total_s": 2998.457366704941, "pid": 45032, "done": false, "experiment_id": "c445dfb1d719475b92d874f1a6bd6dd7", "date": "2019-05-23_04-33-33", "custom_metrics": {"cost2_min": -68.32967049588184, "cost1_mean": 194.41848964343896, "system_level_velocity_max": 18.861909082657103, "outflow_rate_min": 872.5418459510671, "cost1_max": 216.0319807184914, "outflow_rate_max": 1253.5257706809448, "system_level_velocity_min": 13.502862535758064, "cost2_max": -42.48107721842729, "cost1_min": 134.3805318088743, "system_level_velocity_mean": 16.799464287117956, "outflow_rate_mean": 1148.1272050777611, "cost2_mean": -59.62324706750165}, "training_iteration": 124, "info": {"default": {"cur_lr": 0.0005000000237487257, "entropy": 0.9868770241737366, "cur_kl_coeff": 0.33750009536743164, "kl": 0.016091803088784218, "vf_explained_var": 0.9212342500686646, "vf_loss": 7.334403038024902, "total_loss": 7.327626705169678, "policy_loss": -0.012207361869513988}, "sample_time_ms": 15660.516, "num_steps_sampled": 3956110, "num_steps_trained": 3956110, "update_time_ms": 8.764, "load_time_ms": 4.261, "grad_time_ms": 8122.135}, "episode_reward_min": -434.0091334863227}

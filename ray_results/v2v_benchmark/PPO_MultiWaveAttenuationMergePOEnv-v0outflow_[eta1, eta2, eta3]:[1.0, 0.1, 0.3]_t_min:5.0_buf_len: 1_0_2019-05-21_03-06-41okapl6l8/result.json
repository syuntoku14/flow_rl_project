{"time_this_iter_s": 28.41470241546631, "hostname": "flow-main", "info": {"default": {"kl": 0.007030783221125603, "entropy": 1.4087998867034912, "policy_loss": -0.0038508621510118246, "cur_lr": 0.0005000000237487257, "total_loss": 3.1406917572021484, "cur_kl_coeff": 0.20000003278255463, "vf_loss": 3.143136501312256, "vf_explained_var": 0.8312535285949707}, "grad_time_ms": 8479.38, "update_time_ms": 754.841, "load_time_ms": 62.813, "sample_time_ms": 18980.613, "num_steps_sampled": 40319, "num_steps_trained": 40319}, "episode_reward_min": 42.310865412381304, "episode_reward_mean": 313.2982085643063, "done": false, "time_total_s": 28.41470241546631, "custom_metrics": {"cost2_min": -33.73244582428916, "cost2_max": -12.873116297787075, "system_level_velocity_min": 8.757222544636308, "outflow_rate_max": 858.6918238993709, "cost1_max": 143.97299539361956, "cost1_min": 17.91374213832481, "cost2_mean": -24.985982271797816, "system_level_velocity_mean": 10.405788158170532, "outflow_rate_mean": 724.9515864019336, "system_level_velocity_max": 17.748344421483345, "cost1_mean": 120.25557498724068, "outflow_rate_min": 489.92492200470633}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408087, "timesteps_since_restore": 40319, "episodes_total": 41, "policy_reward_mean": {}, "episode_reward_max": 433.8788522308671, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40319, "iterations_since_restore": 1, "training_iteration": 1, "episode_len_mean": 317.7317073170732, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 28.41470241546631, "timesteps_total": 40319, "date": "2019-05-21_03-08-07", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1fe6780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1fe67f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1fe67b8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 41}
{"time_this_iter_s": 26.151381254196167, "hostname": "flow-main", "info": {"default": {"kl": 0.0037458930164575577, "entropy": 1.4067633152008057, "policy_loss": -0.001955024665221572, "cur_lr": 0.0005000000237487257, "total_loss": 3.7029147148132324, "cur_kl_coeff": 0.20000004768371582, "vf_loss": 3.70412015914917, "vf_explained_var": 0.8990381956100464}, "grad_time_ms": 8526.367, "update_time_ms": 380.512, "load_time_ms": 33.555, "sample_time_ms": 18243.062, "num_steps_sampled": 84206, "num_steps_trained": 84206}, "episode_reward_min": 42.310865412381304, "episode_reward_mean": 337.2335686750468, "done": false, "time_total_s": 54.566083669662476, "custom_metrics": {"cost2_min": -47.794965752247606, "cost2_max": -12.511759355283775, "system_level_velocity_min": 8.757222544636308, "outflow_rate_max": 971.186200060891, "cost1_max": 154.5559767512874, "cost1_min": 17.91374213832481, "cost2_mean": -27.489565933664725, "system_level_velocity_mean": 10.663709552908989, "outflow_rate_mean": 747.5906752615709, "system_level_velocity_max": 17.97573428779132, "cost1_mean": 123.76169793298465, "outflow_rate_min": 477.5379300875581}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408113, "timesteps_since_restore": 84206, "episodes_total": 82, "policy_reward_mean": {}, "episode_reward_max": 496.04059590303154, "num_metric_batches_dropped": 0, "timesteps_this_iter": 43887, "iterations_since_restore": 2, "training_iteration": 2, "episode_len_mean": 317.8292682926829, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 54.566083669662476, "timesteps_total": 84206, "date": "2019-05-21_03-08-33", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d899b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89978>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 41}
{"time_this_iter_s": 26.91975235939026, "hostname": "flow-main", "info": {"default": {"kl": 0.008947943337261677, "entropy": 1.3935682773590088, "policy_loss": -0.004751381929963827, "cur_lr": 0.0005000000237487257, "total_loss": 7.0845794677734375, "cur_kl_coeff": 0.10000002384185791, "vf_loss": 7.088436603546143, "vf_explained_var": 0.8900494575500488}, "grad_time_ms": 8514.813, "update_time_ms": 255.93, "load_time_ms": 24.786, "sample_time_ms": 18277.415, "num_steps_sampled": 131019, "num_steps_trained": 131019}, "episode_reward_min": 42.310865412381304, "episode_reward_mean": 370.157312903141, "done": false, "time_total_s": 81.48583602905273, "custom_metrics": {"cost2_min": -56.93939376009018, "cost2_max": -12.511759355283775, "system_level_velocity_min": 8.757222544636308, "outflow_rate_max": 1048.9421279842838, "cost1_max": 163.1054721261081, "cost1_min": 17.91374213832481, "cost2_mean": -30.101143124265658, "system_level_velocity_mean": 11.016298680458997, "outflow_rate_mean": 759.5993610314258, "system_level_velocity_max": 18.225700896590617, "cost1_mean": 127.55668412138692, "outflow_rate_min": 416.8658536585365}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408140, "timesteps_since_restore": 131019, "episodes_total": 123, "policy_reward_mean": {}, "episode_reward_max": 539.1241060403186, "num_metric_batches_dropped": 0, "timesteps_this_iter": 46813, "iterations_since_restore": 3, "training_iteration": 3, "episode_len_mean": 316.24, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 81.48583602905273, "timesteps_total": 131019, "date": "2019-05-21_03-09-00", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96f60>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 41}
{"time_this_iter_s": 31.149843215942383, "hostname": "flow-main", "info": {"default": {"kl": 0.005648844875395298, "entropy": 1.3766409158706665, "policy_loss": -0.0023406727705150843, "cur_lr": 0.0005000000237487257, "total_loss": 13.778555870056152, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 13.7803316116333, "vf_explained_var": 0.8835029006004333}, "grad_time_ms": 8907.329, "update_time_ms": 193.533, "load_time_ms": 20.685, "sample_time_ms": 18946.875, "num_steps_sampled": 177483, "num_steps_trained": 177483}, "episode_reward_min": 55.37674330963079, "episode_reward_mean": 460.8406856829089, "done": false, "time_total_s": 112.63567924499512, "custom_metrics": {"cost2_min": -59.882244237977936, "cost2_max": -15.762583043453049, "system_level_velocity_min": 9.36702448963069, "outflow_rate_max": 1189.0967665688129, "cost1_max": 181.3610564595229, "cost1_min": 24.009695499228435, "cost2_mean": -37.006277918402866, "system_level_velocity_mean": 12.022289184456733, "outflow_rate_mean": 856.3305945997765, "system_level_velocity_max": 18.225700896590617, "cost1_mean": 144.6867891942668, "outflow_rate_min": 416.8658536585365}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408171, "timesteps_since_restore": 177483, "episodes_total": 183, "policy_reward_mean": {}, "episode_reward_max": 618.0690957294261, "num_metric_batches_dropped": 0, "timesteps_this_iter": 46464, "iterations_since_restore": 4, "training_iteration": 4, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 112.63567924499512, "timesteps_total": 177483, "date": "2019-05-21_03-09-31", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89780>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 60}
{"time_this_iter_s": 27.65561604499817, "hostname": "flow-main", "info": {"default": {"kl": 0.010484122671186924, "entropy": 1.3671640157699585, "policy_loss": -0.005743345711380243, "cur_lr": 0.0005000000237487257, "total_loss": 11.961057662963867, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 11.965751647949219, "vf_explained_var": 0.8945592045783997}, "grad_time_ms": 8929.759, "update_time_ms": 156.36, "load_time_ms": 17.739, "sample_time_ms": 18867.167, "num_steps_sampled": 223319, "num_steps_trained": 223319}, "episode_reward_min": 350.5229767210591, "episode_reward_mean": 512.8586557875831, "done": false, "time_total_s": 140.2912952899933, "custom_metrics": {"cost2_min": -73.22587621097011, "cost2_max": -23.791984204112744, "system_level_velocity_min": 10.334529269297121, "outflow_rate_max": 1189.0967665688129, "cost1_max": 181.3610564595229, "cost1_min": 123.49102820081757, "cost2_mean": -42.05065261664323, "system_level_velocity_mean": 12.660442690579838, "outflow_rate_mean": 949.2551947055986, "system_level_velocity_max": 14.643185766409722, "cost1_mean": 155.13352038837107, "outflow_rate_min": 691.7277093928387}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408199, "timesteps_since_restore": 223319, "episodes_total": 223, "policy_reward_mean": {}, "episode_reward_max": 618.0690957294261, "num_metric_batches_dropped": 0, "timesteps_this_iter": 45836, "iterations_since_restore": 5, "training_iteration": 5, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 140.2912952899933, "timesteps_total": 223319, "date": "2019-05-21_03-09-59", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d963c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d966d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96278>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 27.54136061668396, "hostname": "flow-main", "info": {"default": {"kl": 0.010598561726510525, "entropy": 1.362226128578186, "policy_loss": -0.005287433508783579, "cur_lr": 0.0005000000237487257, "total_loss": 19.631956100463867, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 19.63618278503418, "vf_explained_var": 0.8613361120223999}, "grad_time_ms": 8878.764, "update_time_ms": 131.821, "load_time_ms": 15.941, "sample_time_ms": 18861.625, "num_steps_sampled": 269948, "num_steps_trained": 269948}, "episode_reward_min": 43.41548525415776, "episode_reward_mean": 527.0383039533237, "done": false, "time_total_s": 167.83265590667725, "custom_metrics": {"cost2_min": -73.22587621097011, "cost2_max": -12.814681953084714, "system_level_velocity_min": 10.086460568931813, "outflow_rate_max": 1189.0967665688129, "cost1_max": 182.73557603972029, "cost1_min": 17.739305276504997, "cost2_mean": -42.41181577881749, "system_level_velocity_mean": 12.973057585241358, "outflow_rate_mean": 990.76300782197, "system_level_velocity_max": 17.417307885820694, "cost1_mean": 157.3209796963598, "outflow_rate_min": 485.8629864444024}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408226, "timesteps_since_restore": 269948, "episodes_total": 264, "policy_reward_mean": {}, "episode_reward_max": 618.0690957294261, "num_metric_batches_dropped": 0, "timesteps_this_iter": 46629, "iterations_since_restore": 6, "training_iteration": 6, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 167.83265590667725, "timesteps_total": 269948, "date": "2019-05-21_03-10-26", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96e80>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 41}
{"time_this_iter_s": 27.635072231292725, "hostname": "flow-main", "info": {"default": {"kl": 0.009256145916879177, "entropy": 1.3470232486724854, "policy_loss": -0.004864895716309547, "cur_lr": 0.0005000000237487257, "total_loss": 34.77937316894531, "cur_kl_coeff": 0.10000002384185791, "vf_loss": 34.78330993652344, "vf_explained_var": 0.7685821056365967}, "grad_time_ms": 8843.866, "update_time_ms": 113.948, "load_time_ms": 14.49, "sample_time_ms": 18868.182, "num_steps_sampled": 313220, "num_steps_trained": 313220}, "episode_reward_min": 43.41548525415776, "episode_reward_mean": 539.6037158227232, "done": false, "time_total_s": 195.46772813796997, "custom_metrics": {"cost2_min": -59.60911548194069, "cost2_max": -12.814681953084714, "system_level_velocity_min": 10.086460568931813, "outflow_rate_max": 1192.242328678591, "cost1_max": 182.73557603972029, "cost1_min": 17.739305276504997, "cost2_mean": -39.033830908117125, "system_level_velocity_mean": 13.338005715091724, "outflow_rate_mean": 1039.0290726385367, "system_level_velocity_max": 18.203825944425773, "cost1_mean": 160.36710849825369, "outflow_rate_min": 485.8629864444024}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408254, "timesteps_since_restore": 313220, "episodes_total": 324, "policy_reward_mean": {}, "episode_reward_max": 605.2447958458695, "num_metric_batches_dropped": 0, "timesteps_this_iter": 43272, "iterations_since_restore": 7, "training_iteration": 7, "episode_len_mean": 319.15, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 195.46772813796997, "timesteps_total": 313220, "date": "2019-05-21_03-10-54", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d965f8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 60}
{"time_this_iter_s": 24.94059920310974, "hostname": "flow-main", "info": {"default": {"kl": 0.009766632691025734, "entropy": 1.3282182216644287, "policy_loss": -0.005440665874630213, "cur_lr": 0.0005000000237487257, "total_loss": 30.44705581665039, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 30.451519012451172, "vf_explained_var": 0.7270447015762329}, "grad_time_ms": 8622.55, "update_time_ms": 100.562, "load_time_ms": 13.181, "sample_time_ms": 18734.336, "num_steps_sampled": 354971, "num_steps_trained": 354971}, "episode_reward_min": 55.75023298245831, "episode_reward_mean": 546.1806017894764, "done": false, "time_total_s": 220.4083273410797, "custom_metrics": {"cost2_min": -52.80267747041265, "cost2_max": -12.481228868389689, "system_level_velocity_min": 10.914250411644314, "outflow_rate_max": 1192.242328678591, "cost1_max": 182.08037687977014, "cost1_min": 22.292775711010155, "cost2_mean": -35.72176425485386, "system_level_velocity_mean": 13.570074293131944, "outflow_rate_mean": 1064.3232935219087, "system_level_velocity_max": 18.203825944425773, "cost1_mean": 163.89195844769748, "outflow_rate_min": 487.51929263963194}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408279, "timesteps_since_restore": 354971, "episodes_total": 366, "policy_reward_mean": {}, "episode_reward_max": 605.2447958458695, "num_metric_batches_dropped": 0, "timesteps_this_iter": 41751, "iterations_since_restore": 8, "training_iteration": 8, "episode_len_mean": 319.23, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 220.4083273410797, "timesteps_total": 354971, "date": "2019-05-21_03-11-19", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d894e0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 42}
{"time_this_iter_s": 24.281089305877686, "hostname": "flow-main", "info": {"default": {"kl": 0.008464626036584377, "entropy": 1.3413974046707153, "policy_loss": -0.004299192689359188, "cur_lr": 0.0005000000237487257, "total_loss": 32.799102783203125, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 32.802555084228516, "vf_explained_var": 0.7206565141677856}, "grad_time_ms": 8519.835, "update_time_ms": 90.008, "load_time_ms": 12.331, "sample_time_ms": 18486.982, "num_steps_sampled": 395904, "num_steps_trained": 395904}, "episode_reward_min": 55.75023298245831, "episode_reward_mean": 542.6172209896998, "done": false, "time_total_s": 244.6894166469574, "custom_metrics": {"cost2_min": -52.110796656576824, "cost2_max": -12.481228868389689, "system_level_velocity_min": 11.218064539807097, "outflow_rate_max": 1170.1516701680669, "cost1_max": 182.35759432226715, "cost1_min": 22.292775711010155, "cost2_mean": -33.00413164315307, "system_level_velocity_mean": 13.660405448057416, "outflow_rate_mean": 1064.3765738971442, "system_level_velocity_max": 18.203825944425773, "cost1_mean": 165.11103950995496, "outflow_rate_min": 487.51929263963194}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408303, "timesteps_since_restore": 395904, "episodes_total": 406, "policy_reward_mean": {}, "episode_reward_max": 598.5059087883382, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40933, "iterations_since_restore": 9, "training_iteration": 9, "episode_len_mean": 319.23, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 244.6894166469574, "timesteps_total": 395904, "date": "2019-05-21_03-11-43", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99940>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 27.038546085357666, "hostname": "flow-main", "info": {"default": {"kl": 0.0086003253236413, "entropy": 1.3340706825256348, "policy_loss": -0.004478105343878269, "cur_lr": 0.0005000000237487257, "total_loss": 46.58786392211914, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 46.59148025512695, "vf_explained_var": 0.6366464495658875}, "grad_time_ms": 8560.514, "update_time_ms": 81.723, "load_time_ms": 11.652, "sample_time_ms": 18440.718, "num_steps_sampled": 437347, "num_steps_trained": 437347}, "episode_reward_min": 462.1976116752838, "episode_reward_mean": 550.2221053125571, "done": false, "time_total_s": 271.72796273231506, "custom_metrics": {"cost2_min": -44.36974445677225, "cost2_max": -15.764714191612903, "system_level_velocity_min": 11.218064539807097, "outflow_rate_max": 1170.6841084733733, "cost1_max": 183.14802582444503, "cost1_min": 139.5644484196834, "cost2_mean": -30.347127642540087, "system_level_velocity_mean": 13.695119364783155, "outflow_rate_mean": 1082.013189058728, "system_level_velocity_max": 14.77736428817609, "cost1_mean": 169.56569809005535, "outflow_rate_min": 864.0102818981964}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408330, "timesteps_since_restore": 437347, "episodes_total": 461, "policy_reward_mean": {}, "episode_reward_max": 603.0258008322298, "num_metric_batches_dropped": 0, "timesteps_this_iter": 41443, "iterations_since_restore": 10, "training_iteration": 10, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 271.72796273231506, "timesteps_total": 437347, "date": "2019-05-21_03-12-10", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d897f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89a58>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 55}
{"time_this_iter_s": 25.882584810256958, "hostname": "flow-main", "info": {"default": {"kl": 0.009804469533264637, "entropy": 1.3262336254119873, "policy_loss": -0.003928282298147678, "cur_lr": 0.0005000000237487257, "total_loss": 38.868106842041016, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 38.87105178833008, "vf_explained_var": 0.6598307490348816}, "grad_time_ms": 8632.187, "update_time_ms": 6.921, "load_time_ms": 5.864, "sample_time_ms": 18203.957, "num_steps_sampled": 477703, "num_steps_trained": 477703}, "episode_reward_min": 462.1976116752838, "episode_reward_mean": 559.9850302450486, "done": false, "time_total_s": 297.610547542572, "custom_metrics": {"cost2_min": -45.37693128225089, "cost2_max": -15.764714191612903, "system_level_velocity_min": 11.880831020365372, "outflow_rate_max": 1174.886023859861, "cost1_max": 186.36087976510203, "cost1_min": 144.94338485885316, "cost2_mean": -30.173735700979044, "system_level_velocity_mean": 13.925154156841105, "outflow_rate_mean": 1098.370057601435, "system_level_velocity_max": 14.99317718681135, "cost1_mean": 172.63038599497418, "outflow_rate_min": 939.6025900722806}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408356, "timesteps_since_restore": 477703, "episodes_total": 506, "policy_reward_mean": {}, "episode_reward_max": 603.9819113003676, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40356, "iterations_since_restore": 11, "training_iteration": 11, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 297.610547542572, "timesteps_total": 477703, "date": "2019-05-21_03-12-36", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d969e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96c50>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 45}
{"time_this_iter_s": 24.520862340927124, "hostname": "flow-main", "info": {"default": {"kl": 0.009677673690021038, "entropy": 1.328328013420105, "policy_loss": -0.005673989653587341, "cur_lr": 0.0005000000237487257, "total_loss": 36.52397918701172, "cur_kl_coeff": 0.10000002384185791, "vf_loss": 36.5286865234375, "vf_explained_var": 0.6963532567024231}, "grad_time_ms": 8705.559, "update_time_ms": 6.911, "load_time_ms": 5.965, "sample_time_ms": 17966.202, "num_steps_sampled": 518527, "num_steps_trained": 518527}, "episode_reward_min": 511.3751814382668, "episode_reward_mean": 561.6233035826272, "done": false, "time_total_s": 322.13140988349915, "custom_metrics": {"cost2_min": -52.45543614532894, "cost2_max": -18.899961236250167, "system_level_velocity_min": 11.89650846893029, "outflow_rate_max": 1207.5731406454206, "cost1_max": 188.647620407645, "cost1_min": 146.50268942283824, "cost2_mean": -32.061293829670085, "system_level_velocity_mean": 14.040414518036487, "outflow_rate_mean": 1107.670499789962, "system_level_velocity_max": 15.318482252719416, "cost1_mean": 173.87481253703365, "outflow_rate_min": 982.5311957160485}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408381, "timesteps_since_restore": 518527, "episodes_total": 546, "policy_reward_mean": {}, "episode_reward_max": 604.1800091376322, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40824, "iterations_since_restore": 12, "training_iteration": 12, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 322.13140988349915, "timesteps_total": 518527, "date": "2019-05-21_03-13-01", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d990f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99240>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 28.44972586631775, "hostname": "flow-main", "info": {"default": {"kl": 0.011943930760025978, "entropy": 1.3263269662857056, "policy_loss": -0.005862531717866659, "cur_lr": 0.0005000000237487257, "total_loss": 52.783729553222656, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 52.78839111328125, "vf_explained_var": 0.6477307081222534}, "grad_time_ms": 8964.636, "update_time_ms": 7.02, "load_time_ms": 5.71, "sample_time_ms": 17858.645, "num_steps_sampled": 559542, "num_steps_trained": 559542}, "episode_reward_min": 505.2365147710323, "episode_reward_mean": 559.602381261936, "done": false, "time_total_s": 350.5811357498169, "custom_metrics": {"cost2_min": -52.45543614532894, "cost2_max": -18.899961236250167, "system_level_velocity_min": 11.158827668644829, "outflow_rate_max": 1207.5731406454206, "cost1_max": 188.647620407645, "cost1_min": 136.68385154426457, "cost2_mean": -33.03179500079568, "system_level_velocity_mean": 14.070384591325837, "outflow_rate_mean": 1115.5915673597683, "system_level_velocity_max": 15.318482252719416, "cost1_mean": 174.03506810965195, "outflow_rate_min": 960.1145686770284}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408409, "timesteps_since_restore": 559542, "episodes_total": 601, "policy_reward_mean": {}, "episode_reward_max": 604.1800091376322, "num_metric_batches_dropped": 0, "timesteps_this_iter": 41015, "iterations_since_restore": 13, "training_iteration": 13, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 350.5811357498169, "timesteps_total": 559542, "date": "2019-05-21_03-13-29", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d964e0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 55}
{"time_this_iter_s": 26.951196670532227, "hostname": "flow-main", "info": {"default": {"kl": 0.011994896456599236, "entropy": 1.3329801559448242, "policy_loss": -0.00564579525962472, "cur_lr": 0.0005000000237487257, "total_loss": 43.9467887878418, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 43.951236724853516, "vf_explained_var": 0.6451300978660583}, "grad_time_ms": 8991.452, "update_time_ms": 7.173, "load_time_ms": 5.225, "sample_time_ms": 17413.664, "num_steps_sampled": 599083, "num_steps_trained": 599083}, "episode_reward_min": 504.1314010898852, "episode_reward_mean": 556.8499904932422, "done": false, "time_total_s": 377.5323324203491, "custom_metrics": {"cost2_min": -52.12723911933763, "cost2_max": -18.49543310632238, "system_level_velocity_min": 11.158827668644829, "outflow_rate_max": 1175.7309956709953, "cost1_max": 187.28084494413147, "cost1_min": 136.68385154426457, "cost2_mean": -31.026081806440384, "system_level_velocity_mean": 13.9794398077607, "outflow_rate_mean": 1109.4605839324809, "system_level_velocity_max": 15.172270559406021, "cost1_mean": 173.0218124082493, "outflow_rate_min": 960.1145686770284}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408436, "timesteps_since_restore": 599083, "episodes_total": 646, "policy_reward_mean": {}, "episode_reward_max": 590.810714497857, "num_metric_batches_dropped": 0, "timesteps_this_iter": 39541, "iterations_since_restore": 14, "training_iteration": 14, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 377.5323324203491, "timesteps_total": 599083, "date": "2019-05-21_03-13-56", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99588>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 45}
{"time_this_iter_s": 24.514829874038696, "hostname": "flow-main", "info": {"default": {"kl": 0.013228862546384335, "entropy": 1.3440791368484497, "policy_loss": -0.005745293106883764, "cur_lr": 0.0005000000237487257, "total_loss": 44.649288177490234, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 44.65371322631836, "vf_explained_var": 0.590847373008728}, "grad_time_ms": 9035.167, "update_time_ms": 7.189, "load_time_ms": 5.052, "sample_time_ms": 17056.443, "num_steps_sampled": 638413, "num_steps_trained": 638413}, "episode_reward_min": 504.1314010898852, "episode_reward_mean": 550.0876039507605, "done": false, "time_total_s": 402.0471622943878, "custom_metrics": {"cost2_min": -52.12723911933763, "cost2_max": -17.089995514217645, "system_level_velocity_min": 11.158827668644829, "outflow_rate_max": 1170.2100895803862, "cost1_max": 183.33188129456548, "cost1_min": 136.68385154426457, "cost2_mean": -28.36411855369525, "system_level_velocity_mean": 13.868490282140172, "outflow_rate_mean": 1105.2300696484285, "system_level_velocity_max": 14.837691415535245, "cost1_mean": 171.6908476126876, "outflow_rate_min": 960.1145686770284}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408461, "timesteps_since_restore": 638413, "episodes_total": 686, "policy_reward_mean": {}, "episode_reward_max": 590.810714497857, "num_metric_batches_dropped": 0, "timesteps_this_iter": 39330, "iterations_since_restore": 15, "training_iteration": 15, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 402.0471622943878, "timesteps_total": 638413, "date": "2019-05-21_03-14-21", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99278>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.051762580871582, "hostname": "flow-main", "info": {"default": {"kl": 0.012376350350677967, "entropy": 1.340367317199707, "policy_loss": -0.0064794402569532394, "cur_lr": 0.0005000000237487257, "total_loss": 44.160579681396484, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 44.16582107543945, "vf_explained_var": 0.6240543723106384}, "grad_time_ms": 9226.426, "update_time_ms": 7.243, "load_time_ms": 4.724, "sample_time_ms": 16715.503, "num_steps_sampled": 678198, "num_steps_trained": 678198}, "episode_reward_min": 491.5899740171971, "episode_reward_mean": 544.9164709251861, "done": false, "time_total_s": 428.0989248752594, "custom_metrics": {"cost2_min": -46.28339522816346, "cost2_max": -17.089995514217645, "system_level_velocity_min": 11.432192166418135, "outflow_rate_max": 1189.6589297658868, "cost1_max": 183.33188129456548, "cost1_min": 140.95606996839007, "cost2_mean": -27.587581679010846, "system_level_velocity_mean": 13.77510166072039, "outflow_rate_mean": 1103.4250267735206, "system_level_velocity_max": 14.877789712588973, "cost1_mean": 170.42564081617732, "outflow_rate_min": 947.3092179353495}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408487, "timesteps_since_restore": 678198, "episodes_total": 726, "policy_reward_mean": {}, "episode_reward_max": 584.8154644742165, "num_metric_batches_dropped": 0, "timesteps_this_iter": 39785, "iterations_since_restore": 16, "training_iteration": 16, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 428.0989248752594, "timesteps_total": 678198, "date": "2019-05-21_03-14-47", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d964e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96390>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 27.580504894256592, "hostname": "flow-main", "info": {"default": {"kl": 0.012054234743118286, "entropy": 1.3392376899719238, "policy_loss": -0.007013005204498768, "cur_lr": 0.0005000000237487257, "total_loss": 62.39773941040039, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 62.403541564941406, "vf_explained_var": 0.6190457940101624}, "grad_time_ms": 9419.875, "update_time_ms": 7.461, "load_time_ms": 4.543, "sample_time_ms": 16517.086, "num_steps_sampled": 717628, "num_steps_trained": 717628}, "episode_reward_min": 491.5899740171971, "episode_reward_mean": 548.0886716611116, "done": false, "time_total_s": 455.679429769516, "custom_metrics": {"cost2_min": -43.048272158621344, "cost2_max": -18.877014415468402, "system_level_velocity_min": 11.432192166418135, "outflow_rate_max": 1190.6122536539365, "cost1_max": 186.27145315102644, "cost1_min": 141.77562007139107, "cost2_mean": -27.370346377392615, "system_level_velocity_mean": 13.879778144462511, "outflow_rate_mean": 1110.0043092951846, "system_level_velocity_max": 15.092714259625934, "cost1_mean": 171.728472559519, "outflow_rate_min": 947.3092179353495}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408514, "timesteps_since_restore": 717628, "episodes_total": 786, "policy_reward_mean": {}, "episode_reward_max": 584.8368544686389, "num_metric_batches_dropped": 0, "timesteps_this_iter": 39430, "iterations_since_restore": 17, "training_iteration": 17, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 455.679429769516, "timesteps_total": 717628, "date": "2019-05-21_03-15-14", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99710>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 60}
{"time_this_iter_s": 26.457802295684814, "hostname": "flow-main", "info": {"default": {"kl": 0.013288287445902824, "entropy": 1.333900809288025, "policy_loss": -0.007347062695771456, "cur_lr": 0.0005000000237487257, "total_loss": 36.57377624511719, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 36.57979202270508, "vf_explained_var": 0.7529581785202026}, "grad_time_ms": 9803.293, "update_time_ms": 7.439, "load_time_ms": 4.55, "sample_time_ms": 16284.19, "num_steps_sampled": 758566, "num_steps_trained": 758566}, "episode_reward_min": 495.67868924745915, "episode_reward_mean": 553.105129696158, "done": false, "time_total_s": 482.1372320652008, "custom_metrics": {"cost2_min": -43.72275410598444, "cost2_max": -18.877014415468402, "system_level_velocity_min": 11.62218092853273, "outflow_rate_max": 1190.6122536539365, "cost1_max": 186.32620037067818, "cost1_min": 143.47210065608408, "cost2_mean": -28.826506197040054, "system_level_velocity_mean": 13.875840112203274, "outflow_rate_mean": 1109.4643622749545, "system_level_velocity_max": 15.116506569212417, "cost1_mean": 171.88405422243923, "outflow_rate_min": 985.5007563025212}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408541, "timesteps_since_restore": 758566, "episodes_total": 826, "policy_reward_mean": {}, "episode_reward_max": 592.0411898200682, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40938, "iterations_since_restore": 18, "training_iteration": 18, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 482.1372320652008, "timesteps_total": 758566, "date": "2019-05-21_03-15-41", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99e10>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.80439257621765, "hostname": "flow-main", "info": {"default": {"kl": 0.015714334324002266, "entropy": 1.3366254568099976, "policy_loss": -0.008798939175903797, "cur_lr": 0.0005000000237487257, "total_loss": 39.82162857055664, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 39.82884979248047, "vf_explained_var": 0.754092276096344}, "grad_time_ms": 10120.873, "update_time_ms": 7.554, "load_time_ms": 4.475, "sample_time_ms": 16216.893, "num_steps_sampled": 799728, "num_steps_trained": 799728}, "episode_reward_min": 495.67868924745915, "episode_reward_mean": 557.5755993568692, "done": false, "time_total_s": 508.94162464141846, "custom_metrics": {"cost2_min": -47.184364773935556, "cost2_max": -18.00265588449042, "system_level_velocity_min": 10.971759918091148, "outflow_rate_max": 1178.6377918039182, "cost1_max": 188.00474616717122, "cost1_min": 136.18734865883414, "cost2_mean": -30.854025392783882, "system_level_velocity_mean": 13.872266134410083, "outflow_rate_mean": 1108.8119565662478, "system_level_velocity_max": 15.19810511556656, "cost1_mean": 171.79658156015353, "outflow_rate_min": 979.0596818970502}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408568, "timesteps_since_restore": 799728, "episodes_total": 866, "policy_reward_mean": {}, "episode_reward_max": 599.7730438136708, "num_metric_batches_dropped": 0, "timesteps_this_iter": 41162, "iterations_since_restore": 19, "training_iteration": 19, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 508.94162464141846, "timesteps_total": 799728, "date": "2019-05-21_03-16-08", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d962e8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 27.488234281539917, "hostname": "flow-main", "info": {"default": {"kl": 0.012973465025424957, "entropy": 1.325410008430481, "policy_loss": -0.007591907400637865, "cur_lr": 0.0005000000237487257, "total_loss": 55.75155258178711, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 55.757850646972656, "vf_explained_var": 0.7220878005027771}, "grad_time_ms": 10308.846, "update_time_ms": 7.709, "load_time_ms": 4.346, "sample_time_ms": 16073.5, "num_steps_sampled": 839911, "num_steps_trained": 839911}, "episode_reward_min": 489.179566693543, "episode_reward_mean": 558.281717450314, "done": false, "time_total_s": 536.4298589229584, "custom_metrics": {"cost2_min": -47.184364773935556, "cost2_max": -17.605213367603405, "system_level_velocity_min": 10.971759918091148, "outflow_rate_max": 1177.0087887193708, "cost1_max": 188.02038914889232, "cost1_min": 136.18734865883414, "cost2_mean": -30.47460617075455, "system_level_velocity_mean": 13.975250239166275, "outflow_rate_mean": 1101.2413256199388, "system_level_velocity_max": 15.19810511556656, "cost1_mean": 172.95733350046248, "outflow_rate_min": 979.0596818970502}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408595, "timesteps_since_restore": 839911, "episodes_total": 925, "policy_reward_mean": {}, "episode_reward_max": 599.7730438136708, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40183, "iterations_since_restore": 20, "training_iteration": 20, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 536.4298589229584, "timesteps_total": 839911, "date": "2019-05-21_03-16-35", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99320>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 59}
{"time_this_iter_s": 24.840001583099365, "hostname": "flow-main", "info": {"default": {"kl": 0.015237047336995602, "entropy": 1.325211763381958, "policy_loss": -0.009064191952347755, "cur_lr": 0.0005000000237487257, "total_loss": 43.90733337402344, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 43.91487121582031, "vf_explained_var": 0.7278305888175964}, "grad_time_ms": 10331.827, "update_time_ms": 7.823, "load_time_ms": 4.271, "sample_time_ms": 15944.57, "num_steps_sampled": 879109, "num_steps_trained": 879109}, "episode_reward_min": 489.179566693543, "episode_reward_mean": 556.2943846474731, "done": false, "time_total_s": 561.2698605060577, "custom_metrics": {"cost2_min": -46.24775106344705, "cost2_max": -17.605213367603405, "system_level_velocity_min": 11.559180729663613, "outflow_rate_max": 1201.600248756219, "cost1_max": 190.80919926103314, "cost1_min": 143.0804574357404, "cost2_mean": -29.186949910858225, "system_level_velocity_mean": 14.149699090583319, "outflow_rate_mean": 1102.8110092642696, "system_level_velocity_max": 15.513468159770785, "cost1_mean": 174.9877898917401, "outflow_rate_min": 985.1193280841995}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408620, "timesteps_since_restore": 879109, "episodes_total": 966, "policy_reward_mean": {}, "episode_reward_max": 597.8220834347295, "num_metric_batches_dropped": 0, "timesteps_this_iter": 39198, "iterations_since_restore": 21, "training_iteration": 21, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 561.2698605060577, "timesteps_total": 879109, "date": "2019-05-21_03-17-00", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d998d0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 41}
{"time_this_iter_s": 25.845147609710693, "hostname": "flow-main", "info": {"default": {"kl": 0.014285340905189514, "entropy": 1.3270289897918701, "policy_loss": -0.00829034298658371, "cur_lr": 0.0005000000237487257, "total_loss": 45.038883209228516, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 45.045738220214844, "vf_explained_var": 0.7632164359092712}, "grad_time_ms": 10472.741, "update_time_ms": 7.904, "load_time_ms": 4.191, "sample_time_ms": 15935.78, "num_steps_sampled": 919183, "num_steps_trained": 919183}, "episode_reward_min": 489.179566693543, "episode_reward_mean": 558.6923286324679, "done": false, "time_total_s": 587.1150081157684, "custom_metrics": {"cost2_min": -46.24775106344705, "cost2_max": -17.605213367603405, "system_level_velocity_min": 11.057212395430223, "outflow_rate_max": 1201.600248756219, "cost1_max": 191.37861835138347, "cost1_min": 133.8059417481081, "cost2_mean": -29.45418368404297, "system_level_velocity_mean": 14.234827701724493, "outflow_rate_mean": 1107.113662258883, "system_level_velocity_max": 15.513468159770785, "cost1_mean": 175.98809260000905, "outflow_rate_min": 939.6662865652589}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408646, "timesteps_since_restore": 919183, "episodes_total": 1006, "policy_reward_mean": {}, "episode_reward_max": 599.4969699007485, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40074, "iterations_since_restore": 22, "training_iteration": 22, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 587.1150081157684, "timesteps_total": 919183, "date": "2019-05-21_03-17-26", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96128>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 27.831527948379517, "hostname": "flow-main", "info": {"default": {"kl": 0.014686512760818005, "entropy": 1.344437837600708, "policy_loss": -0.008084973320364952, "cur_lr": 0.0005000000237487257, "total_loss": 52.71136474609375, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 52.717987060546875, "vf_explained_var": 0.7752965092658997}, "grad_time_ms": 10431.342, "update_time_ms": 7.902, "load_time_ms": 4.105, "sample_time_ms": 15915.912, "num_steps_sampled": 959222, "num_steps_trained": 959222}, "episode_reward_min": 489.3530522343543, "episode_reward_mean": 564.5725124102752, "done": false, "time_total_s": 614.946536064148, "custom_metrics": {"cost2_min": -49.22866022549923, "cost2_max": -19.986757740168713, "system_level_velocity_min": 11.057212395430223, "outflow_rate_max": 1185.336471749322, "cost1_max": 194.10962648866357, "cost1_min": 133.8059417481081, "cost2_mean": -28.878543759414484, "system_level_velocity_mean": 14.403794532795953, "outflow_rate_mean": 1112.502271092516, "system_level_velocity_max": 15.710565240141698, "cost1_mean": 178.0279847936772, "outflow_rate_min": 939.6662865652589}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408674, "timesteps_since_restore": 959222, "episodes_total": 1061, "policy_reward_mean": {}, "episode_reward_max": 603.1866713820183, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40039, "iterations_since_restore": 23, "training_iteration": 23, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 614.946536064148, "timesteps_total": 959222, "date": "2019-05-21_03-17-54", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99898>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 55}
{"time_this_iter_s": 27.26376223564148, "hostname": "flow-main", "info": {"default": {"kl": 0.01666458696126938, "entropy": 1.3458623886108398, "policy_loss": -0.008307102136313915, "cur_lr": 0.0005000000237487257, "total_loss": 45.64529037475586, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 45.651939392089844, "vf_explained_var": 0.78432697057724}, "grad_time_ms": 10450.648, "update_time_ms": 8.01, "load_time_ms": 4.152, "sample_time_ms": 15927.792, "num_steps_sampled": 998654, "num_steps_trained": 998654}, "episode_reward_min": 60.84910132301949, "episode_reward_mean": 561.3290923396429, "done": false, "time_total_s": 642.2102982997894, "custom_metrics": {"cost2_min": -49.22866022549923, "cost2_max": -11.217945348684133, "system_level_velocity_min": 12.324389305578302, "outflow_rate_max": 1185.336471749322, "cost1_max": 194.10962648866357, "cost1_min": 23.8399499900841, "cost2_mean": -28.315157440776044, "system_level_velocity_mean": 14.567832058560555, "outflow_rate_mean": 1113.4941893676196, "system_level_velocity_max": 18.0991394061613, "cost1_mean": 177.87580667422583, "outflow_rate_min": 486.1420725724921}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408701, "timesteps_since_restore": 998654, "episodes_total": 1107, "policy_reward_mean": {}, "episode_reward_max": 603.1866713820183, "num_metric_batches_dropped": 0, "timesteps_this_iter": 39432, "iterations_since_restore": 24, "training_iteration": 24, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 642.2102982997894, "timesteps_total": 998654, "date": "2019-05-21_03-18-21", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d996d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d996a0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 46}
{"time_this_iter_s": 24.408634185791016, "hostname": "flow-main", "info": {"default": {"kl": 0.014749450609087944, "entropy": 1.3531144857406616, "policy_loss": -0.007926849648356438, "cur_lr": 0.0005000000237487257, "total_loss": 40.14707946777344, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 40.15353012084961, "vf_explained_var": 0.80378657579422}, "grad_time_ms": 10412.24, "update_time_ms": 8.251, "load_time_ms": 4.151, "sample_time_ms": 15954.423, "num_steps_sampled": 1038943, "num_steps_trained": 1038943}, "episode_reward_min": 60.84910132301949, "episode_reward_mean": 563.5880252810126, "done": false, "time_total_s": 666.6189324855804, "custom_metrics": {"cost2_min": -42.80927443040579, "cost2_max": -11.217945348684133, "system_level_velocity_min": 12.324389305578302, "outflow_rate_max": 1175.4191080493113, "cost1_max": 196.67426746751963, "cost1_min": 23.8399499900841, "cost2_mean": -29.16908849995278, "system_level_velocity_mean": 14.546704483283666, "outflow_rate_mean": 1117.3151341913408, "system_level_velocity_max": 18.0991394061613, "cost1_mean": 177.65636688221912, "outflow_rate_min": 486.1420725724921}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408726, "timesteps_since_restore": 1038943, "episodes_total": 1147, "policy_reward_mean": {}, "episode_reward_max": 604.6701764392741, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40289, "iterations_since_restore": 25, "training_iteration": 25, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 666.6189324855804, "timesteps_total": 1038943, "date": "2019-05-21_03-18-46", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89cc0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.841428756713867, "hostname": "flow-main", "info": {"default": {"kl": 0.017750926315784454, "entropy": 1.3434504270553589, "policy_loss": -0.008722023107111454, "cur_lr": 0.0005000000237487257, "total_loss": 53.440982818603516, "cur_kl_coeff": 0.10000002384185791, "vf_loss": 53.44792938232422, "vf_explained_var": 0.7913807034492493}, "grad_time_ms": 10312.122, "update_time_ms": 8.106, "load_time_ms": 4.209, "sample_time_ms": 16132.729, "num_steps_sampled": 1079772, "num_steps_trained": 1079772}, "episode_reward_min": 60.84910132301949, "episode_reward_mean": 562.5305251619257, "done": false, "time_total_s": 693.4603612422943, "custom_metrics": {"cost2_min": -43.53584868615903, "cost2_max": -11.217945348684133, "system_level_velocity_min": 11.432287673970052, "outflow_rate_max": 1184.5554737358866, "cost1_max": 196.90459392307787, "cost1_min": 23.8399499900841, "cost2_mean": -29.837553638556056, "system_level_velocity_mean": 14.506890398770977, "outflow_rate_mean": 1111.8655551928493, "system_level_velocity_max": 18.0991394061613, "cost1_mean": 177.11008682034745, "outflow_rate_min": 486.1420725724921}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408753, "timesteps_since_restore": 1079772, "episodes_total": 1201, "policy_reward_mean": {}, "episode_reward_max": 604.6701764392741, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40829, "iterations_since_restore": 26, "training_iteration": 26, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 693.4603612422943, "timesteps_total": 1079772, "date": "2019-05-21_03-19-13", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d967b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96f28>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 54}
{"time_this_iter_s": 29.09485173225403, "hostname": "flow-main", "info": {"default": {"kl": 0.02012149803340435, "entropy": 1.3316562175750732, "policy_loss": -0.011266300454735756, "cur_lr": 0.0005000000237487257, "total_loss": 50.803627014160156, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 50.81288528442383, "vf_explained_var": 0.7911678552627563}, "grad_time_ms": 10481.078, "update_time_ms": 8.111, "load_time_ms": 4.279, "sample_time_ms": 16114.592, "num_steps_sampled": 1119422, "num_steps_trained": 1119422}, "episode_reward_min": 500.43640253359877, "episode_reward_mean": 567.3441534477495, "done": false, "time_total_s": 722.5552129745483, "custom_metrics": {"cost2_min": -46.343655442111576, "cost2_max": -15.572816628891331, "system_level_velocity_min": 11.432287673970052, "outflow_rate_max": 1184.5554737358866, "cost1_max": 198.38343881849113, "cost1_min": 139.49689682143259, "cost2_mean": -30.517878893706182, "system_level_velocity_mean": 14.49973473354799, "outflow_rate_mean": 1117.0765316711233, "system_level_velocity_max": 16.054744337467085, "cost1_mean": 178.99138170455, "outflow_rate_min": 958.9276918851482}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408782, "timesteps_since_restore": 1119422, "episodes_total": 1247, "policy_reward_mean": {}, "episode_reward_max": 604.0094943888549, "num_metric_batches_dropped": 0, "timesteps_this_iter": 39650, "iterations_since_restore": 27, "training_iteration": 27, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 722.5552129745483, "timesteps_total": 1119422, "date": "2019-05-21_03-19-42", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9f98>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 46}
{"time_this_iter_s": 25.115304946899414, "hostname": "flow-main", "info": {"default": {"kl": 0.01555105671286583, "entropy": 1.3216112852096558, "policy_loss": -0.009375377558171749, "cur_lr": 0.0005000000237487257, "total_loss": 51.09317398071289, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 51.1002197265625, "vf_explained_var": 0.7562776207923889}, "grad_time_ms": 10406.977, "update_time_ms": 8.387, "load_time_ms": 4.246, "sample_time_ms": 16054.348, "num_steps_sampled": 1157993, "num_steps_trained": 1157993}, "episode_reward_min": 496.2510802019052, "episode_reward_mean": 564.5702074190806, "done": false, "time_total_s": 747.6705179214478, "custom_metrics": {"cost2_min": -46.343655442111576, "cost2_max": -15.572816628891331, "system_level_velocity_min": 11.432287673970052, "outflow_rate_max": 1184.5554737358866, "cost1_max": 199.74012270322396, "cost1_min": 139.49689682143259, "cost2_mean": -29.140345538617094, "system_level_velocity_mean": 14.665023070338567, "outflow_rate_mean": 1116.162759504799, "system_level_velocity_max": 16.181647018794642, "cost1_mean": 181.00856228224896, "outflow_rate_min": 958.9276918851482}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408807, "timesteps_since_restore": 1157993, "episodes_total": 1287, "policy_reward_mean": {}, "episode_reward_max": 604.0094943888549, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38571, "iterations_since_restore": 28, "training_iteration": 28, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 747.6705179214478, "timesteps_total": 1157993, "date": "2019-05-21_03-20-07", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9940>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 25.125532865524292, "hostname": "flow-main", "info": {"default": {"kl": 0.014847513288259506, "entropy": 1.311914086341858, "policy_loss": -0.009495302103459835, "cur_lr": 0.0005000000237487257, "total_loss": 55.72446060180664, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 55.73173522949219, "vf_explained_var": 0.7327967882156372}, "grad_time_ms": 10332.565, "update_time_ms": 8.558, "load_time_ms": 4.123, "sample_time_ms": 15961.476, "num_steps_sampled": 1196323, "num_steps_trained": 1196323}, "episode_reward_min": 475.80319985840737, "episode_reward_mean": 559.7686571654099, "done": false, "time_total_s": 772.796050786972, "custom_metrics": {"cost2_min": -46.343655442111576, "cost2_max": -15.97327840015131, "system_level_velocity_min": 11.79057215222272, "outflow_rate_max": 1194.4807772130575, "cost1_max": 199.76498352929596, "cost1_min": 143.0154631166821, "cost2_mean": -27.449634981392496, "system_level_velocity_mean": 14.893887842469942, "outflow_rate_mean": 1117.4294143157917, "system_level_velocity_max": 16.194907490553238, "cost1_mean": 183.73229080369475, "outflow_rate_min": 930.2515531789641}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408832, "timesteps_since_restore": 1196323, "episodes_total": 1327, "policy_reward_mean": {}, "episode_reward_max": 600.982371159909, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38330, "iterations_since_restore": 29, "training_iteration": 29, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 772.796050786972, "timesteps_total": 1196323, "date": "2019-05-21_03-20-32", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99d30>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 27.18537425994873, "hostname": "flow-main", "info": {"default": {"kl": 0.014041060581803322, "entropy": 1.3095943927764893, "policy_loss": -0.008795619010925293, "cur_lr": 0.0005000000237487257, "total_loss": 70.07107543945312, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 70.0777587890625, "vf_explained_var": 0.7396000623703003}, "grad_time_ms": 10283.949, "update_time_ms": 8.469, "load_time_ms": 4.105, "sample_time_ms": 15979.38, "num_steps_sampled": 1234861, "num_steps_trained": 1234861}, "episode_reward_min": 475.80319985840737, "episode_reward_mean": 556.5597038644786, "done": false, "time_total_s": 799.9814250469208, "custom_metrics": {"cost2_min": -48.553608018322564, "cost2_max": -15.97327840015131, "system_level_velocity_min": 11.876300584382973, "outflow_rate_max": 1222.1945930661425, "cost1_max": 201.85030922981827, "cost1_min": 143.0154631166821, "cost2_mean": -28.8763917429104, "system_level_velocity_mean": 14.844350120689349, "outflow_rate_mean": 1117.640959737726, "system_level_velocity_max": 16.371239992895514, "cost1_mean": 182.987497400823, "outflow_rate_min": 930.2515531789641}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408859, "timesteps_since_restore": 1234861, "episodes_total": 1387, "policy_reward_mean": {}, "episode_reward_max": 620.4306565505951, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38538, "iterations_since_restore": 30, "training_iteration": 30, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 799.9814250469208, "timesteps_total": 1234861, "date": "2019-05-21_03-20-59", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d991d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99da0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 60}
{"time_this_iter_s": 25.733864068984985, "hostname": "flow-main", "info": {"default": {"kl": 0.014919188804924488, "entropy": 1.3080744743347168, "policy_loss": -0.009537735022604465, "cur_lr": 0.0005000000237487257, "total_loss": 50.29883575439453, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 50.30613327026367, "vf_explained_var": 0.7803072929382324}, "grad_time_ms": 10374.184, "update_time_ms": 8.42, "load_time_ms": 3.93, "sample_time_ms": 15979.712, "num_steps_sampled": 1273412, "num_steps_trained": 1273412}, "episode_reward_min": 488.3755603114764, "episode_reward_mean": 556.6990752043092, "done": false, "time_total_s": 825.7152891159058, "custom_metrics": {"cost2_min": -53.39461242828312, "cost2_max": -16.017086135317815, "system_level_velocity_min": 12.325767944222724, "outflow_rate_max": 1222.1945930661425, "cost1_max": 202.84222613497735, "cost1_min": 150.156035441067, "cost2_mean": -29.992884066784278, "system_level_velocity_mean": 14.794889326325999, "outflow_rate_mean": 1115.7758922510766, "system_level_velocity_max": 16.4453770126023, "cost1_mean": 182.1911243863617, "outflow_rate_min": 980.3105720749841}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408885, "timesteps_since_restore": 1273412, "episodes_total": 1427, "policy_reward_mean": {}, "episode_reward_max": 620.4306565505951, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38551, "iterations_since_restore": 31, "training_iteration": 31, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 825.7152891159058, "timesteps_total": 1273412, "date": "2019-05-21_03-21-25", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da92b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da90b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da93c8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 25.49220585823059, "hostname": "flow-main", "info": {"default": {"kl": 0.01608240231871605, "entropy": 1.3104121685028076, "policy_loss": -0.009987185709178448, "cur_lr": 0.0005000000237487257, "total_loss": 62.55595779418945, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 62.563533782958984, "vf_explained_var": 0.7204111814498901}, "grad_time_ms": 10313.706, "update_time_ms": 8.468, "load_time_ms": 3.957, "sample_time_ms": 16002.846, "num_steps_sampled": 1312359, "num_steps_trained": 1312359}, "episode_reward_min": 488.3755603114764, "episode_reward_mean": 558.7575175951187, "done": false, "time_total_s": 851.2074949741364, "custom_metrics": {"cost2_min": -53.39461242828312, "cost2_max": -17.703958168453152, "system_level_velocity_min": 11.526839293069576, "outflow_rate_max": 1193.3686350037394, "cost1_max": 202.84222613497735, "cost1_min": 141.41988775820062, "cost2_mean": -30.078184974759694, "system_level_velocity_mean": 14.891652174876144, "outflow_rate_mean": 1117.8225481369795, "system_level_velocity_max": 16.4453770126023, "cost1_mean": 183.33127582437493, "outflow_rate_min": 949.3565246726554}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408911, "timesteps_since_restore": 1312359, "episodes_total": 1467, "policy_reward_mean": {}, "episode_reward_max": 605.5245653469145, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38947, "iterations_since_restore": 32, "training_iteration": 32, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 851.2074949741364, "timesteps_total": 1312359, "date": "2019-05-21_03-21-51", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d995c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99860>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 28.317108392715454, "hostname": "flow-main", "info": {"default": {"kl": 0.015622030012309551, "entropy": 1.3020304441452026, "policy_loss": -0.010389520786702633, "cur_lr": 0.0005000000237487257, "total_loss": 72.90239715576172, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 72.91043853759766, "vf_explained_var": 0.7570943236351013}, "grad_time_ms": 10306.619, "update_time_ms": 8.449, "load_time_ms": 4.025, "sample_time_ms": 16058.544, "num_steps_sampled": 1352060, "num_steps_trained": 1352060}, "episode_reward_min": 500.1728577709497, "episode_reward_mean": 562.9250393139948, "done": false, "time_total_s": 879.5246033668518, "custom_metrics": {"cost2_min": -49.64628289734939, "cost2_max": -17.703958168453152, "system_level_velocity_min": 11.094926326979959, "outflow_rate_max": 1198.182857142857, "cost1_max": 203.12051905977657, "cost1_min": 139.25216777350127, "cost2_mean": -32.304048710652836, "system_level_velocity_mean": 14.849646008845003, "outflow_rate_mean": 1123.0271760498492, "system_level_velocity_max": 16.47903099459157, "cost1_mean": 182.97690773223974, "outflow_rate_min": 949.3565246726554}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408939, "timesteps_since_restore": 1352060, "episodes_total": 1526, "policy_reward_mean": {}, "episode_reward_max": 608.9067491863385, "num_metric_batches_dropped": 0, "timesteps_this_iter": 39701, "iterations_since_restore": 33, "training_iteration": 33, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 879.5246033668518, "timesteps_total": 1352060, "date": "2019-05-21_03-22-19", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99f28>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 59}
{"time_this_iter_s": 25.156333208084106, "hostname": "flow-main", "info": {"default": {"kl": 0.016039090231060982, "entropy": 1.297967791557312, "policy_loss": -0.010955232195556164, "cur_lr": 0.0005000000237487257, "total_loss": 49.61151885986328, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 49.62006759643555, "vf_explained_var": 0.7857053875923157}, "grad_time_ms": 10141.802, "update_time_ms": 8.311, "load_time_ms": 4.043, "sample_time_ms": 16013.553, "num_steps_sampled": 1391262, "num_steps_trained": 1391262}, "episode_reward_min": 500.1728577709497, "episode_reward_mean": 562.7907863589393, "done": false, "time_total_s": 904.6809365749359, "custom_metrics": {"cost2_min": -49.64628289734939, "cost2_max": -19.6298711858444, "system_level_velocity_min": 11.094926326979959, "outflow_rate_max": 1199.0707404637244, "cost1_max": 203.12051905977657, "cost1_min": 139.25216777350127, "cost2_mean": -33.33132147210017, "system_level_velocity_mean": 14.671166699392295, "outflow_rate_mean": 1122.195514156811, "system_level_velocity_max": 16.47903099459157, "cost1_mean": 180.8963027194645, "outflow_rate_min": 962.2896310596313}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408964, "timesteps_since_restore": 1391262, "episodes_total": 1567, "policy_reward_mean": {}, "episode_reward_max": 608.9067491863385, "num_metric_batches_dropped": 0, "timesteps_this_iter": 39202, "iterations_since_restore": 34, "training_iteration": 34, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 904.6809365749359, "timesteps_total": 1391262, "date": "2019-05-21_03-22-44", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da96a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da95f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9710>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 41}
{"time_this_iter_s": 23.87077021598816, "hostname": "flow-main", "info": {"default": {"kl": 0.017446359619498253, "entropy": 1.293161153793335, "policy_loss": -0.011769786477088928, "cur_lr": 0.0005000000237487257, "total_loss": 60.37434387207031, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 60.383487701416016, "vf_explained_var": 0.7189432978630066}, "grad_time_ms": 10076.004, "update_time_ms": 8.025, "load_time_ms": 4.118, "sample_time_ms": 16026.838, "num_steps_sampled": 1428710, "num_steps_trained": 1428710}, "episode_reward_min": 500.1728577709497, "episode_reward_mean": 561.0295565217198, "done": false, "time_total_s": 928.5517067909241, "custom_metrics": {"cost2_min": -47.17953898399125, "cost2_max": -18.069753675525128, "system_level_velocity_min": 11.704509863252236, "outflow_rate_max": 1199.0707404637244, "cost1_max": 202.01760444879858, "cost1_min": 143.957244894475, "cost2_mean": -31.652931091016903, "system_level_velocity_mean": 14.937772057853921, "outflow_rate_mean": 1123.982060784874, "system_level_velocity_max": 16.452419059063892, "cost1_mean": 184.00857588011834, "outflow_rate_min": 976.0787629685952}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558408988, "timesteps_since_restore": 1428710, "episodes_total": 1607, "policy_reward_mean": {}, "episode_reward_max": 603.3994616468681, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37448, "iterations_since_restore": 35, "training_iteration": 35, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 928.5517067909241, "timesteps_total": 1428710, "date": "2019-05-21_03-23-08", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d995c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d990f0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.180187225341797, "hostname": "flow-main", "info": {"default": {"kl": 0.016721408814191818, "entropy": 1.30308198928833, "policy_loss": -0.011125055141746998, "cur_lr": 0.0005000000237487257, "total_loss": 77.6654052734375, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 77.67402648925781, "vf_explained_var": 0.700963020324707}, "grad_time_ms": 10114.503, "update_time_ms": 7.938, "load_time_ms": 4.105, "sample_time_ms": 15923.883, "num_steps_sampled": 1466236, "num_steps_trained": 1466236}, "episode_reward_min": 482.2690675200911, "episode_reward_mean": 558.862493701004, "done": false, "time_total_s": 954.7318940162659, "custom_metrics": {"cost2_min": -49.09237890393668, "cost2_max": -15.112441692480386, "system_level_velocity_min": 11.704509863252236, "outflow_rate_max": 1203.2578418769083, "cost1_max": 203.47542162367841, "cost1_min": 143.957244894475, "cost2_mean": -29.195686323787807, "system_level_velocity_mean": 15.205178136994236, "outflow_rate_mean": 1123.0152590595508, "system_level_velocity_max": 16.452419059063892, "cost1_mean": 187.23768356725068, "outflow_rate_min": 995.0252205882349}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409014, "timesteps_since_restore": 1466236, "episodes_total": 1661, "policy_reward_mean": {}, "episode_reward_max": 600.1202463724403, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37526, "iterations_since_restore": 36, "training_iteration": 36, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 954.7318940162659, "timesteps_total": 1466236, "date": "2019-05-21_03-23-34", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9400>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 54}
{"time_this_iter_s": 25.759263515472412, "hostname": "flow-main", "info": {"default": {"kl": 0.019074667245149612, "entropy": 1.3022894859313965, "policy_loss": -0.012250184081494808, "cur_lr": 0.0005000000237487257, "total_loss": 57.7671012878418, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 57.776493072509766, "vf_explained_var": 0.7438715696334839}, "grad_time_ms": 9854.906, "update_time_ms": 7.806, "load_time_ms": 4.031, "sample_time_ms": 15851.484, "num_steps_sampled": 1502472, "num_steps_trained": 1502472}, "episode_reward_min": 482.2690675200911, "episode_reward_mean": 553.1787410025663, "done": false, "time_total_s": 980.4911575317383, "custom_metrics": {"cost2_min": -49.09237890393668, "cost2_max": -15.112441692480386, "system_level_velocity_min": 12.470639954476505, "outflow_rate_max": 1203.2578418769083, "cost1_max": 203.86988893069494, "cost1_min": 152.61150049412896, "cost2_mean": -27.92281486911751, "system_level_velocity_mean": 15.257605096799193, "outflow_rate_mean": 1118.4709351611082, "system_level_velocity_max": 16.649900772485463, "cost1_mean": 187.8783473419961, "outflow_rate_min": 995.0252205882349}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409040, "timesteps_since_restore": 1502472, "episodes_total": 1707, "policy_reward_mean": {}, "episode_reward_max": 600.8637048096269, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36236, "iterations_since_restore": 37, "training_iteration": 37, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 980.4911575317383, "timesteps_total": 1502472, "date": "2019-05-21_03-24-00", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da96a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da94e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9358>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 46}
{"time_this_iter_s": 24.266122341156006, "hostname": "flow-main", "info": {"default": {"kl": 0.021110499277710915, "entropy": 1.3065569400787354, "policy_loss": -0.013728005811572075, "cur_lr": 0.0005000000237487257, "total_loss": 60.516075134277344, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 60.52663803100586, "vf_explained_var": 0.7663565874099731}, "grad_time_ms": 9787.937, "update_time_ms": 7.611, "load_time_ms": 4.096, "sample_time_ms": 15833.077, "num_steps_sampled": 1539763, "num_steps_trained": 1539763}, "episode_reward_min": 456.9579629667677, "episode_reward_mean": 548.0131813355677, "done": false, "time_total_s": 1004.7572798728943, "custom_metrics": {"cost2_min": -48.941008317619115, "cost2_max": -16.39979867653984, "system_level_velocity_min": 11.818932129430944, "outflow_rate_max": 1212.7473129251698, "cost1_max": 204.98247486063755, "cost1_min": 142.94849042946666, "cost2_mean": -28.45566917843034, "system_level_velocity_mean": 15.118156517967376, "outflow_rate_mean": 1112.8113936235002, "system_level_velocity_max": 16.695243902601675, "cost1_mean": 185.9729482069289, "outflow_rate_min": 914.6346714290515}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409065, "timesteps_since_restore": 1539763, "episodes_total": 1747, "policy_reward_mean": {}, "episode_reward_max": 600.8637048096269, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37291, "iterations_since_restore": 38, "training_iteration": 38, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1004.7572798728943, "timesteps_total": 1539763, "date": "2019-05-21_03-24-25", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabe10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabf28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab358>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 28.00164031982422, "hostname": "flow-main", "info": {"default": {"kl": 0.014922714792191982, "entropy": 1.315014362335205, "policy_loss": -0.01173918042331934, "cur_lr": 0.0005000000237487257, "total_loss": 75.47506713867188, "cur_kl_coeff": 0.22500000894069672, "vf_loss": 75.48345184326172, "vf_explained_var": 0.7019994854927063}, "grad_time_ms": 9868.952, "update_time_ms": 7.483, "load_time_ms": 4.055, "sample_time_ms": 16041.395, "num_steps_sampled": 1577338, "num_steps_trained": 1577338}, "episode_reward_min": 456.9579629667677, "episode_reward_mean": 541.6778873785249, "done": false, "time_total_s": 1032.7589201927185, "custom_metrics": {"cost2_min": -48.941008317619115, "cost2_max": -17.482663708315993, "system_level_velocity_min": 11.818932129430944, "outflow_rate_max": 1250.1180926548377, "cost1_max": 204.98247486063755, "cost1_min": 142.94849042946666, "cost2_mean": -28.54958353300768, "system_level_velocity_mean": 14.962441844603761, "outflow_rate_mean": 1107.8683057418002, "system_level_velocity_max": 16.695243902601675, "cost1_mean": 183.6581711823976, "outflow_rate_min": 914.6346714290515}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409093, "timesteps_since_restore": 1577338, "episodes_total": 1801, "policy_reward_mean": {}, "episode_reward_max": 616.3814324122039, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37575, "iterations_since_restore": 39, "training_iteration": 39, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1032.7589201927185, "timesteps_total": 1577338, "date": "2019-05-21_03-24-53", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9a90>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 54}
{"time_this_iter_s": 25.585893392562866, "hostname": "flow-main", "info": {"default": {"kl": 0.013997246511280537, "entropy": 1.3152236938476562, "policy_loss": -0.011610561050474644, "cur_lr": 0.0005000000237487257, "total_loss": 64.32344818115234, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 64.3319091796875, "vf_explained_var": 0.704226553440094}, "grad_time_ms": 9780.768, "update_time_ms": 7.404, "load_time_ms": 4.011, "sample_time_ms": 15971.12, "num_steps_sampled": 1613854, "num_steps_trained": 1613854}, "episode_reward_min": 56.57240035852293, "episode_reward_mean": 535.5909590258644, "done": false, "time_total_s": 1058.3448135852814, "custom_metrics": {"cost2_min": -49.08714496197445, "cost2_max": -11.711688361384967, "system_level_velocity_min": 11.121597395262892, "outflow_rate_max": 1250.1180926548377, "cost1_max": 203.240556837287, "cost1_min": 23.017959538634987, "cost2_mean": -27.403525721333985, "system_level_velocity_mean": 14.974746574362426, "outflow_rate_mean": 1100.2391679670548, "system_level_velocity_max": 18.511153729298407, "cost1_mean": 181.84991428256365, "outflow_rate_min": 498.5745932701787}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409118, "timesteps_since_restore": 1613854, "episodes_total": 1848, "policy_reward_mean": {}, "episode_reward_max": 616.3814324122039, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36516, "iterations_since_restore": 40, "training_iteration": 40, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1058.3448135852814, "timesteps_total": 1613854, "date": "2019-05-21_03-25-18", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99710>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 47}
{"time_this_iter_s": 22.63277792930603, "hostname": "flow-main", "info": {"default": {"kl": 0.016616061329841614, "entropy": 1.304969072341919, "policy_loss": -0.011249196715652943, "cur_lr": 0.0005000000237487257, "total_loss": 64.2984848022461, "cur_kl_coeff": 0.2250000238418579, "vf_loss": 64.30599975585938, "vf_explained_var": 0.675530731678009}, "grad_time_ms": 9558.281, "update_time_ms": 7.367, "load_time_ms": 4.059, "sample_time_ms": 15883.476, "num_steps_sampled": 1649319, "num_steps_trained": 1649319}, "episode_reward_min": 56.57240035852293, "episode_reward_mean": 536.4148111406631, "done": false, "time_total_s": 1080.9775915145874, "custom_metrics": {"cost2_min": -49.08714496197445, "cost2_max": -11.711688361384967, "system_level_velocity_min": 11.121597395262892, "outflow_rate_max": 1193.399831271091, "cost1_max": 203.64970180398203, "cost1_min": 23.017959538634987, "cost2_mean": -25.267488137257264, "system_level_velocity_mean": 15.278752904778516, "outflow_rate_mean": 1101.6946779583714, "system_level_velocity_max": 18.511153729298407, "cost1_mean": 185.64735204117815, "outflow_rate_min": 498.5745932701787}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409141, "timesteps_since_restore": 1649319, "episodes_total": 1888, "policy_reward_mean": {}, "episode_reward_max": 596.8570473480005, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35465, "iterations_since_restore": 41, "training_iteration": 41, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1080.9775915145874, "timesteps_total": 1649319, "date": "2019-05-21_03-25-41", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabe10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab6a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab9e8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 22.931298971176147, "hostname": "flow-main", "info": {"default": {"kl": 0.01602153666317463, "entropy": 1.305450677871704, "policy_loss": -0.013782142661511898, "cur_lr": 0.0005000000237487257, "total_loss": 70.95086669921875, "cur_kl_coeff": 0.22500000894069672, "vf_loss": 70.96104431152344, "vf_explained_var": 0.6802831292152405}, "grad_time_ms": 9314.934, "update_time_ms": 7.285, "load_time_ms": 3.934, "sample_time_ms": 15874.045, "num_steps_sampled": 1685476, "num_steps_trained": 1685476}, "episode_reward_min": 56.57240035852293, "episode_reward_mean": 533.754111299308, "done": false, "time_total_s": 1103.9088904857635, "custom_metrics": {"cost2_min": -49.08714496197445, "cost2_max": -11.711688361384967, "system_level_velocity_min": 11.121597395262892, "outflow_rate_max": 1195.4594680851064, "cost1_max": 203.64970180398203, "cost1_min": 23.017959538634987, "cost2_mean": -25.87443333553358, "system_level_velocity_mean": 15.340271095939167, "outflow_rate_mean": 1101.0145177260986, "system_level_velocity_max": 18.511153729298407, "cost1_mean": 186.21748875732024, "outflow_rate_min": 498.5745932701787}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409164, "timesteps_since_restore": 1685476, "episodes_total": 1928, "policy_reward_mean": {}, "episode_reward_max": 584.9407189916931, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36157, "iterations_since_restore": 42, "training_iteration": 42, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1103.9088904857635, "timesteps_total": 1685476, "date": "2019-05-21_03-26-04", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da95f8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 25.440441608428955, "hostname": "flow-main", "info": {"default": {"kl": 0.017298003658652306, "entropy": 1.3098409175872803, "policy_loss": -0.014485473744571209, "cur_lr": 0.0005000000237487257, "total_loss": 84.4747543334961, "cur_kl_coeff": 0.2250000238418579, "vf_loss": 84.48534393310547, "vf_explained_var": 0.6816338300704956}, "grad_time_ms": 9019.265, "update_time_ms": 7.468, "load_time_ms": 3.832, "sample_time_ms": 15882.144, "num_steps_sampled": 1721206, "num_steps_trained": 1721206}, "episode_reward_min": 472.8820951139353, "episode_reward_mean": 538.1991237749006, "done": false, "time_total_s": 1129.3493320941925, "custom_metrics": {"cost2_min": -52.274972480340665, "cost2_max": -15.032219600285192, "system_level_velocity_min": 11.180505886228106, "outflow_rate_max": 1211.859145562885, "cost1_max": 204.94852288378635, "cost1_min": 136.47178953687722, "cost2_mean": -27.13006914264265, "system_level_velocity_mean": 15.334698214081497, "outflow_rate_mean": 1108.9726547359685, "system_level_velocity_max": 16.8417580782471, "cost1_mean": 187.7744612255608, "outflow_rate_min": 939.5068253968254}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409189, "timesteps_since_restore": 1721206, "episodes_total": 1988, "policy_reward_mean": {}, "episode_reward_max": 584.629509111193, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35730, "iterations_since_restore": 43, "training_iteration": 43, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1129.3493320941925, "timesteps_total": 1721206, "date": "2019-05-21_03-26-29", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabda0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 60}
{"time_this_iter_s": 22.902785539627075, "hostname": "flow-main", "info": {"default": {"kl": 0.016054196283221245, "entropy": 1.3130303621292114, "policy_loss": -0.014043423347175121, "cur_lr": 0.0005000000237487257, "total_loss": 66.26990509033203, "cur_kl_coeff": 0.2250000238418579, "vf_loss": 66.28032684326172, "vf_explained_var": 0.7008688449859619}, "grad_time_ms": 8859.447, "update_time_ms": 7.36, "load_time_ms": 3.793, "sample_time_ms": 15817.917, "num_steps_sampled": 1756314, "num_steps_trained": 1756314}, "episode_reward_min": 477.9661669476122, "episode_reward_mean": 542.5206111035944, "done": false, "time_total_s": 1152.2521176338196, "custom_metrics": {"cost2_min": -52.274972480340665, "cost2_max": -15.032219600285192, "system_level_velocity_min": 11.180505886228106, "outflow_rate_max": 1212.0733163076948, "cost1_max": 207.22130444277929, "cost1_min": 136.47178953687722, "cost2_mean": -26.200707695880716, "system_level_velocity_mean": 15.631543306930636, "outflow_rate_mean": 1119.7100402907279, "system_level_velocity_max": 16.943628087459796, "cost1_mean": 191.3397453428931, "outflow_rate_min": 939.5068253968254}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409212, "timesteps_since_restore": 1756314, "episodes_total": 2028, "policy_reward_mean": {}, "episode_reward_max": 589.9932456799212, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35108, "iterations_since_restore": 44, "training_iteration": 44, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1152.2521176338196, "timesteps_total": 1756314, "date": "2019-05-21_03-26-52", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da92e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9a90>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 23.214311599731445, "hostname": "flow-main", "info": {"default": {"kl": 0.01657651923596859, "entropy": 1.3176345825195312, "policy_loss": -0.013601378537714481, "cur_lr": 0.0005000000237487257, "total_loss": 68.2057113647461, "cur_kl_coeff": 0.2250000238418579, "vf_loss": 68.21559143066406, "vf_explained_var": 0.703492283821106}, "grad_time_ms": 8710.924, "update_time_ms": 7.333, "load_time_ms": 3.692, "sample_time_ms": 15902.057, "num_steps_sampled": 1792113, "num_steps_trained": 1792113}, "episode_reward_min": 44.348055807917234, "episode_reward_mean": 538.20812063219, "done": false, "time_total_s": 1175.466429233551, "custom_metrics": {"cost2_min": -49.54492144810641, "cost2_max": -11.729514993195746, "system_level_velocity_min": 12.066690012755373, "outflow_rate_max": 1212.0733163076948, "cost1_max": 207.22130444277929, "cost1_min": 18.02273555744603, "cost2_mean": -26.659500669921744, "system_level_velocity_mean": 15.690205531772913, "outflow_rate_mean": 1118.2523725437711, "system_level_velocity_max": 17.765642743465264, "cost1_mean": 190.0028205896146, "outflow_rate_min": 485.8629864444024}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409236, "timesteps_since_restore": 1792113, "episodes_total": 2069, "policy_reward_mean": {}, "episode_reward_max": 589.9932456799212, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35799, "iterations_since_restore": 45, "training_iteration": 45, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1175.466429233551, "timesteps_total": 1792113, "date": "2019-05-21_03-27-16", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab6a0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 41}
{"time_this_iter_s": 24.500954389572144, "hostname": "flow-main", "info": {"default": {"kl": 0.016970235854387283, "entropy": 1.3219094276428223, "policy_loss": -0.013844918459653854, "cur_lr": 0.0005000000237487257, "total_loss": 68.2928237915039, "cur_kl_coeff": 0.22500000894069672, "vf_loss": 68.30284881591797, "vf_explained_var": 0.7551750540733337}, "grad_time_ms": 8428.949, "update_time_ms": 7.153, "load_time_ms": 3.709, "sample_time_ms": 16017.261, "num_steps_sampled": 1828037, "num_steps_trained": 1828037}, "episode_reward_min": 44.348055807917234, "episode_reward_mean": 537.9465192607845, "done": false, "time_total_s": 1199.9673836231232, "custom_metrics": {"cost2_min": -49.54492144810641, "cost2_max": -11.729514993195746, "system_level_velocity_min": 12.072112119125071, "outflow_rate_max": 1202.4624671901897, "cost1_max": 206.69444104468764, "cost1_min": 18.02273555744603, "cost2_mean": -28.278724592262133, "system_level_velocity_mean": 15.627196190417747, "outflow_rate_mean": 1117.7256126223522, "system_level_velocity_max": 17.765642743465264, "cost1_mean": 189.03042695240504, "outflow_rate_min": 485.8629864444024}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409260, "timesteps_since_restore": 1828037, "episodes_total": 2128, "policy_reward_mean": {}, "episode_reward_max": 596.2165703240411, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35924, "iterations_since_restore": 46, "training_iteration": 46, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1199.9673836231232, "timesteps_total": 1828037, "date": "2019-05-21_03-27-40", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1fd1828>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 59}
{"time_this_iter_s": 23.13719630241394, "hostname": "flow-main", "info": {"default": {"kl": 0.016598738729953766, "entropy": 1.3128305673599243, "policy_loss": -0.013348856940865517, "cur_lr": 0.0005000000237487257, "total_loss": 54.03597640991211, "cur_kl_coeff": 0.2250000238418579, "vf_loss": 54.045589447021484, "vf_explained_var": 0.7851602435112}, "grad_time_ms": 8112.887, "update_time_ms": 7.029, "load_time_ms": 3.643, "sample_time_ms": 16072.114, "num_steps_sampled": 1864423, "num_steps_trained": 1864423}, "episode_reward_min": 496.8504759620708, "episode_reward_mean": 542.2151081361255, "done": false, "time_total_s": 1223.104579925537, "custom_metrics": {"cost2_min": -47.05712535737748, "cost2_max": -16.15667849116319, "system_level_velocity_min": 12.7262408071219, "outflow_rate_max": 1224.1627492472398, "cost1_max": 206.12594505587595, "cost1_min": 154.53609210226833, "cost2_mean": -28.580155932322544, "system_level_velocity_mean": 15.559352595802743, "outflow_rate_mean": 1119.423334759654, "system_level_velocity_max": 16.94690371050277, "cost1_mean": 190.07006632714211, "outflow_rate_min": 988.5769416556944}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409283, "timesteps_since_restore": 1864423, "episodes_total": 2169, "policy_reward_mean": {}, "episode_reward_max": 596.2165703240411, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36386, "iterations_since_restore": 47, "training_iteration": 47, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1223.104579925537, "timesteps_total": 1864423, "date": "2019-05-21_03-28-03", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da91d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9908>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 41}
{"time_this_iter_s": 23.730047702789307, "hostname": "flow-main", "info": {"default": {"kl": 0.018190693110227585, "entropy": 1.3188655376434326, "policy_loss": -0.013104804791510105, "cur_lr": 0.0005000000237487257, "total_loss": 62.020103454589844, "cur_kl_coeff": 0.2250000238418579, "vf_loss": 62.02912139892578, "vf_explained_var": 0.7449222803115845}, "grad_time_ms": 7930.539, "update_time_ms": 6.878, "load_time_ms": 3.522, "sample_time_ms": 16201.607, "num_steps_sampled": 1900208, "num_steps_trained": 1900208}, "episode_reward_min": 59.22714090735924, "episode_reward_mean": 532.3598389786388, "done": false, "time_total_s": 1246.8346276283264, "custom_metrics": {"cost2_min": -51.94432229189827, "cost2_max": -14.53411136422791, "system_level_velocity_min": 11.65620882086478, "outflow_rate_max": 1224.1627492472398, "cost1_max": 207.67694342358243, "cost1_min": 24.26637875642634, "cost2_mean": -27.5373543060278, "system_level_velocity_mean": 15.433946687866976, "outflow_rate_mean": 1105.1418527863107, "system_level_velocity_max": 18.571426424670797, "cost1_mean": 186.3618247192317, "outflow_rate_min": 504.43947709232737}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409307, "timesteps_since_restore": 1900208, "episodes_total": 2210, "policy_reward_mean": {}, "episode_reward_max": 584.5155834327245, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35785, "iterations_since_restore": 48, "training_iteration": 48, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1246.8346276283264, "timesteps_total": 1900208, "date": "2019-05-21_03-28-27", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab2e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab2b0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 41}
{"time_this_iter_s": 23.29989981651306, "hostname": "flow-main", "info": {"default": {"kl": 0.017722273245453835, "entropy": 1.3211681842803955, "policy_loss": -0.014744083397090435, "cur_lr": 0.0005000000237487257, "total_loss": 74.20654296875, "cur_kl_coeff": 0.2250000238418579, "vf_loss": 74.21730041503906, "vf_explained_var": 0.6885056495666504}, "grad_time_ms": 7593.025, "update_time_ms": 6.946, "load_time_ms": 3.698, "sample_time_ms": 16068.954, "num_steps_sampled": 1935038, "num_steps_trained": 1935038}, "episode_reward_min": 59.22714090735924, "episode_reward_mean": 525.8379247612208, "done": false, "time_total_s": 1270.1345274448395, "custom_metrics": {"cost2_min": -51.94432229189827, "cost2_max": -14.53411136422791, "system_level_velocity_min": 11.65620882086478, "outflow_rate_max": 1182.7182126160424, "cost1_max": 207.67694342358243, "cost1_min": 24.26637875642634, "cost2_mean": -26.041973775657702, "system_level_velocity_mean": 15.54625197788849, "outflow_rate_mean": 1103.0118593090044, "system_level_velocity_max": 18.571426424670797, "cost1_mean": 187.5098387200574, "outflow_rate_min": 504.43947709232737}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409330, "timesteps_since_restore": 1935038, "episodes_total": 2262, "policy_reward_mean": {}, "episode_reward_max": 577.8999001197931, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34830, "iterations_since_restore": 49, "training_iteration": 49, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1270.1345274448395, "timesteps_total": 1935038, "date": "2019-05-21_03-28-50", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabba8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 52}
{"time_this_iter_s": 23.178589344024658, "hostname": "flow-main", "info": {"default": {"kl": 0.01573299802839756, "entropy": 1.3172377347946167, "policy_loss": -0.01281123049557209, "cur_lr": 0.0005000000237487257, "total_loss": 64.60106658935547, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 64.61033630371094, "vf_explained_var": 0.731700599193573}, "grad_time_ms": 7460.02, "update_time_ms": 6.873, "load_time_ms": 3.702, "sample_time_ms": 15961.698, "num_steps_sampled": 1969299, "num_steps_trained": 1969299}, "episode_reward_min": 60.88950065721204, "episode_reward_mean": 520.7308217295226, "done": false, "time_total_s": 1293.3131167888641, "custom_metrics": {"cost2_min": -40.26609582417245, "cost2_max": -11.899444669427352, "system_level_velocity_min": 12.5506421215109, "outflow_rate_max": 1225.8855382116726, "cost1_max": 209.242768333623, "cost1_min": 24.20851217231829, "cost2_mean": -25.762183869890166, "system_level_velocity_mean": 15.711883080800613, "outflow_rate_mean": 1104.4750466798696, "system_level_velocity_max": 18.472832389514895, "cost1_mean": 189.16578184238202, "outflow_rate_min": 483.4753028303134}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409354, "timesteps_since_restore": 1969299, "episodes_total": 2311, "policy_reward_mean": {}, "episode_reward_max": 579.0405383788632, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34261, "iterations_since_restore": 50, "training_iteration": 50, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1293.3131167888641, "timesteps_total": 1969299, "date": "2019-05-21_03-29-14", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab940>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 23.106586933135986, "hostname": "flow-main", "info": {"default": {"kl": 0.015601659193634987, "entropy": 1.3126897811889648, "policy_loss": -0.012117510661482811, "cur_lr": 0.0005000000237487257, "total_loss": 66.39952850341797, "cur_kl_coeff": 0.2250000238418579, "vf_loss": 66.40814208984375, "vf_explained_var": 0.7025756239891052}, "grad_time_ms": 7575.99, "update_time_ms": 6.889, "load_time_ms": 3.713, "sample_time_ms": 15892.688, "num_steps_sampled": 2004159, "num_steps_trained": 2004159}, "episode_reward_min": 60.88950065721204, "episode_reward_mean": 516.036381371122, "done": false, "time_total_s": 1316.4197037220001, "custom_metrics": {"cost2_min": -40.26609582417245, "cost2_max": -11.899444669427352, "system_level_velocity_min": 12.30116658390912, "outflow_rate_max": 1225.8855382116726, "cost1_max": 209.97208763986882, "cost1_min": 24.20851217231829, "cost2_mean": -26.1891150875739, "system_level_velocity_mean": 15.653720839176277, "outflow_rate_mean": 1094.7209887011395, "system_level_velocity_max": 18.472832389514895, "cost1_mean": 188.10198220214693, "outflow_rate_min": 483.4753028303134}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409377, "timesteps_since_restore": 2004159, "episodes_total": 2351, "policy_reward_mean": {}, "episode_reward_max": 579.0405383788632, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34860, "iterations_since_restore": 51, "training_iteration": 51, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1316.4197037220001, "timesteps_total": 2004159, "date": "2019-05-21_03-29-37", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabf28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabe48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab9e8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.171335697174072, "hostname": "flow-main", "info": {"default": {"kl": 0.01609024405479431, "entropy": 1.3055291175842285, "policy_loss": -0.011088156141340733, "cur_lr": 0.0005000000237487257, "total_loss": 90.2177734375, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 90.2252426147461, "vf_explained_var": 0.6075829863548279}, "grad_time_ms": 7835.693, "update_time_ms": 6.944, "load_time_ms": 3.772, "sample_time_ms": 15957.188, "num_steps_sampled": 2038693, "num_steps_trained": 2038693}, "episode_reward_min": 451.8999416526102, "episode_reward_mean": 520.102665918848, "done": false, "time_total_s": 1342.5910394191742, "custom_metrics": {"cost2_min": -40.79346524576478, "cost2_max": -17.456043189312872, "system_level_velocity_min": 12.30116658390912, "outflow_rate_max": 1216.8290740740736, "cost1_max": 214.10832191155083, "cost1_min": 150.04333722899014, "cost2_mean": -26.678245440244655, "system_level_velocity_mean": 15.594027708982868, "outflow_rate_mean": 1100.1097497223468, "system_level_velocity_max": 17.611430774387962, "cost1_mean": 189.29309973735897, "outflow_rate_min": 892.5865127302235}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409403, "timesteps_since_restore": 2038693, "episodes_total": 2402, "policy_reward_mean": {}, "episode_reward_max": 581.3960143958155, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34534, "iterations_since_restore": 52, "training_iteration": 52, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1342.5910394191742, "timesteps_total": 2038693, "date": "2019-05-21_03-30-03", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d996d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99a90>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 51}
{"time_this_iter_s": 24.66429853439331, "hostname": "flow-main", "info": {"default": {"kl": 0.016619257628917694, "entropy": 1.3180919885635376, "policy_loss": -0.014320997521281242, "cur_lr": 0.0005000000237487257, "total_loss": 70.2327651977539, "cur_kl_coeff": 0.2250000238418579, "vf_loss": 70.24334716796875, "vf_explained_var": 0.7007460594177246}, "grad_time_ms": 7974.279, "update_time_ms": 6.733, "load_time_ms": 3.752, "sample_time_ms": 15741.946, "num_steps_sampled": 2073549, "num_steps_trained": 2073549}, "episode_reward_min": 457.8978070740764, "episode_reward_mean": 527.7085626117861, "done": false, "time_total_s": 1367.2553379535675, "custom_metrics": {"cost2_min": -40.79346524576478, "cost2_max": -17.456043189312872, "system_level_velocity_min": 11.77954624576567, "outflow_rate_max": 1216.8290740740736, "cost1_max": 214.10832191155083, "cost1_min": 148.63968189454098, "cost2_mean": -26.847509454328918, "system_level_velocity_mean": 15.770577357549174, "outflow_rate_mean": 1115.6788508010488, "system_level_velocity_max": 17.611430774387962, "cost1_mean": 191.39672095169, "outflow_rate_min": 943.3997013875316}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409428, "timesteps_since_restore": 2073549, "episodes_total": 2451, "policy_reward_mean": {}, "episode_reward_max": 581.3960143958155, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34856, "iterations_since_restore": 53, "training_iteration": 53, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1367.2553379535675, "timesteps_total": 2073549, "date": "2019-05-21_03-30-28", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db40b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4160>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 23.000481843948364, "hostname": "flow-main", "info": {"default": {"kl": 0.0175614096224308, "entropy": 1.3238625526428223, "policy_loss": -0.013087302446365356, "cur_lr": 0.0005000000237487257, "total_loss": 66.51443481445312, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 66.52357482910156, "vf_explained_var": 0.6923444867134094}, "grad_time_ms": 8162.515, "update_time_ms": 7.011, "load_time_ms": 3.723, "sample_time_ms": 15562.855, "num_steps_sampled": 2108011, "num_steps_trained": 2108011}, "episode_reward_min": 464.57077768791, "episode_reward_mean": 531.6018449169459, "done": false, "time_total_s": 1390.2558197975159, "custom_metrics": {"cost2_min": -40.55885151628257, "cost2_max": -16.59416650996807, "system_level_velocity_min": 11.77954624576567, "outflow_rate_max": 1252.82635812027, "cost1_max": 215.21041060335625, "cost1_min": 148.63968189454098, "cost2_mean": -27.3013262848647, "system_level_velocity_mean": 15.918705522238351, "outflow_rate_mean": 1124.5425032221879, "system_level_velocity_max": 17.748502459763237, "cost1_mean": 193.03500375523814, "outflow_rate_min": 936.3039262409418}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409451, "timesteps_since_restore": 2108011, "episodes_total": 2491, "policy_reward_mean": {}, "episode_reward_max": 603.1424547896681, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34462, "iterations_since_restore": 54, "training_iteration": 54, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1390.2558197975159, "timesteps_total": 2108011, "date": "2019-05-21_03-30-51", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabf60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1daba58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab7f0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 22.940391778945923, "hostname": "flow-main", "info": {"default": {"kl": 0.01763639599084854, "entropy": 1.3360819816589355, "policy_loss": -0.013561682775616646, "cur_lr": 0.0005000000237487257, "total_loss": 65.99335479736328, "cur_kl_coeff": 0.2250000238418579, "vf_loss": 66.0029525756836, "vf_explained_var": 0.7154904007911682}, "grad_time_ms": 8351.141, "update_time_ms": 7.127, "load_time_ms": 3.697, "sample_time_ms": 15344.791, "num_steps_sampled": 2143173, "num_steps_trained": 2143173}, "episode_reward_min": 445.195583925963, "episode_reward_mean": 531.9424785389807, "done": false, "time_total_s": 1413.1962115764618, "custom_metrics": {"cost2_min": -42.65644693651012, "cost2_max": -16.59416650996807, "system_level_velocity_min": 12.26218401092093, "outflow_rate_max": 1252.82635812027, "cost1_max": 215.21041060335625, "cost1_min": 147.6006785388959, "cost2_mean": -27.65962270999192, "system_level_velocity_mean": 16.02639124216094, "outflow_rate_mean": 1126.3706014185582, "system_level_velocity_max": 17.748502459763237, "cost1_mean": 194.24582919725088, "outflow_rate_min": 911.0797504678726}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409474, "timesteps_since_restore": 2143173, "episodes_total": 2531, "policy_reward_mean": {}, "episode_reward_max": 603.1424547896681, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35162, "iterations_since_restore": 55, "training_iteration": 55, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1413.1962115764618, "timesteps_total": 2143173, "date": "2019-05-21_03-31-14", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d964e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96d68>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 25.37305474281311, "hostname": "flow-main", "info": {"default": {"kl": 0.01725701242685318, "entropy": 1.337166428565979, "policy_loss": -0.013861749321222305, "cur_lr": 0.0005000000237487257, "total_loss": 92.71874237060547, "cur_kl_coeff": 0.22500000894069672, "vf_loss": 92.72872161865234, "vf_explained_var": 0.6938249468803406}, "grad_time_ms": 8548.055, "update_time_ms": 7.34, "load_time_ms": 3.69, "sample_time_ms": 15234.366, "num_steps_sampled": 2179040, "num_steps_trained": 2179040}, "episode_reward_min": 445.195583925963, "episode_reward_mean": 538.3864711194814, "done": false, "time_total_s": 1438.569266319275, "custom_metrics": {"cost2_min": -47.88538846374958, "cost2_max": -19.599803910234012, "system_level_velocity_min": 12.26218401092093, "outflow_rate_max": 1265.0724234544061, "cost1_max": 215.54643035274603, "cost1_min": 147.6006785388959, "cost2_mean": -29.338476504314123, "system_level_velocity_mean": 15.855390252282533, "outflow_rate_mean": 1133.7110323836566, "system_level_velocity_max": 17.736489153160203, "cost1_mean": 192.42438519110476, "outflow_rate_min": 911.0797504678726}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409499, "timesteps_since_restore": 2179040, "episodes_total": 2591, "policy_reward_mean": {}, "episode_reward_max": 601.3466203083531, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35867, "iterations_since_restore": 56, "training_iteration": 56, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1438.569266319275, "timesteps_total": 2179040, "date": "2019-05-21_03-31-39", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99f60>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 60}
{"time_this_iter_s": 24.79728937149048, "hostname": "flow-main", "info": {"default": {"kl": 0.01675003208220005, "entropy": 1.3312444686889648, "policy_loss": -0.01293900702148676, "cur_lr": 0.0005000000237487257, "total_loss": 71.38687896728516, "cur_kl_coeff": 0.22500000894069672, "vf_loss": 71.39604949951172, "vf_explained_var": 0.6985494494438171}, "grad_time_ms": 8842.868, "update_time_ms": 7.411, "load_time_ms": 3.737, "sample_time_ms": 15103.939, "num_steps_sampled": 2215072, "num_steps_trained": 2215072}, "episode_reward_min": 471.1975326901085, "episode_reward_mean": 542.971076012624, "done": false, "time_total_s": 1463.3665556907654, "custom_metrics": {"cost2_min": -51.12272314724811, "cost2_max": -19.599803910234012, "system_level_velocity_min": 12.323459275108371, "outflow_rate_max": 1288.5420992754998, "cost1_max": 216.39266725522546, "cost1_min": 149.32085282628606, "cost2_mean": -31.06462723376882, "system_level_velocity_mean": 15.861016574095371, "outflow_rate_mean": 1142.739553353908, "system_level_velocity_max": 18.009091733400734, "cost1_mean": 192.3525955000167, "outflow_rate_min": 952.0009068466094}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409524, "timesteps_since_restore": 2215072, "episodes_total": 2631, "policy_reward_mean": {}, "episode_reward_max": 604.2577217441766, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36032, "iterations_since_restore": 57, "training_iteration": 57, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1463.3665556907654, "timesteps_total": 2215072, "date": "2019-05-21_03-32-04", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabef0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 24.054624795913696, "hostname": "flow-main", "info": {"default": {"kl": 0.017937785014510155, "entropy": 1.3429267406463623, "policy_loss": -0.013604828156530857, "cur_lr": 0.0005000000237487257, "total_loss": 76.18948364257812, "cur_kl_coeff": 0.22500000894069672, "vf_loss": 76.19905090332031, "vf_explained_var": 0.6362000703811646}, "grad_time_ms": 9004.858, "update_time_ms": 7.58, "load_time_ms": 3.838, "sample_time_ms": 14973.042, "num_steps_sampled": 2250357, "num_steps_trained": 2250357}, "episode_reward_min": 471.1975326901085, "episode_reward_mean": 548.0964528959893, "done": false, "time_total_s": 1487.421180486679, "custom_metrics": {"cost2_min": -51.12272314724811, "cost2_max": -19.505271991989243, "system_level_velocity_min": 12.323459275108371, "outflow_rate_max": 1288.5420992754998, "cost1_max": 216.80348106239194, "cost1_min": 150.12634277134288, "cost2_mean": -31.209036060336533, "system_level_velocity_mean": 16.099568103758077, "outflow_rate_mean": 1154.821680960141, "system_level_velocity_max": 18.009091733400734, "cost1_mean": 195.20715435110915, "outflow_rate_min": 952.0009068466094}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409548, "timesteps_since_restore": 2250357, "episodes_total": 2671, "policy_reward_mean": {}, "episode_reward_max": 604.2577217441766, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35285, "iterations_since_restore": 58, "training_iteration": 58, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1487.421180486679, "timesteps_total": 2250357, "date": "2019-05-21_03-32-28", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89c18>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 25.314903259277344, "hostname": "flow-main", "info": {"default": {"kl": 0.0193075779825449, "entropy": 1.3466306924819946, "policy_loss": -0.01519578043371439, "cur_lr": 0.0005000000237487257, "total_loss": 86.91746520996094, "cur_kl_coeff": 0.22500000894069672, "vf_loss": 86.92831420898438, "vf_explained_var": 0.7101156115531921}, "grad_time_ms": 9109.513, "update_time_ms": 7.784, "load_time_ms": 3.663, "sample_time_ms": 15069.031, "num_steps_sampled": 2287381, "num_steps_trained": 2287381}, "episode_reward_min": 485.36389730719554, "episode_reward_mean": 560.5783586215729, "done": false, "time_total_s": 1512.7360837459564, "custom_metrics": {"cost2_min": -49.35441080753903, "cost2_max": -19.505271991989243, "system_level_velocity_min": 12.362494559886843, "outflow_rate_max": 1269.9318191964285, "cost1_max": 217.0411800606714, "cost1_min": 148.85499108351354, "cost2_mean": -31.427579140515576, "system_level_velocity_mean": 16.146484414026833, "outflow_rate_mean": 1173.1719421088594, "system_level_velocity_max": 18.02119612756457, "cost1_mean": 196.19496576479793, "outflow_rate_min": 956.3512298189822}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409573, "timesteps_since_restore": 2287381, "episodes_total": 2729, "policy_reward_mean": {}, "episode_reward_max": 605.2205001923779, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37024, "iterations_since_restore": 59, "training_iteration": 59, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1512.7360837459564, "timesteps_total": 2287381, "date": "2019-05-21_03-32-53", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d996a0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 58}
{"time_this_iter_s": 23.931390285491943, "hostname": "flow-main", "info": {"default": {"kl": 0.018831050023436546, "entropy": 1.3483046293258667, "policy_loss": -0.013946964405477047, "cur_lr": 0.0005000000237487257, "total_loss": 60.15934371948242, "cur_kl_coeff": 0.2250000238418579, "vf_loss": 60.16904830932617, "vf_explained_var": 0.7804074287414551}, "grad_time_ms": 9134.897, "update_time_ms": 7.824, "load_time_ms": 3.727, "sample_time_ms": 15118.791, "num_steps_sampled": 2323822, "num_steps_trained": 2323822}, "episode_reward_min": 485.36389730719554, "episode_reward_mean": 562.7108397750393, "done": false, "time_total_s": 1536.6674740314484, "custom_metrics": {"cost2_min": -49.35441080753903, "cost2_max": -21.78663608812029, "system_level_velocity_min": 12.328183478640566, "outflow_rate_max": 1269.9318191964285, "cost1_max": 218.20750517695282, "cost1_min": 148.85499108351354, "cost2_mean": -32.56233261583228, "system_level_velocity_mean": 16.035669491664915, "outflow_rate_mean": 1171.4415839935648, "system_level_velocity_max": 18.178161179985267, "cost1_mean": 194.81297492182546, "outflow_rate_min": 956.3512298189822}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409597, "timesteps_since_restore": 2323822, "episodes_total": 2771, "policy_reward_mean": {}, "episode_reward_max": 608.7971379433448, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36441, "iterations_since_restore": 60, "training_iteration": 60, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1536.6674740314484, "timesteps_total": 2323822, "date": "2019-05-21_03-33-17", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabf60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabb38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabda0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 42}
{"time_this_iter_s": 23.931172847747803, "hostname": "flow-main", "info": {"default": {"kl": 0.017643185332417488, "entropy": 1.3613566160202026, "policy_loss": -0.01345963217318058, "cur_lr": 0.0005000000237487257, "total_loss": 73.61570739746094, "cur_kl_coeff": 0.22500000894069672, "vf_loss": 73.62519073486328, "vf_explained_var": 0.669094979763031}, "grad_time_ms": 9176.212, "update_time_ms": 7.815, "load_time_ms": 3.777, "sample_time_ms": 15159.563, "num_steps_sampled": 2359980, "num_steps_trained": 2359980}, "episode_reward_min": 485.75038591847255, "episode_reward_mean": 571.0540206898623, "done": false, "time_total_s": 1560.5986468791962, "custom_metrics": {"cost2_min": -48.16025462897054, "cost2_max": -21.78663608812029, "system_level_velocity_min": 12.328183478640566, "outflow_rate_max": 1307.5032687575967, "cost1_max": 218.43842738221713, "cost1_min": 148.85499108351354, "cost2_mean": -32.3878201903612, "system_level_velocity_mean": 16.25924577721924, "outflow_rate_mean": 1187.2780572581726, "system_level_velocity_max": 18.178161179985267, "cost1_mean": 197.57378386067347, "outflow_rate_min": 956.3512298189822}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409621, "timesteps_since_restore": 2359980, "episodes_total": 2811, "policy_reward_mean": {}, "episode_reward_max": 624.9150184561204, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36158, "iterations_since_restore": 61, "training_iteration": 61, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1560.5986468791962, "timesteps_total": 2359980, "date": "2019-05-21_03-33-41", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d964e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96240>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.053062200546265, "hostname": "flow-main", "info": {"default": {"kl": 0.016412248834967613, "entropy": 1.3509302139282227, "policy_loss": -0.012224985286593437, "cur_lr": 0.0005000000237487257, "total_loss": 92.90167236328125, "cur_kl_coeff": 0.2250000387430191, "vf_loss": 92.91020965576172, "vf_explained_var": 0.6860027313232422}, "grad_time_ms": 9116.474, "update_time_ms": 7.854, "load_time_ms": 3.736, "sample_time_ms": 15207.182, "num_steps_sampled": 2396807, "num_steps_trained": 2396807}, "episode_reward_min": 55.92839066025223, "episode_reward_mean": 573.8364745512835, "done": false, "time_total_s": 1586.6517090797424, "custom_metrics": {"cost2_min": -49.52194399216297, "cost2_max": -16.076469958636284, "system_level_velocity_min": 12.23384987414889, "outflow_rate_max": 1307.5032687575967, "cost1_max": 218.769827232902, "cost1_min": 23.254365500827202, "cost2_mean": -32.337553519346955, "system_level_velocity_mean": 16.466252333796074, "outflow_rate_mean": 1197.903398908596, "system_level_velocity_max": 18.73196582040526, "cost1_mean": 197.9748250229997, "outflow_rate_min": 485.030682526844}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409647, "timesteps_since_restore": 2396807, "episodes_total": 2863, "policy_reward_mean": {}, "episode_reward_max": 624.9150184561204, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36827, "iterations_since_restore": 62, "training_iteration": 62, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1586.6517090797424, "timesteps_total": 2396807, "date": "2019-05-21_03-34-07", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d991d0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 52}
{"time_this_iter_s": 24.944895029067993, "hostname": "flow-main", "info": {"default": {"kl": 0.018505075946450233, "entropy": 1.3544526100158691, "policy_loss": -0.014621961861848831, "cur_lr": 0.0005000000237487257, "total_loss": 64.33515930175781, "cur_kl_coeff": 0.22500000894069672, "vf_loss": 64.34561157226562, "vf_explained_var": 0.772625744342804}, "grad_time_ms": 9093.946, "update_time_ms": 7.9, "load_time_ms": 3.816, "sample_time_ms": 15256.562, "num_steps_sampled": 2433776, "num_steps_trained": 2433776}, "episode_reward_min": 55.92839066025223, "episode_reward_mean": 571.1140675668129, "done": false, "time_total_s": 1611.5966041088104, "custom_metrics": {"cost2_min": -49.52194399216297, "cost2_max": -16.076469958636284, "system_level_velocity_min": 11.96307094113317, "outflow_rate_max": 1303.063194093042, "cost1_max": 220.45474727694187, "cost1_min": 23.254365500827202, "cost2_mean": -32.752806396408715, "system_level_velocity_mean": 16.301381874268703, "outflow_rate_mean": 1191.7840153725422, "system_level_velocity_max": 18.73196582040526, "cost1_mean": 195.78140969844233, "outflow_rate_min": 485.030682526844}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409672, "timesteps_since_restore": 2433776, "episodes_total": 2912, "policy_reward_mean": {}, "episode_reward_max": 614.8916603149487, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36969, "iterations_since_restore": 63, "training_iteration": 63, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1611.5966041088104, "timesteps_total": 2433776, "date": "2019-05-21_03-34-32", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89c88>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 25.75303077697754, "hostname": "flow-main", "info": {"default": {"kl": 0.01937223970890045, "entropy": 1.3372979164123535, "policy_loss": -0.013752928003668785, "cur_lr": 0.0005000000237487257, "total_loss": 63.798545837402344, "cur_kl_coeff": 0.22500000894069672, "vf_loss": 63.80793762207031, "vf_explained_var": 0.7983192801475525}, "grad_time_ms": 9099.969, "update_time_ms": 7.749, "load_time_ms": 3.779, "sample_time_ms": 15525.585, "num_steps_sampled": 2472723, "num_steps_trained": 2472723}, "episode_reward_min": 55.27430602076245, "episode_reward_mean": 561.8486989756889, "done": false, "time_total_s": 1637.349634885788, "custom_metrics": {"cost2_min": -49.811870677574156, "cost2_max": -13.95561271542882, "system_level_velocity_min": 11.96307094113317, "outflow_rate_max": 1319.0812526346929, "cost1_max": 220.45474727694187, "cost1_min": 22.910827587391136, "cost2_mean": -34.243865900267686, "system_level_velocity_mean": 15.86776645063941, "outflow_rate_mean": 1169.8205062520478, "system_level_velocity_max": 18.727333410607656, "cost1_mean": 188.7339663871952, "outflow_rate_min": 475.3770657418198}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409698, "timesteps_since_restore": 2472723, "episodes_total": 2954, "policy_reward_mean": {}, "episode_reward_max": 625.7328381926775, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38947, "iterations_since_restore": 64, "training_iteration": 64, "episode_len_mean": 319.2, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1637.349634885788, "timesteps_total": 2472723, "date": "2019-05-21_03-34-58", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d999b0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 42}
{"time_this_iter_s": 27.31049394607544, "hostname": "flow-main", "info": {"default": {"kl": 0.020697137340903282, "entropy": 1.3430988788604736, "policy_loss": -0.014942201785743237, "cur_lr": 0.0005000000237487257, "total_loss": 79.44571685791016, "cur_kl_coeff": 0.22500000894069672, "vf_loss": 79.45600128173828, "vf_explained_var": 0.7531570792198181}, "grad_time_ms": 9204.785, "update_time_ms": 7.674, "load_time_ms": 3.721, "sample_time_ms": 15858.139, "num_steps_sampled": 2510103, "num_steps_trained": 2510103}, "episode_reward_min": 55.27430602076245, "episode_reward_mean": 562.7338685236501, "done": false, "time_total_s": 1664.6601288318634, "custom_metrics": {"cost2_min": -49.811870677574156, "cost2_max": -13.95561271542882, "system_level_velocity_min": 11.99943841908515, "outflow_rate_max": 1319.0812526346929, "cost1_max": 220.48192379555343, "cost1_min": 22.910827587391136, "cost2_mean": -34.79965110927288, "system_level_velocity_mean": 15.918339982355585, "outflow_rate_mean": 1175.6612240024915, "system_level_velocity_max": 18.727333410607656, "cost1_mean": 189.03343265913693, "outflow_rate_min": 475.3770657418198}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409726, "timesteps_since_restore": 2510103, "episodes_total": 3005, "policy_reward_mean": {}, "episode_reward_max": 625.7328381926775, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37380, "iterations_since_restore": 65, "training_iteration": 65, "episode_len_mean": 319.2, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1664.6601288318634, "timesteps_total": 2510103, "date": "2019-05-21_03-35-26", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99e80>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 51}
{"time_this_iter_s": 26.017317533493042, "hostname": "flow-main", "info": {"default": {"kl": 0.015242845751345158, "entropy": 1.348389744758606, "policy_loss": -0.013454974628984928, "cur_lr": 0.0005000000237487257, "total_loss": 67.7327880859375, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 67.74109649658203, "vf_explained_var": 0.7837944030761719}, "grad_time_ms": 9186.473, "update_time_ms": 7.747, "load_time_ms": 3.742, "sample_time_ms": 15940.305, "num_steps_sampled": 2547376, "num_steps_trained": 2547376}, "episode_reward_min": 496.89975311289334, "episode_reward_mean": 575.9593920177658, "done": false, "time_total_s": 1690.6774463653564, "custom_metrics": {"cost2_min": -50.497163872316946, "cost2_max": -23.695837184448155, "system_level_velocity_min": 12.408957240558252, "outflow_rate_max": 1330.5257053072626, "cost1_max": 220.48192379555343, "cost1_min": 149.10348190543237, "cost2_mean": -35.23057550799002, "system_level_velocity_mean": 16.246907680093578, "outflow_rate_mean": 1204.040325778702, "system_level_velocity_max": 18.35366893685306, "cost1_mean": 196.66704254559158, "outflow_rate_min": 972.0352830809742}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409752, "timesteps_since_restore": 2547376, "episodes_total": 3054, "policy_reward_mean": {}, "episode_reward_max": 614.612479361874, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37273, "iterations_since_restore": 66, "training_iteration": 66, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1690.6774463653564, "timesteps_total": 2547376, "date": "2019-05-21_03-35-52", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d995f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabc18>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 23.007673025131226, "hostname": "flow-main", "info": {"default": {"kl": 0.015340029262006283, "entropy": 1.3516581058502197, "policy_loss": -0.011944347992539406, "cur_lr": 0.0005000000237487257, "total_loss": 76.61066436767578, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 76.617431640625, "vf_explained_var": 0.6999734044075012}, "grad_time_ms": 9053.488, "update_time_ms": 7.787, "load_time_ms": 3.839, "sample_time_ms": 15895.245, "num_steps_sampled": 2583150, "num_steps_trained": 2583150}, "episode_reward_min": 496.89975311289334, "episode_reward_mean": 571.9135462175185, "done": false, "time_total_s": 1713.6851193904877, "custom_metrics": {"cost2_min": -50.497163872316946, "cost2_max": -25.408659675270215, "system_level_velocity_min": 12.408957240558252, "outflow_rate_max": 1330.5257053072626, "cost1_max": 219.45460040826885, "cost1_min": 149.10348190543237, "cost2_mean": -35.12635799312375, "system_level_velocity_mean": 16.350028998867916, "outflow_rate_mean": 1204.7684897776487, "system_level_velocity_max": 18.35366893685306, "cost1_mean": 197.77736844533382, "outflow_rate_min": 972.0352830809742}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409775, "timesteps_since_restore": 2583150, "episodes_total": 3094, "policy_reward_mean": {}, "episode_reward_max": 614.612479361874, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35774, "iterations_since_restore": 67, "training_iteration": 67, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1713.6851193904877, "timesteps_total": 2583150, "date": "2019-05-21_03-36-15", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d999b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d997b8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 24.416223764419556, "hostname": "flow-main", "info": {"default": {"kl": 0.01619735173881054, "entropy": 1.3509999513626099, "policy_loss": -0.013996259309351444, "cur_lr": 0.0005000000237487257, "total_loss": 70.7144775390625, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 70.72300720214844, "vf_explained_var": 0.7309272885322571}, "grad_time_ms": 9092.816, "update_time_ms": 7.885, "load_time_ms": 3.851, "sample_time_ms": 15892.371, "num_steps_sampled": 2620301, "num_steps_trained": 2620301}, "episode_reward_min": 496.89975311289334, "episode_reward_mean": 569.7679191056983, "done": false, "time_total_s": 1738.1013431549072, "custom_metrics": {"cost2_min": -48.405541043680586, "cost2_max": -23.585862097925627, "system_level_velocity_min": 12.466191595858813, "outflow_rate_max": 1315.4895425513814, "cost1_max": 219.45460040826885, "cost1_min": 151.82134684718477, "cost2_mean": -34.81293627470686, "system_level_velocity_mean": 16.33576097411946, "outflow_rate_mean": 1196.45074834422, "system_level_velocity_max": 18.35366893685306, "cost1_mean": 197.56894333073805, "outflow_rate_min": 972.0352830809742}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409799, "timesteps_since_restore": 2620301, "episodes_total": 3134, "policy_reward_mean": {}, "episode_reward_max": 614.612479361874, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37151, "iterations_since_restore": 68, "training_iteration": 68, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1738.1013431549072, "timesteps_total": 2620301, "date": "2019-05-21_03-36-39", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4860>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 24.335800886154175, "hostname": "flow-main", "info": {"default": {"kl": 0.015592850744724274, "entropy": 1.3457592725753784, "policy_loss": -0.0135293984785676, "cur_lr": 0.0005000000237487257, "total_loss": 85.88661193847656, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 85.8948745727539, "vf_explained_var": 0.7290570139884949}, "grad_time_ms": 9050.181, "update_time_ms": 7.612, "load_time_ms": 3.845, "sample_time_ms": 15837.485, "num_steps_sampled": 2656773, "num_steps_trained": 2656773}, "episode_reward_min": 491.5023265870581, "episode_reward_mean": 569.7069218556804, "done": false, "time_total_s": 1762.4371440410614, "custom_metrics": {"cost2_min": -54.867776574054574, "cost2_max": -21.770424353723456, "system_level_velocity_min": 12.11098583563857, "outflow_rate_max": 1297.2925661569286, "cost1_max": 219.4502037100048, "cost1_min": 147.11661943928235, "cost2_mean": -33.96544072872968, "system_level_velocity_mean": 16.241893588515143, "outflow_rate_mean": 1192.0097129423293, "system_level_velocity_max": 18.269078596223846, "cost1_mean": 196.55128876393672, "outflow_rate_min": 972.4107951133087}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409824, "timesteps_since_restore": 2656773, "episodes_total": 3194, "policy_reward_mean": {}, "episode_reward_max": 609.2409594729796, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36472, "iterations_since_restore": 69, "training_iteration": 69, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1762.4371440410614, "timesteps_total": 2656773, "date": "2019-05-21_03-37-04", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d964e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4748>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 60}
{"time_this_iter_s": 24.049938678741455, "hostname": "flow-main", "info": {"default": {"kl": 0.013802534900605679, "entropy": 1.3519271612167358, "policy_loss": -0.012402143329381943, "cur_lr": 0.0005000000237487257, "total_loss": 70.14253997802734, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 70.15027618408203, "vf_explained_var": 0.7207889556884766}, "grad_time_ms": 9158.319, "update_time_ms": 7.883, "load_time_ms": 3.702, "sample_time_ms": 15741.342, "num_steps_sampled": 2692872, "num_steps_trained": 2692872}, "episode_reward_min": 491.5023265870581, "episode_reward_mean": 569.6283259180991, "done": false, "time_total_s": 1786.4870827198029, "custom_metrics": {"cost2_min": -54.867776574054574, "cost2_max": -21.770424353723456, "system_level_velocity_min": 12.11098583563857, "outflow_rate_max": 1297.2925661569286, "cost1_max": 218.69508117024995, "cost1_min": 147.11661943928235, "cost2_mean": -33.2189602713552, "system_level_velocity_mean": 16.30522639978242, "outflow_rate_mean": 1194.4220628810142, "system_level_velocity_max": 18.22927832180349, "cost1_mean": 197.3112909001104, "outflow_rate_min": 972.4107951133087}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409848, "timesteps_since_restore": 2692872, "episodes_total": 3234, "policy_reward_mean": {}, "episode_reward_max": 607.4542101846413, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36099, "iterations_since_restore": 70, "training_iteration": 70, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1786.4870827198029, "timesteps_total": 2692872, "date": "2019-05-21_03-37-28", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89c50>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 25.39166498184204, "hostname": "flow-main", "info": {"default": {"kl": 0.015421300195157528, "entropy": 1.3385754823684692, "policy_loss": -0.013606265187263489, "cur_lr": 0.0005000000237487257, "total_loss": 73.25048065185547, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 73.25888061523438, "vf_explained_var": 0.7309561371803284}, "grad_time_ms": 9153.853, "update_time_ms": 7.962, "load_time_ms": 3.752, "sample_time_ms": 15891.883, "num_steps_sampled": 2729499, "num_steps_trained": 2729499}, "episode_reward_min": 57.32083914855541, "episode_reward_mean": 563.1366375807887, "done": false, "time_total_s": 1811.878747701645, "custom_metrics": {"cost2_min": -47.70877731677962, "cost2_max": -14.395020313856108, "system_level_velocity_min": 12.11098583563857, "outflow_rate_max": 1294.426536867343, "cost1_max": 218.69508117024995, "cost1_min": 22.91588871757066, "cost2_mean": -32.573697576820834, "system_level_velocity_mean": 16.332218208342038, "outflow_rate_mean": 1186.8733368427934, "system_level_velocity_max": 18.281075845783292, "cost1_mean": 195.71175957464186, "outflow_rate_min": 480.4101308344419}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409873, "timesteps_since_restore": 2729499, "episodes_total": 3275, "policy_reward_mean": {}, "episode_reward_max": 607.4542101846413, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36627, "iterations_since_restore": 71, "training_iteration": 71, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1811.878747701645, "timesteps_total": 2729499, "date": "2019-05-21_03-37-53", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabc50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96320>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 41}
{"time_this_iter_s": 24.229922771453857, "hostname": "flow-main", "info": {"default": {"kl": 0.015122009441256523, "entropy": 1.3393471240997314, "policy_loss": -0.013334110379219055, "cur_lr": 0.0005000000237487257, "total_loss": 91.81094360351562, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 91.81918334960938, "vf_explained_var": 0.6851821541786194}, "grad_time_ms": 9015.294, "update_time_ms": 7.958, "load_time_ms": 3.735, "sample_time_ms": 15847.437, "num_steps_sampled": 2765825, "num_steps_trained": 2765825}, "episode_reward_min": 57.32083914855541, "episode_reward_mean": 558.6422426878602, "done": false, "time_total_s": 1836.1086704730988, "custom_metrics": {"cost2_min": -47.21155663050931, "cost2_max": -14.395020313856108, "system_level_velocity_min": 10.813484497949313, "outflow_rate_max": 1303.046154725596, "cost1_max": 219.22164305450696, "cost1_min": 22.91588871757066, "cost2_mean": -32.06366280187889, "system_level_velocity_mean": 16.271271071120676, "outflow_rate_mean": 1177.0791951895792, "system_level_velocity_max": 18.41138588805635, "cost1_mean": 194.8860724708134, "outflow_rate_min": 480.4101308344419}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409897, "timesteps_since_restore": 2765825, "episodes_total": 3330, "policy_reward_mean": {}, "episode_reward_max": 604.8119431729748, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36326, "iterations_since_restore": 72, "training_iteration": 72, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1836.1086704730988, "timesteps_total": 2765825, "date": "2019-05-21_03-38-17", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db48d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4240>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 55}
{"time_this_iter_s": 23.778762578964233, "hostname": "flow-main", "info": {"default": {"kl": 0.014626314863562584, "entropy": 1.3451199531555176, "policy_loss": -0.013805552385747433, "cur_lr": 0.0005000000237487257, "total_loss": 68.0547103881836, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 68.0635757446289, "vf_explained_var": 0.742017924785614}, "grad_time_ms": 8985.981, "update_time_ms": 8.06, "load_time_ms": 3.625, "sample_time_ms": 15761.251, "num_steps_sampled": 2802434, "num_steps_trained": 2802434}, "episode_reward_min": 490.1247465337591, "episode_reward_mean": 562.6583273061738, "done": false, "time_total_s": 1859.887433052063, "custom_metrics": {"cost2_min": -47.21155663050931, "cost2_max": -17.74519226257747, "system_level_velocity_min": 10.813484497949313, "outflow_rate_max": 1303.046154725596, "cost1_max": 219.22164305450696, "cost1_min": 135.99879479794788, "cost2_mean": -32.175202400742144, "system_level_velocity_mean": 16.078851256105782, "outflow_rate_mean": 1178.1851719652911, "system_level_velocity_max": 18.41138588805635, "cost1_mean": 194.6611850264362, "outflow_rate_min": 964.6670311084265}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409921, "timesteps_since_restore": 2802434, "episodes_total": 3375, "policy_reward_mean": {}, "episode_reward_max": 605.6030548185763, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36609, "iterations_since_restore": 73, "training_iteration": 73, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1859.887433052063, "timesteps_total": 2802434, "date": "2019-05-21_03-38-41", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d895f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89a20>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 45}
{"time_this_iter_s": 24.12156367301941, "hostname": "flow-main", "info": {"default": {"kl": 0.01485714316368103, "entropy": 1.33674156665802, "policy_loss": -0.012481607496738434, "cur_lr": 0.0005000000237487257, "total_loss": 67.19793701171875, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 67.20540618896484, "vf_explained_var": 0.748502790927887}, "grad_time_ms": 9008.513, "update_time_ms": 8.023, "load_time_ms": 3.668, "sample_time_ms": 15574.922, "num_steps_sampled": 2838832, "num_steps_trained": 2838832}, "episode_reward_min": 485.18351642023555, "episode_reward_mean": 566.2485895259931, "done": false, "time_total_s": 1884.0089967250824, "custom_metrics": {"cost2_min": -46.27165230564396, "cost2_max": -17.74519226257747, "system_level_velocity_min": 11.385162691738879, "outflow_rate_max": 1302.1586357236274, "cost1_max": 219.22164305450696, "cost1_min": 139.5899270513683, "cost2_mean": -32.398378238813116, "system_level_velocity_mean": 16.09756883769556, "outflow_rate_mean": 1182.959145277797, "system_level_velocity_max": 18.269152505691583, "cost1_mean": 195.01815623540085, "outflow_rate_min": 964.6670311084265}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409945, "timesteps_since_restore": 2838832, "episodes_total": 3415, "policy_reward_mean": {}, "episode_reward_max": 620.0586768159629, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36398, "iterations_since_restore": 74, "training_iteration": 74, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1884.0089967250824, "timesteps_total": 2838832, "date": "2019-05-21_03-39-05", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4940>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.248596668243408, "hostname": "flow-main", "info": {"default": {"kl": 0.015523410402238369, "entropy": 1.3348957300186157, "policy_loss": -0.013212413527071476, "cur_lr": 0.0005000000237487257, "total_loss": 80.0256118774414, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 80.03358459472656, "vf_explained_var": 0.7043658494949341}, "grad_time_ms": 8990.984, "update_time_ms": 8.067, "load_time_ms": 3.717, "sample_time_ms": 15486.627, "num_steps_sampled": 2875826, "num_steps_trained": 2875826}, "episode_reward_min": 485.18351642023555, "episode_reward_mean": 563.1619676120137, "done": false, "time_total_s": 1910.2575933933258, "custom_metrics": {"cost2_min": -49.887592401234315, "cost2_max": -19.896766324068018, "system_level_velocity_min": 11.385162691738879, "outflow_rate_max": 1302.1586357236274, "cost1_max": 219.68703126108602, "cost1_min": 139.5899270513683, "cost2_mean": -33.879328430321586, "system_level_velocity_mean": 16.23213777640128, "outflow_rate_mean": 1180.8520420614427, "system_level_velocity_max": 18.366952020739678, "cost1_mean": 196.18604220713712, "outflow_rate_min": 965.5865053939198}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409972, "timesteps_since_restore": 2875826, "episodes_total": 3466, "policy_reward_mean": {}, "episode_reward_max": 620.0586768159629, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36994, "iterations_since_restore": 75, "training_iteration": 75, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1910.2575933933258, "timesteps_total": 2875826, "date": "2019-05-21_03-39-32", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db48d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4400>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 51}
{"time_this_iter_s": 25.679646968841553, "hostname": "flow-main", "info": {"default": {"kl": 0.013365301303565502, "entropy": 1.3331900835037231, "policy_loss": -0.011392693035304546, "cur_lr": 0.0005000000237487257, "total_loss": 81.01227569580078, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 81.0191650390625, "vf_explained_var": 0.6853903532028198}, "grad_time_ms": 9074.226, "update_time_ms": 7.93, "load_time_ms": 3.631, "sample_time_ms": 15370.27, "num_steps_sampled": 2911538, "num_steps_trained": 2911538}, "episode_reward_min": 366.64301914497196, "episode_reward_mean": 554.2494554446589, "done": false, "time_total_s": 1935.9372403621674, "custom_metrics": {"cost2_min": -49.887592401234315, "cost2_max": -12.884132483306972, "system_level_velocity_min": 13.322685196904294, "outflow_rate_max": 1285.311321553524, "cost1_max": 220.67855145651856, "cost1_min": 141.66590151703025, "cost2_mean": -34.38444337804762, "system_level_velocity_mean": 16.186466612964534, "outflow_rate_mean": 1170.6555196820057, "system_level_velocity_max": 18.509526953373054, "cost1_mean": 194.3070814664666, "outflow_rate_min": 993.1032601595517}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558409997, "timesteps_since_restore": 2911538, "episodes_total": 3515, "policy_reward_mean": {}, "episode_reward_max": 594.8768157894048, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35712, "iterations_since_restore": 76, "training_iteration": 76, "episode_len_mean": 323.62, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1935.9372403621674, "timesteps_total": 2911538, "date": "2019-05-21_03-39-57", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4c18>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 26.288261890411377, "hostname": "flow-main", "info": {"default": {"kl": 0.01473031286150217, "entropy": 1.336622714996338, "policy_loss": -0.013013902120292187, "cur_lr": 0.0005000000237487257, "total_loss": 63.47986602783203, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 63.4879035949707, "vf_explained_var": 0.7589235305786133}, "grad_time_ms": 9403.577, "update_time_ms": 8.181, "load_time_ms": 3.503, "sample_time_ms": 15368.22, "num_steps_sampled": 2948788, "num_steps_trained": 2948788}, "episode_reward_min": 366.64301914497196, "episode_reward_mean": 551.457053711715, "done": false, "time_total_s": 1962.2255022525787, "custom_metrics": {"cost2_min": -49.887592401234315, "cost2_max": -12.884132483306972, "system_level_velocity_min": 12.323641414403578, "outflow_rate_max": 1285.311321553524, "cost1_max": 220.67855145651856, "cost1_min": 141.66590151703025, "cost2_mean": -35.08361562691288, "system_level_velocity_mean": 15.903279582169557, "outflow_rate_mean": 1161.237278528416, "system_level_velocity_max": 18.509526953373054, "cost1_mean": 190.88735239441056, "outflow_rate_min": 955.7009980867349}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410024, "timesteps_since_restore": 2948788, "episodes_total": 3555, "policy_reward_mean": {}, "episode_reward_max": 595.1050119623226, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37250, "iterations_since_restore": 77, "training_iteration": 77, "episode_len_mean": 323.62, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1962.2255022525787, "timesteps_total": 2948788, "date": "2019-05-21_03-40-24", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da94e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9128>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.096853017807007, "hostname": "flow-main", "info": {"default": {"kl": 0.014134323224425316, "entropy": 1.3326915502548218, "policy_loss": -0.011225157417356968, "cur_lr": 0.0005000000237487257, "total_loss": 94.76612091064453, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 94.77257537841797, "vf_explained_var": 0.6873741149902344}, "grad_time_ms": 9382.124, "update_time_ms": 8.337, "load_time_ms": 3.351, "sample_time_ms": 15558.209, "num_steps_sampled": 2984910, "num_steps_trained": 2984910}, "episode_reward_min": 62.9916620795341, "episode_reward_mean": 548.0389731365747, "done": false, "time_total_s": 1988.3223552703857, "custom_metrics": {"cost2_min": -52.61320006049078, "cost2_max": -9.323705334375022, "system_level_velocity_min": 12.323641414403578, "outflow_rate_max": 1300.4900649350648, "cost1_max": 219.1379627613333, "cost1_min": 24.788300763740345, "cost2_mean": -33.916620345440684, "system_level_velocity_mean": 16.166199120786292, "outflow_rate_mean": 1164.06400613892, "system_level_velocity_max": 18.432029187838932, "cost1_mean": 191.22622592830413, "outflow_rate_min": 499.2141957283318}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410050, "timesteps_since_restore": 2984910, "episodes_total": 3608, "policy_reward_mean": {}, "episode_reward_max": 595.1050119623226, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36122, "iterations_since_restore": 78, "training_iteration": 78, "episode_len_mean": 319.93, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 1988.3223552703857, "timesteps_total": 2984910, "date": "2019-05-21_03-40-50", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db40b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4160>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 53}
{"time_this_iter_s": 24.219691514968872, "hostname": "flow-main", "info": {"default": {"kl": 0.015091431327164173, "entropy": 1.3399204015731812, "policy_loss": -0.013134445063769817, "cur_lr": 0.0005000000237487257, "total_loss": 74.76539611816406, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 74.7734375, "vf_explained_var": 0.7333569526672363}, "grad_time_ms": 9431.451, "update_time_ms": 8.481, "load_time_ms": 3.483, "sample_time_ms": 15494.851, "num_steps_sampled": 3020778, "num_steps_trained": 3020778}, "episode_reward_min": 62.9916620795341, "episode_reward_mean": 554.5067512627226, "done": false, "time_total_s": 2012.5420467853546, "custom_metrics": {"cost2_min": -56.85739504846856, "cost2_max": -9.323705334375022, "system_level_velocity_min": 12.326382927103547, "outflow_rate_max": 1300.930540352505, "cost1_max": 219.23711945682456, "cost1_min": 24.788300763740345, "cost2_mean": -33.829141551716646, "system_level_velocity_mean": 16.451052466699174, "outflow_rate_mean": 1180.4593943515747, "system_level_velocity_max": 18.432029187838932, "cost1_mean": 195.19381722648475, "outflow_rate_min": 499.2141957283318}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410074, "timesteps_since_restore": 3020778, "episodes_total": 3655, "policy_reward_mean": {}, "episode_reward_max": 595.9415563894605, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35868, "iterations_since_restore": 79, "training_iteration": 79, "episode_len_mean": 321.03, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2012.5420467853546, "timesteps_total": 3020778, "date": "2019-05-21_03-41-14", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96b70>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 47}
{"time_this_iter_s": 24.547399282455444, "hostname": "flow-main", "info": {"default": {"kl": 0.014261634089052677, "entropy": 1.3482314348220825, "policy_loss": -0.011470743454992771, "cur_lr": 0.0005000000237487257, "total_loss": 72.81423950195312, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 72.8208999633789, "vf_explained_var": 0.729713499546051}, "grad_time_ms": 9435.668, "update_time_ms": 8.542, "load_time_ms": 3.63, "sample_time_ms": 15539.442, "num_steps_sampled": 3056574, "num_steps_trained": 3056574}, "episode_reward_min": 498.31022988217575, "episode_reward_mean": 562.7384353898237, "done": false, "time_total_s": 2037.08944606781, "custom_metrics": {"cost2_min": -56.85739504846856, "cost2_max": -18.616521917605674, "system_level_velocity_min": 12.326382927103547, "outflow_rate_max": 1300.930540352505, "cost1_max": 220.28227988925877, "cost1_min": 148.5617615012189, "cost2_mean": -34.23594129853097, "system_level_velocity_mean": 16.518625343234373, "outflow_rate_mean": 1194.7932904789047, "system_level_velocity_max": 18.62086433680109, "cost1_mean": 198.51072692845642, "outflow_rate_min": 1008.0599348867447}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410099, "timesteps_since_restore": 3056574, "episodes_total": 3696, "policy_reward_mean": {}, "episode_reward_max": 598.9269892326586, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35796, "iterations_since_restore": 80, "training_iteration": 80, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2037.08944606781, "timesteps_total": 3056574, "date": "2019-05-21_03-41-39", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da94e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9128>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 41}
{"time_this_iter_s": 24.58568811416626, "hostname": "flow-main", "info": {"default": {"kl": 0.015127938240766525, "entropy": 1.3584973812103271, "policy_loss": -0.013405238278210163, "cur_lr": 0.0005000000237487257, "total_loss": 82.86664581298828, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 82.87494659423828, "vf_explained_var": 0.6814146041870117}, "grad_time_ms": 9410.401, "update_time_ms": 8.536, "load_time_ms": 3.623, "sample_time_ms": 15483.385, "num_steps_sampled": 3092491, "num_steps_trained": 3092491}, "episode_reward_min": 504.0135450164897, "episode_reward_mean": 559.6057632961714, "done": false, "time_total_s": 2061.6751341819763, "custom_metrics": {"cost2_min": -56.85739504846856, "cost2_max": -21.971695065937535, "system_level_velocity_min": 13.26382958030749, "outflow_rate_max": 1314.7172979163788, "cost1_max": 222.41413332875857, "cost1_min": 159.59525456628313, "cost2_mean": -34.988879927006266, "system_level_velocity_mean": 16.502535450495234, "outflow_rate_mean": 1194.5515860671294, "system_level_velocity_max": 18.733102982267525, "cost1_mean": 197.9044008794569, "outflow_rate_min": 1001.8085301682563}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410123, "timesteps_since_restore": 3092491, "episodes_total": 3738, "policy_reward_mean": {}, "episode_reward_max": 598.9269892326586, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35917, "iterations_since_restore": 81, "training_iteration": 81, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2061.6751341819763, "timesteps_total": 3092491, "date": "2019-05-21_03-42-03", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4c18>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 42}
{"time_this_iter_s": 24.682698965072632, "hostname": "flow-main", "info": {"default": {"kl": 0.014525750651955605, "entropy": 1.3435742855072021, "policy_loss": -0.013149102218449116, "cur_lr": 0.0005000000237487257, "total_loss": 84.46234893798828, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 84.47059631347656, "vf_explained_var": 0.7278106212615967}, "grad_time_ms": 9406.886, "update_time_ms": 8.527, "load_time_ms": 3.617, "sample_time_ms": 15531.171, "num_steps_sampled": 3128875, "num_steps_trained": 3128875}, "episode_reward_min": 484.1734231154179, "episode_reward_mean": 555.3322780242122, "done": false, "time_total_s": 2086.357833147049, "custom_metrics": {"cost2_min": -55.2067518715569, "cost2_max": -26.427830670574036, "system_level_velocity_min": 12.717127886748797, "outflow_rate_max": 1314.7172979163788, "cost1_max": 222.41413332875857, "cost1_min": 151.57904332648906, "cost2_mean": -36.15545154100156, "system_level_velocity_mean": 16.345188462688633, "outflow_rate_mean": 1188.1127003656068, "system_level_velocity_max": 18.733102982267525, "cost1_mean": 196.0182018314142, "outflow_rate_min": 977.3467356173237}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410148, "timesteps_since_restore": 3128875, "episodes_total": 3795, "policy_reward_mean": {}, "episode_reward_max": 599.4856725543286, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36384, "iterations_since_restore": 82, "training_iteration": 82, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2086.357833147049, "timesteps_total": 3128875, "date": "2019-05-21_03-42-28", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabb00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab390>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 57}
{"time_this_iter_s": 24.408970832824707, "hostname": "flow-main", "info": {"default": {"kl": 0.014390164986252785, "entropy": 1.352108120918274, "policy_loss": -0.012531528249382973, "cur_lr": 0.0005000000237487257, "total_loss": 68.44245147705078, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 68.45012664794922, "vf_explained_var": 0.728206992149353}, "grad_time_ms": 9526.25, "update_time_ms": 8.459, "load_time_ms": 3.741, "sample_time_ms": 15474.83, "num_steps_sampled": 3165136, "num_steps_trained": 3165136}, "episode_reward_min": 484.1734231154179, "episode_reward_mean": 553.493320647207, "done": false, "time_total_s": 2110.7668039798737, "custom_metrics": {"cost2_min": -55.2067518715569, "cost2_max": -14.964341914820636, "system_level_velocity_min": 12.717127886748797, "outflow_rate_max": 1309.4710412552115, "cost1_max": 221.1267488616703, "cost1_min": 151.57904332648906, "cost2_mean": -36.463992773997234, "system_level_velocity_mean": 16.155143857408927, "outflow_rate_mean": 1177.518841688365, "system_level_velocity_max": 18.6552286759829, "cost1_mean": 193.9651053744869, "outflow_rate_min": 977.3467356173237}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410173, "timesteps_since_restore": 3165136, "episodes_total": 3836, "policy_reward_mean": {}, "episode_reward_max": 599.4856725543286, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36261, "iterations_since_restore": 83, "training_iteration": 83, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2110.7668039798737, "timesteps_total": 3165136, "date": "2019-05-21_03-42-53", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da95f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9a20>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 41}
{"time_this_iter_s": 25.27578568458557, "hostname": "flow-main", "info": {"default": {"kl": 0.01565578766167164, "entropy": 1.3384939432144165, "policy_loss": -0.014205878600478172, "cur_lr": 0.0005000000237487257, "total_loss": 78.0689468383789, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 78.07786560058594, "vf_explained_var": 0.7212801575660706}, "grad_time_ms": 9503.175, "update_time_ms": 8.674, "load_time_ms": 3.768, "sample_time_ms": 15612.323, "num_steps_sampled": 3200431, "num_steps_trained": 3200431}, "episode_reward_min": 56.82450415979615, "episode_reward_mean": 543.004201009038, "done": false, "time_total_s": 2136.0425896644592, "custom_metrics": {"cost2_min": -55.2067518715569, "cost2_max": -14.313813930966862, "system_level_velocity_min": 12.69283212318297, "outflow_rate_max": 1306.022375984671, "cost1_max": 219.7281207074004, "cost1_min": 23.042840213753877, "cost2_mean": -35.692896521681305, "system_level_velocity_mean": 16.190578976852144, "outflow_rate_mean": 1160.4153216743066, "system_level_velocity_max": 18.610705209373407, "cost1_mean": 191.36903481619825, "outflow_rate_min": 473.20973104725}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410198, "timesteps_since_restore": 3200431, "episodes_total": 3880, "policy_reward_mean": {}, "episode_reward_max": 596.8412734929595, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35295, "iterations_since_restore": 84, "training_iteration": 84, "episode_len_mean": 320.92, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2136.0425896644592, "timesteps_total": 3200431, "date": "2019-05-21_03-43-18", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4d30>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 44}
{"time_this_iter_s": 24.18344783782959, "hostname": "flow-main", "info": {"default": {"kl": 0.013507872819900513, "entropy": 1.3474371433258057, "policy_loss": -0.012926178984344006, "cur_lr": 0.0005000000237487257, "total_loss": 100.81137084960938, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 100.81973266601562, "vf_explained_var": 0.630096971988678}, "grad_time_ms": 9336.717, "update_time_ms": 8.603, "load_time_ms": 3.77, "sample_time_ms": 15572.765, "num_steps_sampled": 3235133, "num_steps_trained": 3235133}, "episode_reward_min": 56.82450415979615, "episode_reward_mean": 539.9664898695153, "done": false, "time_total_s": 2160.226037502289, "custom_metrics": {"cost2_min": -46.83919696328603, "cost2_max": -14.313813930966862, "system_level_velocity_min": 12.69283212318297, "outflow_rate_max": 1315.301463414634, "cost1_max": 219.87853932050228, "cost1_min": 23.042840213753877, "cost2_mean": -34.65674216632237, "system_level_velocity_mean": 16.552483663780308, "outflow_rate_mean": 1168.0536213521325, "system_level_velocity_max": 18.70098863540911, "cost1_mean": 194.83176322908938, "outflow_rate_min": 473.20973104725}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410222, "timesteps_since_restore": 3235133, "episodes_total": 3934, "policy_reward_mean": {}, "episode_reward_max": 593.2304364251085, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34702, "iterations_since_restore": 85, "training_iteration": 85, "episode_len_mean": 320.64, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2160.226037502289, "timesteps_total": 3235133, "date": "2019-05-21_03-43-42", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4cf8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 54}
{"time_this_iter_s": 22.991387605667114, "hostname": "flow-main", "info": {"default": {"kl": 0.0139605812728405, "entropy": 1.3525961637496948, "policy_loss": -0.013028853572905064, "cur_lr": 0.0005000000237487257, "total_loss": 86.69844055175781, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 86.7067642211914, "vf_explained_var": 0.6367403268814087}, "grad_time_ms": 9168.793, "update_time_ms": 8.706, "load_time_ms": 3.778, "sample_time_ms": 15471.031, "num_steps_sampled": 3269351, "num_steps_trained": 3269351}, "episode_reward_min": 500.58339626651883, "episode_reward_mean": 545.3738481038419, "done": false, "time_total_s": 2183.217425107956, "custom_metrics": {"cost2_min": -46.80277049403291, "cost2_max": -25.318352906829148, "system_level_velocity_min": 13.05547840107399, "outflow_rate_max": 1315.301463414634, "cost1_max": 221.12532284119635, "cost1_min": 155.59382000753527, "cost2_mean": -34.56005700480592, "system_level_velocity_mean": 16.724451555848805, "outflow_rate_mean": 1186.2360193719642, "system_level_velocity_max": 18.725467437920145, "cost1_mean": 199.3860235547963, "outflow_rate_min": 1013.2644140218455}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410245, "timesteps_since_restore": 3269351, "episodes_total": 3977, "policy_reward_mean": {}, "episode_reward_max": 584.0904843223218, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34218, "iterations_since_restore": 86, "training_iteration": 86, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2183.217425107956, "timesteps_total": 3269351, "date": "2019-05-21_03-44-05", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db47b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4f60>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 43}
{"time_this_iter_s": 23.196815013885498, "hostname": "flow-main", "info": {"default": {"kl": 0.015375640243291855, "entropy": 1.355244755744934, "policy_loss": -0.014612208120524883, "cur_lr": 0.0005000000237487257, "total_loss": 71.11436462402344, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 71.123779296875, "vf_explained_var": 0.7507117390632629}, "grad_time_ms": 8838.317, "update_time_ms": 8.469, "load_time_ms": 3.805, "sample_time_ms": 15492.903, "num_steps_sampled": 3304695, "num_steps_trained": 3304695}, "episode_reward_min": 487.89858670471835, "episode_reward_mean": 545.2071681812168, "done": false, "time_total_s": 2206.4142401218414, "custom_metrics": {"cost2_min": -51.24497165974301, "cost2_max": -25.318352906829148, "system_level_velocity_min": 12.484672116550428, "outflow_rate_max": 1305.926709183674, "cost1_max": 221.12532284119635, "cost1_min": 147.70598850425623, "cost2_mean": -34.98276578789348, "system_level_velocity_mean": 16.68357436008167, "outflow_rate_mean": 1183.369263920285, "system_level_velocity_max": 18.725467437920145, "cost1_mean": 198.89902698098402, "outflow_rate_min": 936.0551686965109}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410268, "timesteps_since_restore": 3304695, "episodes_total": 4018, "policy_reward_mean": {}, "episode_reward_max": 582.6861600516721, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35344, "iterations_since_restore": 87, "training_iteration": 87, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2206.4142401218414, "timesteps_total": 3304695, "date": "2019-05-21_03-44-28", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4b00>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 41}
{"time_this_iter_s": 23.252533197402954, "hostname": "flow-main", "info": {"default": {"kl": 0.014337556436657906, "entropy": 1.359442949295044, "policy_loss": -0.012926120311021805, "cur_lr": 0.0005000000237487257, "total_loss": 101.4586181640625, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 101.4666976928711, "vf_explained_var": 0.6123663187026978}, "grad_time_ms": 8683.621, "update_time_ms": 8.104, "load_time_ms": 3.822, "sample_time_ms": 15362.333, "num_steps_sampled": 3338514, "num_steps_trained": 3338514}, "episode_reward_min": 485.5243079591105, "episode_reward_mean": 547.6392903036653, "done": false, "time_total_s": 2229.6667733192444, "custom_metrics": {"cost2_min": -51.24497165974301, "cost2_max": -25.318352906829148, "system_level_velocity_min": 12.484672116550428, "outflow_rate_max": 1300.1955703432773, "cost1_max": 219.32997675237155, "cost1_min": 147.70598850425623, "cost2_mean": -34.50496899756415, "system_level_velocity_mean": 16.887881903873883, "outflow_rate_mean": 1191.4837651793816, "system_level_velocity_max": 18.583053376640283, "cost1_mean": 200.87887487718996, "outflow_rate_min": 936.0551686965109}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410292, "timesteps_since_restore": 3338514, "episodes_total": 4069, "policy_reward_mean": {}, "episode_reward_max": 587.3450655590582, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33819, "iterations_since_restore": 88, "training_iteration": 88, "episode_len_mean": 324.8, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2229.6667733192444, "timesteps_total": 3338514, "date": "2019-05-21_03-44-52", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab390>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 51}
{"time_this_iter_s": 25.759767770767212, "hostname": "flow-main", "info": {"default": {"kl": 0.014020812697708607, "entropy": 1.3540613651275635, "policy_loss": -0.012376739643514156, "cur_lr": 0.0005000000237487257, "total_loss": 77.24253845214844, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 77.25018310546875, "vf_explained_var": 0.7385082840919495}, "grad_time_ms": 8661.92, "update_time_ms": 7.911, "load_time_ms": 3.745, "sample_time_ms": 15540.954, "num_steps_sampled": 3374206, "num_steps_trained": 3374206}, "episode_reward_min": 53.377674947126046, "episode_reward_mean": 540.0545215139759, "done": false, "time_total_s": 2255.4265410900116, "custom_metrics": {"cost2_min": -50.75593194283484, "cost2_max": -15.544289576903939, "system_level_velocity_min": 13.011118219182066, "outflow_rate_max": 1302.0015838683037, "cost1_max": 221.6150559705539, "cost1_min": 23.305129119934538, "cost2_mean": -34.6105854844522, "system_level_velocity_mean": 16.845271697303485, "outflow_rate_mean": 1176.4882627392976, "system_level_velocity_max": 18.902256990467418, "cost1_mean": 197.59019654242218, "outflow_rate_min": 511.17688865063195}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410317, "timesteps_since_restore": 3374206, "episodes_total": 4118, "policy_reward_mean": {}, "episode_reward_max": 587.3450655590582, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35692, "iterations_since_restore": 89, "training_iteration": 89, "episode_len_mean": 320.72, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2255.4265410900116, "timesteps_total": 3374206, "date": "2019-05-21_03-45-17", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da98d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9a90>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 23.64130139350891, "hostname": "flow-main", "info": {"default": {"kl": 0.012849202379584312, "entropy": 1.3522133827209473, "policy_loss": -0.01122021209448576, "cur_lr": 0.0005000000237487257, "total_loss": 73.91259002685547, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 73.91947174072266, "vf_explained_var": 0.7446224689483643}, "grad_time_ms": 8523.837, "update_time_ms": 7.594, "load_time_ms": 3.615, "sample_time_ms": 15589.448, "num_steps_sampled": 3410193, "num_steps_trained": 3410193}, "episode_reward_min": 53.35525448686541, "episode_reward_mean": 534.4359091998118, "done": false, "time_total_s": 2279.0678424835205, "custom_metrics": {"cost2_min": -50.35979071431095, "cost2_max": -15.544289576903939, "system_level_velocity_min": 12.594640267728076, "outflow_rate_max": 1302.0015838683037, "cost1_max": 221.6150559705539, "cost1_min": 23.3008007264717, "cost2_mean": -35.74272319408842, "system_level_velocity_mean": 16.49559133953562, "outflow_rate_mean": 1157.490932420086, "system_level_velocity_max": 18.949641874615153, "cost1_mean": 191.9348484150476, "outflow_rate_min": 511.17688865063195}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410341, "timesteps_since_restore": 3410193, "episodes_total": 4160, "policy_reward_mean": {}, "episode_reward_max": 586.7448718763517, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35987, "iterations_since_restore": 90, "training_iteration": 90, "episode_len_mean": 318.02, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2279.0678424835205, "timesteps_total": 3410193, "date": "2019-05-21_03-45-41", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4208>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 42}
{"time_this_iter_s": 25.377013206481934, "hostname": "flow-main", "info": {"default": {"kl": 0.014081223867833614, "entropy": 1.351487398147583, "policy_loss": -0.011640405282378197, "cur_lr": 0.0005000000237487257, "total_loss": 84.92305755615234, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 84.92993927001953, "vf_explained_var": 0.720872700214386}, "grad_time_ms": 8443.1, "update_time_ms": 7.503, "load_time_ms": 3.624, "sample_time_ms": 15751.285, "num_steps_sampled": 3447456, "num_steps_trained": 3447456}, "episode_reward_min": 53.35525448686541, "episode_reward_mean": 542.5229515719316, "done": false, "time_total_s": 2304.4448556900024, "custom_metrics": {"cost2_min": -53.14114138015373, "cost2_max": -15.551734725508584, "system_level_velocity_min": 12.516941737386954, "outflow_rate_max": 1324.667948610529, "cost1_max": 221.12227168682605, "cost1_min": 23.3008007264717, "cost2_mean": -36.90017086432315, "system_level_velocity_mean": 16.288008990314516, "outflow_rate_mean": 1165.6582075761073, "system_level_velocity_max": 18.949641874615153, "cost1_mean": 191.90903386293652, "outflow_rate_min": 511.17688865063195}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410367, "timesteps_since_restore": 3447456, "episodes_total": 4211, "policy_reward_mean": {}, "episode_reward_max": 587.1593248188678, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37263, "iterations_since_restore": 91, "training_iteration": 91, "episode_len_mean": 320.92, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2304.4448556900024, "timesteps_total": 3447456, "date": "2019-05-21_03-46-07", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab588>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 51}
{"time_this_iter_s": 23.842700004577637, "hostname": "flow-main", "info": {"default": {"kl": 0.015947146341204643, "entropy": 1.3647836446762085, "policy_loss": -0.013427690602838993, "cur_lr": 0.0005000000237487257, "total_loss": 86.29705047607422, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 86.30509948730469, "vf_explained_var": 0.6925793290138245}, "grad_time_ms": 8418.205, "update_time_ms": 7.404, "load_time_ms": 3.657, "sample_time_ms": 15693.813, "num_steps_sampled": 3482551, "num_steps_trained": 3482551}, "episode_reward_min": 57.353401616839406, "episode_reward_mean": 549.6399966960777, "done": false, "time_total_s": 2328.28755569458, "custom_metrics": {"cost2_min": -53.29467636771971, "cost2_max": -14.743175999766542, "system_level_velocity_min": 12.516941737386954, "outflow_rate_max": 1324.667948610529, "cost1_max": 221.75856262818095, "cost1_min": 24.702545663749508, "cost2_mean": -37.37764612107668, "system_level_velocity_mean": 16.474555795406555, "outflow_rate_mean": 1180.4837008957352, "system_level_velocity_max": 18.948485707484487, "cost1_mean": 195.03056946404217, "outflow_rate_min": 508.5230901032742}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410390, "timesteps_since_restore": 3482551, "episodes_total": 4259, "policy_reward_mean": {}, "episode_reward_max": 597.4727468268917, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35095, "iterations_since_restore": 92, "training_iteration": 92, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2328.28755569458, "timesteps_total": 3482551, "date": "2019-05-21_03-46-30", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db44e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4080>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 48}
{"time_this_iter_s": 24.634925365447998, "hostname": "flow-main", "info": {"default": {"kl": 0.014227273873984814, "entropy": 1.3547497987747192, "policy_loss": -0.011924097314476967, "cur_lr": 0.0005000000237487257, "total_loss": 73.99166870117188, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 73.99879455566406, "vf_explained_var": 0.765174150466919}, "grad_time_ms": 8404.655, "update_time_ms": 7.315, "load_time_ms": 3.689, "sample_time_ms": 15729.511, "num_steps_sampled": 3518746, "num_steps_trained": 3518746}, "episode_reward_min": 57.353401616839406, "episode_reward_mean": 549.6286897443804, "done": false, "time_total_s": 2352.922481060028, "custom_metrics": {"cost2_min": -53.29467636771971, "cost2_max": -14.743175999766542, "system_level_velocity_min": 12.582975390069867, "outflow_rate_max": 1314.268863841163, "cost1_max": 222.30404680185046, "cost1_min": 24.702545663749508, "cost2_mean": -37.43181761321008, "system_level_velocity_mean": 16.50114284901603, "outflow_rate_mean": 1178.2659940450153, "system_level_velocity_max": 18.948485707484487, "cost1_mean": 195.32022940968545, "outflow_rate_min": 508.5230901032742}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410415, "timesteps_since_restore": 3518746, "episodes_total": 4300, "policy_reward_mean": {}, "episode_reward_max": 597.4727468268917, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36195, "iterations_since_restore": 93, "training_iteration": 93, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2352.922481060028, "timesteps_total": 3518746, "date": "2019-05-21_03-46-55", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db44a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4048>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 41}
{"time_this_iter_s": 24.068179845809937, "hostname": "flow-main", "info": {"default": {"kl": 0.014175291173160076, "entropy": 1.3721508979797363, "policy_loss": -0.013784217648208141, "cur_lr": 0.0005000000237487257, "total_loss": 84.70088195800781, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 84.70988464355469, "vf_explained_var": 0.7010295391082764}, "grad_time_ms": 8403.153, "update_time_ms": 7.36, "load_time_ms": 3.634, "sample_time_ms": 15611.905, "num_steps_sampled": 3553874, "num_steps_trained": 3553874}, "episode_reward_min": 57.353401616839406, "episode_reward_mean": 550.4846089626045, "done": false, "time_total_s": 2376.990660905838, "custom_metrics": {"cost2_min": -49.9630127432499, "cost2_max": -14.743175999766542, "system_level_velocity_min": 12.55859930796196, "outflow_rate_max": 1323.63929112099, "cost1_max": 223.10067383913827, "cost1_min": 24.702545663749508, "cost2_mean": -36.4793201518534, "system_level_velocity_mean": 16.716083175266782, "outflow_rate_mean": 1186.797721649025, "system_level_velocity_max": 18.948485707484487, "cost1_mean": 197.61211838207524, "outflow_rate_min": 508.5230901032742}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410439, "timesteps_since_restore": 3553874, "episodes_total": 4344, "policy_reward_mean": {}, "episode_reward_max": 592.888931130813, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35128, "iterations_since_restore": 94, "training_iteration": 94, "episode_len_mean": 321.96, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2376.990660905838, "timesteps_total": 3553874, "date": "2019-05-21_03-47-19", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab898>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 44}
{"time_this_iter_s": 25.32317090034485, "hostname": "flow-main", "info": {"default": {"kl": 0.014324605464935303, "entropy": 1.3709077835083008, "policy_loss": -0.012632460333406925, "cur_lr": 0.0005000000237487257, "total_loss": 100.36686706542969, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 100.3746566772461, "vf_explained_var": 0.6768803000450134}, "grad_time_ms": 8433.037, "update_time_ms": 7.364, "load_time_ms": 3.582, "sample_time_ms": 15696.401, "num_steps_sampled": 3589604, "num_steps_trained": 3589604}, "episode_reward_min": 60.461167848134124, "episode_reward_mean": 551.1410446925623, "done": false, "time_total_s": 2402.313831806183, "custom_metrics": {"cost2_min": -48.32190444654462, "cost2_max": -16.026993107996507, "system_level_velocity_min": 11.768105441530965, "outflow_rate_max": 1323.63929112099, "cost1_max": 223.10067383913827, "cost1_min": 24.502338402821536, "cost2_mean": -35.78508948581666, "system_level_velocity_mean": 16.69417755706596, "outflow_rate_mean": 1194.7893047373398, "system_level_velocity_max": 18.870753118871736, "cost1_mean": 197.56134031893893, "outflow_rate_min": 474.32689684233026}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410465, "timesteps_since_restore": 3589604, "episodes_total": 4399, "policy_reward_mean": {}, "episode_reward_max": 592.2387774428951, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35730, "iterations_since_restore": 95, "training_iteration": 95, "episode_len_mean": 321.96, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2402.313831806183, "timesteps_total": 3589604, "date": "2019-05-21_03-47-45", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9518>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 55}
{"time_this_iter_s": 24.36433458328247, "hostname": "flow-main", "info": {"default": {"kl": 0.01455687452107668, "entropy": 1.3752878904342651, "policy_loss": -0.01273069903254509, "cur_lr": 0.0005000000237487257, "total_loss": 70.7235336303711, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 70.73135375976562, "vf_explained_var": 0.7589179873466492}, "grad_time_ms": 8456.054, "update_time_ms": 7.314, "load_time_ms": 3.563, "sample_time_ms": 15811.816, "num_steps_sampled": 3626127, "num_steps_trained": 3626127}, "episode_reward_min": 56.192250756054904, "episode_reward_mean": 544.9751683028697, "done": false, "time_total_s": 2426.6781663894653, "custom_metrics": {"cost2_min": -48.32190444654462, "cost2_max": -16.026993107996507, "system_level_velocity_min": 11.768105441530965, "outflow_rate_max": 1326.7779273896044, "cost1_max": 223.80553416247105, "cost1_min": 24.502338402821536, "cost2_mean": -35.57997109642552, "system_level_velocity_mean": 16.439580450806595, "outflow_rate_mean": 1177.2724234872962, "system_level_velocity_max": 18.960635235356666, "cost1_mean": 192.9934744166085, "outflow_rate_min": 474.32689684233026}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410489, "timesteps_since_restore": 3626127, "episodes_total": 4442, "policy_reward_mean": {}, "episode_reward_max": 593.1963323538253, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36523, "iterations_since_restore": 96, "training_iteration": 96, "episode_len_mean": 319.24, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2426.6781663894653, "timesteps_total": 3626127, "date": "2019-05-21_03-48-09", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4cf8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 43}
{"time_this_iter_s": 24.278225421905518, "hostname": "flow-main", "info": {"default": {"kl": 0.013364185579121113, "entropy": 1.380106806755066, "policy_loss": -0.012743880040943623, "cur_lr": 0.0005000000237487257, "total_loss": 81.34822845458984, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 81.35645294189453, "vf_explained_var": 0.7282732129096985}, "grad_time_ms": 8472.201, "update_time_ms": 7.185, "load_time_ms": 3.555, "sample_time_ms": 15904.35, "num_steps_sampled": 3662211, "num_steps_trained": 3662211}, "episode_reward_min": 56.192250756054904, "episode_reward_mean": 546.8687906786297, "done": false, "time_total_s": 2450.956391811371, "custom_metrics": {"cost2_min": -45.8824172463305, "cost2_max": -16.108369955455576, "system_level_velocity_min": 12.243845513894358, "outflow_rate_max": 1326.7779273896044, "cost1_max": 223.80553416247105, "cost1_min": 24.612704315243334, "cost2_mean": -35.718077592512586, "system_level_velocity_mean": 16.34088105351226, "outflow_rate_mean": 1172.6070200534946, "system_level_velocity_max": 18.960635235356666, "cost1_mean": 193.00479752316605, "outflow_rate_min": 514.1511736692719}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410513, "timesteps_since_restore": 3662211, "episodes_total": 4487, "policy_reward_mean": {}, "episode_reward_max": 593.1963323538253, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36084, "iterations_since_restore": 97, "training_iteration": 97, "episode_len_mean": 320.94, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2450.956391811371, "timesteps_total": 3662211, "date": "2019-05-21_03-48-33", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabba8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 45}
{"time_this_iter_s": 25.027111291885376, "hostname": "flow-main", "info": {"default": {"kl": 0.015110908076167107, "entropy": 1.38209068775177, "policy_loss": -0.013874075375497341, "cur_lr": 0.0005000000237487257, "total_loss": 89.32061767578125, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 89.32938385009766, "vf_explained_var": 0.7091578841209412}, "grad_time_ms": 8497.459, "update_time_ms": 7.178, "load_time_ms": 3.652, "sample_time_ms": 16058.808, "num_steps_sampled": 3698178, "num_steps_trained": 3698178}, "episode_reward_min": 360.49689872485766, "episode_reward_mean": 552.7969739935172, "done": false, "time_total_s": 2475.983503103256, "custom_metrics": {"cost2_min": -52.0994128899504, "cost2_max": -24.63372017972095, "system_level_velocity_min": 12.221534546021063, "outflow_rate_max": 1312.9636552108436, "cost1_max": 223.32864908015821, "cost1_min": 140.17186388047023, "cost2_mean": -35.8737342987285, "system_level_velocity_mean": 16.345360183483663, "outflow_rate_mean": 1178.6177051372476, "system_level_velocity_max": 18.828812626247707, "cost1_mean": 195.31737159813864, "outflow_rate_min": 968.6716338671364}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410538, "timesteps_since_restore": 3698178, "episodes_total": 4537, "policy_reward_mean": {}, "episode_reward_max": 593.0313223760105, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35967, "iterations_since_restore": 98, "training_iteration": 98, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2475.983503103256, "timesteps_total": 3698178, "date": "2019-05-21_03-48-58", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9a90>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 50}
{"time_this_iter_s": 23.39931845664978, "hostname": "flow-main", "info": {"default": {"kl": 0.014003988355398178, "entropy": 1.3910446166992188, "policy_loss": -0.012546058744192123, "cur_lr": 0.0005000000237487257, "total_loss": 81.72321319580078, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 81.73102569580078, "vf_explained_var": 0.6894964575767517}, "grad_time_ms": 8421.147, "update_time_ms": 7.22, "load_time_ms": 3.63, "sample_time_ms": 15899.373, "num_steps_sampled": 3733257, "num_steps_trained": 3733257}, "episode_reward_min": 505.7100711883213, "episode_reward_mean": 557.1211688950398, "done": false, "time_total_s": 2499.382821559906, "custom_metrics": {"cost2_min": -55.21152986052867, "cost2_max": -20.64474825738215, "system_level_velocity_min": 12.221534546021063, "outflow_rate_max": 1312.9636552108436, "cost1_max": 221.892173718009, "cost1_min": 149.40290823909498, "cost2_mean": -35.07369141388658, "system_level_velocity_mean": 16.55618929993247, "outflow_rate_mean": 1191.0963681953754, "system_level_velocity_max": 18.70297067952213, "cost1_mean": 198.57793303084793, "outflow_rate_min": 1003.5170676369862}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410562, "timesteps_since_restore": 3733257, "episodes_total": 4582, "policy_reward_mean": {}, "episode_reward_max": 591.6127508570039, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35079, "iterations_since_restore": 99, "training_iteration": 99, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2499.382821559906, "timesteps_total": 3733257, "date": "2019-05-21_03-49-22", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4cc0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 45}
{"time_this_iter_s": 24.471545457839966, "hostname": "flow-main", "info": {"default": {"kl": 0.014069890603423119, "entropy": 1.3983235359191895, "policy_loss": -0.013501740992069244, "cur_lr": 0.0005000000237487257, "total_loss": 66.96781158447266, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 66.9765625, "vf_explained_var": 0.7851040959358215}, "grad_time_ms": 8410.088, "update_time_ms": 7.215, "load_time_ms": 3.687, "sample_time_ms": 15993.432, "num_steps_sampled": 3769926, "num_steps_trained": 3769926}, "episode_reward_min": 464.38447403472543, "episode_reward_mean": 553.6936081226364, "done": false, "time_total_s": 2523.854367017746, "custom_metrics": {"cost2_min": -55.21152986052867, "cost2_max": -20.64474825738215, "system_level_velocity_min": 12.429990230756502, "outflow_rate_max": 1306.0099466003014, "cost1_max": 221.892173718009, "cost1_min": 147.0053145625264, "cost2_mean": -34.976838233369705, "system_level_velocity_mean": 16.303263552912412, "outflow_rate_mean": 1177.9336768126382, "system_level_velocity_max": 18.70297067952213, "cost1_mean": 195.66085712477613, "outflow_rate_min": 928.5835619886723}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410586, "timesteps_since_restore": 3769926, "episodes_total": 4625, "policy_reward_mean": {}, "episode_reward_max": 596.4515864785898, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36669, "iterations_since_restore": 100, "training_iteration": 100, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2523.854367017746, "timesteps_total": 3769926, "date": "2019-05-21_03-49-46", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9a20>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 43}
{"time_this_iter_s": 24.73474383354187, "hostname": "flow-main", "info": {"default": {"kl": 0.013727360405027866, "entropy": 1.398087978363037, "policy_loss": -0.012023120187222958, "cur_lr": 0.0005000000237487257, "total_loss": 86.90740966796875, "cur_kl_coeff": 0.3375000059604645, "vf_loss": 86.914794921875, "vf_explained_var": 0.6735381484031677}, "grad_time_ms": 8382.156, "update_time_ms": 7.213, "load_time_ms": 3.621, "sample_time_ms": 15954.9, "num_steps_sampled": 3805450, "num_steps_trained": 3805450}, "episode_reward_min": 59.05907320480457, "episode_reward_mean": 551.0255665002277, "done": false, "time_total_s": 2548.589110851288, "custom_metrics": {"cost2_min": -54.396999457874685, "cost2_max": -15.591129493617272, "system_level_velocity_min": 12.429990230756502, "outflow_rate_max": 1306.1891843446697, "cost1_max": 221.892173718009, "cost1_min": 24.905875893092407, "cost2_mean": -33.56329039950111, "system_level_velocity_mean": 16.33481543473753, "outflow_rate_mean": 1173.628941732767, "system_level_velocity_max": 19.101241110144073, "cost1_mean": 194.38753841893384, "outflow_rate_min": 498.8277026883816}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410611, "timesteps_since_restore": 3805450, "episodes_total": 4674, "policy_reward_mean": {}, "episode_reward_max": 596.4515864785898, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35524, "iterations_since_restore": 101, "training_iteration": 101, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2548.589110851288, "timesteps_total": 3805450, "date": "2019-05-21_03-50-11", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db47b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4ac8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 24.31829833984375, "hostname": "flow-main", "info": {"default": {"kl": 0.015586353838443756, "entropy": 1.4043217897415161, "policy_loss": -0.014176425524055958, "cur_lr": 0.0005000000237487257, "total_loss": 80.8780746459961, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 80.8869857788086, "vf_explained_var": 0.7083958387374878}, "grad_time_ms": 8389.972, "update_time_ms": 7.388, "load_time_ms": 3.547, "sample_time_ms": 15994.427, "num_steps_sampled": 3841179, "num_steps_trained": 3841179}, "episode_reward_min": 59.05907320480457, "episode_reward_mean": 554.9089060361222, "done": false, "time_total_s": 2572.9074091911316, "custom_metrics": {"cost2_min": -47.20333940916238, "cost2_max": -15.591129493617272, "system_level_velocity_min": 12.962047842579288, "outflow_rate_max": 1306.1891843446697, "cost1_max": 220.98648588636712, "cost1_min": 24.905875893092407, "cost2_mean": -32.394187604146225, "system_level_velocity_mean": 16.567420564487687, "outflow_rate_mean": 1185.184506117916, "system_level_velocity_max": 19.101241110144073, "cost1_mean": 197.2924917905284, "outflow_rate_min": 498.8277026883816}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410636, "timesteps_since_restore": 3841179, "episodes_total": 4723, "policy_reward_mean": {}, "episode_reward_max": 597.4231622054865, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35729, "iterations_since_restore": 102, "training_iteration": 102, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2572.9074091911316, "timesteps_total": 3841179, "date": "2019-05-21_03-50-36", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d992e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d997f0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 24.869977951049805, "hostname": "flow-main", "info": {"default": {"kl": 0.015765782445669174, "entropy": 1.397522211074829, "policy_loss": -0.015353299677371979, "cur_lr": 0.0005000000237487257, "total_loss": 80.50090789794922, "cur_kl_coeff": 0.3375000059604645, "vf_loss": 80.51094055175781, "vf_explained_var": 0.7096303105354309}, "grad_time_ms": 8251.851, "update_time_ms": 7.621, "load_time_ms": 3.417, "sample_time_ms": 16156.28, "num_steps_sampled": 3876749, "num_steps_trained": 3876749}, "episode_reward_min": 60.22916277991948, "episode_reward_mean": 549.2165730744848, "done": false, "time_total_s": 2597.7773871421814, "custom_metrics": {"cost2_min": -47.20333940916238, "cost2_max": -15.764874920076586, "system_level_velocity_min": 12.673405711544328, "outflow_rate_max": 1300.575633713131, "cost1_max": 221.18010422154546, "cost1_min": 24.432325431572195, "cost2_mean": -32.52762385950058, "system_level_velocity_mean": 16.405632851858062, "outflow_rate_mean": 1173.0705775933116, "system_level_velocity_max": 18.676693309349638, "cost1_mean": 194.00151489367855, "outflow_rate_min": 471.4016065469103}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410660, "timesteps_since_restore": 3876749, "episodes_total": 4767, "policy_reward_mean": {}, "episode_reward_max": 597.4231622054865, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35570, "iterations_since_restore": 103, "training_iteration": 103, "episode_len_mean": 319.95, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2597.7773871421814, "timesteps_total": 3876749, "date": "2019-05-21_03-51-00", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab2e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabd30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabe10>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 44}
{"time_this_iter_s": 23.931021690368652, "hostname": "flow-main", "info": {"default": {"kl": 0.015125424601137638, "entropy": 1.4117480516433716, "policy_loss": -0.014587145298719406, "cur_lr": 0.0005000000237487257, "total_loss": 94.14176940917969, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 94.15125274658203, "vf_explained_var": 0.6341236233711243}, "grad_time_ms": 8088.528, "update_time_ms": 7.287, "load_time_ms": 3.436, "sample_time_ms": 16306.588, "num_steps_sampled": 3912086, "num_steps_trained": 3912086}, "episode_reward_min": 42.81216868113346, "episode_reward_mean": 538.0028751281078, "done": false, "time_total_s": 2621.70840883255, "custom_metrics": {"cost2_min": -45.51358492773298, "cost2_max": -13.156157569679776, "system_level_velocity_min": 12.673405711544328, "outflow_rate_max": 1310.398340952461, "cost1_max": 221.5368260753832, "cost1_min": 17.828175074399955, "cost2_mean": -31.24350264718537, "system_level_velocity_mean": 16.507797108876886, "outflow_rate_mean": 1163.5411642753497, "system_level_velocity_max": 18.715537871241786, "cost1_mean": 191.58954075888832, "outflow_rate_min": 471.4016065469103}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410684, "timesteps_since_restore": 3912086, "episodes_total": 4817, "policy_reward_mean": {}, "episode_reward_max": 593.3666467904127, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35337, "iterations_since_restore": 104, "training_iteration": 104, "episode_len_mean": 314.71, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2621.70840883255, "timesteps_total": 3912086, "date": "2019-05-21_03-51-24", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db99b0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 50}
{"time_this_iter_s": 24.73087501525879, "hostname": "flow-main", "info": {"default": {"kl": 0.014759371988475323, "entropy": 1.4064148664474487, "policy_loss": -0.014964272268116474, "cur_lr": 0.0005000000237487257, "total_loss": 89.31053924560547, "cur_kl_coeff": 0.3375000059604645, "vf_loss": 89.32052612304688, "vf_explained_var": 0.6510290503501892}, "grad_time_ms": 8077.88, "update_time_ms": 7.166, "load_time_ms": 3.44, "sample_time_ms": 16257.329, "num_steps_sampled": 3947551, "num_steps_trained": 3947551}, "episode_reward_min": 42.81216868113346, "episode_reward_mean": 542.4505636259125, "done": false, "time_total_s": 2646.439283847809, "custom_metrics": {"cost2_min": -45.51358492773298, "cost2_max": -13.156157569679776, "system_level_velocity_min": 12.452854932692604, "outflow_rate_max": 1310.398340952461, "cost1_max": 221.5368260753832, "cost1_min": 17.828175074399955, "cost2_mean": -31.1905453956675, "system_level_velocity_mean": 16.383197316558917, "outflow_rate_mean": 1169.7095755295306, "system_level_velocity_max": 18.715537871241786, "cost1_mean": 192.98189431186324, "outflow_rate_min": 487.8590816741719}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410709, "timesteps_since_restore": 3947551, "episodes_total": 4865, "policy_reward_mean": {}, "episode_reward_max": 592.7807004077505, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35465, "iterations_since_restore": 105, "training_iteration": 105, "episode_len_mean": 318.69, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2646.439283847809, "timesteps_total": 3947551, "date": "2019-05-21_03-51-49", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d998d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99550>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 48}
{"time_this_iter_s": 22.691718101501465, "hostname": "flow-main", "info": {"default": {"kl": 0.015034095384180546, "entropy": 1.4172691106796265, "policy_loss": -0.015143505297601223, "cur_lr": 0.0005000000237487257, "total_loss": 84.3087158203125, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 84.31878662109375, "vf_explained_var": 0.6042991876602173}, "grad_time_ms": 8040.641, "update_time_ms": 7.071, "load_time_ms": 3.407, "sample_time_ms": 16127.401, "num_steps_sampled": 3982370, "num_steps_trained": 3982370}, "episode_reward_min": 349.9968036215807, "episode_reward_mean": 549.6337318738674, "done": false, "time_total_s": 2669.1310019493103, "custom_metrics": {"cost2_min": -50.413400876540706, "cost2_max": -14.784265328778854, "system_level_velocity_min": 12.452854932692604, "outflow_rate_max": 1302.2861508091335, "cost1_max": 221.07145080084192, "cost1_min": 140.47037176408054, "cost2_mean": -31.104827268291345, "system_level_velocity_mean": 16.376022701330513, "outflow_rate_mean": 1176.925264777313, "system_level_velocity_max": 18.73192307207684, "cost1_mean": 196.2391637386554, "outflow_rate_min": 963.6147939560439}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410732, "timesteps_since_restore": 3982370, "episodes_total": 4907, "policy_reward_mean": {}, "episode_reward_max": 597.7963661685081, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34819, "iterations_since_restore": 106, "training_iteration": 106, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2669.1310019493103, "timesteps_total": 3982370, "date": "2019-05-21_03-52-12", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9320>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 42}
{"time_this_iter_s": 23.218149185180664, "hostname": "flow-main", "info": {"default": {"kl": 0.014488019049167633, "entropy": 1.407095193862915, "policy_loss": -0.013318712823092937, "cur_lr": 0.0005000000237487257, "total_loss": 76.95057678222656, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 76.95901489257812, "vf_explained_var": 0.6753876805305481}, "grad_time_ms": 8044.0, "update_time_ms": 7.158, "load_time_ms": 3.348, "sample_time_ms": 16017.935, "num_steps_sampled": 4017332, "num_steps_trained": 4017332}, "episode_reward_min": 497.11943441961773, "episode_reward_mean": 552.368249926164, "done": false, "time_total_s": 2692.349151134491, "custom_metrics": {"cost2_min": -50.413400876540706, "cost2_max": -14.784265328778854, "system_level_velocity_min": 13.203133548283446, "outflow_rate_max": 1302.2861508091335, "cost1_max": 221.07145080084192, "cost1_min": 158.51001864390742, "cost2_mean": -30.839228592515965, "system_level_velocity_mean": 16.565750399632726, "outflow_rate_mean": 1186.8488748878424, "system_level_velocity_max": 18.73192307207684, "cost1_mean": 198.9516385108639, "outflow_rate_min": 1012.99886765043}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410755, "timesteps_since_restore": 4017332, "episodes_total": 4951, "policy_reward_mean": {}, "episode_reward_max": 597.7963661685081, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34962, "iterations_since_restore": 107, "training_iteration": 107, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2692.349151134491, "timesteps_total": 4017332, "date": "2019-05-21_03-52-35", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9c50>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 44}
{"time_this_iter_s": 23.852784395217896, "hostname": "flow-main", "info": {"default": {"kl": 0.015325133688747883, "entropy": 1.4137462377548218, "policy_loss": -0.014912992715835571, "cur_lr": 0.0005000000237487257, "total_loss": 87.90504455566406, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 87.91477966308594, "vf_explained_var": 0.6595287919044495}, "grad_time_ms": 8009.655, "update_time_ms": 7.379, "load_time_ms": 3.195, "sample_time_ms": 15934.314, "num_steps_sampled": 4052403, "num_steps_trained": 4052403}, "episode_reward_min": 465.7520370339828, "episode_reward_mean": 546.6205752442366, "done": false, "time_total_s": 2716.201935529709, "custom_metrics": {"cost2_min": -43.88721608968886, "cost2_max": -16.60295921292577, "system_level_velocity_min": 12.338919327385337, "outflow_rate_max": 1301.185116604554, "cost1_max": 221.30118603804402, "cost1_min": 145.0077386620707, "cost2_mean": -31.692463731551097, "system_level_velocity_mean": 16.38215979155696, "outflow_rate_mean": 1178.7069901875766, "system_level_velocity_max": 18.707990803799497, "cost1_mean": 196.72863293965747, "outflow_rate_min": 938.6656876212022}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410779, "timesteps_since_restore": 4052403, "episodes_total": 5004, "policy_reward_mean": {}, "episode_reward_max": 589.9914904844948, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35071, "iterations_since_restore": 108, "training_iteration": 108, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2716.201935529709, "timesteps_total": 4052403, "date": "2019-05-21_03-52-59", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d997f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d997b8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 53}
{"time_this_iter_s": 23.118743419647217, "hostname": "flow-main", "info": {"default": {"kl": 0.015095814131200314, "entropy": 1.422008752822876, "policy_loss": -0.013799076899886131, "cur_lr": 0.0005000000237487257, "total_loss": 76.63019561767578, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 76.6388931274414, "vf_explained_var": 0.6637556552886963}, "grad_time_ms": 8047.92, "update_time_ms": 7.312, "load_time_ms": 3.22, "sample_time_ms": 15866.993, "num_steps_sampled": 4088056, "num_steps_trained": 4088056}, "episode_reward_min": 465.7520370339828, "episode_reward_mean": 541.1627003480726, "done": false, "time_total_s": 2739.320678949356, "custom_metrics": {"cost2_min": -46.265879448095816, "cost2_max": -20.798579227497257, "system_level_velocity_min": 12.266114785038909, "outflow_rate_max": 1305.2448271136918, "cost1_max": 221.30118603804402, "cost1_min": 145.0077386620707, "cost2_mean": -32.61449946908428, "system_level_velocity_mean": 16.187062359386417, "outflow_rate_mean": 1167.1628557931401, "system_level_velocity_max": 18.707990803799497, "cost1_mean": 193.98843882649527, "outflow_rate_min": 938.6656876212022}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410802, "timesteps_since_restore": 4088056, "episodes_total": 5046, "policy_reward_mean": {}, "episode_reward_max": 589.6238824661152, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35653, "iterations_since_restore": 109, "training_iteration": 109, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2739.320678949356, "timesteps_total": 4088056, "date": "2019-05-21_03-53-22", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9470>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 42}
{"time_this_iter_s": 24.12499213218689, "hostname": "flow-main", "info": {"default": {"kl": 0.017075087875127792, "entropy": 1.4217995405197144, "policy_loss": -0.01390580739825964, "cur_lr": 0.0005000000237487257, "total_loss": 81.89644622802734, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 81.90460205078125, "vf_explained_var": 0.6681357026100159}, "grad_time_ms": 8078.396, "update_time_ms": 7.281, "load_time_ms": 3.18, "sample_time_ms": 15799.879, "num_steps_sampled": 4123273, "num_steps_trained": 4123273}, "episode_reward_min": 368.0742488982539, "episode_reward_mean": 539.0475506153016, "done": false, "time_total_s": 2763.445671081543, "custom_metrics": {"cost2_min": -46.265879448095816, "cost2_max": -17.41394317941054, "system_level_velocity_min": 12.266114785038909, "outflow_rate_max": 1305.2448271136918, "cost1_max": 220.71039196259173, "cost1_min": 144.18624645267653, "cost2_mean": -32.3505533148854, "system_level_velocity_mean": 16.169796825312943, "outflow_rate_mean": 1164.0190405348599, "system_level_velocity_max": 18.513415319446093, "cost1_mean": 193.06525160385266, "outflow_rate_min": 945.7174086378739}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410826, "timesteps_since_restore": 4123273, "episodes_total": 5092, "policy_reward_mean": {}, "episode_reward_max": 589.6238824661152, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35217, "iterations_since_restore": 110, "training_iteration": 110, "episode_len_mean": 323.62, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2763.445671081543, "timesteps_total": 4123273, "date": "2019-05-21_03-53-46", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96c18>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 46}
{"time_this_iter_s": 24.06483030319214, "hostname": "flow-main", "info": {"default": {"kl": 0.015391344204545021, "entropy": 1.4260435104370117, "policy_loss": -0.014789395034313202, "cur_lr": 0.0005000000237487257, "total_loss": 87.6379165649414, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 87.64750671386719, "vf_explained_var": 0.6335331201553345}, "grad_time_ms": 8067.278, "update_time_ms": 7.521, "load_time_ms": 3.236, "sample_time_ms": 15745.798, "num_steps_sampled": 4158641, "num_steps_trained": 4158641}, "episode_reward_min": 193.45110798431662, "episode_reward_mean": 538.3963021233601, "done": false, "time_total_s": 2787.510501384735, "custom_metrics": {"cost2_min": -45.2713783587958, "cost2_max": -17.41394317941054, "system_level_velocity_min": 12.575216827629443, "outflow_rate_max": 1318.4546656698265, "cost1_max": 222.08775089519142, "cost1_min": 80.10479624141402, "cost2_mean": -31.560046432693195, "system_level_velocity_mean": 16.255742962448466, "outflow_rate_mean": 1165.6601821734384, "system_level_velocity_max": 18.84717936590316, "cost1_mean": 192.03050159953818, "outflow_rate_min": 760.0028421846765}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410851, "timesteps_since_restore": 4158641, "episodes_total": 5141, "policy_reward_mean": {}, "episode_reward_max": 587.5636777708037, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35368, "iterations_since_restore": 111, "training_iteration": 111, "episode_len_mean": 320.47, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2787.510501384735, "timesteps_total": 4158641, "date": "2019-05-21_03-54-11", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99748>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 24.007150888442993, "hostname": "flow-main", "info": {"default": {"kl": 0.014559056609869003, "entropy": 1.4229847192764282, "policy_loss": -0.013505717739462852, "cur_lr": 0.0005000000237487257, "total_loss": 83.51779174804688, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 83.52638244628906, "vf_explained_var": 0.6611334085464478}, "grad_time_ms": 8095.282, "update_time_ms": 7.399, "load_time_ms": 3.131, "sample_time_ms": 15687.261, "num_steps_sampled": 4194088, "num_steps_trained": 4194088}, "episode_reward_min": 193.45110798431662, "episode_reward_mean": 545.1937154086743, "done": false, "time_total_s": 2811.517652273178, "custom_metrics": {"cost2_min": -43.63190775249656, "cost2_max": -21.225586157909504, "system_level_velocity_min": 11.291689105777303, "outflow_rate_max": 1318.4546656698265, "cost1_max": 222.09781026560316, "cost1_min": 80.10479624141402, "cost2_mean": -32.14863346642696, "system_level_velocity_mean": 16.317276246675792, "outflow_rate_mean": 1176.585023896734, "system_level_velocity_max": 18.84717936590316, "cost1_mean": 193.47167186812567, "outflow_rate_min": 760.0028421846765}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410875, "timesteps_since_restore": 4194088, "episodes_total": 5187, "policy_reward_mean": {}, "episode_reward_max": 593.6326186707444, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35447, "iterations_since_restore": 112, "training_iteration": 112, "episode_len_mean": 321.37, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2811.517652273178, "timesteps_total": 4194088, "date": "2019-05-21_03-54-35", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9128>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 46}
{"time_this_iter_s": 23.460818767547607, "hostname": "flow-main", "info": {"default": {"kl": 0.016958199441432953, "entropy": 1.4267525672912598, "policy_loss": -0.015720536932349205, "cur_lr": 0.0005000000237487257, "total_loss": 73.94817352294922, "cur_kl_coeff": 0.3375000059604645, "vf_loss": 73.95817565917969, "vf_explained_var": 0.7182013988494873}, "grad_time_ms": 8082.853, "update_time_ms": 7.18, "load_time_ms": 3.114, "sample_time_ms": 15559.088, "num_steps_sampled": 4229631, "num_steps_trained": 4229631}, "episode_reward_min": 46.44651617334533, "episode_reward_mean": 547.3215954189133, "done": false, "time_total_s": 2834.9784710407257, "custom_metrics": {"cost2_min": -43.96625689944131, "cost2_max": -10.591608062245568, "system_level_velocity_min": 11.291689105777303, "outflow_rate_max": 1309.1116735727444, "cost1_max": 222.09781026560316, "cost1_min": 17.94573633209753, "cost2_mean": -31.861746508388748, "system_level_velocity_mean": 16.426058371205876, "outflow_rate_mean": 1178.784970714909, "system_level_velocity_max": 18.75303984568885, "cost1_mean": 194.88499247217268, "outflow_rate_min": 477.24354782665716}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410898, "timesteps_since_restore": 4229631, "episodes_total": 5233, "policy_reward_mean": {}, "episode_reward_max": 594.3956941235141, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35543, "iterations_since_restore": 113, "training_iteration": 113, "episode_len_mean": 321.62, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2834.9784710407257, "timesteps_total": 4229631, "date": "2019-05-21_03-54-58", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9518>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 46}
{"time_this_iter_s": 25.860155820846558, "hostname": "flow-main", "info": {"default": {"kl": 0.014954229816794395, "entropy": 1.4177659749984741, "policy_loss": -0.013365657068789005, "cur_lr": 0.0005000000237487257, "total_loss": 89.53782653808594, "cur_kl_coeff": 0.3375000059604645, "vf_loss": 89.54615020751953, "vf_explained_var": 0.6505488753318787}, "grad_time_ms": 8134.782, "update_time_ms": 7.221, "load_time_ms": 2.973, "sample_time_ms": 15699.007, "num_steps_sampled": 4265092, "num_steps_trained": 4265092}, "episode_reward_min": 45.501435018448234, "episode_reward_mean": 536.1817471199245, "done": false, "time_total_s": 2860.8386268615723, "custom_metrics": {"cost2_min": -43.96625689944131, "cost2_max": -10.591608062245568, "system_level_velocity_min": 12.677475925017939, "outflow_rate_max": 1323.3759143276077, "cost1_max": 222.63824168872924, "cost1_min": 17.94573633209753, "cost2_mean": -31.881685648577548, "system_level_velocity_mean": 16.470266263774917, "outflow_rate_mean": 1166.9203488869089, "system_level_velocity_max": 18.838430342626708, "cost1_mean": 191.51898069995062, "outflow_rate_min": 448.5093812448499}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410924, "timesteps_since_restore": 4265092, "episodes_total": 5282, "policy_reward_mean": {}, "episode_reward_max": 594.3956941235141, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35461, "iterations_since_restore": 114, "training_iteration": 114, "episode_len_mean": 315.94, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2860.8386268615723, "timesteps_total": 4265092, "date": "2019-05-21_03-55-24", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4e80>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 25.804776668548584, "hostname": "flow-main", "info": {"default": {"kl": 0.015838004648685455, "entropy": 1.4242967367172241, "policy_loss": -0.015550997108221054, "cur_lr": 0.0005000000237487257, "total_loss": 71.80524444580078, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 71.8154525756836, "vf_explained_var": 0.6994918584823608}, "grad_time_ms": 8204.899, "update_time_ms": 7.35, "load_time_ms": 3.0, "sample_time_ms": 15735.334, "num_steps_sampled": 4301417, "num_steps_trained": 4301417}, "episode_reward_min": 45.501435018448234, "episode_reward_mean": 529.9796598361808, "done": false, "time_total_s": 2886.643403530121, "custom_metrics": {"cost2_min": -42.673730762949916, "cost2_max": -11.309699444937266, "system_level_velocity_min": 11.1314486643954, "outflow_rate_max": 1323.3759143276077, "cost1_max": 222.63824168872924, "cost1_min": 18.030682641806678, "cost2_mean": -32.68048525129721, "system_level_velocity_mean": 16.140065122382723, "outflow_rate_mean": 1154.4957567086258, "system_level_velocity_max": 18.838430342626708, "cost1_mean": 188.03472629909768, "outflow_rate_min": 448.5093812448499}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410950, "timesteps_since_restore": 4301417, "episodes_total": 5330, "policy_reward_mean": {}, "episode_reward_max": 597.3116525646728, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36325, "iterations_since_restore": 115, "training_iteration": 115, "episode_len_mean": 316.24, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2886.643403530121, "timesteps_total": 4301417, "date": "2019-05-21_03-55-50", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db44e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db44a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4668>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 48}
{"time_this_iter_s": 24.02717399597168, "hostname": "flow-main", "info": {"default": {"kl": 0.01568804495036602, "entropy": 1.430973768234253, "policy_loss": -0.013574409298598766, "cur_lr": 0.0005000000237487257, "total_loss": 72.65506744384766, "cur_kl_coeff": 0.3375000059604645, "vf_loss": 72.66334533691406, "vf_explained_var": 0.6811546683311462}, "grad_time_ms": 8207.23, "update_time_ms": 7.571, "load_time_ms": 2.991, "sample_time_ms": 15866.52, "num_steps_sampled": 4336945, "num_steps_trained": 4336945}, "episode_reward_min": 60.27282744501277, "episode_reward_mean": 533.0755824869808, "done": false, "time_total_s": 2910.6705775260925, "custom_metrics": {"cost2_min": -44.067536235456096, "cost2_max": -11.309699444937266, "system_level_velocity_min": 11.1314486643954, "outflow_rate_max": 1323.3759143276077, "cost1_max": 222.63824168872924, "cost1_min": 24.101163943323698, "cost2_mean": -33.13664648827448, "system_level_velocity_mean": 15.921212901486099, "outflow_rate_mean": 1155.3693626441272, "system_level_velocity_max": 18.90461383494264, "cost1_mean": 188.02440300422262, "outflow_rate_min": 501.53457663979225}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410974, "timesteps_since_restore": 4336945, "episodes_total": 5376, "policy_reward_mean": {}, "episode_reward_max": 597.3116525646728, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35528, "iterations_since_restore": 116, "training_iteration": 116, "episode_len_mean": 320.04, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2910.6705775260925, "timesteps_total": 4336945, "date": "2019-05-21_03-56-14", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d996a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99cf8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 46}
{"time_this_iter_s": 23.354532718658447, "hostname": "flow-main", "info": {"default": {"kl": 0.015810076147317886, "entropy": 1.4252222776412964, "policy_loss": -0.015666915103793144, "cur_lr": 0.0005000000237487257, "total_loss": 85.94886016845703, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 85.95918273925781, "vf_explained_var": 0.6041495203971863}, "grad_time_ms": 8119.325, "update_time_ms": 7.533, "load_time_ms": 3.114, "sample_time_ms": 15968.164, "num_steps_sampled": 4371718, "num_steps_trained": 4371718}, "episode_reward_min": 58.04890952229846, "episode_reward_mean": 533.4345218141137, "done": false, "time_total_s": 2934.025110244751, "custom_metrics": {"cost2_min": -45.749764339667166, "cost2_max": -11.309699444937266, "system_level_velocity_min": 12.518169282270096, "outflow_rate_max": 1318.744503274485, "cost1_max": 222.74036039784204, "cost1_min": 22.903574339486553, "cost2_mean": -32.31655460415034, "system_level_velocity_mean": 16.34877120927525, "outflow_rate_mean": 1167.581581475798, "system_level_velocity_max": 18.91312029676526, "cost1_mean": 190.13711645353044, "outflow_rate_min": 483.59628932995435}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558410997, "timesteps_since_restore": 4371718, "episodes_total": 5423, "policy_reward_mean": {}, "episode_reward_max": 593.6267318530442, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34773, "iterations_since_restore": 117, "training_iteration": 117, "episode_len_mean": 316.06, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2934.025110244751, "timesteps_total": 4371718, "date": "2019-05-21_03-56-37", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da98d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da95c0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 47}
{"time_this_iter_s": 23.725534439086914, "hostname": "flow-main", "info": {"default": {"kl": 0.016165995970368385, "entropy": 1.43315589427948, "policy_loss": -0.01450035534799099, "cur_lr": 0.0005000000237487257, "total_loss": 86.44877624511719, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 86.45782470703125, "vf_explained_var": 0.5976795554161072}, "grad_time_ms": 8127.241, "update_time_ms": 7.266, "load_time_ms": 3.243, "sample_time_ms": 15947.917, "num_steps_sampled": 4407045, "num_steps_trained": 4407045}, "episode_reward_min": 58.04890952229846, "episode_reward_mean": 540.6535143042053, "done": false, "time_total_s": 2957.750644683838, "custom_metrics": {"cost2_min": -45.749764339667166, "cost2_max": -11.389079009040726, "system_level_velocity_min": 12.985824932489631, "outflow_rate_max": 1318.744503274485, "cost1_max": 222.74036039784204, "cost1_min": 22.903574339486553, "cost2_mean": -32.30210496111838, "system_level_velocity_mean": 16.50126180964992, "outflow_rate_mean": 1183.174950990051, "system_level_velocity_max": 18.91312029676526, "cost1_mean": 194.34872405216666, "outflow_rate_min": 483.59628932995435}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411021, "timesteps_since_restore": 4407045, "episodes_total": 5472, "policy_reward_mean": {}, "episode_reward_max": 593.6267318530442, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35327, "iterations_since_restore": 118, "training_iteration": 118, "episode_len_mean": 319.92, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2957.750644683838, "timesteps_total": 4407045, "date": "2019-05-21_03-57-01", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9fd0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 23.370129346847534, "hostname": "flow-main", "info": {"default": {"kl": 0.014797835610806942, "entropy": 1.4239892959594727, "policy_loss": -0.01469279732555151, "cur_lr": 0.0005000000237487257, "total_loss": 75.46106719970703, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 75.47076416015625, "vf_explained_var": 0.6222171783447266}, "grad_time_ms": 8111.806, "update_time_ms": 7.251, "load_time_ms": 3.269, "sample_time_ms": 15988.76, "num_steps_sampled": 4442028, "num_steps_trained": 4442028}, "episode_reward_min": 363.2315087643926, "episode_reward_mean": 542.3565622009038, "done": false, "time_total_s": 2981.1207740306854, "custom_metrics": {"cost2_min": -43.7320152161513, "cost2_max": -19.08439096478554, "system_level_velocity_min": 12.835368685869199, "outflow_rate_max": 1314.7951973684214, "cost1_max": 220.8871694830589, "cost1_min": 144.00855291734302, "cost2_mean": -32.824190316989956, "system_level_velocity_mean": 16.345229203554872, "outflow_rate_mean": 1179.108573636261, "system_level_velocity_max": 18.762683838269766, "cost1_mean": 195.19007557724728, "outflow_rate_min": 944.0290694626476}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411044, "timesteps_since_restore": 4442028, "episodes_total": 5515, "policy_reward_mean": {}, "episode_reward_max": 593.6267318530442, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34983, "iterations_since_restore": 119, "training_iteration": 119, "episode_len_mean": 323.9, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 2981.1207740306854, "timesteps_total": 4442028, "date": "2019-05-21_03-57-24", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4978>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 43}
{"time_this_iter_s": 23.863014698028564, "hostname": "flow-main", "info": {"default": {"kl": 0.017041832208633423, "entropy": 1.4298118352890015, "policy_loss": -0.016347475349903107, "cur_lr": 0.0005000000237487257, "total_loss": 80.76809692382812, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 80.77869415283203, "vf_explained_var": 0.6155425906181335}, "grad_time_ms": 8109.767, "update_time_ms": 7.322, "load_time_ms": 3.25, "sample_time_ms": 15966.627, "num_steps_sampled": 4477277, "num_steps_trained": 4477277}, "episode_reward_min": 210.73813299574658, "episode_reward_mean": 538.3699926103069, "done": false, "time_total_s": 3004.983788728714, "custom_metrics": {"cost2_min": -44.0285950401108, "cost2_max": -19.08439096478554, "system_level_velocity_min": 12.469457053774441, "outflow_rate_max": 1305.6799541849114, "cost1_max": 220.8871694830589, "cost1_min": 86.19204071054706, "cost2_mean": -32.85717422745778, "system_level_velocity_mean": 16.26570535593681, "outflow_rate_mean": 1167.7585825338188, "system_level_velocity_max": 18.972878137699592, "cost1_mean": 193.3820746070338, "outflow_rate_min": 792.7669482335073}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411068, "timesteps_since_restore": 4477277, "episodes_total": 5561, "policy_reward_mean": {}, "episode_reward_max": 582.4777440726574, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35249, "iterations_since_restore": 120, "training_iteration": 120, "episode_len_mean": 322.8, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3004.983788728714, "timesteps_total": 4477277, "date": "2019-05-21_03-57-48", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4278>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 46}
{"time_this_iter_s": 23.931538581848145, "hostname": "flow-main", "info": {"default": {"kl": 0.015374021604657173, "entropy": 1.4229388236999512, "policy_loss": -0.014387968927621841, "cur_lr": 0.0005000000237487257, "total_loss": 77.78338623046875, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 77.79258728027344, "vf_explained_var": 0.6721737384796143}, "grad_time_ms": 8114.964, "update_time_ms": 7.216, "load_time_ms": 3.253, "sample_time_ms": 15947.559, "num_steps_sampled": 4512688, "num_steps_trained": 4512688}, "episode_reward_min": 210.73813299574658, "episode_reward_mean": 535.6442331683998, "done": false, "time_total_s": 3028.915327310562, "custom_metrics": {"cost2_min": -49.10911234908296, "cost2_max": -19.93222760403845, "system_level_velocity_min": 11.727951543925677, "outflow_rate_max": 1308.6164778854904, "cost1_max": 219.77268685512834, "cost1_min": 86.19204071054706, "cost2_mean": -32.61426224787042, "system_level_velocity_mean": 16.160078001002077, "outflow_rate_mean": 1160.808863186434, "system_level_velocity_max": 18.972878137699592, "cost1_mean": 192.16574261190166, "outflow_rate_min": 792.7669482335073}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411092, "timesteps_since_restore": 4512688, "episodes_total": 5610, "policy_reward_mean": {}, "episode_reward_max": 590.5537112903553, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35411, "iterations_since_restore": 121, "training_iteration": 121, "episode_len_mean": 322.8, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3028.915327310562, "timesteps_total": 4512688, "date": "2019-05-21_03-58-12", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4128>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 23.66652774810791, "hostname": "flow-main", "info": {"default": {"kl": 0.015977051109075546, "entropy": 1.4335930347442627, "policy_loss": -0.01407482847571373, "cur_lr": 0.0005000000237487257, "total_loss": 74.1071548461914, "cur_kl_coeff": 0.3375000059604645, "vf_loss": 74.11583709716797, "vf_explained_var": 0.6426596641540527}, "grad_time_ms": 8112.195, "update_time_ms": 7.198, "load_time_ms": 3.363, "sample_time_ms": 15915.683, "num_steps_sampled": 4548153, "num_steps_trained": 4548153}, "episode_reward_min": 371.7464241923846, "episode_reward_mean": 535.9624595069558, "done": false, "time_total_s": 3052.58185505867, "custom_metrics": {"cost2_min": -49.35806037234203, "cost2_max": -17.155490511353214, "system_level_velocity_min": 11.727951543925677, "outflow_rate_max": 1311.8408231707317, "cost1_max": 219.70197038020416, "cost1_min": 141.45639153632922, "cost2_mean": -32.60538533828253, "system_level_velocity_mean": 16.125555751010157, "outflow_rate_mean": 1163.0680610100537, "system_level_velocity_max": 18.566053193910854, "cost1_mean": 192.53290418952486, "outflow_rate_min": 955.1872997711674}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411116, "timesteps_since_restore": 4548153, "episodes_total": 5654, "policy_reward_mean": {}, "episode_reward_max": 590.5537112903553, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35465, "iterations_since_restore": 122, "training_iteration": 122, "episode_len_mean": 323.92, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3052.58185505867, "timesteps_total": 4548153, "date": "2019-05-21_03-58-36", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4860>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 44}
{"time_this_iter_s": 24.03294014930725, "hostname": "flow-main", "info": {"default": {"kl": 0.016110654920339584, "entropy": 1.440653681755066, "policy_loss": -0.015780838206410408, "cur_lr": 0.0005000000237487257, "total_loss": 69.20501708984375, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 69.21536254882812, "vf_explained_var": 0.7102671265602112}, "grad_time_ms": 8119.339, "update_time_ms": 7.135, "load_time_ms": 3.358, "sample_time_ms": 15965.899, "num_steps_sampled": 4583494, "num_steps_trained": 4583494}, "episode_reward_min": 371.7464241923846, "episode_reward_mean": 536.7921441795389, "done": false, "time_total_s": 3076.6147952079773, "custom_metrics": {"cost2_min": -51.11242124386854, "cost2_max": -17.155490511353214, "system_level_velocity_min": 11.368341256394208, "outflow_rate_max": 1318.6088454301362, "cost1_max": 223.08912142135648, "cost1_min": 137.6909594831343, "cost2_mean": -32.86010879284907, "system_level_velocity_mean": 16.08733969010828, "outflow_rate_mean": 1163.6203606564984, "system_level_velocity_max": 18.850420881657342, "cost1_mean": 192.2127151194277, "outflow_rate_min": 955.2865433374883}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411140, "timesteps_since_restore": 4583494, "episodes_total": 5701, "policy_reward_mean": {}, "episode_reward_max": 591.4620533422718, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35341, "iterations_since_restore": 123, "training_iteration": 123, "episode_len_mean": 323.92, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3076.6147952079773, "timesteps_total": 4583494, "date": "2019-05-21_03-59-00", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4ef0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 47}
{"time_this_iter_s": 24.109394311904907, "hostname": "flow-main", "info": {"default": {"kl": 0.015920478850603104, "entropy": 1.4317384958267212, "policy_loss": -0.01323864609003067, "cur_lr": 0.0005000000237487257, "total_loss": 79.88151550292969, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 79.88937377929688, "vf_explained_var": 0.6712377071380615}, "grad_time_ms": 8117.702, "update_time_ms": 7.355, "load_time_ms": 3.508, "sample_time_ms": 15792.862, "num_steps_sampled": 4618692, "num_steps_trained": 4618692}, "episode_reward_min": 475.96914350533774, "episode_reward_mean": 542.8311150075124, "done": false, "time_total_s": 3100.724189519882, "custom_metrics": {"cost2_min": -51.11242124386854, "cost2_max": -21.884889514500937, "system_level_velocity_min": 11.368341256394208, "outflow_rate_max": 1318.6088454301362, "cost1_max": 223.08912142135648, "cost1_min": 137.6909594831343, "cost2_mean": -32.9771677513955, "system_level_velocity_mean": 16.206179392037473, "outflow_rate_mean": 1171.1517227771026, "system_level_velocity_max": 18.850420881657342, "cost1_mean": 194.1904956333764, "outflow_rate_min": 955.2865433374883}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411164, "timesteps_since_restore": 4618692, "episodes_total": 5748, "policy_reward_mean": {}, "episode_reward_max": 591.4620533422718, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35198, "iterations_since_restore": 124, "training_iteration": 124, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3100.724189519882, "timesteps_total": 4618692, "date": "2019-05-21_03-59-24", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4fd0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 47}
{"time_this_iter_s": 24.217369318008423, "hostname": "flow-main", "info": {"default": {"kl": 0.015258979983627796, "entropy": 1.4469691514968872, "policy_loss": -0.014694469049572945, "cur_lr": 0.0005000000237487257, "total_loss": 75.44064331054688, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 75.45018768310547, "vf_explained_var": 0.6274309754371643}, "grad_time_ms": 8076.372, "update_time_ms": 7.4, "load_time_ms": 3.533, "sample_time_ms": 15676.93, "num_steps_sampled": 4653942, "num_steps_trained": 4653942}, "episode_reward_min": 363.6869766061824, "episode_reward_mean": 545.0259403309819, "done": false, "time_total_s": 3124.9415588378906, "custom_metrics": {"cost2_min": -42.53964731762278, "cost2_max": -18.588317801159107, "system_level_velocity_min": 12.87244807593544, "outflow_rate_max": 1318.6088454301362, "cost1_max": 223.08912142135648, "cost1_min": 140.8645762300145, "cost2_mean": -31.965066759892224, "system_level_velocity_mean": 16.479361810555808, "outflow_rate_mean": 1179.753559910651, "system_level_velocity_max": 18.882501963069853, "cost1_mean": 196.39725791255657, "outflow_rate_min": 1009.3782518730732}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411189, "timesteps_since_restore": 4653942, "episodes_total": 5795, "policy_reward_mean": {}, "episode_reward_max": 591.4620533422718, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35250, "iterations_since_restore": 125, "training_iteration": 125, "episode_len_mean": 323.54, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3124.9415588378906, "timesteps_total": 4653942, "date": "2019-05-21_03-59-49", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db49e8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 47}
{"time_this_iter_s": 24.08776617050171, "hostname": "flow-main", "info": {"default": {"kl": 0.01742026023566723, "entropy": 1.442247748374939, "policy_loss": -0.014570719562470913, "cur_lr": 0.0005000000237487257, "total_loss": 72.82000732421875, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 72.82869720458984, "vf_explained_var": 0.684540331363678}, "grad_time_ms": 8096.428, "update_time_ms": 7.212, "load_time_ms": 3.633, "sample_time_ms": 15662.573, "num_steps_sampled": 4689837, "num_steps_trained": 4689837}, "episode_reward_min": 363.6869766061824, "episode_reward_mean": 544.485139652722, "done": false, "time_total_s": 3149.0293250083923, "custom_metrics": {"cost2_min": -43.959250782536934, "cost2_max": -18.588317801159107, "system_level_velocity_min": 12.60306685247878, "outflow_rate_max": 1313.1145075757577, "cost1_max": 222.70933481531557, "cost1_min": 140.8645762300145, "cost2_mean": -32.48208179942411, "system_level_velocity_mean": 16.35872034070675, "outflow_rate_mean": 1178.0762988740528, "system_level_velocity_max": 18.882501963069853, "cost1_mean": 195.0720683944567, "outflow_rate_min": 970.2078253236776}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411213, "timesteps_since_restore": 4689837, "episodes_total": 5839, "policy_reward_mean": {}, "episode_reward_max": 592.6616085988755, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35895, "iterations_since_restore": 126, "training_iteration": 126, "episode_len_mean": 323.54, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3149.0293250083923, "timesteps_total": 4689837, "date": "2019-05-21_04-00-13", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4748>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 44}
{"time_this_iter_s": 24.184847593307495, "hostname": "flow-main", "info": {"default": {"kl": 0.018820781260728836, "entropy": 1.446613073348999, "policy_loss": -0.012701202183961868, "cur_lr": 0.0005000000237487257, "total_loss": 68.5858383178711, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 68.5921859741211, "vf_explained_var": 0.70916348695755}, "grad_time_ms": 8139.393, "update_time_ms": 7.163, "load_time_ms": 3.586, "sample_time_ms": 15702.718, "num_steps_sampled": 4725956, "num_steps_trained": 4725956}, "episode_reward_min": 54.16637784093233, "episode_reward_mean": 538.8061391126664, "done": false, "time_total_s": 3173.2141726017, "custom_metrics": {"cost2_min": -46.450440019522254, "cost2_max": -14.543871657715082, "system_level_velocity_min": 11.909980173827389, "outflow_rate_max": 1306.012057069678, "cost1_max": 221.73402546382624, "cost1_min": 22.892447978857142, "cost2_mean": -33.1236902843402, "system_level_velocity_mean": 16.077991399224754, "outflow_rate_mean": 1162.0431902922537, "system_level_velocity_max": 18.637580167615475, "cost1_mean": 190.8237249379668, "outflow_rate_min": 506.069524914099}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411237, "timesteps_since_restore": 4725956, "episodes_total": 5887, "policy_reward_mean": {}, "episode_reward_max": 592.6616085988755, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36119, "iterations_since_restore": 127, "training_iteration": 127, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3173.2141726017, "timesteps_total": 4725956, "date": "2019-05-21_04-00-37", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9710>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 48}
{"time_this_iter_s": 24.977700233459473, "hostname": "flow-main", "info": {"default": {"kl": 0.014887172728776932, "entropy": 1.4516030550003052, "policy_loss": -0.014594368636608124, "cur_lr": 0.0005000000237487257, "total_loss": 64.68238067626953, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 64.69195556640625, "vf_explained_var": 0.6911717653274536}, "grad_time_ms": 8225.733, "update_time_ms": 7.378, "load_time_ms": 3.551, "sample_time_ms": 15740.582, "num_steps_sampled": 4760709, "num_steps_trained": 4760709}, "episode_reward_min": 54.16637784093233, "episode_reward_mean": 535.9523813901939, "done": false, "time_total_s": 3198.1918728351593, "custom_metrics": {"cost2_min": -46.450440019522254, "cost2_max": -14.543871657715082, "system_level_velocity_min": 11.909980173827389, "outflow_rate_max": 1314.0823189973403, "cost1_max": 220.6741654994587, "cost1_min": 22.892447978857142, "cost2_mean": -32.36437648311548, "system_level_velocity_mean": 16.27145284658526, "outflow_rate_mean": 1166.153464387985, "system_level_velocity_max": 19.083904284451545, "cost1_mean": 191.3823612658975, "outflow_rate_min": 506.069524914099}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411262, "timesteps_since_restore": 4760709, "episodes_total": 5935, "policy_reward_mean": {}, "episode_reward_max": 585.8230361662481, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34753, "iterations_since_restore": 128, "training_iteration": 128, "episode_len_mean": 320.1, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3198.1918728351593, "timesteps_total": 4760709, "date": "2019-05-21_04-01-02", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db45f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db40f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4da0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 48}
{"time_this_iter_s": 24.267672061920166, "hostname": "flow-main", "info": {"default": {"kl": 0.016851376742124557, "entropy": 1.4498766660690308, "policy_loss": -0.014365487731993198, "cur_lr": 0.0005000000237487257, "total_loss": 67.5243911743164, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 67.53307342529297, "vf_explained_var": 0.7441768050193787}, "grad_time_ms": 8206.461, "update_time_ms": 7.657, "load_time_ms": 3.466, "sample_time_ms": 15849.527, "num_steps_sampled": 4796756, "num_steps_trained": 4796756}, "episode_reward_min": 202.36200148186958, "episode_reward_mean": 537.5522443413469, "done": false, "time_total_s": 3222.4595448970795, "custom_metrics": {"cost2_min": -42.922860009760676, "cost2_max": -21.842857947230407, "system_level_velocity_min": 11.503754522729272, "outflow_rate_max": 1319.4892248937697, "cost1_max": 221.5251486726513, "cost1_min": 85.47837144256273, "cost2_mean": -31.858124587557185, "system_level_velocity_mean": 16.360103802926293, "outflow_rate_mean": 1172.5538521909255, "system_level_velocity_max": 19.083904284451545, "cost1_mean": 193.04672218849512, "outflow_rate_min": 804.4932736616141}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411286, "timesteps_since_restore": 4796756, "episodes_total": 5980, "policy_reward_mean": {}, "episode_reward_max": 591.8447205079607, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36047, "iterations_since_restore": 129, "training_iteration": 129, "episode_len_mean": 321.04, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3222.4595448970795, "timesteps_total": 4796756, "date": "2019-05-21_04-01-26", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4f60>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 45}
{"time_this_iter_s": 24.421502113342285, "hostname": "flow-main", "info": {"default": {"kl": 0.015564296394586563, "entropy": 1.4515985250473022, "policy_loss": -0.013561918400228024, "cur_lr": 0.0005000000237487257, "total_loss": 69.9493408203125, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 69.95764923095703, "vf_explained_var": 0.7124548554420471}, "grad_time_ms": 8149.432, "update_time_ms": 7.678, "load_time_ms": 3.503, "sample_time_ms": 15960.502, "num_steps_sampled": 4832880, "num_steps_trained": 4832880}, "episode_reward_min": 192.63678035752358, "episode_reward_mean": 529.1696097215247, "done": false, "time_total_s": 3246.8810470104218, "custom_metrics": {"cost2_min": -45.658075864696784, "cost2_max": -21.205874855495782, "system_level_velocity_min": 10.37219884778878, "outflow_rate_max": 1319.4892248937697, "cost1_max": 222.10971595482914, "cost1_min": 80.2673146864191, "cost2_mean": -32.065382185675624, "system_level_velocity_mean": 16.044221867306625, "outflow_rate_mean": 1155.596810900765, "system_level_velocity_max": 19.083904284451545, "cost1_mean": 188.08055393150698, "outflow_rate_min": 768.0384502342879}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411311, "timesteps_since_restore": 4832880, "episodes_total": 6027, "policy_reward_mean": {}, "episode_reward_max": 591.8447205079607, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36124, "iterations_since_restore": 130, "training_iteration": 130, "episode_len_mean": 318.96, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3246.8810470104218, "timesteps_total": 4832880, "date": "2019-05-21_04-01-51", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab358>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 47}
{"time_this_iter_s": 23.53889274597168, "hostname": "flow-main", "info": {"default": {"kl": 0.015633990988135338, "entropy": 1.4490983486175537, "policy_loss": -0.013221277855336666, "cur_lr": 0.0005000000237487257, "total_loss": 71.59416961669922, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 71.60211944580078, "vf_explained_var": 0.6988540887832642}, "grad_time_ms": 7977.654, "update_time_ms": 7.625, "load_time_ms": 3.401, "sample_time_ms": 16094.494, "num_steps_sampled": 4868787, "num_steps_trained": 4868787}, "episode_reward_min": 192.63678035752358, "episode_reward_mean": 534.723788106168, "done": false, "time_total_s": 3270.4199397563934, "custom_metrics": {"cost2_min": -45.658075864696784, "cost2_max": -21.205874855495782, "system_level_velocity_min": 10.37219884778878, "outflow_rate_max": 1328.9795941558443, "cost1_max": 222.10971595482914, "cost1_min": 80.2673146864191, "cost2_mean": -32.61217497737415, "system_level_velocity_mean": 15.865083112759823, "outflow_rate_mean": 1160.6642184437674, "system_level_velocity_max": 18.836676269522332, "cost1_mean": 188.76492110448547, "outflow_rate_min": 768.0384502342879}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411334, "timesteps_since_restore": 4868787, "episodes_total": 6076, "policy_reward_mean": {}, "episode_reward_max": 593.4550856453028, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35907, "iterations_since_restore": 131, "training_iteration": 131, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3270.4199397563934, "timesteps_total": 4868787, "date": "2019-05-21_04-02-14", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db92e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db90f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9e80>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 22.96139407157898, "hostname": "flow-main", "info": {"default": {"kl": 0.017009753733873367, "entropy": 1.4704920053482056, "policy_loss": -0.014437382109463215, "cur_lr": 0.0005000000237487257, "total_loss": 71.79232788085938, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 71.80103302001953, "vf_explained_var": 0.6494392156600952}, "grad_time_ms": 7786.043, "update_time_ms": 7.575, "load_time_ms": 3.39, "sample_time_ms": 16214.997, "num_steps_sampled": 4904072, "num_steps_trained": 4904072}, "episode_reward_min": 192.63678035752358, "episode_reward_mean": 536.3732783727045, "done": false, "time_total_s": 3293.3813338279724, "custom_metrics": {"cost2_min": -46.48968585992301, "cost2_max": -21.205874855495782, "system_level_velocity_min": 11.377741152434075, "outflow_rate_max": 1329.7096196843484, "cost1_max": 221.76514222864319, "cost1_min": 80.2673146864191, "cost2_mean": -32.31901813013483, "system_level_velocity_mean": 16.091565061535867, "outflow_rate_mean": 1169.7407037655944, "system_level_velocity_max": 18.836676269522332, "cost1_mean": 190.59568951163288, "outflow_rate_min": 768.0384502342879}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411357, "timesteps_since_restore": 4904072, "episodes_total": 6119, "policy_reward_mean": {}, "episode_reward_max": 593.4550856453028, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35285, "iterations_since_restore": 132, "training_iteration": 132, "episode_len_mean": 321.82, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3293.3813338279724, "timesteps_total": 4904072, "date": "2019-05-21_04-02-37", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabd30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab940>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 43}
{"time_this_iter_s": 24.573721885681152, "hostname": "flow-main", "info": {"default": {"kl": 0.016900816932320595, "entropy": 1.4665284156799316, "policy_loss": -0.0148144057020545, "cur_lr": 0.0005000000237487257, "total_loss": 83.92664337158203, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 83.93576049804688, "vf_explained_var": 0.6431566476821899}, "grad_time_ms": 7716.941, "update_time_ms": 7.645, "load_time_ms": 3.418, "sample_time_ms": 16338.716, "num_steps_sampled": 4940016, "num_steps_trained": 4940016}, "episode_reward_min": 58.79139982682038, "episode_reward_mean": 535.5750376834048, "done": false, "time_total_s": 3317.9550557136536, "custom_metrics": {"cost2_min": -47.11864127598304, "cost2_max": -15.86875181052215, "system_level_velocity_min": 11.377741152434075, "outflow_rate_max": 1329.7096196843484, "cost1_max": 221.85769921211886, "cost1_min": 24.895350513482793, "cost2_mean": -32.13676298401373, "system_level_velocity_mean": 16.087151037340572, "outflow_rate_mean": 1167.8287471047897, "system_level_velocity_max": 19.01225303984077, "cost1_mean": 190.15896860752997, "outflow_rate_min": 492.1092242513756}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411382, "timesteps_since_restore": 4940016, "episodes_total": 6168, "policy_reward_mean": {}, "episode_reward_max": 593.230364204029, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35944, "iterations_since_restore": 133, "training_iteration": 133, "episode_len_mean": 321.02, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3317.9550557136536, "timesteps_total": 4940016, "date": "2019-05-21_04-03-02", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab128>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 23.70042133331299, "hostname": "flow-main", "info": {"default": {"kl": 0.01596832647919655, "entropy": 1.469881296157837, "policy_loss": -0.014619406312704086, "cur_lr": 0.0005000000237487257, "total_loss": 94.14498901367188, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 94.15421295166016, "vf_explained_var": 0.5701872110366821}, "grad_time_ms": 7567.77, "update_time_ms": 7.401, "load_time_ms": 3.342, "sample_time_ms": 16447.275, "num_steps_sampled": 4975236, "num_steps_trained": 4975236}, "episode_reward_min": 56.77271227618092, "episode_reward_mean": 530.8477118670147, "done": false, "time_total_s": 3341.6554770469666, "custom_metrics": {"cost2_min": -48.070909600004924, "cost2_max": -15.758433105483663, "system_level_velocity_min": 12.445422205231493, "outflow_rate_max": 1324.8729097678327, "cost1_max": 221.85769921211886, "cost1_min": 24.895350513482793, "cost2_mean": -31.753362229956863, "system_level_velocity_mean": 16.136930583042155, "outflow_rate_mean": 1161.0757852466982, "system_level_velocity_max": 19.01225303984077, "cost1_mean": 188.00224327019762, "outflow_rate_min": 492.1092242513756}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411406, "timesteps_since_restore": 4975236, "episodes_total": 6218, "policy_reward_mean": {}, "episode_reward_max": 593.230364204029, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35220, "iterations_since_restore": 134, "training_iteration": 134, "episode_len_mean": 316.89, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3341.6554770469666, "timesteps_total": 4975236, "date": "2019-05-21_04-03-26", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabda0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 50}
{"time_this_iter_s": 23.083081007003784, "hostname": "flow-main", "info": {"default": {"kl": 0.017046697437763214, "entropy": 1.4708083868026733, "policy_loss": -0.015277025289833546, "cur_lr": 0.0005000000237487257, "total_loss": 79.0760498046875, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 79.08557891845703, "vf_explained_var": 0.5308993458747864}, "grad_time_ms": 7387.131, "update_time_ms": 7.457, "load_time_ms": 3.258, "sample_time_ms": 16513.691, "num_steps_sampled": 5009915, "num_steps_trained": 5009915}, "episode_reward_min": 56.77271227618092, "episode_reward_mean": 536.7878525563276, "done": false, "time_total_s": 3364.7385580539703, "custom_metrics": {"cost2_min": -48.070909600004924, "cost2_max": -15.758433105483663, "system_level_velocity_min": 12.71887736627849, "outflow_rate_max": 1324.8729097678327, "cost1_max": 220.88326861001826, "cost1_min": 24.976859137148644, "cost2_mean": -30.479773806026216, "system_level_velocity_mean": 16.494671874640343, "outflow_rate_mean": 1177.7044605767985, "system_level_velocity_max": 18.630140425313634, "cost1_mean": 191.40544487185537, "outflow_rate_min": 489.1531656349236}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411429, "timesteps_since_restore": 5009915, "episodes_total": 6261, "policy_reward_mean": {}, "episode_reward_max": 595.1106314156323, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34679, "iterations_since_restore": 135, "training_iteration": 135, "episode_len_mean": 315.74, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3364.7385580539703, "timesteps_total": 5009915, "date": "2019-05-21_04-03-49", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db90f0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 43}
{"time_this_iter_s": 24.044968605041504, "hostname": "flow-main", "info": {"default": {"kl": 0.016227563843131065, "entropy": 1.4763590097427368, "policy_loss": -0.016218163073062897, "cur_lr": 0.0005000000237487257, "total_loss": 80.58679962158203, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 80.59754180908203, "vf_explained_var": 0.6250690817832947}, "grad_time_ms": 7306.527, "update_time_ms": 7.483, "load_time_ms": 3.239, "sample_time_ms": 16589.981, "num_steps_sampled": 5045046, "num_steps_trained": 5045046}, "episode_reward_min": 56.77271227618092, "episode_reward_mean": 539.0023401279794, "done": false, "time_total_s": 3388.783526659012, "custom_metrics": {"cost2_min": -45.040088586684476, "cost2_max": -15.758433105483663, "system_level_velocity_min": 12.392350102760185, "outflow_rate_max": 1306.9732519667998, "cost1_max": 218.703649601615, "cost1_min": 24.976859137148644, "cost2_mean": -30.117651011053066, "system_level_velocity_mean": 16.496344099521153, "outflow_rate_mean": 1181.7675018237721, "system_level_velocity_max": 18.5000511896516, "cost1_mean": 192.01558772556302, "outflow_rate_min": 489.1531656349236}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411453, "timesteps_since_restore": 5045046, "episodes_total": 6307, "policy_reward_mean": {}, "episode_reward_max": 595.1106314156323, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35131, "iterations_since_restore": 136, "training_iteration": 136, "episode_len_mean": 316.92, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3388.783526659012, "timesteps_total": 5045046, "date": "2019-05-21_04-04-13", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db97f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9358>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 46}
{"time_this_iter_s": 25.649645566940308, "hostname": "flow-main", "info": {"default": {"kl": 0.016141004860401154, "entropy": 1.475670337677002, "policy_loss": -0.014693980105221272, "cur_lr": 0.0005000000237487257, "total_loss": 64.68951416015625, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 64.69876098632812, "vf_explained_var": 0.738767147064209}, "grad_time_ms": 7393.765, "update_time_ms": 7.627, "load_time_ms": 3.316, "sample_time_ms": 16647.879, "num_steps_sampled": 5082006, "num_steps_trained": 5082006}, "episode_reward_min": 490.7155167268256, "episode_reward_mean": 548.150522051127, "done": false, "time_total_s": 3414.433172225952, "custom_metrics": {"cost2_min": -50.03299624590133, "cost2_max": -20.394953949725632, "system_level_velocity_min": 11.89245556102887, "outflow_rate_max": 1306.9732519667998, "cost1_max": 216.6112533902861, "cost1_min": 144.74229386627215, "cost2_mean": -31.888274955439666, "system_level_velocity_mean": 16.0323687285066, "outflow_rate_mean": 1179.7997193065341, "system_level_velocity_max": 18.283604249092757, "cost1_mean": 192.01511593012074, "outflow_rate_min": 948.0837364152741}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411479, "timesteps_since_restore": 5082006, "episodes_total": 6357, "policy_reward_mean": {}, "episode_reward_max": 595.1106314156323, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36960, "iterations_since_restore": 137, "training_iteration": 137, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3414.433172225952, "timesteps_total": 5082006, "date": "2019-05-21_04-04-39", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab898>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 50}
{"time_this_iter_s": 25.13082242012024, "hostname": "flow-main", "info": {"default": {"kl": 0.016607128083705902, "entropy": 1.477291464805603, "policy_loss": -0.014026349410414696, "cur_lr": 0.0005000000237487257, "total_loss": 76.32061004638672, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 76.32901763916016, "vf_explained_var": 0.6686071753501892}, "grad_time_ms": 7440.343, "update_time_ms": 7.551, "load_time_ms": 3.332, "sample_time_ms": 16616.723, "num_steps_sampled": 5117739, "num_steps_trained": 5117739}, "episode_reward_min": 491.5317147070095, "episode_reward_mean": 546.8588182321243, "done": false, "time_total_s": 3439.5639946460724, "custom_metrics": {"cost2_min": -50.03299624590133, "cost2_max": -19.37374311958136, "system_level_velocity_min": 11.89245556102887, "outflow_rate_max": 1312.9357325594538, "cost1_max": 216.81611601308532, "cost1_min": 144.74229386627215, "cost2_mean": -31.907713954608194, "system_level_velocity_mean": 15.940264308689853, "outflow_rate_mean": 1175.0300169032046, "system_level_velocity_max": 18.434110293102567, "cost1_mean": 190.86388397453257, "outflow_rate_min": 948.0837364152741}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411504, "timesteps_since_restore": 5117739, "episodes_total": 6401, "policy_reward_mean": {}, "episode_reward_max": 592.8290061348218, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35733, "iterations_since_restore": 138, "training_iteration": 138, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3439.5639946460724, "timesteps_total": 5117739, "date": "2019-05-21_04-05-04", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db91d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db90b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db92e8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 44}
{"time_this_iter_s": 24.373438358306885, "hostname": "flow-main", "info": {"default": {"kl": 0.016127703711390495, "entropy": 1.475879430770874, "policy_loss": -0.014018607325851917, "cur_lr": 0.0005000000237487257, "total_loss": 76.42743682861328, "cur_kl_coeff": 0.3375000059604645, "vf_loss": 76.43600463867188, "vf_explained_var": 0.6426621079444885}, "grad_time_ms": 7522.492, "update_time_ms": 7.565, "load_time_ms": 3.369, "sample_time_ms": 16544.914, "num_steps_sampled": 5153220, "num_steps_trained": 5153220}, "episode_reward_min": 497.37646196662655, "episode_reward_mean": 550.8937223047747, "done": false, "time_total_s": 3463.9374330043793, "custom_metrics": {"cost2_min": -50.03299624590133, "cost2_max": -19.37374311958136, "system_level_velocity_min": 12.519577386362467, "outflow_rate_max": 1312.9357325594538, "cost1_max": 216.81611601308532, "cost1_min": 149.61950810502273, "cost2_mean": -30.95932710622213, "system_level_velocity_mean": 16.15577753052443, "outflow_rate_mean": 1187.1480083906638, "system_level_velocity_max": 18.434110293102567, "cost1_mean": 193.3710928394899, "outflow_rate_min": 989.2983832054929}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411528, "timesteps_since_restore": 5153220, "episodes_total": 6445, "policy_reward_mean": {}, "episode_reward_max": 592.8290061348218, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35481, "iterations_since_restore": 139, "training_iteration": 139, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3463.9374330043793, "timesteps_total": 5153220, "date": "2019-05-21_04-05-28", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db92b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9630>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 44}
{"time_this_iter_s": 23.849918127059937, "hostname": "flow-main", "info": {"default": {"kl": 0.016338063403964043, "entropy": 1.4804433584213257, "policy_loss": -0.014429519884288311, "cur_lr": 0.0005000000237487257, "total_loss": 72.49464416503906, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 72.50355529785156, "vf_explained_var": 0.652744472026825}, "grad_time_ms": 7519.558, "update_time_ms": 7.5, "load_time_ms": 3.725, "sample_time_ms": 16492.841, "num_steps_sampled": 5188851, "num_steps_trained": 5188851}, "episode_reward_min": 509.57806474326077, "episode_reward_mean": 552.3826504102414, "done": false, "time_total_s": 3487.787351131439, "custom_metrics": {"cost2_min": -44.42113835133891, "cost2_max": -19.37374311958136, "system_level_velocity_min": 12.519577386362467, "outflow_rate_max": 1307.6336840509814, "cost1_max": 217.74667039342373, "cost1_min": 149.61950810502273, "cost2_mean": -30.98542003690753, "system_level_velocity_mean": 16.223618003077515, "outflow_rate_mean": 1193.9235932231243, "system_level_velocity_max": 18.38991698801938, "cost1_mean": 194.35430153124867, "outflow_rate_min": 989.2983832054929}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411552, "timesteps_since_restore": 5188851, "episodes_total": 6494, "policy_reward_mean": {}, "episode_reward_max": 588.2754503425532, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35631, "iterations_since_restore": 140, "training_iteration": 140, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3487.787351131439, "timesteps_total": 5188851, "date": "2019-05-21_04-05-52", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9828>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 24.925392866134644, "hostname": "flow-main", "info": {"default": {"kl": 0.016484150663018227, "entropy": 1.4850455522537231, "policy_loss": -0.015529385767877102, "cur_lr": 0.0005000000237487257, "total_loss": 78.55975341796875, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 78.56970977783203, "vf_explained_var": 0.634259819984436}, "grad_time_ms": 7749.448, "update_time_ms": 7.383, "load_time_ms": 3.786, "sample_time_ms": 16400.908, "num_steps_sampled": 5224777, "num_steps_trained": 5224777}, "episode_reward_min": 512.5334828449704, "episode_reward_mean": 551.7551798038272, "done": false, "time_total_s": 3512.712743997574, "custom_metrics": {"cost2_min": -43.13757717140614, "cost2_max": -21.047570626302377, "system_level_velocity_min": 13.08319904664831, "outflow_rate_max": 1311.6646048516318, "cost1_max": 217.99365718759117, "cost1_min": 159.27981672910948, "cost2_mean": -31.837067084308732, "system_level_velocity_mean": 16.05032022130218, "outflow_rate_mean": 1186.1011816506202, "system_level_velocity_max": 18.38991698801938, "cost1_mean": 192.79478771050583, "outflow_rate_min": 1032.5727278386316}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411577, "timesteps_since_restore": 5224777, "episodes_total": 6541, "policy_reward_mean": {}, "episode_reward_max": 596.1603118670422, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35926, "iterations_since_restore": 141, "training_iteration": 141, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3512.712743997574, "timesteps_total": 5224777, "date": "2019-05-21_04-06-17", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99780>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 47}
{"time_this_iter_s": 23.10507893562317, "hostname": "flow-main", "info": {"default": {"kl": 0.018375961109995842, "entropy": 1.4690628051757812, "policy_loss": -0.01322915218770504, "cur_lr": 0.0005000000237487257, "total_loss": 71.43807220458984, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 71.4450912475586, "vf_explained_var": 0.6352804899215698}, "grad_time_ms": 7877.638, "update_time_ms": 7.556, "load_time_ms": 3.77, "sample_time_ms": 16288.642, "num_steps_sampled": 5259750, "num_steps_trained": 5259750}, "episode_reward_min": 46.035650662276204, "episode_reward_mean": 548.0757843378339, "done": false, "time_total_s": 3535.817822933197, "custom_metrics": {"cost2_min": -45.98205454713249, "cost2_max": -10.65946551817112, "system_level_velocity_min": 13.236759632187436, "outflow_rate_max": 1313.3186597542244, "cost1_max": 218.51177900549004, "cost1_min": 17.99643643564805, "cost2_mean": -31.64178492792812, "system_level_velocity_mean": 16.183723616986867, "outflow_rate_mean": 1183.6356292266541, "system_level_velocity_max": 18.448602946581662, "cost1_mean": 192.29345585438105, "outflow_rate_min": 482.07223716978217}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411600, "timesteps_since_restore": 5259750, "episodes_total": 6583, "policy_reward_mean": {}, "episode_reward_max": 596.1603118670422, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34973, "iterations_since_restore": 142, "training_iteration": 142, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3535.817822933197, "timesteps_total": 5259750, "date": "2019-05-21_04-06-40", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db97b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9e10>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 42}
{"time_this_iter_s": 23.250413417816162, "hostname": "flow-main", "info": {"default": {"kl": 0.01599782332777977, "entropy": 1.4805452823638916, "policy_loss": -0.016371512785553932, "cur_lr": 0.0005000000237487257, "total_loss": 80.22999572753906, "cur_kl_coeff": 0.3375000059604645, "vf_loss": 80.240966796875, "vf_explained_var": 0.6428792476654053}, "grad_time_ms": 7793.837, "update_time_ms": 7.475, "load_time_ms": 3.875, "sample_time_ms": 16239.332, "num_steps_sampled": 5295239, "num_steps_trained": 5295239}, "episode_reward_min": 46.035650662276204, "episode_reward_mean": 549.9616376804343, "done": false, "time_total_s": 3559.068236351013, "custom_metrics": {"cost2_min": -45.98205454713249, "cost2_max": -10.65946551817112, "system_level_velocity_min": 13.005912027653599, "outflow_rate_max": 1313.3186597542244, "cost1_max": 218.51177900549004, "cost1_min": 17.99643643564805, "cost2_mean": -31.15429677946538, "system_level_velocity_mean": 16.43493316352583, "outflow_rate_mean": 1194.651092688817, "system_level_velocity_max": 18.448602946581662, "cost1_mean": 194.92105364634085, "outflow_rate_min": 482.07223716978217}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411623, "timesteps_since_restore": 5295239, "episodes_total": 6633, "policy_reward_mean": {}, "episode_reward_max": 596.1603118670422, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35489, "iterations_since_restore": 143, "training_iteration": 143, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3559.068236351013, "timesteps_total": 5295239, "date": "2019-05-21_04-07-03", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1278>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 50}
{"time_this_iter_s": 23.74084448814392, "hostname": "flow-main", "info": {"default": {"kl": 0.016162598505616188, "entropy": 1.4798275232315063, "policy_loss": -0.014901584945619106, "cur_lr": 0.0005000000237487257, "total_loss": 75.33841705322266, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 75.34786987304688, "vf_explained_var": 0.6700683832168579}, "grad_time_ms": 7865.056, "update_time_ms": 7.445, "load_time_ms": 3.976, "sample_time_ms": 16172.291, "num_steps_sampled": 5330972, "num_steps_trained": 5330972}, "episode_reward_min": 56.703787855154026, "episode_reward_mean": 544.9612492400976, "done": false, "time_total_s": 3582.809080839157, "custom_metrics": {"cost2_min": -47.080447737693916, "cost2_max": -15.535760257918586, "system_level_velocity_min": 12.794832730362133, "outflow_rate_max": 1305.548635806254, "cost1_max": 217.3877071711131, "cost1_min": 22.92789645628148, "cost2_mean": -31.57267409882911, "system_level_velocity_mean": 16.23824175642134, "outflow_rate_mean": 1181.214804185041, "system_level_velocity_max": 18.417529296098518, "cost1_mean": 192.62350489810285, "outflow_rate_min": 460.7989278777953}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411647, "timesteps_since_restore": 5330972, "episodes_total": 6681, "policy_reward_mean": {}, "episode_reward_max": 591.3418990806684, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35733, "iterations_since_restore": 144, "training_iteration": 144, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3582.809080839157, "timesteps_total": 5330972, "date": "2019-05-21_04-07-27", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1048>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 48}
{"time_this_iter_s": 23.24563241004944, "hostname": "flow-main", "info": {"default": {"kl": 0.017102044075727463, "entropy": 1.487878680229187, "policy_loss": -0.014951130375266075, "cur_lr": 0.0005000000237487257, "total_loss": 75.18885803222656, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 75.19804382324219, "vf_explained_var": 0.6301819086074829}, "grad_time_ms": 7937.979, "update_time_ms": 7.254, "load_time_ms": 4.142, "sample_time_ms": 16115.396, "num_steps_sampled": 5366319, "num_steps_trained": 5366319}, "episode_reward_min": 56.703787855154026, "episode_reward_mean": 542.0925172758851, "done": false, "time_total_s": 3606.0547132492065, "custom_metrics": {"cost2_min": -47.080447737693916, "cost2_max": -15.535760257918586, "system_level_velocity_min": 12.532342858113731, "outflow_rate_max": 1302.6676660885225, "cost1_max": 217.3877071711131, "cost1_min": 22.92789645628148, "cost2_mean": -31.127460068877596, "system_level_velocity_mean": 16.14235370810334, "outflow_rate_mean": 1178.0121579188944, "system_level_velocity_max": 18.417529296098518, "cost1_mean": 191.3826702489296, "outflow_rate_min": 460.7989278777953}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411671, "timesteps_since_restore": 5366319, "episodes_total": 6723, "policy_reward_mean": {}, "episode_reward_max": 591.3418990806684, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35347, "iterations_since_restore": 145, "training_iteration": 145, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3606.0547132492065, "timesteps_total": 5366319, "date": "2019-05-21_04-07-51", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9e10>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 42}
{"time_this_iter_s": 24.52756667137146, "hostname": "flow-main", "info": {"default": {"kl": 0.01759745553135872, "entropy": 1.4833728075027466, "policy_loss": -0.014777228236198425, "cur_lr": 0.0005000000237487257, "total_loss": 86.7496566772461, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 86.75849151611328, "vf_explained_var": 0.609566867351532}, "grad_time_ms": 7942.009, "update_time_ms": 7.17, "load_time_ms": 4.081, "sample_time_ms": 16160.616, "num_steps_sampled": 5401957, "num_steps_trained": 5401957}, "episode_reward_min": 502.4901053909246, "episode_reward_mean": 544.1759454210234, "done": false, "time_total_s": 3630.582279920578, "custom_metrics": {"cost2_min": -51.252157885500196, "cost2_max": -21.906238706876014, "system_level_velocity_min": 12.532342858113731, "outflow_rate_max": 1313.8775288018435, "cost1_max": 218.60566048242254, "cost1_min": 154.54627446965574, "cost2_mean": -32.02516158148856, "system_level_velocity_mean": 15.945896243523189, "outflow_rate_mean": 1181.4331756164074, "system_level_velocity_max": 18.33906047254278, "cost1_mean": 191.12799879984468, "outflow_rate_min": 1016.1464100915953}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411695, "timesteps_since_restore": 5401957, "episodes_total": 6772, "policy_reward_mean": {}, "episode_reward_max": 587.4715084607359, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35638, "iterations_since_restore": 146, "training_iteration": 146, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3630.582279920578, "timesteps_total": 5401957, "date": "2019-05-21_04-08-15", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc10b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1ef0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 24.719709873199463, "hostname": "flow-main", "info": {"default": {"kl": 0.016643822193145752, "entropy": 1.493057131767273, "policy_loss": -0.015367449261248112, "cur_lr": 0.0005000000237487257, "total_loss": 85.53326416015625, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 85.54301452636719, "vf_explained_var": 0.5948135852813721}, "grad_time_ms": 7815.694, "update_time_ms": 7.032, "load_time_ms": 3.822, "sample_time_ms": 16193.112, "num_steps_sampled": 5437589, "num_steps_trained": 5437589}, "episode_reward_min": 56.8142752400749, "episode_reward_mean": 541.3733648568171, "done": false, "time_total_s": 3655.3019897937775, "custom_metrics": {"cost2_min": -51.252157885500196, "cost2_max": -11.248057353372083, "system_level_velocity_min": 13.018082001582018, "outflow_rate_max": 1313.8775288018435, "cost1_max": 218.60566048242254, "cost1_min": 22.42699518210255, "cost2_mean": -32.18644129559666, "system_level_velocity_mean": 16.148354724135107, "outflow_rate_mean": 1180.9713820807297, "system_level_velocity_max": 18.33906047254278, "cost1_mean": 191.1889024147061, "outflow_rate_min": 478.24926648870354}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411720, "timesteps_since_restore": 5437589, "episodes_total": 6821, "policy_reward_mean": {}, "episode_reward_max": 581.3827740562283, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35632, "iterations_since_restore": 147, "training_iteration": 147, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3655.3019897937775, "timesteps_total": 5437589, "date": "2019-05-21_04-08-40", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4fd0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 23.95255160331726, "hostname": "flow-main", "info": {"default": {"kl": 0.01793222874403, "entropy": 1.4967302083969116, "policy_loss": -0.015942541882395744, "cur_lr": 0.0005000000237487257, "total_loss": 76.33037567138672, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 76.34026336669922, "vf_explained_var": 0.6108783483505249}, "grad_time_ms": 7613.852, "update_time_ms": 7.027, "load_time_ms": 3.841, "sample_time_ms": 16275.377, "num_steps_sampled": 5472924, "num_steps_trained": 5472924}, "episode_reward_min": 56.8142752400749, "episode_reward_mean": 539.492387560839, "done": false, "time_total_s": 3679.2545413970947, "custom_metrics": {"cost2_min": -58.51284860805453, "cost2_max": -11.248057353372083, "system_level_velocity_min": 13.079638649043263, "outflow_rate_max": 1283.109855867836, "cost1_max": 212.55678900223887, "cost1_min": 22.42699518210255, "cost2_mean": -32.33856116351027, "system_level_velocity_mean": 16.04711950129273, "outflow_rate_mean": 1176.9865421486916, "system_level_velocity_max": 18.080229238013978, "cost1_mean": 190.01194203703446, "outflow_rate_min": 478.24926648870354}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411744, "timesteps_since_restore": 5472924, "episodes_total": 6864, "policy_reward_mean": {}, "episode_reward_max": 576.6078397725825, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35335, "iterations_since_restore": 148, "training_iteration": 148, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3679.2545413970947, "timesteps_total": 5472924, "date": "2019-05-21_04-09-04", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4828>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 43}
{"time_this_iter_s": 25.163371801376343, "hostname": "flow-main", "info": {"default": {"kl": 0.01797245256602764, "entropy": 1.5103963613510132, "policy_loss": -0.016372093930840492, "cur_lr": 0.0005000000237487257, "total_loss": 78.99072265625, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 79.00102996826172, "vf_explained_var": 0.6337206959724426}, "grad_time_ms": 7595.024, "update_time_ms": 6.87, "load_time_ms": 3.677, "sample_time_ms": 16373.13, "num_steps_sampled": 5508365, "num_steps_trained": 5508365}, "episode_reward_min": 491.96219377451877, "episode_reward_mean": 540.7438924124965, "done": false, "time_total_s": 3704.417913198471, "custom_metrics": {"cost2_min": -58.51284860805453, "cost2_max": -22.56320147949218, "system_level_velocity_min": 12.855583220432262, "outflow_rate_max": 1282.9764851395435, "cost1_max": 212.12959635308144, "cost1_min": 156.07696624928184, "cost2_mean": -32.71623007715949, "system_level_velocity_mean": 15.907233226627218, "outflow_rate_mean": 1177.6871653692212, "system_level_velocity_max": 17.962817480642514, "cost1_mean": 190.31417369437492, "outflow_rate_min": 989.2260512084762}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411769, "timesteps_since_restore": 5508365, "episodes_total": 6910, "policy_reward_mean": {}, "episode_reward_max": 577.9667088850022, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35441, "iterations_since_restore": 149, "training_iteration": 149, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3704.417913198471, "timesteps_total": 5508365, "date": "2019-05-21_04-09-29", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc14a8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 46}
{"time_this_iter_s": 25.28141164779663, "hostname": "flow-main", "info": {"default": {"kl": 0.016948476433753967, "entropy": 1.5197138786315918, "policy_loss": -0.015491765923798084, "cur_lr": 0.0005000000237487257, "total_loss": 78.61974334716797, "cur_kl_coeff": 0.3375000059604645, "vf_loss": 78.62950897216797, "vf_explained_var": 0.627792477607727}, "grad_time_ms": 7747.762, "update_time_ms": 7.031, "load_time_ms": 3.281, "sample_time_ms": 16362.161, "num_steps_sampled": 5543912, "num_steps_trained": 5543912}, "episode_reward_min": 491.96219377451877, "episode_reward_mean": 541.1037464162753, "done": false, "time_total_s": 3729.6993248462677, "custom_metrics": {"cost2_min": -50.68093216558907, "cost2_max": -20.84262166817718, "system_level_velocity_min": 12.432562168378885, "outflow_rate_max": 1282.9764851395435, "cost1_max": 212.12959635308144, "cost1_min": 148.91245533190488, "cost2_mean": -31.588640640408855, "system_level_velocity_mean": 16.010941213111003, "outflow_rate_mean": 1179.5143583715283, "system_level_velocity_max": 17.962817480642514, "cost1_mean": 191.43675740897882, "outflow_rate_min": 968.2823740231811}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411794, "timesteps_since_restore": 5543912, "episodes_total": 6959, "policy_reward_mean": {}, "episode_reward_max": 583.7062968224639, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35547, "iterations_since_restore": 150, "training_iteration": 150, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3729.6993248462677, "timesteps_total": 5543912, "date": "2019-05-21_04-09-54", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9fd0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 23.611036777496338, "hostname": "flow-main", "info": {"default": {"kl": 0.016592301428318024, "entropy": 1.5164135694503784, "policy_loss": -0.01611609011888504, "cur_lr": 0.0005000000237487257, "total_loss": 77.35491180419922, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 77.36542510986328, "vf_explained_var": 0.6101362705230713}, "grad_time_ms": 7676.17, "update_time_ms": 7.18, "load_time_ms": 3.21, "sample_time_ms": 16302.171, "num_steps_sampled": 5579347, "num_steps_trained": 5579347}, "episode_reward_min": 491.4495358748472, "episode_reward_mean": 539.689032297046, "done": false, "time_total_s": 3753.310361623764, "custom_metrics": {"cost2_min": -50.82111483293346, "cost2_max": -20.84262166817718, "system_level_velocity_min": 12.432562168378885, "outflow_rate_max": 1297.7884927793514, "cost1_max": 211.54819996292588, "cost1_min": 148.91245533190488, "cost2_mean": -32.0116134868258, "system_level_velocity_mean": 15.863399660105433, "outflow_rate_mean": 1171.529884756842, "system_level_velocity_max": 17.960728961907087, "cost1_mean": 189.7536999659477, "outflow_rate_min": 968.2823740231811}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411818, "timesteps_since_restore": 5579347, "episodes_total": 7004, "policy_reward_mean": {}, "episode_reward_max": 583.7062968224639, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35435, "iterations_since_restore": 151, "training_iteration": 151, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3753.310361623764, "timesteps_total": 5579347, "date": "2019-05-21_04-10-18", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc17f0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 45}
{"time_this_iter_s": 23.99954319000244, "hostname": "flow-main", "info": {"default": {"kl": 0.017277035862207413, "entropy": 1.5396604537963867, "policy_loss": -0.015441453084349632, "cur_lr": 0.0005000000237487257, "total_loss": 74.74546813964844, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 74.75507354736328, "vf_explained_var": 0.654788076877594}, "grad_time_ms": 7729.251, "update_time_ms": 7.148, "load_time_ms": 3.293, "sample_time_ms": 16337.206, "num_steps_sampled": 5615482, "num_steps_trained": 5615482}, "episode_reward_min": 477.2475437638639, "episode_reward_mean": 535.2218747361669, "done": false, "time_total_s": 3777.3099048137665, "custom_metrics": {"cost2_min": -50.82111483293346, "cost2_max": -21.44921557033165, "system_level_velocity_min": 9.889219818026765, "outflow_rate_max": 1297.7884927793514, "cost1_max": 213.33649675305884, "cost1_min": 122.98105143829959, "cost2_mean": -32.01088018040849, "system_level_velocity_mean": 15.678814962763672, "outflow_rate_mean": 1160.9505619951656, "system_level_velocity_max": 18.242553444309458, "cost1_mean": 187.56629848372896, "outflow_rate_min": 882.1415073927155}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411842, "timesteps_since_restore": 5615482, "episodes_total": 7047, "policy_reward_mean": {}, "episode_reward_max": 578.1770632600677, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36135, "iterations_since_restore": 152, "training_iteration": 152, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3777.3099048137665, "timesteps_total": 5615482, "date": "2019-05-21_04-10-42", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db90f0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 43}
{"time_this_iter_s": 23.789536952972412, "hostname": "flow-main", "info": {"default": {"kl": 0.017157696187496185, "entropy": 1.5397439002990723, "policy_loss": -0.017015768215060234, "cur_lr": 0.0005000000237487257, "total_loss": 80.73652648925781, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 80.74774932861328, "vf_explained_var": 0.6091934442520142}, "grad_time_ms": 7870.631, "update_time_ms": 7.193, "load_time_ms": 3.258, "sample_time_ms": 16250.523, "num_steps_sampled": 5651319, "num_steps_trained": 5651319}, "episode_reward_min": 198.20331294267814, "episode_reward_mean": 536.7458005013143, "done": false, "time_total_s": 3801.099441766739, "custom_metrics": {"cost2_min": -45.910504477279375, "cost2_max": -17.97097516371776, "system_level_velocity_min": 9.889219818026765, "outflow_rate_max": 1324.9041720779226, "cost1_max": 213.33649675305884, "cost1_min": 76.87481623304855, "cost2_mean": -32.04197595255949, "system_level_velocity_mean": 15.876948148920205, "outflow_rate_mean": 1167.5933047999513, "system_level_velocity_max": 18.242553444309458, "cost1_mean": 188.3703989799122, "outflow_rate_min": 753.6550011316102}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411866, "timesteps_since_restore": 5651319, "episodes_total": 7097, "policy_reward_mean": {}, "episode_reward_max": 594.182885750413, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35837, "iterations_since_restore": 153, "training_iteration": 153, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3801.099441766739, "timesteps_total": 5651319, "date": "2019-05-21_04-11-06", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab2b0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 50}
{"time_this_iter_s": 25.386488437652588, "hostname": "flow-main", "info": {"default": {"kl": 0.0167585089802742, "entropy": 1.5610874891281128, "policy_loss": -0.01462715957313776, "cur_lr": 0.0005000000237487257, "total_loss": 69.32887268066406, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 69.33784484863281, "vf_explained_var": 0.6695742011070251}, "grad_time_ms": 7983.992, "update_time_ms": 7.28, "load_time_ms": 3.249, "sample_time_ms": 16301.505, "num_steps_sampled": 5688353, "num_steps_trained": 5688353}, "episode_reward_min": 198.20331294267814, "episode_reward_mean": 541.0065380917351, "done": false, "time_total_s": 3826.4859302043915, "custom_metrics": {"cost2_min": -46.63909067536218, "cost2_max": -17.97097516371776, "system_level_velocity_min": 12.196573038745845, "outflow_rate_max": 1324.9041720779226, "cost1_max": 213.33649675305884, "cost1_min": 76.87481623304855, "cost2_mean": -33.729180672458995, "system_level_velocity_mean": 15.751283667031846, "outflow_rate_mean": 1168.9260063689826, "system_level_velocity_max": 18.242553444309458, "cost1_mean": 187.34923970710537, "outflow_rate_min": 753.6550011316102}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411891, "timesteps_since_restore": 5688353, "episodes_total": 7144, "policy_reward_mean": {}, "episode_reward_max": 594.182885750413, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37034, "iterations_since_restore": 154, "training_iteration": 154, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3826.4859302043915, "timesteps_total": 5688353, "date": "2019-05-21_04-11-31", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc17f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc17b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1208>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 47}
{"time_this_iter_s": 23.72587561607361, "hostname": "flow-main", "info": {"default": {"kl": 0.016874436289072037, "entropy": 1.5672228336334229, "policy_loss": -0.016423096880316734, "cur_lr": 0.0005000000237487257, "total_loss": 69.56336212158203, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 69.57408905029297, "vf_explained_var": 0.6521151661872864}, "grad_time_ms": 8028.205, "update_time_ms": 7.34, "load_time_ms": 3.128, "sample_time_ms": 16306.205, "num_steps_sampled": 5725652, "num_steps_trained": 5725652}, "episode_reward_min": 198.20331294267814, "episode_reward_mean": 539.6235409533982, "done": false, "time_total_s": 3850.211805820465, "custom_metrics": {"cost2_min": -47.5266252097593, "cost2_max": -21.710636781413566, "system_level_velocity_min": 12.196573038745845, "outflow_rate_max": 1329.9512515802778, "cost1_max": 213.99737463572362, "cost1_min": 76.87481623304855, "cost2_mean": -35.43569687953258, "system_level_velocity_mean": 15.365187124511085, "outflow_rate_mean": 1156.7124888285562, "system_level_velocity_max": 17.965639442099498, "cost1_mean": 183.37908637703248, "outflow_rate_min": 753.6550011316102}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411915, "timesteps_since_restore": 5725652, "episodes_total": 7186, "policy_reward_mean": {}, "episode_reward_max": 599.6318027482192, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37299, "iterations_since_restore": 155, "training_iteration": 155, "episode_len_mean": 322.92, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3850.211805820465, "timesteps_total": 5725652, "date": "2019-05-21_04-11-55", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d999e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d996d8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 42}
{"time_this_iter_s": 25.171156644821167, "hostname": "flow-main", "info": {"default": {"kl": 0.01658346876502037, "entropy": 1.5686874389648438, "policy_loss": -0.014659308828413486, "cur_lr": 0.0005000000237487257, "total_loss": 75.58966827392578, "cur_kl_coeff": 0.3375000059604645, "vf_loss": 75.5987319946289, "vf_explained_var": 0.6889660954475403}, "grad_time_ms": 8079.507, "update_time_ms": 7.336, "load_time_ms": 3.139, "sample_time_ms": 16318.401, "num_steps_sampled": 5763369, "num_steps_trained": 5763369}, "episode_reward_min": 486.3060957616359, "episode_reward_mean": 541.1646690868822, "done": false, "time_total_s": 3875.3829624652863, "custom_metrics": {"cost2_min": -54.868885289839966, "cost2_max": -23.219272031662626, "system_level_velocity_min": 11.359532305195337, "outflow_rate_max": 1329.9512515802778, "cost1_max": 213.99737463572362, "cost1_min": 137.92658378211252, "cost2_mean": -35.483736087674956, "system_level_velocity_mean": 15.35379063175421, "outflow_rate_mean": 1154.616223464819, "system_level_velocity_max": 17.965639442099498, "cost1_mean": 184.4685418754954, "outflow_rate_min": 925.1547169708971}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411940, "timesteps_since_restore": 5763369, "episodes_total": 7236, "policy_reward_mean": {}, "episode_reward_max": 599.6318027482192, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37717, "iterations_since_restore": 156, "training_iteration": 156, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3875.3829624652863, "timesteps_total": 5763369, "date": "2019-05-21_04-12-20", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab9b0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 50}
{"time_this_iter_s": 24.38663125038147, "hostname": "flow-main", "info": {"default": {"kl": 0.019102612510323524, "entropy": 1.55831778049469, "policy_loss": -0.016351541504263878, "cur_lr": 0.0005000000237487257, "total_loss": 77.65473175048828, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 77.66463470458984, "vf_explained_var": 0.6440231204032898}, "grad_time_ms": 8090.686, "update_time_ms": 7.324, "load_time_ms": 3.288, "sample_time_ms": 16275.347, "num_steps_sampled": 5799375, "num_steps_trained": 5799375}, "episode_reward_min": 58.63524596109992, "episode_reward_mean": 536.6136017230693, "done": false, "time_total_s": 3899.7695937156677, "custom_metrics": {"cost2_min": -54.868885289839966, "cost2_max": -13.504064603783576, "system_level_velocity_min": 11.359532305195337, "outflow_rate_max": 1332.0410078828295, "cost1_max": 211.63428782800696, "cost1_min": 24.817306586440118, "cost2_mean": -34.4557453526777, "system_level_velocity_mean": 15.60748251749822, "outflow_rate_mean": 1153.6459660049964, "system_level_velocity_max": 17.947648245477406, "cost1_mean": 184.90562227186913, "outflow_rate_min": 511.6785236005303}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411965, "timesteps_since_restore": 5799375, "episodes_total": 7283, "policy_reward_mean": {}, "episode_reward_max": 586.9012701509732, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36006, "iterations_since_restore": 157, "training_iteration": 157, "episode_len_mean": 321.85, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3899.7695937156677, "timesteps_total": 5799375, "date": "2019-05-21_04-12-45", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1898>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 47}
{"time_this_iter_s": 23.97046184539795, "hostname": "flow-main", "info": {"default": {"kl": 0.017183713614940643, "entropy": 1.569457769393921, "policy_loss": -0.016312599182128906, "cur_lr": 0.0005000000237487257, "total_loss": 71.26979064941406, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 71.28030395507812, "vf_explained_var": 0.6475722193717957}, "grad_time_ms": 8141.485, "update_time_ms": 7.271, "load_time_ms": 3.317, "sample_time_ms": 16226.96, "num_steps_sampled": 5835900, "num_steps_trained": 5835900}, "episode_reward_min": 58.63524596109992, "episode_reward_mean": 536.0401182337297, "done": false, "time_total_s": 3923.7400555610657, "custom_metrics": {"cost2_min": -46.466955246011814, "cost2_max": -13.504064603783576, "system_level_velocity_min": 11.652375005570164, "outflow_rate_max": 1332.0410078828295, "cost1_max": 211.63428782800696, "cost1_min": 24.817306586440118, "cost2_mean": -32.846991354919574, "system_level_velocity_mean": 15.697369411302855, "outflow_rate_mean": 1157.9626452655448, "system_level_velocity_max": 17.947648245477406, "cost1_mean": 185.99791079982597, "outflow_rate_min": 511.6785236005303}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558411989, "timesteps_since_restore": 5835900, "episodes_total": 7326, "policy_reward_mean": {}, "episode_reward_max": 589.5865850495285, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36525, "iterations_since_restore": 158, "training_iteration": 158, "episode_len_mean": 321.85, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3923.7400555610657, "timesteps_total": 5835900, "date": "2019-05-21_04-13-09", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db90f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db97b8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 43}
{"time_this_iter_s": 24.289835691452026, "hostname": "flow-main", "info": {"default": {"kl": 0.01794775016605854, "entropy": 1.5701829195022583, "policy_loss": -0.015198549255728722, "cur_lr": 0.0005000000237487257, "total_loss": 73.7845230102539, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 73.79366302490234, "vf_explained_var": 0.6445434093475342}, "grad_time_ms": 8011.727, "update_time_ms": 7.385, "load_time_ms": 3.477, "sample_time_ms": 16269.783, "num_steps_sampled": 5872237, "num_steps_trained": 5872237}, "episode_reward_min": 58.63524596109992, "episode_reward_mean": 537.314390566513, "done": false, "time_total_s": 3948.0298912525177, "custom_metrics": {"cost2_min": -46.41068589163357, "cost2_max": -13.504064603783576, "system_level_velocity_min": 11.652375005570164, "outflow_rate_max": 1309.9380330500226, "cost1_max": 213.0368719927057, "cost1_min": 24.817306586440118, "cost2_mean": -32.31680914009895, "system_level_velocity_mean": 15.78759209706741, "outflow_rate_mean": 1160.850828339102, "system_level_velocity_max": 18.12974447904918, "cost1_mean": 187.2037698806337, "outflow_rate_min": 511.6785236005303}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412013, "timesteps_since_restore": 5872237, "episodes_total": 7374, "policy_reward_mean": {}, "episode_reward_max": 589.5865850495285, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36337, "iterations_since_restore": 159, "training_iteration": 159, "episode_len_mean": 322.13, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3948.0298912525177, "timesteps_total": 5872237, "date": "2019-05-21_04-13-33", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc16d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1550>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 48}
{"time_this_iter_s": 25.05521011352539, "hostname": "flow-main", "info": {"default": {"kl": 0.016810521483421326, "entropy": 1.5796188116073608, "policy_loss": -0.01332277711480856, "cur_lr": 0.0005000000237487257, "total_loss": 80.40576934814453, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 80.41342163085938, "vf_explained_var": 0.6420873999595642}, "grad_time_ms": 7908.065, "update_time_ms": 7.259, "load_time_ms": 3.605, "sample_time_ms": 16350.664, "num_steps_sampled": 5908723, "num_steps_trained": 5908723}, "episode_reward_min": 484.8551613066797, "episode_reward_mean": 541.1446658540514, "done": false, "time_total_s": 3973.085101366043, "custom_metrics": {"cost2_min": -48.42571784088877, "cost2_max": -19.72203986532966, "system_level_velocity_min": 12.178815831476378, "outflow_rate_max": 1318.2771125876577, "cost1_max": 213.0368719927057, "cost1_min": 146.75851758951103, "cost2_mean": -32.701949388775, "system_level_velocity_mean": 15.686319693086608, "outflow_rate_mean": 1161.64397411759, "system_level_velocity_max": 18.12974447904918, "cost1_mean": 188.00103406422485, "outflow_rate_min": 944.9412005703703}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412038, "timesteps_since_restore": 5908723, "episodes_total": 7422, "policy_reward_mean": {}, "episode_reward_max": 586.2143227830276, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36486, "iterations_since_restore": 160, "training_iteration": 160, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3973.085101366043, "timesteps_total": 5908723, "date": "2019-05-21_04-13-58", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4cf8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 48}
{"time_this_iter_s": 24.04070782661438, "hostname": "flow-main", "info": {"default": {"kl": 0.016699761152267456, "entropy": 1.5908561944961548, "policy_loss": -0.014894616790115833, "cur_lr": 0.0005000000237487257, "total_loss": 81.97570037841797, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 81.98497009277344, "vf_explained_var": 0.5447437167167664}, "grad_time_ms": 7908.369, "update_time_ms": 7.178, "load_time_ms": 3.652, "sample_time_ms": 16393.6, "num_steps_sampled": 5943782, "num_steps_trained": 5943782}, "episode_reward_min": 357.56596063622163, "episode_reward_mean": 538.2370042783183, "done": false, "time_total_s": 3997.1258091926575, "custom_metrics": {"cost2_min": -48.42571784088877, "cost2_max": -18.33737957678409, "system_level_velocity_min": 12.178815831476378, "outflow_rate_max": 1318.2771125876577, "cost1_max": 212.6970776277853, "cost1_min": 136.28008001294234, "cost2_mean": -31.191019652347723, "system_level_velocity_mean": 15.831087636953349, "outflow_rate_mean": 1163.9239530438344, "system_level_velocity_max": 17.915817228056166, "cost1_mean": 188.29453898921136, "outflow_rate_min": 944.9412005703703}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412062, "timesteps_since_restore": 5943782, "episodes_total": 7466, "policy_reward_mean": {}, "episode_reward_max": 586.2143227830276, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35059, "iterations_since_restore": 161, "training_iteration": 161, "episode_len_mean": 322.87, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 3997.1258091926575, "timesteps_total": 5943782, "date": "2019-05-21_04-14-22", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1780>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 44}
{"time_this_iter_s": 26.064732551574707, "hostname": "flow-main", "info": {"default": {"kl": 0.01721159927546978, "entropy": 1.591084599494934, "policy_loss": -0.01547006145119667, "cur_lr": 0.0005000000237487257, "total_loss": 83.6717529296875, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 83.68140411376953, "vf_explained_var": 0.5906894207000732}, "grad_time_ms": 8029.023, "update_time_ms": 7.134, "load_time_ms": 3.607, "sample_time_ms": 16479.964, "num_steps_sampled": 5980227, "num_steps_trained": 5980227}, "episode_reward_min": 54.744195282236724, "episode_reward_mean": 528.6510579481823, "done": false, "time_total_s": 4023.190541744232, "custom_metrics": {"cost2_min": -48.641581154541925, "cost2_max": -16.34782033861421, "system_level_velocity_min": 12.178815831476378, "outflow_rate_max": 1305.7199722203168, "cost1_max": 212.6970776277853, "cost1_min": 23.184314029166398, "cost2_mean": -30.842689323190758, "system_level_velocity_mean": 15.802118191253417, "outflow_rate_mean": 1152.7247910121234, "system_level_velocity_max": 18.64692270463966, "cost1_mean": 185.1633865384951, "outflow_rate_min": 482.3357142740561}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412088, "timesteps_since_restore": 5980227, "episodes_total": 7513, "policy_reward_mean": {}, "episode_reward_max": 585.104384451806, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36445, "iterations_since_restore": 162, "training_iteration": 162, "episode_len_mean": 318.61, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4023.190541744232, "timesteps_total": 5980227, "date": "2019-05-21_04-14-48", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc17b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1240>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 47}
{"time_this_iter_s": 24.93509268760681, "hostname": "flow-main", "info": {"default": {"kl": 0.017600975930690765, "entropy": 1.5956289768218994, "policy_loss": -0.015962081030011177, "cur_lr": 0.0005000000237487257, "total_loss": 80.58480834960938, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 80.59483337402344, "vf_explained_var": 0.6195706725120544}, "grad_time_ms": 8061.73, "update_time_ms": 7.324, "load_time_ms": 3.439, "sample_time_ms": 16561.631, "num_steps_sampled": 6016586, "num_steps_trained": 6016586}, "episode_reward_min": 54.744195282236724, "episode_reward_mean": 525.9707029713002, "done": false, "time_total_s": 4048.125634431839, "custom_metrics": {"cost2_min": -54.15754341251213, "cost2_max": -16.34782033861421, "system_level_velocity_min": 12.289115870011688, "outflow_rate_max": 1305.7199722203168, "cost1_max": 211.54564847993572, "cost1_min": 23.184314029166398, "cost2_mean": -32.22659401290166, "system_level_velocity_mean": 15.579522552931941, "outflow_rate_mean": 1142.1326888283572, "system_level_velocity_max": 18.64692270463966, "cost1_mean": 183.17398345572178, "outflow_rate_min": 482.3357142740561}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412113, "timesteps_since_restore": 6016586, "episodes_total": 7564, "policy_reward_mean": {}, "episode_reward_max": 585.104384451806, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36359, "iterations_since_restore": 163, "training_iteration": 163, "episode_len_mean": 319.44, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4048.125634431839, "timesteps_total": 6016586, "date": "2019-05-21_04-15-13", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabfd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab828>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 51}
{"time_this_iter_s": 23.83961033821106, "hostname": "flow-main", "info": {"default": {"kl": 0.01788829080760479, "entropy": 1.6094447374343872, "policy_loss": -0.01707773469388485, "cur_lr": 0.0005000000237487257, "total_loss": 69.10198974609375, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 69.113037109375, "vf_explained_var": 0.6360920667648315}, "grad_time_ms": 7975.478, "update_time_ms": 7.349, "load_time_ms": 3.271, "sample_time_ms": 16493.842, "num_steps_sampled": 6052950, "num_steps_trained": 6052950}, "episode_reward_min": 58.776203339118986, "episode_reward_mean": 525.8204925713177, "done": false, "time_total_s": 4071.96524477005, "custom_metrics": {"cost2_min": -54.15754341251213, "cost2_max": -14.450148229725073, "system_level_velocity_min": 11.84595378933767, "outflow_rate_max": 1285.699109932271, "cost1_max": 210.57624578054606, "cost1_min": 23.95952757857228, "cost2_mean": -32.34507104797585, "system_level_velocity_mean": 15.492428438241298, "outflow_rate_mean": 1137.9639554785933, "system_level_velocity_max": 18.278131471609168, "cost1_mean": 183.05866835474123, "outflow_rate_min": 480.3653735522863}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412137, "timesteps_since_restore": 6052950, "episodes_total": 7608, "policy_reward_mean": {}, "episode_reward_max": 593.0745359204599, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36364, "iterations_since_restore": 164, "training_iteration": 164, "episode_len_mean": 320.82, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4071.96524477005, "timesteps_total": 6052950, "date": "2019-05-21_04-15-37", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1b70>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 44}
{"time_this_iter_s": 23.695348024368286, "hostname": "flow-main", "info": {"default": {"kl": 0.01739225536584854, "entropy": 1.6068934202194214, "policy_loss": -0.015886850655078888, "cur_lr": 0.0005000000237487257, "total_loss": 76.49712371826172, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 76.50713348388672, "vf_explained_var": 0.5825570821762085}, "grad_time_ms": 7980.525, "update_time_ms": 7.487, "load_time_ms": 3.299, "sample_time_ms": 16485.495, "num_steps_sampled": 6088030, "num_steps_trained": 6088030}, "episode_reward_min": 58.776203339118986, "episode_reward_mean": 523.6409873659437, "done": false, "time_total_s": 4095.6605927944183, "custom_metrics": {"cost2_min": -49.23184973971123, "cost2_max": -14.450148229725073, "system_level_velocity_min": 11.84595378933767, "outflow_rate_max": 1295.8764370997662, "cost1_max": 210.57624578054606, "cost1_min": 23.95952757857228, "cost2_mean": -31.375457763078803, "system_level_velocity_mean": 15.646823011873817, "outflow_rate_mean": 1143.2209876955721, "system_level_velocity_max": 18.278131471609168, "cost1_mean": 184.23404723679857, "outflow_rate_min": 480.3653735522863}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412161, "timesteps_since_restore": 6088030, "episodes_total": 7652, "policy_reward_mean": {}, "episode_reward_max": 593.0745359204599, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35080, "iterations_since_restore": 165, "training_iteration": 165, "episode_len_mean": 319.95, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4095.6605927944183, "timesteps_total": 6088030, "date": "2019-05-21_04-16-01", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1828>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 44}
{"time_this_iter_s": 24.492017030715942, "hostname": "flow-main", "info": {"default": {"kl": 0.0173940546810627, "entropy": 1.600609540939331, "policy_loss": -0.017163343727588654, "cur_lr": 0.0005000000237487257, "total_loss": 83.30728149414062, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 83.31857299804688, "vf_explained_var": 0.5644385814666748}, "grad_time_ms": 7954.403, "update_time_ms": 7.481, "load_time_ms": 3.156, "sample_time_ms": 16444.464, "num_steps_sampled": 6123106, "num_steps_trained": 6123106}, "episode_reward_min": 55.75046812237376, "episode_reward_mean": 518.9418929828926, "done": false, "time_total_s": 4120.152609825134, "custom_metrics": {"cost2_min": -52.748764331203034, "cost2_max": -14.018415929786164, "system_level_velocity_min": 12.311298765002354, "outflow_rate_max": 1298.3044760329144, "cost1_max": 211.1881192493358, "cost1_min": 22.594195660061636, "cost2_mean": -30.641532776683913, "system_level_velocity_mean": 15.723976026750709, "outflow_rate_mean": 1142.668079324883, "system_level_velocity_max": 18.146493547705305, "cost1_mean": 184.90674467807628, "outflow_rate_min": 471.084583467557}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412186, "timesteps_since_restore": 6123106, "episodes_total": 7705, "policy_reward_mean": {}, "episode_reward_max": 582.9572847789716, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35076, "iterations_since_restore": 166, "training_iteration": 166, "episode_len_mean": 319.85, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4120.152609825134, "timesteps_total": 6123106, "date": "2019-05-21_04-16-26", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db43c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4390>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 53}
{"time_this_iter_s": 23.89233946800232, "hostname": "flow-main", "info": {"default": {"kl": 0.016295406967401505, "entropy": 1.6025184392929077, "policy_loss": -0.016152862459421158, "cur_lr": 0.0005000000237487257, "total_loss": 76.519287109375, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 76.52993774414062, "vf_explained_var": 0.5444651246070862}, "grad_time_ms": 7870.348, "update_time_ms": 7.519, "load_time_ms": 3.14, "sample_time_ms": 16479.169, "num_steps_sampled": 6157582, "num_steps_trained": 6157582}, "episode_reward_min": 55.75046812237376, "episode_reward_mean": 519.4770856888404, "done": false, "time_total_s": 4144.044949293137, "custom_metrics": {"cost2_min": -52.748764331203034, "cost2_max": -14.018415929786164, "system_level_velocity_min": 12.667088953155549, "outflow_rate_max": 1314.023411752182, "cost1_max": 211.1881192493358, "cost1_min": 22.594195660061636, "cost2_mean": -30.146244294949984, "system_level_velocity_mean": 15.789183680724404, "outflow_rate_mean": 1143.8232106485739, "system_level_velocity_max": 18.146493547705305, "cost1_mean": 186.0382021118331, "outflow_rate_min": 471.084583467557}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412209, "timesteps_since_restore": 6157582, "episodes_total": 7750, "policy_reward_mean": {}, "episode_reward_max": 574.7230809718033, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34476, "iterations_since_restore": 167, "training_iteration": 167, "episode_len_mean": 320.72, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4144.044949293137, "timesteps_total": 6157582, "date": "2019-05-21_04-16-49", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc18d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1668>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 45}
{"time_this_iter_s": 23.771751165390015, "hostname": "flow-main", "info": {"default": {"kl": 0.01737685315310955, "entropy": 1.591490387916565, "policy_loss": -0.013988147489726543, "cur_lr": 0.0005000000237487257, "total_loss": 75.73658752441406, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 75.74472045898438, "vf_explained_var": 0.5784354209899902}, "grad_time_ms": 7743.26, "update_time_ms": 7.465, "load_time_ms": 3.081, "sample_time_ms": 16588.474, "num_steps_sampled": 6192151, "num_steps_trained": 6192151}, "episode_reward_min": 51.65629400554328, "episode_reward_mean": 520.4362974570008, "done": false, "time_total_s": 4167.816700458527, "custom_metrics": {"cost2_min": -46.76144152893332, "cost2_max": -12.936064489705629, "system_level_velocity_min": 12.559892210355557, "outflow_rate_max": 1314.023411752182, "cost1_max": 211.01385464455035, "cost1_min": 22.61657268876949, "cost2_mean": -29.64041147667061, "system_level_velocity_mean": 15.849885950258026, "outflow_rate_mean": 1147.5399839274737, "system_level_velocity_max": 18.30245687218902, "cost1_mean": 187.3585899536816, "outflow_rate_min": 506.5568824271422}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412233, "timesteps_since_restore": 6192151, "episodes_total": 7793, "policy_reward_mean": {}, "episode_reward_max": 574.7230809718033, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34569, "iterations_since_restore": 168, "training_iteration": 168, "episode_len_mean": 321.9, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4167.816700458527, "timesteps_total": 6192151, "date": "2019-05-21_04-17-13", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc13c8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 43}
{"time_this_iter_s": 23.390408992767334, "hostname": "flow-main", "info": {"default": {"kl": 0.0172538124024868, "entropy": 1.5973913669586182, "policy_loss": -0.016334937885403633, "cur_lr": 0.0005000000237487257, "total_loss": 87.77156829833984, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 87.78206634521484, "vf_explained_var": 0.5161866545677185}, "grad_time_ms": 7688.087, "update_time_ms": 7.173, "load_time_ms": 3.142, "sample_time_ms": 16552.492, "num_steps_sampled": 6226398, "num_steps_trained": 6226398}, "episode_reward_min": 51.65629400554328, "episode_reward_mean": 518.5140194201207, "done": false, "time_total_s": 4191.207109451294, "custom_metrics": {"cost2_min": -46.76144152893332, "cost2_max": -12.936064489705629, "system_level_velocity_min": 12.10215697468339, "outflow_rate_max": 1314.023411752182, "cost1_max": 211.01385464455035, "cost1_min": 22.61657268876949, "cost2_mean": -29.33389065056506, "system_level_velocity_mean": 15.86254137059606, "outflow_rate_mean": 1148.8812278494406, "system_level_velocity_max": 18.30245687218902, "cost1_mean": 187.4456811619208, "outflow_rate_min": 506.5568824271422}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412257, "timesteps_since_restore": 6226398, "episodes_total": 7842, "policy_reward_mean": {}, "episode_reward_max": 574.7230809718033, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34247, "iterations_since_restore": 169, "training_iteration": 169, "episode_len_mean": 321.82, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4191.207109451294, "timesteps_total": 6226398, "date": "2019-05-21_04-17-37", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1da0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 23.147809505462646, "hostname": "flow-main", "info": {"default": {"kl": 0.017094815149903297, "entropy": 1.5952242612838745, "policy_loss": -0.016903162002563477, "cur_lr": 0.0005000000237487257, "total_loss": 65.43489837646484, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 65.4460220336914, "vf_explained_var": 0.6234989762306213}, "grad_time_ms": 7541.566, "update_time_ms": 7.165, "load_time_ms": 2.99, "sample_time_ms": 16509.766, "num_steps_sampled": 6260316, "num_steps_trained": 6260316}, "episode_reward_min": 443.7562899709734, "episode_reward_mean": 524.9602686275297, "done": false, "time_total_s": 4214.354918956757, "custom_metrics": {"cost2_min": -47.66769927026013, "cost2_max": -19.84671581099106, "system_level_velocity_min": 12.10215697468339, "outflow_rate_max": 1273.9961715082582, "cost1_max": 208.542649616853, "cost1_min": 146.08030554601964, "cost2_mean": -28.750005142480763, "system_level_velocity_mean": 16.083765169179472, "outflow_rate_mean": 1164.7038698580154, "system_level_velocity_max": 17.708146235610158, "cost1_mean": 191.694247606497, "outflow_rate_min": 944.5775732434536}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412280, "timesteps_since_restore": 6260316, "episodes_total": 7889, "policy_reward_mean": {}, "episode_reward_max": 583.4145389537676, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33918, "iterations_since_restore": 170, "training_iteration": 170, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4214.354918956757, "timesteps_total": 6260316, "date": "2019-05-21_04-18-00", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1438>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 47}
{"time_this_iter_s": 23.84650492668152, "hostname": "flow-main", "info": {"default": {"kl": 0.016296280547976494, "entropy": 1.6175999641418457, "policy_loss": -0.01530997920781374, "cur_lr": 0.0005000000237487257, "total_loss": 65.09394073486328, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 65.10375213623047, "vf_explained_var": 0.598593533039093}, "grad_time_ms": 7479.674, "update_time_ms": 7.22, "load_time_ms": 3.009, "sample_time_ms": 16551.905, "num_steps_sampled": 6295249, "num_steps_trained": 6295249}, "episode_reward_min": 464.0327259158384, "episode_reward_mean": 521.600636823143, "done": false, "time_total_s": 4238.201423883438, "custom_metrics": {"cost2_min": -48.3059165366687, "cost2_max": -18.800375446934474, "system_level_velocity_min": 12.10215697468339, "outflow_rate_max": 1273.9961715082582, "cost1_max": 207.47122720684715, "cost1_min": 146.08030554601964, "cost2_mean": -29.81780489760573, "system_level_velocity_mean": 15.854731306243547, "outflow_rate_mean": 1153.4167609099165, "system_level_velocity_max": 17.663785802753086, "cost1_mean": 189.26810834094846, "outflow_rate_min": 944.5775732434536}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412304, "timesteps_since_restore": 6295249, "episodes_total": 7931, "policy_reward_mean": {}, "episode_reward_max": 583.4145389537676, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34933, "iterations_since_restore": 171, "training_iteration": 171, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4238.201423883438, "timesteps_total": 6295249, "date": "2019-05-21_04-18-24", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4b00>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 42}
{"time_this_iter_s": 24.17992663383484, "hostname": "flow-main", "info": {"default": {"kl": 0.01709841936826706, "entropy": 1.6100631952285767, "policy_loss": -0.015748923644423485, "cur_lr": 0.0005000000237487257, "total_loss": 74.37310028076172, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 74.3830795288086, "vf_explained_var": 0.5861448645591736}, "grad_time_ms": 7326.23, "update_time_ms": 7.271, "load_time_ms": 2.994, "sample_time_ms": 16516.687, "num_steps_sampled": 6330200, "num_steps_trained": 6330200}, "episode_reward_min": 463.27937114623217, "episode_reward_mean": 520.6828890574996, "done": false, "time_total_s": 4262.381350517273, "custom_metrics": {"cost2_min": -48.3059165366687, "cost2_max": -17.28423392629105, "system_level_velocity_min": 11.884791587988733, "outflow_rate_max": 1255.7333350122688, "cost1_max": 209.5555328036534, "cost1_min": 142.6268653801636, "cost2_mean": -30.43159030815317, "system_level_velocity_mean": 15.7025272011262, "outflow_rate_mean": 1148.0095821680318, "system_level_velocity_max": 17.87758250240983, "cost1_mean": 187.67494326148295, "outflow_rate_min": 927.1741983780411}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412328, "timesteps_since_restore": 6330200, "episodes_total": 7980, "policy_reward_mean": {}, "episode_reward_max": 567.9927395630899, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34951, "iterations_since_restore": 172, "training_iteration": 172, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4262.381350517273, "timesteps_total": 6330200, "date": "2019-05-21_04-18-48", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc17b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1be0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 25.13783884048462, "hostname": "flow-main", "info": {"default": {"kl": 0.015770889818668365, "entropy": 1.598630666732788, "policy_loss": -0.015602425672113895, "cur_lr": 0.0005000000237487257, "total_loss": 82.83879852294922, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 82.84909057617188, "vf_explained_var": 0.5292447805404663}, "grad_time_ms": 7348.569, "update_time_ms": 7.365, "load_time_ms": 3.084, "sample_time_ms": 16514.144, "num_steps_sampled": 6364310, "num_steps_trained": 6364310}, "episode_reward_min": 54.02292076399765, "episode_reward_mean": 525.8951960814042, "done": false, "time_total_s": 4287.519189357758, "custom_metrics": {"cost2_min": -48.281778852585134, "cost2_max": -16.24455057168579, "system_level_velocity_min": 11.884791587988733, "outflow_rate_max": 1266.1889197066284, "cost1_max": 211.64026292023476, "cost1_min": 22.886409999111045, "cost2_mean": -29.938196650681967, "system_level_velocity_mean": 16.047884356041514, "outflow_rate_mean": 1162.6616232405402, "system_level_velocity_max": 18.303011827677203, "cost1_mean": 189.3829335858766, "outflow_rate_min": 478.89415583249774}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412353, "timesteps_since_restore": 6364310, "episodes_total": 8029, "policy_reward_mean": {}, "episode_reward_max": 574.1843394639134, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34110, "iterations_since_restore": 173, "training_iteration": 173, "episode_len_mean": 321.92, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4287.519189357758, "timesteps_total": 6364310, "date": "2019-05-21_04-19-13", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc14e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4748>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 24.349392652511597, "hostname": "flow-main", "info": {"default": {"kl": 0.016952719539403915, "entropy": 1.6289798021316528, "policy_loss": -0.016405200585722923, "cur_lr": 0.0005000000237487257, "total_loss": 68.92889404296875, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 68.93956756591797, "vf_explained_var": 0.5674822330474854}, "grad_time_ms": 7488.75, "update_time_ms": 7.349, "load_time_ms": 3.209, "sample_time_ms": 16424.109, "num_steps_sampled": 6399182, "num_steps_trained": 6399182}, "episode_reward_min": 45.05331343271694, "episode_reward_mean": 523.4866159466105, "done": false, "time_total_s": 4311.868582010269, "custom_metrics": {"cost2_min": -44.70703832335663, "cost2_max": -15.316601267539445, "system_level_velocity_min": 12.131964207621042, "outflow_rate_max": 1289.1782799606328, "cost1_max": 211.64026292023476, "cost1_min": 18.172870982875676, "cost2_mean": -29.863090666260117, "system_level_velocity_mean": 16.159846682797898, "outflow_rate_mean": 1163.1843658496784, "system_level_velocity_max": 18.303011827677203, "cost1_mean": 188.75990467900976, "outflow_rate_min": 453.06258849431106}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412378, "timesteps_since_restore": 6399182, "episodes_total": 8073, "policy_reward_mean": {}, "episode_reward_max": 588.6151027410358, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34872, "iterations_since_restore": 174, "training_iteration": 174, "episode_len_mean": 318.94, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4311.868582010269, "timesteps_total": 6399182, "date": "2019-05-21_04-19-38", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc00b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0cc0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 44}
{"time_this_iter_s": 24.813883543014526, "hostname": "flow-main", "info": {"default": {"kl": 0.016992216929793358, "entropy": 1.6490904092788696, "policy_loss": -0.01601126603782177, "cur_lr": 0.0005000000237487257, "total_loss": 82.27880096435547, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 82.2890853881836, "vf_explained_var": 0.5360869765281677}, "grad_time_ms": 7616.299, "update_time_ms": 7.262, "load_time_ms": 3.178, "sample_time_ms": 16408.875, "num_steps_sampled": 6433960, "num_steps_trained": 6433960}, "episode_reward_min": 45.05331343271694, "episode_reward_mean": 525.5680134075942, "done": false, "time_total_s": 4336.682465553284, "custom_metrics": {"cost2_min": -44.180895957838054, "cost2_max": -15.316601267539445, "system_level_velocity_min": 12.844669456806072, "outflow_rate_max": 1316.723919516238, "cost1_max": 212.65674955571347, "cost1_min": 18.172870982875676, "cost2_mean": -29.336303992437344, "system_level_velocity_mean": 16.025564031939783, "outflow_rate_mean": 1163.3477291376976, "system_level_velocity_max": 17.8105837323743, "cost1_mean": 188.60587744885441, "outflow_rate_min": 453.06258849431106}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412402, "timesteps_since_restore": 6433960, "episodes_total": 8121, "policy_reward_mean": {}, "episode_reward_max": 588.6151027410358, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34778, "iterations_since_restore": 175, "training_iteration": 175, "episode_len_mean": 320.56, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4336.682465553284, "timesteps_total": 6433960, "date": "2019-05-21_04-20-02", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1be0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 48}
{"time_this_iter_s": 23.774231433868408, "hostname": "flow-main", "info": {"default": {"kl": 0.01849791593849659, "entropy": 1.6618256568908691, "policy_loss": -0.017182357609272003, "cur_lr": 0.0005000000237487257, "total_loss": 72.99871063232422, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 73.00965118408203, "vf_explained_var": 0.5758468508720398}, "grad_time_ms": 7653.224, "update_time_ms": 7.597, "load_time_ms": 3.377, "sample_time_ms": 16299.503, "num_steps_sampled": 6469068, "num_steps_trained": 6469068}, "episode_reward_min": 341.4232628201572, "episode_reward_mean": 532.0743858196645, "done": false, "time_total_s": 4360.456696987152, "custom_metrics": {"cost2_min": -44.180895957838054, "cost2_max": -17.71637405304719, "system_level_velocity_min": 12.37569921946176, "outflow_rate_max": 1316.723919516238, "cost1_max": 212.65674955571347, "cost1_min": 134.4507489022556, "cost2_mean": -29.20662920896354, "system_level_velocity_mean": 15.92221294825484, "outflow_rate_mean": 1167.5278890630368, "system_level_velocity_max": 17.8105837323743, "cost1_mean": 189.51430233509146, "outflow_rate_min": 947.392104632283}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412426, "timesteps_since_restore": 6469068, "episodes_total": 8169, "policy_reward_mean": {}, "episode_reward_max": 588.6151027410358, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35108, "iterations_since_restore": 176, "training_iteration": 176, "episode_len_mean": 323.54, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4360.456696987152, "timesteps_total": 6469068, "date": "2019-05-21_04-20-26", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db46d8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 48}
{"time_this_iter_s": 23.926839351654053, "hostname": "flow-main", "info": {"default": {"kl": 0.01744844950735569, "entropy": 1.6533691883087158, "policy_loss": -0.0163791012018919, "cur_lr": 0.0005000000237487257, "total_loss": 67.71554565429688, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 67.72602844238281, "vf_explained_var": 0.5949892401695251}, "grad_time_ms": 7753.265, "update_time_ms": 7.639, "load_time_ms": 3.438, "sample_time_ms": 16203.279, "num_steps_sampled": 6503914, "num_steps_trained": 6503914}, "episode_reward_min": 460.12075706518317, "episode_reward_mean": 534.1429946808115, "done": false, "time_total_s": 4384.383536338806, "custom_metrics": {"cost2_min": -48.043337279168775, "cost2_max": -18.576234269971863, "system_level_velocity_min": 11.585510363297091, "outflow_rate_max": 1283.7071115133367, "cost1_max": 208.90331242206744, "cost1_min": 143.35054420439744, "cost2_mean": -28.81032623689324, "system_level_velocity_mean": 15.932056971220538, "outflow_rate_mean": 1171.423058507352, "system_level_velocity_max": 17.670417034412726, "cost1_mean": 190.36759313188122, "outflow_rate_min": 947.392104632283}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412450, "timesteps_since_restore": 6503914, "episodes_total": 8213, "policy_reward_mean": {}, "episode_reward_max": 585.5762682208749, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34846, "iterations_since_restore": 177, "training_iteration": 177, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4384.383536338806, "timesteps_total": 6503914, "date": "2019-05-21_04-20-50", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db98d0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 44}
{"time_this_iter_s": 23.575003623962402, "hostname": "flow-main", "info": {"default": {"kl": 0.017597846686840057, "entropy": 1.6638985872268677, "policy_loss": -0.016438109800219536, "cur_lr": 0.0005000000237487257, "total_loss": 71.77681732177734, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 71.78731536865234, "vf_explained_var": 0.582236647605896}, "grad_time_ms": 7906.962, "update_time_ms": 7.624, "load_time_ms": 3.412, "sample_time_ms": 16029.055, "num_steps_sampled": 6539091, "num_steps_trained": 6539091}, "episode_reward_min": 460.12075706518317, "episode_reward_mean": 531.8134814418545, "done": false, "time_total_s": 4407.958539962769, "custom_metrics": {"cost2_min": -48.043337279168775, "cost2_max": -19.131103741011835, "system_level_velocity_min": 11.585510363297091, "outflow_rate_max": 1283.7071115133367, "cost1_max": 208.90331242206744, "cost1_min": 143.35054420439744, "cost2_mean": -29.276828866114982, "system_level_velocity_mean": 15.803868456130827, "outflow_rate_mean": 1163.730616453529, "system_level_velocity_max": 17.670417034412726, "cost1_mean": 188.9408557919687, "outflow_rate_min": 919.6222845336482}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412474, "timesteps_since_restore": 6539091, "episodes_total": 8257, "policy_reward_mean": {}, "episode_reward_max": 585.5762682208749, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35177, "iterations_since_restore": 178, "training_iteration": 178, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4407.958539962769, "timesteps_total": 6539091, "date": "2019-05-21_04-21-14", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc00b8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 44}
{"time_this_iter_s": 24.97024440765381, "hostname": "flow-main", "info": {"default": {"kl": 0.016421012580394745, "entropy": 1.6662088632583618, "policy_loss": -0.016365984454751015, "cur_lr": 0.0005000000237487257, "total_loss": 76.50399017333984, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 76.51481628417969, "vf_explained_var": 0.5390336513519287}, "grad_time_ms": 8079.808, "update_time_ms": 7.854, "load_time_ms": 3.356, "sample_time_ms": 16014.47, "num_steps_sampled": 6574463, "num_steps_trained": 6574463}, "episode_reward_min": 58.14220968520963, "episode_reward_mean": 520.7884841717187, "done": false, "time_total_s": 4432.928784370422, "custom_metrics": {"cost2_min": -48.043337279168775, "cost2_max": -13.032610776969353, "system_level_velocity_min": 12.03128786550236, "outflow_rate_max": 1279.4975752741439, "cost1_max": 207.8353201033425, "cost1_min": 24.82615900706282, "cost2_mean": -29.751196700176624, "system_level_velocity_mean": 15.662025323500998, "outflow_rate_mean": 1143.4000182139791, "system_level_velocity_max": 18.524607293330273, "cost1_mean": 185.1515982358609, "outflow_rate_min": 511.11709677636463}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412499, "timesteps_since_restore": 6574463, "episodes_total": 8308, "policy_reward_mean": {}, "episode_reward_max": 580.3265164742572, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35372, "iterations_since_restore": 179, "training_iteration": 179, "episode_len_mean": 322.13, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4432.928784370422, "timesteps_total": 6574463, "date": "2019-05-21_04-21-39", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1470>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 51}
{"time_this_iter_s": 23.8966965675354, "hostname": "flow-main", "info": {"default": {"kl": 0.017940834164619446, "entropy": 1.6829687356948853, "policy_loss": -0.017830107361078262, "cur_lr": 0.0005000000237487257, "total_loss": 69.28205108642578, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 69.29383850097656, "vf_explained_var": 0.5088992118835449}, "grad_time_ms": 8182.35, "update_time_ms": 7.969, "load_time_ms": 3.395, "sample_time_ms": 15986.463, "num_steps_sampled": 6609789, "num_steps_trained": 6609789}, "episode_reward_min": 53.82779530297183, "episode_reward_mean": 516.2032156377605, "done": false, "time_total_s": 4456.825480937958, "custom_metrics": {"cost2_min": -46.843311079181305, "cost2_max": -13.032610776969353, "system_level_velocity_min": 12.558988769936114, "outflow_rate_max": 1276.6622153406975, "cost1_max": 207.6789527558758, "cost1_min": 22.829454719684488, "cost2_mean": -29.84249977166826, "system_level_velocity_mean": 15.594261820799199, "outflow_rate_mean": 1136.309817690327, "system_level_velocity_max": 18.524607293330273, "cost1_mean": 182.90970336286352, "outflow_rate_min": 496.26021248702307}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412523, "timesteps_since_restore": 6609789, "episodes_total": 8355, "policy_reward_mean": {}, "episode_reward_max": 584.3212540448362, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35326, "iterations_since_restore": 180, "training_iteration": 180, "episode_len_mean": 319.23, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4456.825480937958, "timesteps_total": 6609789, "date": "2019-05-21_04-22-03", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9dd8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 47}
{"time_this_iter_s": 23.77849531173706, "hostname": "flow-main", "info": {"default": {"kl": 0.016830619424581528, "entropy": 1.6818604469299316, "policy_loss": -0.017800617963075638, "cur_lr": 0.0005000000237487257, "total_loss": 69.58944702148438, "cur_kl_coeff": 0.3375000059604645, "vf_loss": 69.6015625, "vf_explained_var": 0.5482267141342163}, "grad_time_ms": 8237.64, "update_time_ms": 7.82, "load_time_ms": 3.356, "sample_time_ms": 15924.938, "num_steps_sampled": 6645334, "num_steps_trained": 6645334}, "episode_reward_min": 52.49179777746553, "episode_reward_mean": 515.2644902913623, "done": false, "time_total_s": 4480.603976249695, "custom_metrics": {"cost2_min": -55.17531113883523, "cost2_max": -13.032610776969353, "system_level_velocity_min": 12.410710782201276, "outflow_rate_max": 1287.3481798034531, "cost1_max": 208.57872687052046, "cost1_min": 22.829454719684488, "cost2_mean": -30.12477774947661, "system_level_velocity_mean": 15.585957951390006, "outflow_rate_mean": 1134.4043152931656, "system_level_velocity_max": 18.524607293330273, "cost1_mean": 181.0069544709045, "outflow_rate_min": 496.26021248702307}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412547, "timesteps_since_restore": 6645334, "episodes_total": 8399, "policy_reward_mean": {}, "episode_reward_max": 584.3212540448362, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35545, "iterations_since_restore": 181, "training_iteration": 181, "episode_len_mean": 316.33, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4480.603976249695, "timesteps_total": 6645334, "date": "2019-05-21_04-22-27", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0ba8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 44}
{"time_this_iter_s": 23.617626190185547, "hostname": "flow-main", "info": {"default": {"kl": 0.01729470118880272, "entropy": 1.6993998289108276, "policy_loss": -0.016023803502321243, "cur_lr": 0.0005000000237487257, "total_loss": 78.3281021118164, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 78.33829498291016, "vf_explained_var": 0.47559478878974915}, "grad_time_ms": 8251.218, "update_time_ms": 7.683, "load_time_ms": 3.484, "sample_time_ms": 15855.776, "num_steps_sampled": 6680999, "num_steps_trained": 6680999}, "episode_reward_min": 52.49179777746553, "episode_reward_mean": 517.0953942694072, "done": false, "time_total_s": 4504.22160243988, "custom_metrics": {"cost2_min": -55.17531113883523, "cost2_max": -14.056011341541861, "system_level_velocity_min": 12.130019180994148, "outflow_rate_max": 1287.3481798034531, "cost1_max": 208.57872687052046, "cost1_min": 22.815792966840213, "cost2_mean": -28.99885068058998, "system_level_velocity_mean": 15.606143180943613, "outflow_rate_mean": 1133.165067270238, "system_level_velocity_max": 18.43684516596724, "cost1_mean": 181.2085089936557, "outflow_rate_min": 477.60822728785155}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412570, "timesteps_since_restore": 6680999, "episodes_total": 8447, "policy_reward_mean": {}, "episode_reward_max": 580.8431759607843, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35665, "iterations_since_restore": 182, "training_iteration": 182, "episode_len_mean": 316.3, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4504.22160243988, "timesteps_total": 6680999, "date": "2019-05-21_04-22-50", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1438>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 48}
{"time_this_iter_s": 23.59598970413208, "hostname": "flow-main", "info": {"default": {"kl": 0.01753520593047142, "entropy": 1.706964135169983, "policy_loss": -0.016430983319878578, "cur_lr": 0.0005000000237487257, "total_loss": 68.46742248535156, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 68.47793579101562, "vf_explained_var": 0.5040138363838196}, "grad_time_ms": 8218.001, "update_time_ms": 7.447, "load_time_ms": 3.503, "sample_time_ms": 15735.229, "num_steps_sampled": 6716382, "num_steps_trained": 6716382}, "episode_reward_min": 56.33604847265354, "episode_reward_mean": 523.9436967971405, "done": false, "time_total_s": 4527.817592144012, "custom_metrics": {"cost2_min": -46.12826829700931, "cost2_max": -14.056011341541861, "system_level_velocity_min": 12.130019180994148, "outflow_rate_max": 1273.7126554798174, "cost1_max": 208.57872687052046, "cost1_min": 22.815792966840213, "cost2_mean": -27.730123505276403, "system_level_velocity_mean": 15.60364843049896, "outflow_rate_mean": 1141.2411903556444, "system_level_velocity_max": 18.39509675885128, "cost1_mean": 184.43365690205496, "outflow_rate_min": 477.60822728785155}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412594, "timesteps_since_restore": 6716382, "episodes_total": 8496, "policy_reward_mean": {}, "episode_reward_max": 587.9860423994136, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35383, "iterations_since_restore": 183, "training_iteration": 183, "episode_len_mean": 321.02, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4527.817592144012, "timesteps_total": 6716382, "date": "2019-05-21_04-23-14", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9908>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 23.493058443069458, "hostname": "flow-main", "info": {"default": {"kl": 0.019658265635371208, "entropy": 1.7075215578079224, "policy_loss": -0.019813286140561104, "cur_lr": 0.0005000000237487257, "total_loss": 67.9307632446289, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 67.94393920898438, "vf_explained_var": 0.5115467309951782}, "grad_time_ms": 8114.171, "update_time_ms": 7.466, "load_time_ms": 3.537, "sample_time_ms": 15753.979, "num_steps_sampled": 6751692, "num_steps_trained": 6751692}, "episode_reward_min": 354.980284693307, "episode_reward_mean": 527.2358982400883, "done": false, "time_total_s": 4551.310650587082, "custom_metrics": {"cost2_min": -51.28430340717627, "cost2_max": -16.073600276206, "system_level_velocity_min": 12.837900646134747, "outflow_rate_max": 1273.7126554798174, "cost1_max": 209.99740275328605, "cost1_min": 137.01240695040008, "cost2_mean": -28.06051610057115, "system_level_velocity_mean": 15.564011298787475, "outflow_rate_mean": 1144.6913786218333, "system_level_velocity_max": 17.77385710299184, "cost1_mean": 186.08094610674758, "outflow_rate_min": 955.3803109652166}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412617, "timesteps_since_restore": 6751692, "episodes_total": 8538, "policy_reward_mean": {}, "episode_reward_max": 587.9860423994136, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35310, "iterations_since_restore": 184, "training_iteration": 184, "episode_len_mean": 323.92, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4551.310650587082, "timesteps_total": 6751692, "date": "2019-05-21_04-23-37", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc06d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0208>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 42}
{"time_this_iter_s": 22.797648191452026, "hostname": "flow-main", "info": {"default": {"kl": 0.017146974802017212, "entropy": 1.7002009153366089, "policy_loss": -0.016632165759801865, "cur_lr": 0.0005000000237487257, "total_loss": 64.59869384765625, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 64.60953521728516, "vf_explained_var": 0.5692194700241089}, "grad_time_ms": 7952.172, "update_time_ms": 7.427, "load_time_ms": 3.621, "sample_time_ms": 15714.152, "num_steps_sampled": 6786098, "num_steps_trained": 6786098}, "episode_reward_min": 354.980284693307, "episode_reward_mean": 527.098724683277, "done": false, "time_total_s": 4574.108298778534, "custom_metrics": {"cost2_min": -51.28430340717627, "cost2_max": -16.073600276206, "system_level_velocity_min": 12.57147433145186, "outflow_rate_max": 1275.711866426334, "cost1_max": 209.99740275328605, "cost1_min": 137.01240695040008, "cost2_mean": -27.782294006386955, "system_level_velocity_mean": 15.76361621624152, "outflow_rate_mean": 1151.4011223064172, "system_level_velocity_max": 17.853939721954816, "cost1_mean": 187.93241893411562, "outflow_rate_min": 954.5380203580203}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412640, "timesteps_since_restore": 6786098, "episodes_total": 8587, "policy_reward_mean": {}, "episode_reward_max": 585.7064688025729, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34406, "iterations_since_restore": 185, "training_iteration": 185, "episode_len_mean": 323.92, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4574.108298778534, "timesteps_total": 6786098, "date": "2019-05-21_04-24-00", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db97b8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 23.472640991210938, "hostname": "flow-main", "info": {"default": {"kl": 0.016537239775061607, "entropy": 1.7102668285369873, "policy_loss": -0.01662970706820488, "cur_lr": 0.0005000000237487257, "total_loss": 59.771446228027344, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 59.78249740600586, "vf_explained_var": 0.6034488677978516}, "grad_time_ms": 7947.674, "update_time_ms": 7.087, "load_time_ms": 3.557, "sample_time_ms": 15687.577, "num_steps_sampled": 6820828, "num_steps_trained": 6820828}, "episode_reward_min": 463.31730261903976, "episode_reward_mean": 525.1250895432065, "done": false, "time_total_s": 4597.580939769745, "custom_metrics": {"cost2_min": -50.34370417577823, "cost2_max": -16.073600276206, "system_level_velocity_min": 12.57147433145186, "outflow_rate_max": 1275.711866426334, "cost1_max": 209.4472175655666, "cost1_min": 150.98216446853385, "cost2_mean": -27.76344767382958, "system_level_velocity_mean": 15.834725715046439, "outflow_rate_mean": 1154.4930314756516, "system_level_velocity_max": 17.853939721954816, "cost1_mean": 189.2513392485247, "outflow_rate_min": 954.5380203580203}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412664, "timesteps_since_restore": 6820828, "episodes_total": 8633, "policy_reward_mean": {}, "episode_reward_max": 585.7064688025729, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34730, "iterations_since_restore": 186, "training_iteration": 186, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4597.580939769745, "timesteps_total": 6820828, "date": "2019-05-21_04-24-24", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db95c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9748>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 46}
{"time_this_iter_s": 23.445966958999634, "hostname": "flow-main", "info": {"default": {"kl": 0.017961515113711357, "entropy": 1.7082390785217285, "policy_loss": -0.013844326138496399, "cur_lr": 0.0005000000237487257, "total_loss": 60.45869827270508, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 60.46648025512695, "vf_explained_var": 0.5885053277015686}, "grad_time_ms": 7972.811, "update_time_ms": 7.324, "load_time_ms": 3.514, "sample_time_ms": 15613.874, "num_steps_sampled": 6855747, "num_steps_trained": 6855747}, "episode_reward_min": 463.31730261903976, "episode_reward_mean": 520.3881041587979, "done": false, "time_total_s": 4621.0269067287445, "custom_metrics": {"cost2_min": -50.34370417577823, "cost2_max": -17.350302418051335, "system_level_velocity_min": 11.996708844666397, "outflow_rate_max": 1264.5957811116161, "cost1_max": 209.36011265887856, "cost1_min": 143.29861521031364, "cost2_mean": -28.461490188094768, "system_level_velocity_mean": 15.630307299025809, "outflow_rate_mean": 1143.846535370238, "system_level_velocity_max": 17.806462145410688, "cost1_mean": 186.97674320263016, "outflow_rate_min": 924.7721442818822}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412687, "timesteps_since_restore": 6855747, "episodes_total": 8677, "policy_reward_mean": {}, "episode_reward_max": 575.7100269447477, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34919, "iterations_since_restore": 187, "training_iteration": 187, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4621.0269067287445, "timesteps_total": 6855747, "date": "2019-05-21_04-24-47", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0ac8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 44}
{"time_this_iter_s": 23.553954124450684, "hostname": "flow-main", "info": {"default": {"kl": 0.017528826370835304, "entropy": 1.702628254890442, "policy_loss": -0.015965446829795837, "cur_lr": 0.0005000000237487257, "total_loss": 71.86711883544922, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 71.8771743774414, "vf_explained_var": 0.542985200881958}, "grad_time_ms": 7997.038, "update_time_ms": 7.358, "load_time_ms": 3.529, "sample_time_ms": 15587.039, "num_steps_sampled": 6890120, "num_steps_trained": 6890120}, "episode_reward_min": 465.98024593441244, "episode_reward_mean": 519.6283263902366, "done": false, "time_total_s": 4644.580860853195, "custom_metrics": {"cost2_min": -44.53678977309019, "cost2_max": -17.202126368009065, "system_level_velocity_min": 11.996708844666397, "outflow_rate_max": 1261.078765597043, "cost1_max": 206.12946336857962, "cost1_min": 143.29861521031364, "cost2_mean": -27.956822866028233, "system_level_velocity_mean": 15.586275836999143, "outflow_rate_mean": 1144.6388229970896, "system_level_velocity_max": 17.528966275680908, "cost1_mean": 186.43937993423478, "outflow_rate_min": 924.7721442818822}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412711, "timesteps_since_restore": 6890120, "episodes_total": 8725, "policy_reward_mean": {}, "episode_reward_max": 578.2216206115082, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34373, "iterations_since_restore": 188, "training_iteration": 188, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4644.580860853195, "timesteps_total": 6890120, "date": "2019-05-21_04-25-11", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db97b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db99b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9cc0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 48}
{"time_this_iter_s": 23.037538051605225, "hostname": "flow-main", "info": {"default": {"kl": 0.017624519765377045, "entropy": 1.6971888542175293, "policy_loss": -0.016539499163627625, "cur_lr": 0.0005000000237487257, "total_loss": 61.22749328613281, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 61.23808670043945, "vf_explained_var": 0.5931225419044495}, "grad_time_ms": 7962.348, "update_time_ms": 7.218, "load_time_ms": 3.476, "sample_time_ms": 15429.512, "num_steps_sampled": 6925073, "num_steps_trained": 6925073}, "episode_reward_min": 438.1447721369161, "episode_reward_mean": 514.6294523716921, "done": false, "time_total_s": 4667.6183989048, "custom_metrics": {"cost2_min": -44.53678977309019, "cost2_max": -16.486318720287276, "system_level_velocity_min": 12.363185669344828, "outflow_rate_max": 1261.078765597043, "cost1_max": 206.71689177574638, "cost1_min": 146.53191165054906, "cost2_mean": -27.434009436154838, "system_level_velocity_mean": 15.554859900461917, "outflow_rate_mean": 1135.7026892163622, "system_level_velocity_max": 17.54466121436447, "cost1_mean": 185.7239201817465, "outflow_rate_min": 930.3468367346937}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412734, "timesteps_since_restore": 6925073, "episodes_total": 8772, "policy_reward_mean": {}, "episode_reward_max": 578.2216206115082, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34953, "iterations_since_restore": 189, "training_iteration": 189, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4667.6183989048, "timesteps_total": 6925073, "date": "2019-05-21_04-25-34", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc09b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc09e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0080>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 47}
{"time_this_iter_s": 23.195390224456787, "hostname": "flow-main", "info": {"default": {"kl": 0.01913568004965782, "entropy": 1.6941540241241455, "policy_loss": -0.01916607841849327, "cur_lr": 0.0005000000237487257, "total_loss": 63.78779602050781, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 63.80050277709961, "vf_explained_var": 0.592965841293335}, "grad_time_ms": 7980.674, "update_time_ms": 7.177, "load_time_ms": 3.574, "sample_time_ms": 15340.813, "num_steps_sampled": 6959486, "num_steps_trained": 6959486}, "episode_reward_min": 438.1447721369161, "episode_reward_mean": 516.748395626935, "done": false, "time_total_s": 4690.813789129257, "custom_metrics": {"cost2_min": -41.01102564801771, "cost2_max": -16.486318720287276, "system_level_velocity_min": 11.659628149574726, "outflow_rate_max": 1265.0894171729283, "cost1_max": 208.95683198759286, "cost1_min": 138.40809794573997, "cost2_mean": -26.71722295245668, "system_level_velocity_mean": 15.791657228739737, "outflow_rate_mean": 1140.6788576578392, "system_level_velocity_max": 17.77740893173113, "cost1_mean": 187.9366702456446, "outflow_rate_min": 881.9035714285716}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412757, "timesteps_since_restore": 6959486, "episodes_total": 8817, "policy_reward_mean": {}, "episode_reward_max": 572.7910746329022, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34413, "iterations_since_restore": 190, "training_iteration": 190, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4690.813789129257, "timesteps_total": 6959486, "date": "2019-05-21_04-25-57", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc02b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0a90>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 45}
{"time_this_iter_s": 23.387351751327515, "hostname": "flow-main", "info": {"default": {"kl": 0.016991648823022842, "entropy": 1.7099921703338623, "policy_loss": -0.017435694113373756, "cur_lr": 0.0005000000237487257, "total_loss": 59.82657241821289, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 59.83827590942383, "vf_explained_var": 0.5975149273872375}, "grad_time_ms": 7958.646, "update_time_ms": 7.28, "load_time_ms": 3.564, "sample_time_ms": 15323.262, "num_steps_sampled": 6993591, "num_steps_trained": 6993591}, "episode_reward_min": 332.1250853845188, "episode_reward_mean": 514.5747366052974, "done": false, "time_total_s": 4714.201140880585, "custom_metrics": {"cost2_min": -41.543912827698385, "cost2_max": -15.409041974085465, "system_level_velocity_min": 11.659628149574726, "outflow_rate_max": 1268.5962548128446, "cost1_max": 208.95683198759286, "cost1_min": 130.43868532541012, "cost2_mean": -26.275567228047016, "system_level_velocity_mean": 15.932963961070472, "outflow_rate_mean": 1143.607299136264, "system_level_velocity_max": 17.77740893173113, "cost1_mean": 187.42302047182736, "outflow_rate_min": 881.9035714285716}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412781, "timesteps_since_restore": 6993591, "episodes_total": 8862, "policy_reward_mean": {}, "episode_reward_max": 581.6774003321248, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34105, "iterations_since_restore": 191, "training_iteration": 191, "episode_len_mean": 321.54, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4714.201140880585, "timesteps_total": 6993591, "date": "2019-05-21_04-26-21", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9ac8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 45}
{"time_this_iter_s": 23.524105548858643, "hostname": "flow-main", "info": {"default": {"kl": 0.01706567592918873, "entropy": 1.7138947248458862, "policy_loss": -0.01572914980351925, "cur_lr": 0.0005000000237487257, "total_loss": 71.57017517089844, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 71.58015441894531, "vf_explained_var": 0.5149864554405212}, "grad_time_ms": 7917.737, "update_time_ms": 7.267, "load_time_ms": 3.41, "sample_time_ms": 15355.215, "num_steps_sampled": 7027180, "num_steps_trained": 7027180}, "episode_reward_min": 60.49786239123399, "episode_reward_mean": 511.95402606604904, "done": false, "time_total_s": 4737.725246429443, "custom_metrics": {"cost2_min": -41.543912827698385, "cost2_max": -10.261114328954335, "system_level_velocity_min": 11.85112028089266, "outflow_rate_max": 1268.5962548128446, "cost1_max": 209.7152842888447, "cost1_min": 25.029335414540984, "cost2_mean": -25.174576393237743, "system_level_velocity_mean": 16.01280341493422, "outflow_rate_mean": 1142.5683137882997, "system_level_velocity_max": 18.16840546629401, "cost1_mean": 186.8148513518749, "outflow_rate_min": 505.77207870660305}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412804, "timesteps_since_restore": 7027180, "episodes_total": 8913, "policy_reward_mean": {}, "episode_reward_max": 581.6774003321248, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33589, "iterations_since_restore": 192, "training_iteration": 192, "episode_len_mean": 318.68, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4737.725246429443, "timesteps_total": 7027180, "date": "2019-05-21_04-26-44", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc09e8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 51}
{"time_this_iter_s": 23.06123185157776, "hostname": "flow-main", "info": {"default": {"kl": 0.019076848402619362, "entropy": 1.7269725799560547, "policy_loss": -0.018053269013762474, "cur_lr": 0.0005000000237487257, "total_loss": 72.04261016845703, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 72.05423736572266, "vf_explained_var": 0.5107738971710205}, "grad_time_ms": 7884.487, "update_time_ms": 7.228, "load_time_ms": 3.39, "sample_time_ms": 15333.045, "num_steps_sampled": 7061570, "num_steps_trained": 7061570}, "episode_reward_min": 60.49786239123399, "episode_reward_mean": 522.0178565152846, "done": false, "time_total_s": 4760.786478281021, "custom_metrics": {"cost2_min": -38.634471821278375, "cost2_max": -10.261114328954335, "system_level_velocity_min": 11.171853225126112, "outflow_rate_max": 1268.0536773940341, "cost1_max": 209.7152842888447, "cost1_min": 25.029335414540984, "cost2_mean": -24.56939089239095, "system_level_velocity_mean": 16.008854084321428, "outflow_rate_mean": 1155.568522754752, "system_level_velocity_max": 18.16840546629401, "cost1_mean": 189.25160600939148, "outflow_rate_min": 505.77207870660305}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412827, "timesteps_since_restore": 7061570, "episodes_total": 8959, "policy_reward_mean": {}, "episode_reward_max": 581.5490489857877, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34390, "iterations_since_restore": 193, "training_iteration": 193, "episode_len_mean": 322.14, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4760.786478281021, "timesteps_total": 7061570, "date": "2019-05-21_04-27-07", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0c18>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 46}
{"time_this_iter_s": 24.14170742034912, "hostname": "flow-main", "info": {"default": {"kl": 0.017481425777077675, "entropy": 1.7134156227111816, "policy_loss": -0.01602492481470108, "cur_lr": 0.0005000000237487257, "total_loss": 61.56211853027344, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 61.57223892211914, "vf_explained_var": 0.5152684450149536}, "grad_time_ms": 7993.364, "update_time_ms": 7.428, "load_time_ms": 3.355, "sample_time_ms": 15288.779, "num_steps_sampled": 7095519, "num_steps_trained": 7095519}, "episode_reward_min": 467.41496502605946, "episode_reward_mean": 520.5037964720431, "done": false, "time_total_s": 4784.92818570137, "custom_metrics": {"cost2_min": -38.634471821278375, "cost2_max": -15.801749555917905, "system_level_velocity_min": 11.171853225126112, "outflow_rate_max": 1268.0536773940341, "cost1_max": 207.42637482250944, "cost1_min": 136.11398129614543, "cost2_mean": -25.529848902336493, "system_level_velocity_mean": 15.70559389487212, "outflow_rate_mean": 1147.875330274035, "system_level_velocity_max": 17.581737029947572, "cost1_mean": 187.87945290742266, "outflow_rate_min": 883.1213707301102}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412852, "timesteps_since_restore": 7095519, "episodes_total": 9002, "policy_reward_mean": {}, "episode_reward_max": 581.5490489857877, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33949, "iterations_since_restore": 194, "training_iteration": 194, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4784.92818570137, "timesteps_total": 7095519, "date": "2019-05-21_04-27-32", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc00f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0e10>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 43}
{"time_this_iter_s": 24.68472909927368, "hostname": "flow-main", "info": {"default": {"kl": 0.016339581459760666, "entropy": 1.705114722251892, "policy_loss": -0.016226008534431458, "cur_lr": 0.0005000000237487257, "total_loss": 67.54389190673828, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 67.55459594726562, "vf_explained_var": 0.5140315294265747}, "grad_time_ms": 8000.628, "update_time_ms": 7.405, "load_time_ms": 3.299, "sample_time_ms": 15470.354, "num_steps_sampled": 7129006, "num_steps_trained": 7129006}, "episode_reward_min": 45.103027531085395, "episode_reward_mean": 507.34417470840884, "done": false, "time_total_s": 4809.612914800644, "custom_metrics": {"cost2_min": -38.634471821278375, "cost2_max": -7.411117038256033, "system_level_velocity_min": 11.171853225126112, "outflow_rate_max": 1256.2421558185279, "cost1_max": 209.684466362027, "cost1_min": 17.150967308978394, "cost2_mean": -25.386765293641737, "system_level_velocity_mean": 15.683972221845952, "outflow_rate_mean": 1128.7633012727797, "system_level_velocity_max": 17.686284187110612, "cost1_mean": 185.4231953493892, "outflow_rate_min": 477.24354782665716}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412876, "timesteps_since_restore": 7129006, "episodes_total": 9051, "policy_reward_mean": {}, "episode_reward_max": 581.5490489857877, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33487, "iterations_since_restore": 195, "training_iteration": 195, "episode_len_mean": 321.74, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4809.612914800644, "timesteps_total": 7129006, "date": "2019-05-21_04-27-56", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9748>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 49}
{"time_this_iter_s": 23.219910621643066, "hostname": "flow-main", "info": {"default": {"kl": 0.017920074984431267, "entropy": 1.7125591039657593, "policy_loss": -0.016815559938549995, "cur_lr": 0.0005000000237487257, "total_loss": 61.415489196777344, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 61.426265716552734, "vf_explained_var": 0.5527767539024353}, "grad_time_ms": 8006.456, "update_time_ms": 7.492, "load_time_ms": 3.344, "sample_time_ms": 15440.337, "num_steps_sampled": 7163247, "num_steps_trained": 7163247}, "episode_reward_min": 45.103027531085395, "episode_reward_mean": 507.28391410254136, "done": false, "time_total_s": 4832.832825422287, "custom_metrics": {"cost2_min": -46.200431837561034, "cost2_max": -7.411117038256033, "system_level_velocity_min": 11.369017485064163, "outflow_rate_max": 1256.2421558185279, "cost1_max": 209.684466362027, "cost1_min": 17.150967308978394, "cost2_mean": -25.415377270234785, "system_level_velocity_mean": 15.907719676952356, "outflow_rate_mean": 1134.2178950271602, "system_level_velocity_max": 17.686284187110612, "cost1_mean": 187.47022711406743, "outflow_rate_min": 477.24354782665716}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412900, "timesteps_since_restore": 7163247, "episodes_total": 9099, "policy_reward_mean": {}, "episode_reward_max": 575.2877441253872, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34241, "iterations_since_restore": 196, "training_iteration": 196, "episode_len_mean": 321.74, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4832.832825422287, "timesteps_total": 7163247, "date": "2019-05-21_04-28-20", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc02e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0438>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 48}
{"time_this_iter_s": 23.35245966911316, "hostname": "flow-main", "info": {"default": {"kl": 0.0164711344987154, "entropy": 1.708749771118164, "policy_loss": -0.01671738363802433, "cur_lr": 0.0005000000237487257, "total_loss": 64.00704193115234, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 64.01820373535156, "vf_explained_var": 0.494272917509079}, "grad_time_ms": 7994.166, "update_time_ms": 7.246, "load_time_ms": 3.341, "sample_time_ms": 15443.828, "num_steps_sampled": 7197908, "num_steps_trained": 7197908}, "episode_reward_min": 465.5216452717478, "episode_reward_mean": 518.7747682413469, "done": false, "time_total_s": 4856.1852850914, "custom_metrics": {"cost2_min": -46.200431837561034, "cost2_max": -17.933717704262286, "system_level_velocity_min": 12.814940626876384, "outflow_rate_max": 1323.0088472927744, "cost1_max": 212.86570532807244, "cost1_min": 154.27924581301642, "cost2_mean": -27.019061815441777, "system_level_velocity_mean": 15.88298516756446, "outflow_rate_mean": 1148.7462313613248, "system_level_velocity_max": 17.873041534943273, "cost1_mean": 189.27013109471736, "outflow_rate_min": 991.7996624266148}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412923, "timesteps_since_restore": 7197908, "episodes_total": 9141, "policy_reward_mean": {}, "episode_reward_max": 592.7798842823092, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34661, "iterations_since_restore": 197, "training_iteration": 197, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4856.1852850914, "timesteps_total": 7197908, "date": "2019-05-21_04-28-43", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db91d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db97b8>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 42}
{"time_this_iter_s": 22.017325401306152, "hostname": "flow-main", "info": {"default": {"kl": 0.01910293661057949, "entropy": 1.7254433631896973, "policy_loss": -0.018793616443872452, "cur_lr": 0.0005000000237487257, "total_loss": 68.94518280029297, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 68.95753479003906, "vf_explained_var": 0.5209560394287109}, "grad_time_ms": 7847.4, "update_time_ms": 7.285, "load_time_ms": 3.35, "sample_time_ms": 15438.919, "num_steps_sampled": 7232653, "num_steps_trained": 7232653}, "episode_reward_min": 57.3108842976449, "episode_reward_mean": 514.3482659736044, "done": false, "time_total_s": 4878.202610492706, "custom_metrics": {"cost2_min": -40.092935038770904, "cost2_max": -11.923991636538508, "system_level_velocity_min": 12.90041392563968, "outflow_rate_max": 1323.0088472927744, "cost1_max": 212.86570532807244, "cost1_min": 23.900762514705523, "cost2_mean": -27.77311857760591, "system_level_velocity_mean": 15.840587651620345, "outflow_rate_mean": 1139.5152448036158, "system_level_velocity_max": 18.415180184375675, "cost1_mean": 185.2386654000137, "outflow_rate_min": 495.9978486892713}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412945, "timesteps_since_restore": 7232653, "episodes_total": 9191, "policy_reward_mean": {}, "episode_reward_max": 597.1590600994848, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34745, "iterations_since_restore": 198, "training_iteration": 198, "episode_len_mean": 318.96, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4878.202610492706, "timesteps_total": 7232653, "date": "2019-05-21_04-29-05", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1fe6ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1fe6b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1fe6b70>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 50}
{"time_this_iter_s": 22.640156269073486, "hostname": "flow-main", "info": {"default": {"kl": 0.019196370616555214, "entropy": 1.7341232299804688, "policy_loss": -0.017355095595121384, "cur_lr": 0.0005000000237487257, "total_loss": 69.95771789550781, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 69.96859741210938, "vf_explained_var": 0.5584407448768616}, "grad_time_ms": 7875.208, "update_time_ms": 7.335, "load_time_ms": 3.366, "sample_time_ms": 15372.018, "num_steps_sampled": 7267725, "num_steps_trained": 7267725}, "episode_reward_min": 57.3108842976449, "episode_reward_mean": 521.866202303731, "done": false, "time_total_s": 4900.84276676178, "custom_metrics": {"cost2_min": -40.48321621526767, "cost2_max": -11.923991636538508, "system_level_velocity_min": 12.661796408983607, "outflow_rate_max": 1302.4193255004539, "cost1_max": 210.6871885991946, "cost1_min": 23.900762514705523, "cost2_mean": -27.301266535991793, "system_level_velocity_mean": 15.96457589365634, "outflow_rate_mean": 1145.5767025971973, "system_level_velocity_max": 18.415180184375675, "cost1_mean": 186.75254931289209, "outflow_rate_min": 495.9978486892713}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412968, "timesteps_since_restore": 7267725, "episodes_total": 9239, "policy_reward_mean": {}, "episode_reward_max": 597.1590600994848, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35072, "iterations_since_restore": 199, "training_iteration": 199, "episode_len_mean": 318.96, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4900.84276676178, "timesteps_total": 7267725, "date": "2019-05-21_04-29-28", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc13c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc10f0>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 48}
{"time_this_iter_s": 22.945245504379272, "hostname": "flow-main", "info": {"default": {"kl": 0.017637381330132484, "entropy": 1.755478024482727, "policy_loss": -0.01850959099829197, "cur_lr": 0.0005000000237487257, "total_loss": 66.58456420898438, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 66.59712219238281, "vf_explained_var": 0.5892682671546936}, "grad_time_ms": 7926.013, "update_time_ms": 7.282, "load_time_ms": 3.288, "sample_time_ms": 15296.196, "num_steps_sampled": 7303906, "num_steps_trained": 7303906}, "episode_reward_min": 452.13332613594486, "episode_reward_mean": 535.7611848673926, "done": true, "time_total_s": 4923.788012266159, "custom_metrics": {"cost2_min": -41.51738231055352, "cost2_max": -17.644689058140706, "system_level_velocity_min": 12.229706986631685, "outflow_rate_max": 1280.7814193426748, "cost1_max": 210.6871885991946, "cost1_min": 147.7501194078176, "cost2_mean": -27.419990309237484, "system_level_velocity_mean": 15.882901664796252, "outflow_rate_mean": 1159.1796819877504, "system_level_velocity_max": 17.79836036633995, "cost1_mean": 190.07184646304748, "outflow_rate_min": 935.04125819135}, "experiment_id": "6e579d78c401467f932670bb0c3b85f4", "timestamp": 1558412991, "timesteps_since_restore": 7303906, "episodes_total": 9283, "policy_reward_mean": {}, "episode_reward_max": 594.2720917826448, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36181, "iterations_since_restore": 200, "training_iteration": 200, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 286, "time_since_restore": 4923.788012266159, "timesteps_total": 7303906, "date": "2019-05-21_04-29-51", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "sgd_minibatch_size": 128, "kl_target": 0.01, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d891d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89080>"}, "output_max_file_size": 67108864, "lambda": 0.97, "custom_resources_per_worker": {}, "model": {"fcnet_activation": "tanh", "channel_major": false, "custom_model": null, "squash_to_range": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "conv_filters": null, "grayscale": false, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "lstm_cell_size": 256, "use_lstm": false, "lstm_use_prev_action_reward": false, "custom_options": {}, "zero_mean": true, "framestack": true, "conv_activation": "relu"}, "horizon": 750, "kl_coeff": 0.2, "lr": 0.0005, "monitor": false, "simple_optimizer": false, "num_sgd_iter": 10, "train_batch_size": 15000, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "output_compress_columns": ["obs", "new_obs"], "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "collect_metrics_timeout": 180, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "sample_async": false, "vf_loss_coeff": 1.0, "input": "sampler", "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "lr_schedule": null, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "num_envs_per_worker": 1, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "use_gae": true}, "episodes_this_iter": 44}

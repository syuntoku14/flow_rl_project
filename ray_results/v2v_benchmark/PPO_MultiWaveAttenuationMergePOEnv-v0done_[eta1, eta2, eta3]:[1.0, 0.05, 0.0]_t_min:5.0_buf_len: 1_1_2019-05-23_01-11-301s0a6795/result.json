{"time_this_iter_s": 32.340616941452026, "timesteps_total": 41356, "num_metric_batches_dropped": 0, "timestamp": 1558573974, "time_since_restore": 32.340616941452026, "episode_reward_max": -32.21229843451887, "hostname": "flow-main", "episode_len_mean": 318.0487804878049, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-12-54", "episode_reward_mean": -691.485370021674, "episode_reward_min": -1054.3054887065234, "time_total_s": 32.340616941452026, "iterations_since_restore": 1, "custom_metrics": {"cost1_max": 144.1688077504824, "outflow_rate_mean": 738.900677179085, "outflow_rate_min": 429.4959955005623, "cost2_max": -14.374347067021246, "cost2_min": -46.580669946477045, "outflow_rate_max": 967.0216463268723, "system_level_velocity_min": 8.455346975418138, "system_level_velocity_max": 18.31637683520338, "cost1_min": 25.891490610891974, "cost2_mean": -26.963569923917607, "system_level_velocity_mean": 10.22708275006256, "cost1_mean": 117.87885629803361}, "timesteps_since_restore": 41356, "episodes_this_iter": 41, "training_iteration": 1, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 41356, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114588>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 41, "info": {"load_time_ms": 52.038, "default": {"vf_explained_var": 0.5291586518287659, "total_loss": 18.32912254333496, "cur_kl_coeff": 0.20000001788139343, "entropy": 1.4158496856689453, "policy_loss": -0.002945807995274663, "cur_lr": 0.0005000000237487257, "kl": 0.005317029543220997, "vf_loss": 18.33100700378418}, "num_steps_trained": 41356, "update_time_ms": 749.588, "num_steps_sampled": 41356, "grad_time_ms": 10573.497, "sample_time_ms": 20828.384}}
{"time_this_iter_s": 29.216752290725708, "timesteps_total": 84505, "num_metric_batches_dropped": 0, "timestamp": 1558574003, "time_since_restore": 61.557369232177734, "episode_reward_max": -32.21229843451887, "hostname": "flow-main", "episode_len_mean": 321.48148148148147, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-13-23", "episode_reward_mean": -679.3564395635337, "episode_reward_min": -1054.3054887065234, "time_total_s": 61.557369232177734, "iterations_since_restore": 2, "custom_metrics": {"cost1_max": 162.4418297979318, "outflow_rate_mean": 778.7414130085479, "outflow_rate_min": 414.91337979094067, "cost2_max": -14.374347067021246, "cost2_min": -58.92400672899079, "outflow_rate_max": 1038.3415820543091, "system_level_velocity_min": 8.455346975418138, "system_level_velocity_max": 18.31637683520338, "cost1_min": 25.891490610891974, "cost2_mean": -28.01904960900915, "system_level_velocity_mean": 10.720504632635691, "cost1_mean": 126.63759617125935}, "timesteps_since_restore": 84505, "episodes_this_iter": 40, "training_iteration": 2, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43149, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91218d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121908>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 81, "info": {"load_time_ms": 29.432, "default": {"vf_explained_var": 0.5866647362709045, "total_loss": 32.61098098754883, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.3972342014312744, "policy_loss": -0.003664411837235093, "cur_lr": 0.0005000000237487257, "kl": 0.005384237039834261, "vf_loss": 32.61357116699219}, "num_steps_trained": 84505, "update_time_ms": 379.257, "num_steps_sampled": 84505, "grad_time_ms": 10817.851, "sample_time_ms": 19441.765}}
{"time_this_iter_s": 28.428574323654175, "timesteps_total": 127162, "num_metric_batches_dropped": 0, "timestamp": 1558574032, "time_since_restore": 89.98594355583191, "episode_reward_max": -478.3982027727617, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-13-52", "episode_reward_mean": -654.1778509301711, "episode_reward_min": -1054.3054887065234, "time_total_s": 89.98594355583191, "iterations_since_restore": 3, "custom_metrics": {"cost1_max": 174.65825843594013, "outflow_rate_mean": 845.545942863368, "outflow_rate_min": 414.91337979094067, "cost2_max": -15.22387141652298, "cost2_min": -58.92400672899079, "outflow_rate_max": 1195.047142857143, "system_level_velocity_min": 8.455346975418138, "system_level_velocity_max": 14.086367511780319, "cost1_min": 99.25393576264301, "cost2_mean": -30.53697070963345, "system_level_velocity_mean": 11.379443944048742, "cost1_mean": 137.46228476924324}, "timesteps_since_restore": 127162, "episodes_this_iter": 40, "training_iteration": 3, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 42657, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91147f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114978>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 121, "info": {"load_time_ms": 21.547, "default": {"vf_explained_var": 0.6888402700424194, "total_loss": 38.30635070800781, "cur_kl_coeff": 0.20000001788139343, "entropy": 1.3862168788909912, "policy_loss": -0.0036404086276888847, "cur_lr": 0.0005000000237487257, "kl": 0.0057826293632388115, "vf_loss": 38.308834075927734}, "num_steps_trained": 127162, "update_time_ms": 255.916, "num_steps_sampled": 127162, "grad_time_ms": 10865.725, "sample_time_ms": 18749.875}}
{"time_this_iter_s": 31.8843674659729, "timesteps_total": 169118, "num_metric_batches_dropped": 0, "timestamp": 1558574063, "time_since_restore": 121.87031102180481, "episode_reward_max": -30.64122903209683, "hostname": "flow-main", "episode_len_mean": 322.12, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-14-23", "episode_reward_mean": -561.1892749207316, "episode_reward_min": -942.3728132843659, "time_total_s": 121.87031102180481, "iterations_since_restore": 4, "custom_metrics": {"cost1_max": 193.95214846879705, "outflow_rate_mean": 1000.0674919094351, "outflow_rate_min": 501.3, "cost2_max": -11.529080796730947, "cost2_min": -59.567466753192626, "outflow_rate_max": 1236.3887453997993, "system_level_velocity_min": 9.188808771428848, "system_level_velocity_max": 18.272460085925754, "cost1_min": 23.954025637595432, "cost2_mean": -37.0748995984985, "system_level_velocity_mean": 12.926891695711355, "cost1_mean": 155.22103377045647}, "timesteps_since_restore": 169118, "episodes_this_iter": 61, "training_iteration": 4, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 41956, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b0f0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 182, "info": {"load_time_ms": 17.594, "default": {"vf_explained_var": 0.7482123374938965, "total_loss": 37.455806732177734, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.3728152513504028, "policy_loss": -0.0037769118789583445, "cur_lr": 0.0005000000237487257, "kl": 0.005199409555643797, "vf_loss": 37.45854187011719}, "num_steps_trained": 169118, "update_time_ms": 193.988, "num_steps_sampled": 169118, "grad_time_ms": 11057.362, "sample_time_ms": 19100.631}}
{"time_this_iter_s": 29.94137477874756, "timesteps_total": 210907, "num_metric_batches_dropped": 0, "timestamp": 1558574093, "time_since_restore": 151.81168580055237, "episode_reward_max": -30.64122903209683, "hostname": "flow-main", "episode_len_mean": 322.12, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-14-53", "episode_reward_mean": -522.5295910609617, "episode_reward_min": -904.4744597908881, "time_total_s": 151.81168580055237, "iterations_since_restore": 5, "custom_metrics": {"cost1_max": 202.1937070730459, "outflow_rate_mean": 1075.070041035731, "outflow_rate_min": 501.53457663979225, "cost2_max": -11.529080796730947, "cost2_min": -66.13568476846697, "outflow_rate_max": 1309.6055326876517, "system_level_velocity_min": 10.435793558568285, "system_level_velocity_max": 18.272460085925754, "cost1_min": 23.954025637595432, "cost2_mean": -41.35452983573597, "system_level_velocity_mean": 13.730307606067916, "cost1_mean": 165.48660716832913}, "timesteps_since_restore": 210907, "episodes_this_iter": 40, "training_iteration": 5, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 41789, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91214e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114e10>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 222, "info": {"load_time_ms": 15.416, "default": {"vf_explained_var": 0.808464765548706, "total_loss": 28.578964233398438, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.364912748336792, "policy_loss": -0.006217172369360924, "cur_lr": 0.0005000000237487257, "kl": 0.008738801814615726, "vf_loss": 28.583433151245117}, "num_steps_trained": 210907, "update_time_ms": 156.741, "num_steps_sampled": 210907, "grad_time_ms": 11379.173, "sample_time_ms": 18716.246}}
{"time_this_iter_s": 30.821321487426758, "timesteps_total": 252612, "num_metric_batches_dropped": 0, "timestamp": 1558574124, "time_since_restore": 182.63300728797913, "episode_reward_max": -338.0696546260259, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-15-24", "episode_reward_mean": -504.5104578365343, "episode_reward_min": -904.4744597908881, "time_total_s": 182.63300728797913, "iterations_since_restore": 6, "custom_metrics": {"cost1_max": 205.15630157317662, "outflow_rate_mean": 1121.8692580714346, "outflow_rate_min": 750.1508260016457, "cost2_max": -20.70648463242765, "cost2_min": -69.5638725971998, "outflow_rate_max": 1309.6055326876517, "system_level_velocity_min": 10.150852238345278, "system_level_velocity_max": 16.899735675125005, "cost1_min": 122.33353862942826, "cost2_mean": -44.41283242704588, "system_level_velocity_mean": 14.255771773440951, "cost1_mean": 173.71634245800865}, "timesteps_since_restore": 252612, "episodes_this_iter": 40, "training_iteration": 6, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 41705, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a90fafd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b780>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 262, "info": {"load_time_ms": 13.994, "default": {"vf_explained_var": 0.8035404086112976, "total_loss": 30.742218017578125, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.3573873043060303, "policy_loss": -0.005292484536767006, "cur_lr": 0.0005000000237487257, "kl": 0.007190205622464418, "vf_loss": 30.746068954467773}, "num_steps_trained": 252612, "update_time_ms": 131.959, "num_steps_sampled": 252612, "grad_time_ms": 11738.202, "sample_time_ms": 18462.181}}
{"time_this_iter_s": 32.11398458480835, "timesteps_total": 293276, "num_metric_batches_dropped": 0, "timestamp": 1558574157, "time_since_restore": 214.74699187278748, "episode_reward_max": -200.37815546616844, "hostname": "flow-main", "episode_len_mean": 323.9, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-15-57", "episode_reward_mean": -473.1933147228617, "episode_reward_min": -861.4638340053037, "time_total_s": 214.74699187278748, "iterations_since_restore": 7, "custom_metrics": {"cost1_max": 208.9015333324421, "outflow_rate_mean": 1156.773922574648, "outflow_rate_min": 880.0611748126322, "cost2_max": -25.958182762699373, "cost2_min": -69.5638725971998, "outflow_rate_max": 1325.3387903467874, "system_level_velocity_min": 10.150852238345278, "system_level_velocity_max": 17.46398750675257, "cost1_min": 122.33353862942826, "cost2_mean": -44.60891723965353, "system_level_velocity_mean": 14.811028999957209, "cost1_mean": 178.86171139060653}, "timesteps_since_restore": 293276, "episodes_this_iter": 60, "training_iteration": 7, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 40664, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b5f8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 322, "info": {"load_time_ms": 13.231, "default": {"vf_explained_var": 0.7895473837852478, "total_loss": 31.94234848022461, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.3485209941864014, "policy_loss": -0.005473022349178791, "cur_lr": 0.0005000000237487257, "kl": 0.006698979996144772, "vf_loss": 31.946483612060547}, "num_steps_trained": 293276, "update_time_ms": 114.399, "num_steps_sampled": 293276, "grad_time_ms": 11916.694, "sample_time_ms": 18541.341}}
{"time_this_iter_s": 29.128875255584717, "timesteps_total": 333866, "num_metric_batches_dropped": 0, "timestamp": 1558574186, "time_since_restore": 243.8758671283722, "episode_reward_max": -200.37815546616844, "hostname": "flow-main", "episode_len_mean": 323.9, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-16-26", "episode_reward_mean": -457.7543708419236, "episode_reward_min": -735.0419892849325, "time_total_s": 243.8758671283722, "iterations_since_restore": 8, "custom_metrics": {"cost1_max": 212.55104687957476, "outflow_rate_mean": 1174.4956019438414, "outflow_rate_min": 925.2685492521222, "cost2_max": -25.958182762699373, "cost2_min": -65.92982952428288, "outflow_rate_max": 1365.619545454546, "system_level_velocity_min": 11.813465361342624, "system_level_velocity_max": 17.749137857010634, "cost1_min": 137.76957198054743, "cost2_mean": -45.60078725587762, "system_level_velocity_mean": 15.123011270279337, "cost1_mean": 182.09483843913824}, "timesteps_since_restore": 333866, "episodes_this_iter": 40, "training_iteration": 8, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 40590, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121c18>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 362, "info": {"load_time_ms": 12.241, "default": {"vf_explained_var": 0.8278471827507019, "total_loss": 24.079219818115234, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.347386121749878, "policy_loss": -0.005083838012069464, "cur_lr": 0.0005000000237487257, "kl": 0.006299328990280628, "vf_loss": 24.083044052124023}, "num_steps_trained": 333866, "update_time_ms": 101.304, "num_steps_sampled": 333866, "grad_time_ms": 11960.776, "sample_time_ms": 18319.795}}
{"time_this_iter_s": 30.78168511390686, "timesteps_total": 376419, "num_metric_batches_dropped": 0, "timestamp": 1558574217, "time_since_restore": 274.65755224227905, "episode_reward_max": -200.37815546616844, "hostname": "flow-main", "episode_len_mean": 323.9, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-16-57", "episode_reward_mean": -460.6098673703975, "episode_reward_min": -959.9978215609099, "time_total_s": 274.65755224227905, "iterations_since_restore": 9, "custom_metrics": {"cost1_max": 212.55104687957476, "outflow_rate_mean": 1189.5605192165278, "outflow_rate_min": 759.836953125, "cost2_max": -32.654136436760545, "cost2_min": -65.92982952428288, "outflow_rate_max": 1365.619545454546, "system_level_velocity_min": 10.783913890925593, "system_level_velocity_max": 17.749137857010634, "cost1_min": 127.60325521433946, "cost2_mean": -48.47329536568038, "system_level_velocity_mean": 15.231715598157058, "cost1_mean": 183.5633440079222}, "timesteps_since_restore": 376419, "episodes_this_iter": 41, "training_iteration": 9, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 42553, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bc18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b6a0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 403, "info": {"load_time_ms": 11.655, "default": {"vf_explained_var": 0.8045476078987122, "total_loss": 28.00137710571289, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.3435114622116089, "policy_loss": -0.006529566831886768, "cur_lr": 0.0005000000237487257, "kl": 0.008800305426120758, "vf_loss": 28.006147384643555}, "num_steps_trained": 376419, "update_time_ms": 91.13, "num_steps_sampled": 376419, "grad_time_ms": 12037.355, "sample_time_ms": 18287.512}}
{"time_this_iter_s": 32.03665018081665, "timesteps_total": 418525, "num_metric_batches_dropped": 0, "timestamp": 1558574249, "time_since_restore": 306.6942024230957, "episode_reward_max": -296.03344930265433, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-17-29", "episode_reward_mean": -477.6975788541569, "episode_reward_min": -1454.7905510461983, "time_total_s": 306.6942024230957, "iterations_since_restore": 10, "custom_metrics": {"cost1_max": 212.96918598686466, "outflow_rate_mean": 1182.7352116748457, "outflow_rate_min": 73.08, "cost2_max": -31.829738030433656, "cost2_min": -68.2112038143605, "outflow_rate_max": 1366.7590981493527, "system_level_velocity_min": 5.386680802566547, "system_level_velocity_max": 17.70315184822571, "cost1_min": 62.865437452298096, "cost2_mean": -49.53973464486775, "system_level_velocity_mean": 15.156320891560181, "cost1_mean": 183.32192534691504}, "timesteps_since_restore": 418525, "episodes_this_iter": 57, "training_iteration": 10, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 42106, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b5f8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 460, "info": {"load_time_ms": 11.189, "default": {"vf_explained_var": 0.7739623188972473, "total_loss": 31.930997848510742, "cur_kl_coeff": 0.20000001788139343, "entropy": 1.3343071937561035, "policy_loss": -0.0051406314596533775, "cur_lr": 0.0005000000237487257, "kl": 0.006959619931876659, "vf_loss": 31.93474578857422}, "num_steps_trained": 418525, "update_time_ms": 82.779, "num_steps_sampled": 418525, "grad_time_ms": 12095.911, "sample_time_ms": 18390.178}}
{"time_this_iter_s": 29.545507669448853, "timesteps_total": 459409, "num_metric_batches_dropped": 0, "timestamp": 1558574278, "time_since_restore": 336.23971009254456, "episode_reward_max": -272.09817980709585, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-17-58", "episode_reward_mean": -480.71611198823274, "episode_reward_min": -1454.7905510461983, "time_total_s": 336.23971009254456, "iterations_since_restore": 11, "custom_metrics": {"cost1_max": 215.90301582060886, "outflow_rate_mean": 1179.577053185884, "outflow_rate_min": 73.08, "cost2_max": -31.64065554855154, "cost2_min": -68.2112038143605, "outflow_rate_max": 1380.4956032676998, "system_level_velocity_min": 5.386680802566547, "system_level_velocity_max": 18.046549170123892, "cost1_min": 62.865437452298096, "cost2_mean": -49.60951761626098, "system_level_velocity_mean": 15.075931414388736, "cost1_mean": 182.47232496687892}, "timesteps_since_restore": 459409, "episodes_this_iter": 42, "training_iteration": 11, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 40884, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91214a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91214e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114d68>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 502, "info": {"load_time_ms": 6.769, "default": {"vf_explained_var": 0.82856285572052, "total_loss": 25.2017879486084, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.3263071775436401, "policy_loss": -0.007662779651582241, "cur_lr": 0.0005000000237487257, "kl": 0.009305491112172604, "vf_loss": 25.207590103149414}, "num_steps_trained": 459409, "update_time_ms": 8.648, "num_steps_sampled": 459409, "grad_time_ms": 12241.596, "sample_time_ms": 18049.006}}
{"time_this_iter_s": 31.211389303207397, "timesteps_total": 503490, "num_metric_batches_dropped": 0, "timestamp": 1558574309, "time_since_restore": 367.45109939575195, "episode_reward_max": -272.09817980709585, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-18-29", "episode_reward_mean": -516.0862281063972, "episode_reward_min": -1454.7905510461983, "time_total_s": 367.45109939575195, "iterations_since_restore": 12, "custom_metrics": {"cost1_max": 215.90301582060886, "outflow_rate_mean": 1139.7082177774566, "outflow_rate_min": 73.08, "cost2_max": -31.64065554855154, "cost2_min": -64.50300454848909, "outflow_rate_max": 1410.6527778241027, "system_level_velocity_min": 5.386680802566547, "system_level_velocity_max": 18.046549170123892, "cost1_min": 62.865437452298096, "cost2_mean": -48.90143488163616, "system_level_velocity_mean": 14.76919506480225, "cost1_mean": 178.36837092820198}, "timesteps_since_restore": 503490, "episodes_this_iter": 41, "training_iteration": 12, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44081, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912be10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bd30>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 543, "info": {"load_time_ms": 6.827, "default": {"vf_explained_var": 0.8085456490516663, "total_loss": 36.95789337158203, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.3429293632507324, "policy_loss": -0.005659076850861311, "cur_lr": 0.0005000000237487257, "kl": 0.007769571617245674, "vf_loss": 36.961997985839844}, "num_steps_trained": 503490, "update_time_ms": 8.526, "num_steps_sampled": 503490, "grad_time_ms": 12425.743, "sample_time_ms": 18064.528}}
{"time_this_iter_s": 31.09270930290222, "timesteps_total": 545464, "num_metric_batches_dropped": 0, "timestamp": 1558574341, "time_since_restore": 398.5438086986542, "episode_reward_max": -105.55582753780232, "hostname": "flow-main", "episode_len_mean": 323.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-19-01", "episode_reward_mean": -526.0236282638725, "episode_reward_min": -937.2282941648368, "time_total_s": 398.5438086986542, "iterations_since_restore": 13, "custom_metrics": {"cost1_max": 215.85514428503802, "outflow_rate_mean": 1129.2819487499896, "outflow_rate_min": 712.1507066959017, "cost2_max": -34.048950686651466, "cost2_min": -63.406077874663396, "outflow_rate_max": 1410.6527778241027, "system_level_velocity_min": 10.316265005033666, "system_level_velocity_max": 18.542377327214158, "cost1_min": 85.95142472409236, "cost2_mean": -49.2651622656987, "system_level_velocity_mean": 14.701151644718022, "cost1_mean": 175.57954314551662}, "timesteps_since_restore": 545464, "episodes_this_iter": 57, "training_iteration": 13, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 41974, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bbe0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 600, "info": {"load_time_ms": 7.025, "default": {"vf_explained_var": 0.786724865436554, "total_loss": 39.78533935546875, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.3383138179779053, "policy_loss": -0.006172137334942818, "cur_lr": 0.0005000000237487257, "kl": 0.008494684472680092, "vf_loss": 39.78981399536133}, "num_steps_trained": 545464, "update_time_ms": 8.334, "num_steps_sampled": 545464, "grad_time_ms": 12584.31, "sample_time_ms": 18172.058}}
{"time_this_iter_s": 28.23651623725891, "timesteps_total": 586228, "num_metric_batches_dropped": 0, "timestamp": 1558574369, "time_since_restore": 426.7803249359131, "episode_reward_max": -105.55582753780232, "hostname": "flow-main", "episode_len_mean": 323.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-19-29", "episode_reward_mean": -504.0728696053309, "episode_reward_min": -923.4805513950326, "time_total_s": 426.7803249359131, "iterations_since_restore": 14, "custom_metrics": {"cost1_max": 218.3219617534332, "outflow_rate_mean": 1153.8681531943337, "outflow_rate_min": 712.1507066959017, "cost2_max": -34.048950686651466, "cost2_min": -66.79935979771484, "outflow_rate_max": 1412.7964916054677, "system_level_velocity_min": 10.316265005033666, "system_level_velocity_max": 18.542377327214158, "cost1_min": 85.95142472409236, "cost2_mean": -51.21041820862543, "system_level_velocity_mean": 14.929856165845388, "cost1_mean": 178.23864274052087}, "timesteps_since_restore": 586228, "episodes_this_iter": 42, "training_iteration": 14, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 40764, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bf60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b2e8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 642, "info": {"load_time_ms": 7.027, "default": {"vf_explained_var": 0.8124648928642273, "total_loss": 38.19784164428711, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.3191242218017578, "policy_loss": -0.0060791936703026295, "cur_lr": 0.0005000000237487257, "kl": 0.007977467961609364, "vf_loss": 38.202327728271484}, "num_steps_trained": 586228, "update_time_ms": 8.359, "num_steps_sampled": 586228, "grad_time_ms": 12466.454, "sample_time_ms": 17925.841}}
{"time_this_iter_s": 31.09735369682312, "timesteps_total": 629336, "num_metric_batches_dropped": 0, "timestamp": 1558574400, "time_since_restore": 457.8776786327362, "episode_reward_max": -21.16346945111836, "hostname": "flow-main", "episode_len_mean": 320.03, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-20-00", "episode_reward_mean": -505.02180886173227, "episode_reward_min": -914.8101805289054, "time_total_s": 457.8776786327362, "iterations_since_restore": 15, "custom_metrics": {"cost1_max": 218.3219617534332, "outflow_rate_mean": 1153.540216801166, "outflow_rate_min": 497.50056700217027, "cost2_max": -14.276719495501833, "cost2_min": -70.91236676263486, "outflow_rate_max": 1412.7964916054677, "system_level_velocity_min": 11.370827155166056, "system_level_velocity_max": 18.561908492975633, "cost1_min": 18.717484103587434, "cost2_mean": -54.50387784627202, "system_level_velocity_mean": 15.020143938916858, "cost1_mean": 177.24656257852564}, "timesteps_since_restore": 629336, "episodes_this_iter": 43, "training_iteration": 15, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43108, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121dd8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 685, "info": {"load_time_ms": 7.074, "default": {"vf_explained_var": 0.8121663331985474, "total_loss": 40.874427795410156, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.3139886856079102, "policy_loss": -0.00762967998161912, "cur_lr": 0.0005000000237487257, "kl": 0.009944893419742584, "vf_loss": 40.880069732666016}, "num_steps_trained": 629336, "update_time_ms": 8.554, "num_steps_sampled": 629336, "grad_time_ms": 12477.105, "sample_time_ms": 18030.081}}
{"time_this_iter_s": 31.866106033325195, "timesteps_total": 672871, "num_metric_batches_dropped": 0, "timestamp": 1558574432, "time_since_restore": 489.7437846660614, "episode_reward_max": -21.16346945111836, "hostname": "flow-main", "episode_len_mean": 320.03, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-20-32", "episode_reward_mean": -503.62474830565776, "episode_reward_min": -951.0295402363328, "time_total_s": 489.7437846660614, "iterations_since_restore": 16, "custom_metrics": {"cost1_max": 222.87045788026518, "outflow_rate_mean": 1164.6687424692232, "outflow_rate_min": 497.50056700217027, "cost2_max": -14.276719495501833, "cost2_min": -73.04114602628793, "outflow_rate_max": 1435.9191414141417, "system_level_velocity_min": 11.370827155166056, "system_level_velocity_max": 18.667120449343088, "cost1_min": 18.717484103587434, "cost2_mean": -57.73326232547968, "system_level_velocity_mean": 15.122543220305586, "cost1_mean": 178.2067433986134}, "timesteps_since_restore": 672871, "episodes_this_iter": 41, "training_iteration": 16, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43535, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b780>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 726, "info": {"load_time_ms": 7.125, "default": {"vf_explained_var": 0.8358736038208008, "total_loss": 35.033390045166016, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.3169255256652832, "policy_loss": -0.00646635377779603, "cur_lr": 0.0005000000237487257, "kl": 0.009517787024378777, "vf_loss": 35.0379524230957}, "num_steps_trained": 672871, "update_time_ms": 8.613, "num_steps_sampled": 672871, "grad_time_ms": 12540.576, "sample_time_ms": 18070.179}}
{"time_this_iter_s": 34.63820004463196, "timesteps_total": 718153, "num_metric_batches_dropped": 0, "timestamp": 1558574467, "time_since_restore": 524.3819847106934, "episode_reward_max": -103.95425410608084, "hostname": "flow-main", "episode_len_mean": 323.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-21-07", "episode_reward_mean": -547.2672644712027, "episode_reward_min": -969.9157903854116, "time_total_s": 524.3819847106934, "iterations_since_restore": 17, "custom_metrics": {"cost1_max": 222.87045788026518, "outflow_rate_mean": 1157.749125524199, "outflow_rate_min": 713.781417476106, "cost2_max": -35.22215204445651, "cost2_min": -80.06061774883398, "outflow_rate_max": 1435.9191414141417, "system_level_velocity_min": 11.337222857429634, "system_level_velocity_max": 18.667120449343088, "cost1_min": 86.17261707769323, "cost2_mean": -62.52380595339489, "system_level_velocity_mean": 14.85120179127937, "cost1_mean": 177.07163270454421}, "timesteps_since_restore": 718153, "episodes_this_iter": 57, "training_iteration": 17, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45282, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bd68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a90fa438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114dd8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 783, "info": {"load_time_ms": 6.963, "default": {"vf_explained_var": 0.7643653750419617, "total_loss": 49.14859390258789, "cur_kl_coeff": 0.20000001788139343, "entropy": 1.3228856325149536, "policy_loss": -0.006045629270374775, "cur_lr": 0.0005000000237487257, "kl": 0.009293864481151104, "vf_loss": 49.15278244018555}, "num_steps_trained": 718153, "update_time_ms": 8.523, "num_steps_sampled": 718153, "grad_time_ms": 12774.086, "sample_time_ms": 18090.257}}
{"time_this_iter_s": 30.489514350891113, "timesteps_total": 761587, "num_metric_batches_dropped": 0, "timestamp": 1558574497, "time_since_restore": 554.8714990615845, "episode_reward_max": -21.415866994319927, "hostname": "flow-main", "episode_len_mean": 320.04, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-21-37", "episode_reward_mean": -545.9737399713042, "episode_reward_min": -969.9157903854116, "time_total_s": 554.8714990615845, "iterations_since_restore": 18, "custom_metrics": {"cost1_max": 221.31230342166896, "outflow_rate_mean": 1163.1599251866585, "outflow_rate_min": 474.3699846082663, "cost2_max": -11.225010836307867, "cost2_min": -80.06061774883398, "outflow_rate_max": 1426.9088846459206, "system_level_velocity_min": 11.118472105492955, "system_level_velocity_max": 18.6321497851581, "cost1_min": 17.80430482286663, "cost2_mean": -64.46960736856819, "system_level_velocity_mean": 14.807458720010029, "cost1_mean": 174.9938005773828}, "timesteps_since_restore": 761587, "episodes_this_iter": 44, "training_iteration": 18, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43434, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114d30>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 827, "info": {"load_time_ms": 7.054, "default": {"vf_explained_var": 0.8435171842575073, "total_loss": 30.658899307250977, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.303798794746399, "policy_loss": -0.006354562472552061, "cur_lr": 0.0005000000237487257, "kl": 0.009391354396939278, "vf_loss": 30.66338348388672}, "num_steps_trained": 761587, "update_time_ms": 8.289, "num_steps_sampled": 761587, "grad_time_ms": 12719.619, "sample_time_ms": 18280.793}}
{"time_this_iter_s": 31.301587104797363, "timesteps_total": 806601, "num_metric_batches_dropped": 0, "timestamp": 1558574529, "time_since_restore": 586.1730861663818, "episode_reward_max": -21.415866994319927, "hostname": "flow-main", "episode_len_mean": 320.04, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-22-09", "episode_reward_mean": -524.7094401949078, "episode_reward_min": -966.316313488833, "time_total_s": 586.1730861663818, "iterations_since_restore": 19, "custom_metrics": {"cost1_max": 222.21695212696557, "outflow_rate_mean": 1184.4687678707328, "outflow_rate_min": 474.3699846082663, "cost2_max": -11.225010836307867, "cost2_min": -82.50987680022973, "outflow_rate_max": 1430.6201490416615, "system_level_velocity_min": 11.118472105492955, "system_level_velocity_max": 18.70499915034018, "cost1_min": 17.80430482286663, "cost2_mean": -64.96683524508552, "system_level_velocity_mean": 15.08711576568853, "cost1_mean": 178.41169201888798}, "timesteps_since_restore": 806601, "episodes_this_iter": 41, "training_iteration": 19, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45014, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114c50>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 868, "info": {"load_time_ms": 7.074, "default": {"vf_explained_var": 0.8274155259132385, "total_loss": 36.96206283569336, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.31498384475708, "policy_loss": -0.006385665852576494, "cur_lr": 0.0005000000237487257, "kl": 0.009077322669327259, "vf_loss": 36.96662902832031}, "num_steps_trained": 806601, "update_time_ms": 8.126, "num_steps_sampled": 806601, "grad_time_ms": 12674.025, "sample_time_ms": 18378.382}}
{"time_this_iter_s": 31.46136164665222, "timesteps_total": 852551, "num_metric_batches_dropped": 0, "timestamp": 1558574560, "time_since_restore": 617.6344478130341, "episode_reward_max": -91.83801246778896, "hostname": "flow-main", "episode_len_mean": 322.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-22-40", "episode_reward_mean": -564.9147871691781, "episode_reward_min": -966.316313488833, "time_total_s": 617.6344478130341, "iterations_since_restore": 20, "custom_metrics": {"cost1_max": 222.21695212696557, "outflow_rate_mean": 1167.4502643738454, "outflow_rate_min": 712.048027334761, "cost2_max": -36.38465868857337, "cost2_min": -83.82382229171715, "outflow_rate_max": 1437.1903281271886, "system_level_velocity_min": 10.711642605944993, "system_level_velocity_max": 18.70499915034018, "cost1_min": 79.09421538005452, "cost2_mean": -66.93934000820825, "system_level_velocity_mean": 14.80609780352024, "cost1_mean": 176.85174092538378}, "timesteps_since_restore": 852551, "episodes_this_iter": 56, "training_iteration": 20, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45950, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121550>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 924, "info": {"load_time_ms": 7.19, "default": {"vf_explained_var": 0.7793741822242737, "total_loss": 47.71738052368164, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.329148530960083, "policy_loss": -0.0063414606265723705, "cur_lr": 0.0005000000237487257, "kl": 0.00964471884071827, "vf_loss": 47.72179412841797}, "num_steps_trained": 852551, "update_time_ms": 8.15, "num_steps_sampled": 852551, "grad_time_ms": 12612.219, "sample_time_ms": 18382.362}}
{"time_this_iter_s": 28.80585289001465, "timesteps_total": 896458, "num_metric_batches_dropped": 0, "timestamp": 1558574589, "time_since_restore": 646.4403007030487, "episode_reward_max": -91.83801246778896, "hostname": "flow-main", "episode_len_mean": 322.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-23-09", "episode_reward_mean": -565.5700350353706, "episode_reward_min": -956.9976295834014, "time_total_s": 646.4403007030487, "iterations_since_restore": 21, "custom_metrics": {"cost1_max": 219.84374704629113, "outflow_rate_mean": 1172.9254406518403, "outflow_rate_min": 715.323867412425, "cost2_max": -36.38465868857337, "cost2_min": -83.82382229171715, "outflow_rate_max": 1437.1903281271886, "system_level_velocity_min": 10.711642605944993, "system_level_velocity_max": 18.700631371944805, "cost1_min": 79.09421538005452, "cost2_mean": -67.85682901046384, "system_level_velocity_mean": 14.701358329171892, "cost1_mean": 175.66739734765085}, "timesteps_since_restore": 896458, "episodes_this_iter": 44, "training_iteration": 21, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43907, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121978>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 968, "info": {"load_time_ms": 7.13, "default": {"vf_explained_var": 0.8516148924827576, "total_loss": 27.912994384765625, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.3108795881271362, "policy_loss": -0.007248849142342806, "cur_lr": 0.0005000000237487257, "kl": 0.010204244405031204, "vf_loss": 27.918201446533203}, "num_steps_trained": 896458, "update_time_ms": 8.058, "num_steps_sampled": 896458, "grad_time_ms": 12469.029, "sample_time_ms": 18450.169}}
{"time_this_iter_s": 30.20503044128418, "timesteps_total": 941697, "num_metric_batches_dropped": 0, "timestamp": 1558574619, "time_since_restore": 676.6453311443329, "episode_reward_max": -271.639853508226, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-23-39", "episode_reward_mean": -565.7266843985343, "episode_reward_min": -955.0876911286717, "time_total_s": 676.6453311443329, "iterations_since_restore": 22, "custom_metrics": {"cost1_max": 221.3300875623152, "outflow_rate_mean": 1194.9962660589022, "outflow_rate_min": 713.0033497536948, "cost2_max": -50.224189784915346, "cost2_min": -82.9392049170373, "outflow_rate_max": 1435.6920464852606, "system_level_velocity_min": 10.971133072817919, "system_level_velocity_max": 18.429665133654925, "cost1_min": 131.59943597170204, "cost2_mean": -70.39646490785975, "system_level_velocity_mean": 14.678027938638845, "cost1_mean": 176.66183125199154}, "timesteps_since_restore": 941697, "episodes_this_iter": 41, "training_iteration": 22, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45239, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91215c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91215f8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1009, "info": {"load_time_ms": 7.069, "default": {"vf_explained_var": 0.8597474098205566, "total_loss": 27.653553009033203, "cur_kl_coeff": 0.20000001788139343, "entropy": 1.3083792924880981, "policy_loss": -0.005797987338155508, "cur_lr": 0.0005000000237487257, "kl": 0.00866188295185566, "vf_loss": 27.657617568969727}, "num_steps_trained": 941697, "update_time_ms": 8.196, "num_steps_sampled": 941697, "grad_time_ms": 12372.513, "sample_time_ms": 18445.798}}
{"time_this_iter_s": 33.557034730911255, "timesteps_total": 986722, "num_metric_batches_dropped": 0, "timestamp": 1558574653, "time_since_restore": 710.2023658752441, "episode_reward_max": -29.274093534905276, "hostname": "flow-main", "episode_len_mean": 319.25, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-24-13", "episode_reward_mean": -542.9878624004199, "episode_reward_min": -965.8455327797925, "time_total_s": 710.2023658752441, "iterations_since_restore": 23, "custom_metrics": {"cost1_max": 221.3300875623152, "outflow_rate_mean": 1203.937968029294, "outflow_rate_min": 481.1996810430701, "cost2_max": -17.26807400052574, "cost2_min": -83.46132641100397, "outflow_rate_max": 1443.0447031953286, "system_level_velocity_min": 11.09085916254881, "system_level_velocity_max": 18.891265450961644, "cost1_min": 24.568704717224744, "cost2_mean": -73.3743282585328, "system_level_velocity_mean": 15.005914664849358, "cost1_mean": 176.80376519502303}, "timesteps_since_restore": 986722, "episodes_this_iter": 52, "training_iteration": 23, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45025, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913abe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913af60>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1061, "info": {"load_time_ms": 7.022, "default": {"vf_explained_var": 0.8239090442657471, "total_loss": 33.82084274291992, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.306408166885376, "policy_loss": -0.007027729414403439, "cur_lr": 0.0005000000237487257, "kl": 0.01147389318794012, "vf_loss": 33.82557678222656}, "num_steps_trained": 986722, "update_time_ms": 8.312, "num_steps_sampled": 986722, "grad_time_ms": 12498.881, "sample_time_ms": 18566.446}}
{"time_this_iter_s": 31.893033504486084, "timesteps_total": 1031799, "num_metric_batches_dropped": 0, "timestamp": 1558574685, "time_since_restore": 742.0953993797302, "episode_reward_max": -29.274093534905276, "hostname": "flow-main", "episode_len_mean": 316.07, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-24-45", "episode_reward_mean": -541.2449166041205, "episode_reward_min": -965.8455327797925, "time_total_s": 742.0953993797302, "iterations_since_restore": 24, "custom_metrics": {"cost1_max": 223.3686318094314, "outflow_rate_mean": 1197.4212421985749, "outflow_rate_min": 481.1996810430701, "cost2_max": -17.26807400052574, "cost2_min": -87.73826771246685, "outflow_rate_max": 1443.0447031953286, "system_level_velocity_min": 9.514881807910827, "system_level_velocity_max": 18.891265450961644, "cost1_min": 24.568704717224744, "cost2_mean": -74.0612096657532, "system_level_velocity_mean": 14.995184899048834, "cost1_mean": 174.54413264008738}, "timesteps_since_restore": 1031799, "episodes_this_iter": 48, "training_iteration": 24, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45077, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a828>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1109, "info": {"load_time_ms": 7.129, "default": {"vf_explained_var": 0.840376079082489, "total_loss": 30.290966033935547, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.3026849031448364, "policy_loss": -0.005909700412303209, "cur_lr": 0.0005000000237487257, "kl": 0.010264504700899124, "vf_loss": 30.294822692871094}, "num_steps_trained": 1031799, "update_time_ms": 8.268, "num_steps_sampled": 1031799, "grad_time_ms": 12644.186, "sample_time_ms": 18785.89}}
{"time_this_iter_s": 33.7677800655365, "timesteps_total": 1078080, "num_metric_batches_dropped": 0, "timestamp": 1558574718, "time_since_restore": 775.8631794452667, "episode_reward_max": -21.71949112326708, "hostname": "flow-main", "episode_len_mean": 315.97, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-25-18", "episode_reward_mean": -574.3298668392803, "episode_reward_min": -967.9286375864492, "time_total_s": 775.8631794452667, "iterations_since_restore": 25, "custom_metrics": {"cost1_max": 223.41030647490732, "outflow_rate_mean": 1171.1114888273012, "outflow_rate_min": 437.2949997643919, "cost2_max": -16.557512615711342, "cost2_min": -90.4359297108018, "outflow_rate_max": 1444.2503474278783, "system_level_velocity_min": 9.514881807910827, "system_level_velocity_max": 18.689993547530225, "cost1_min": 17.924379303324905, "cost2_mean": -75.49956592850252, "system_level_velocity_mean": 14.65561477211409, "cost1_mean": 170.383124382994}, "timesteps_since_restore": 1078080, "episodes_this_iter": 44, "training_iteration": 25, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 46281, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b2e8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1153, "info": {"load_time_ms": 7.105, "default": {"vf_explained_var": 0.8374674320220947, "total_loss": 30.60042953491211, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.292677640914917, "policy_loss": -0.009336897172033787, "cur_lr": 0.0005000000237487257, "kl": 0.01178886741399765, "vf_loss": 30.60740852355957}, "num_steps_trained": 1078080, "update_time_ms": 8.111, "num_steps_sampled": 1078080, "grad_time_ms": 12577.738, "sample_time_ms": 19118.47}}
{"time_this_iter_s": 32.93487763404846, "timesteps_total": 1124967, "num_metric_batches_dropped": 0, "timestamp": 1558574751, "time_since_restore": 808.7980570793152, "episode_reward_max": -21.71949112326708, "hostname": "flow-main", "episode_len_mean": 322.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-25-51", "episode_reward_mean": -584.8454448884911, "episode_reward_min": -967.9286375864492, "time_total_s": 808.7980570793152, "iterations_since_restore": 26, "custom_metrics": {"cost1_max": 223.4527574095573, "outflow_rate_mean": 1193.9565365513458, "outflow_rate_min": 437.2949997643919, "cost2_max": -16.557512615711342, "cost2_min": -92.12189339821005, "outflow_rate_max": 1444.2503474278783, "system_level_velocity_min": 10.706535318500219, "system_level_velocity_max": 18.680057842972356, "cost1_min": 17.924379303324905, "cost2_mean": -79.11998418952827, "system_level_velocity_mean": 14.709324835520674, "cost1_mean": 175.03080645213245}, "timesteps_since_restore": 1124967, "episodes_this_iter": 50, "training_iteration": 26, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 46887, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a550>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1203, "info": {"load_time_ms": 7.001, "default": {"vf_explained_var": 0.8440319299697876, "total_loss": 29.871990203857422, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.3023284673690796, "policy_loss": -0.005391092970967293, "cur_lr": 0.0005000000237487257, "kl": 0.009805290959775448, "vf_loss": 29.87542152404785}, "num_steps_trained": 1124967, "update_time_ms": 7.999, "num_steps_sampled": 1124967, "grad_time_ms": 12321.479, "sample_time_ms": 19481.614}}
{"time_this_iter_s": 33.38062787055969, "timesteps_total": 1170954, "num_metric_batches_dropped": 0, "timestamp": 1558574785, "time_since_restore": 842.1786849498749, "episode_reward_max": -21.71949112326708, "hostname": "flow-main", "episode_len_mean": 320.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-26-25", "episode_reward_mean": -587.4305935472674, "episode_reward_min": -988.0043178374915, "time_total_s": 842.1786849498749, "iterations_since_restore": 27, "custom_metrics": {"cost1_max": 224.1472943341505, "outflow_rate_mean": 1195.4157037951704, "outflow_rate_min": 437.2949997643919, "cost2_max": -16.557512615711342, "cost2_min": -94.25364134227917, "outflow_rate_max": 1451.101882940393, "system_level_velocity_min": 11.386508574579954, "system_level_velocity_max": 18.740448859364278, "cost1_min": 17.924379303324905, "cost2_mean": -79.88244420427215, "system_level_velocity_mean": 14.691672024154188, "cost1_mean": 174.04920933400743}, "timesteps_since_restore": 1170954, "episodes_this_iter": 45, "training_iteration": 27, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45987, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91335f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91331d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133128>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1248, "info": {"load_time_ms": 6.859, "default": {"vf_explained_var": 0.8490801453590393, "total_loss": 29.841846466064453, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.282283902168274, "policy_loss": -0.005497599486261606, "cur_lr": 0.0005000000237487257, "kl": 0.009604609571397305, "vf_loss": 29.845420837402344}, "num_steps_trained": 1170954, "update_time_ms": 7.973, "num_steps_sampled": 1170954, "grad_time_ms": 11944.986, "sample_time_ms": 19732.833}}
{"time_this_iter_s": 31.249613761901855, "timesteps_total": 1216182, "num_metric_batches_dropped": 0, "timestamp": 1558574816, "time_since_restore": 873.4282987117767, "episode_reward_max": -91.37755429736696, "hostname": "flow-main", "episode_len_mean": 321.82, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-26-56", "episode_reward_mean": -579.7464059481706, "episode_reward_min": -988.0043178374915, "time_total_s": 873.4282987117767, "iterations_since_restore": 28, "custom_metrics": {"cost1_max": 224.1472943341505, "outflow_rate_mean": 1204.5887971505676, "outflow_rate_min": 721.9461968713103, "cost2_max": -41.559711878532326, "cost2_min": -94.25364134227917, "outflow_rate_max": 1451.101882940393, "system_level_velocity_min": 10.919545236139658, "system_level_velocity_max": 18.740448859364278, "cost1_min": 79.74042077802547, "cost2_mean": -79.9548750084207, "system_level_velocity_mean": 14.810541117991328, "cost1_mean": 175.7402276281304}, "timesteps_since_restore": 1216182, "episodes_this_iter": 45, "training_iteration": 28, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45228, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ad68>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1293, "info": {"load_time_ms": 6.847, "default": {"vf_explained_var": 0.8390138149261475, "total_loss": 32.95008850097656, "cur_kl_coeff": 0.20000001788139343, "entropy": 1.2772278785705566, "policy_loss": -0.007644515484571457, "cur_lr": 0.0005000000237487257, "kl": 0.01108325831592083, "vf_loss": 32.95551681518555}, "num_steps_trained": 1216182, "update_time_ms": 8.107, "num_steps_sampled": 1216182, "grad_time_ms": 11915.585, "sample_time_ms": 19836.715}}
{"time_this_iter_s": 32.93353343009949, "timesteps_total": 1261193, "num_metric_batches_dropped": 0, "timestamp": 1558574849, "time_since_restore": 906.3618321418762, "episode_reward_max": -29.38201872885996, "hostname": "flow-main", "episode_len_mean": 318.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-27-29", "episode_reward_mean": -569.1624074198953, "episode_reward_min": -988.0043178374915, "time_total_s": 906.3618321418762, "iterations_since_restore": 29, "custom_metrics": {"cost1_max": 225.29781382097073, "outflow_rate_mean": 1197.7859634754377, "outflow_rate_min": 460.7989278777953, "cost2_max": -20.569808016992884, "cost2_min": -92.19140716633608, "outflow_rate_max": 1451.101882940393, "system_level_velocity_min": 10.919545236139658, "system_level_velocity_max": 18.878272985394087, "cost1_min": 23.22779648815808, "cost2_mean": -79.755151870771, "system_level_velocity_mean": 14.93411632983506, "cost1_mean": 174.83173874258483}, "timesteps_since_restore": 1261193, "episodes_this_iter": 43, "training_iteration": 29, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45011, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913aeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a208>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1336, "info": {"load_time_ms": 6.694, "default": {"vf_explained_var": 0.8425427675247192, "total_loss": 32.92304229736328, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.2704589366912842, "policy_loss": -0.007751801051199436, "cur_lr": 0.0005000000237487257, "kl": 0.012254678644239902, "vf_loss": 32.9283447265625}, "num_steps_trained": 1261193, "update_time_ms": 8.269, "num_steps_sampled": 1261193, "grad_time_ms": 11990.355, "sample_time_ms": 19925.712}}
{"time_this_iter_s": 31.084030628204346, "timesteps_total": 1305461, "num_metric_batches_dropped": 0, "timestamp": 1558574880, "time_since_restore": 937.4458627700806, "episode_reward_max": -29.38201872885996, "hostname": "flow-main", "episode_len_mean": 320.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-28-00", "episode_reward_mean": -542.872462747563, "episode_reward_min": -983.1005795596512, "time_total_s": 937.4458627700806, "iterations_since_restore": 30, "custom_metrics": {"cost1_max": 225.29781382097073, "outflow_rate_mean": 1219.7213530201125, "outflow_rate_min": 460.7989278777953, "cost2_max": -20.569808016992884, "cost2_min": -96.29004473582512, "outflow_rate_max": 1450.6461870941553, "system_level_velocity_min": 11.36995664392016, "system_level_velocity_max": 18.878272985394087, "cost1_min": 23.22779648815808, "cost2_mean": -81.10099685802696, "system_level_velocity_mean": 15.268385764005329, "cost1_mean": 180.12636404379057}, "timesteps_since_restore": 1305461, "episodes_this_iter": 54, "training_iteration": 30, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44268, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91333c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133160>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1390, "info": {"load_time_ms": 6.522, "default": {"vf_explained_var": 0.8307634592056274, "total_loss": 34.689151763916016, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.2651728391647339, "policy_loss": -0.00748129328712821, "cur_lr": 0.0005000000237487257, "kl": 0.010709315538406372, "vf_loss": 34.694496154785156}, "num_steps_trained": 1305461, "update_time_ms": 8.344, "num_steps_sampled": 1305461, "grad_time_ms": 11944.679, "sample_time_ms": 19934.121}}
{"time_this_iter_s": 31.94976234436035, "timesteps_total": 1350539, "num_metric_batches_dropped": 0, "timestamp": 1558574912, "time_since_restore": 969.3956251144409, "episode_reward_max": -168.3072690453155, "hostname": "flow-main", "episode_len_mean": 323.82, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-28-32", "episode_reward_mean": -538.6824419098645, "episode_reward_min": -963.6667821197409, "time_total_s": 969.3956251144409, "iterations_since_restore": 31, "custom_metrics": {"cost1_max": 225.25446062203554, "outflow_rate_mean": 1227.3874840418193, "outflow_rate_min": 711.4312678804507, "cost2_max": -58.841355280140064, "cost2_min": -96.29004473582512, "outflow_rate_max": 1453.9362149988738, "system_level_velocity_min": 10.969932428520139, "system_level_velocity_max": 18.831619796493456, "cost1_min": 131.19218352164876, "cost2_mean": -82.8533130455135, "system_level_velocity_mean": 15.362326731087613, "cost1_mean": 183.3330190833003}, "timesteps_since_restore": 1350539, "episodes_this_iter": 44, "training_iteration": 31, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45078, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121b00>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1434, "info": {"load_time_ms": 6.497, "default": {"vf_explained_var": 0.8588600158691406, "total_loss": 28.2791805267334, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.2501742839813232, "policy_loss": -0.00688563846051693, "cur_lr": 0.0005000000237487257, "kl": 0.01146842259913683, "vf_loss": 28.283775329589844}, "num_steps_trained": 1350539, "update_time_ms": 8.47, "num_steps_sampled": 1350539, "grad_time_ms": 12023.802, "sample_time_ms": 20170.824}}
{"time_this_iter_s": 29.820500373840332, "timesteps_total": 1395434, "num_metric_batches_dropped": 0, "timestamp": 1558574942, "time_since_restore": 999.2161254882812, "episode_reward_max": -260.7535257635702, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-29-02", "episode_reward_mean": -552.2133503085631, "episode_reward_min": -963.6667821197409, "time_total_s": 999.2161254882812, "iterations_since_restore": 32, "custom_metrics": {"cost1_max": 225.25446062203554, "outflow_rate_mean": 1221.8829589912323, "outflow_rate_min": 711.4312678804507, "cost2_max": -66.18334638262684, "cost2_min": -92.3928304067326, "outflow_rate_max": 1453.9362149988738, "system_level_velocity_min": 10.969932428520139, "system_level_velocity_max": 18.831619796493456, "cost1_min": 131.19218352164876, "cost2_mean": -82.46330776429191, "system_level_velocity_mean": 15.149327039562493, "cost1_mean": 181.83647979106365}, "timesteps_since_restore": 1395434, "episodes_this_iter": 42, "training_iteration": 32, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44895, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ae48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a6a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ac50>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1476, "info": {"load_time_ms": 6.43, "default": {"vf_explained_var": 0.854713499546051, "total_loss": 28.591205596923828, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.2366594076156616, "policy_loss": -0.0070306300185620785, "cur_lr": 0.0005000000237487257, "kl": 0.011391065083444118, "vf_loss": 28.59596061706543}, "num_steps_trained": 1395434, "update_time_ms": 8.385, "num_steps_sampled": 1395434, "grad_time_ms": 11937.078, "sample_time_ms": 20219.693}}
{"time_this_iter_s": 31.681039810180664, "timesteps_total": 1440071, "num_metric_batches_dropped": 0, "timestamp": 1558574974, "time_since_restore": 1030.897165298462, "episode_reward_max": -90.40270446887442, "hostname": "flow-main", "episode_len_mean": 320.94, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-29-34", "episode_reward_mean": -545.9446294782381, "episode_reward_min": -963.6667821197409, "time_total_s": 1030.897165298462, "iterations_since_restore": 33, "custom_metrics": {"cost1_max": 224.59113012225885, "outflow_rate_mean": 1210.3374842351398, "outflow_rate_min": 711.4312678804507, "cost2_max": -43.233766295469906, "cost2_min": -94.74583797739518, "outflow_rate_max": 1451.1619179176287, "system_level_velocity_min": 11.703675658127803, "system_level_velocity_max": 19.017531061872422, "cost1_min": 80.17148031230629, "cost2_mean": -81.12270513430977, "system_level_velocity_mean": 15.183415564491714, "cost1_mean": 179.21832396035413}, "timesteps_since_restore": 1440071, "episodes_this_iter": 53, "training_iteration": 33, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44637, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133320>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1529, "info": {"load_time_ms": 6.432, "default": {"vf_explained_var": 0.8506348729133606, "total_loss": 29.053834915161133, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.233867883682251, "policy_loss": -0.009289497509598732, "cur_lr": 0.0005000000237487257, "kl": 0.012797955423593521, "vf_loss": 29.060564041137695}, "num_steps_trained": 1440071, "update_time_ms": 8.368, "num_steps_sampled": 1440071, "grad_time_ms": 11679.874, "sample_time_ms": 20288.05}}
{"time_this_iter_s": 30.69981598854065, "timesteps_total": 1483729, "num_metric_batches_dropped": 0, "timestamp": 1558575005, "time_since_restore": 1061.5969812870026, "episode_reward_max": -90.40270446887442, "hostname": "flow-main", "episode_len_mean": 320.94, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-30-05", "episode_reward_mean": -528.205566021796, "episode_reward_min": -810.6074675240133, "time_total_s": 1061.5969812870026, "iterations_since_restore": 34, "custom_metrics": {"cost1_max": 224.59113012225885, "outflow_rate_mean": 1225.242947038155, "outflow_rate_min": 777.0164766072302, "cost2_max": -43.233766295469906, "cost2_min": -96.59341565878346, "outflow_rate_max": 1451.1619179176287, "system_level_velocity_min": 11.703675658127803, "system_level_velocity_max": 19.017531061872422, "cost1_min": 80.17148031230629, "cost2_mean": -82.33064931366458, "system_level_velocity_mean": 15.335477542069425, "cost1_mean": 181.1665969246303}, "timesteps_since_restore": 1483729, "episodes_this_iter": 45, "training_iteration": 34, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43658, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133518>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1574, "info": {"load_time_ms": 6.368, "default": {"vf_explained_var": 0.8489891886711121, "total_loss": 26.862565994262695, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.2219444513320923, "policy_loss": -0.008641369640827179, "cur_lr": 0.0005000000237487257, "kl": 0.012535875663161278, "vf_loss": 26.86870002746582}, "num_steps_trained": 1483729, "update_time_ms": 8.401, "num_steps_sampled": 1483729, "grad_time_ms": 11535.056, "sample_time_ms": 20314.044}}
{"time_this_iter_s": 30.904871702194214, "timesteps_total": 1528323, "num_metric_batches_dropped": 0, "timestamp": 1558575036, "time_since_restore": 1092.5018529891968, "episode_reward_max": -266.3117832138757, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-30-36", "episode_reward_mean": -529.1237928310861, "episode_reward_min": -814.2180645835426, "time_total_s": 1092.5018529891968, "iterations_since_restore": 35, "custom_metrics": {"cost1_max": 224.5710619359529, "outflow_rate_mean": 1246.1358724871359, "outflow_rate_min": 1054.395925945772, "cost2_max": -71.6251088737774, "cost2_min": -96.59341565878346, "outflow_rate_max": 1454.5777385785498, "system_level_velocity_min": 11.492454382391648, "system_level_velocity_max": 18.828860718906412, "cost1_min": 137.02978225020453, "cost2_mean": -82.63868241645828, "system_level_velocity_mean": 15.327343387797093, "cost1_mean": 184.09314239438498}, "timesteps_since_restore": 1528323, "episodes_this_iter": 44, "training_iteration": 35, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44594, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91335f8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1618, "info": {"load_time_ms": 6.276, "default": {"vf_explained_var": 0.8749372363090515, "total_loss": 22.310678482055664, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.219820261001587, "policy_loss": -0.007990989834070206, "cur_lr": 0.0005000000237487257, "kl": 0.01162964478135109, "vf_loss": 22.316343307495117}, "num_steps_trained": 1528323, "update_time_ms": 8.482, "num_steps_sampled": 1528323, "grad_time_ms": 11391.497, "sample_time_ms": 20172.26}}
{"time_this_iter_s": 29.655618906021118, "timesteps_total": 1573175, "num_metric_batches_dropped": 0, "timestamp": 1558575065, "time_since_restore": 1122.157471895218, "episode_reward_max": -266.3117832138757, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-31-05", "episode_reward_mean": -529.557323220472, "episode_reward_min": -814.2180645835426, "time_total_s": 1122.157471895218, "iterations_since_restore": 36, "custom_metrics": {"cost1_max": 224.5710619359529, "outflow_rate_mean": 1247.8709137050369, "outflow_rate_min": 1049.4926173557571, "cost2_max": -66.08440940104985, "cost2_min": -93.8996899090307, "outflow_rate_max": 1454.5777385785498, "system_level_velocity_min": 11.465560457976025, "system_level_velocity_max": 18.828860718906412, "cost1_min": 136.7303197980068, "cost2_mean": -81.75666443439479, "system_level_velocity_mean": 15.289038474197023, "cost1_mean": 183.88674623518614}, "timesteps_since_restore": 1573175, "episodes_this_iter": 47, "training_iteration": 36, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44852, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133198>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1665, "info": {"load_time_ms": 6.181, "default": {"vf_explained_var": 0.8444597721099854, "total_loss": 27.494539260864258, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.2397582530975342, "policy_loss": -0.008614392951130867, "cur_lr": 0.0005000000237487257, "kl": 0.013998563401401043, "vf_loss": 27.500354766845703}, "num_steps_trained": 1573175, "update_time_ms": 8.512, "num_steps_sampled": 1573175, "grad_time_ms": 11128.208, "sample_time_ms": 20108.068}}
{"time_this_iter_s": 30.853323221206665, "timesteps_total": 1618269, "num_metric_batches_dropped": 0, "timestamp": 1558575096, "time_since_restore": 1153.0107951164246, "episode_reward_max": -21.715195943172514, "hostname": "flow-main", "episode_len_mean": 319.76, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-31-36", "episode_reward_mean": -545.4017433742644, "episode_reward_min": -904.2550730916746, "time_total_s": 1153.0107951164246, "iterations_since_restore": 37, "custom_metrics": {"cost1_max": 223.52360269696067, "outflow_rate_mean": 1217.2250247278184, "outflow_rate_min": 440.0050268646629, "cost2_max": -16.95747634098609, "cost2_min": -91.58982904144052, "outflow_rate_max": 1451.8538760548215, "system_level_velocity_min": 11.013524726020178, "system_level_velocity_max": 18.65078164365442, "cost1_min": 17.945595177440673, "cost2_mean": -80.02359201115215, "system_level_velocity_mean": 15.015152411070392, "cost1_mean": 177.16261602975996}, "timesteps_since_restore": 1618269, "episodes_this_iter": 49, "training_iteration": 37, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45094, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91215c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121b70>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1714, "info": {"load_time_ms": 6.214, "default": {"vf_explained_var": 0.8873348236083984, "total_loss": 21.454160690307617, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.2205073833465576, "policy_loss": -0.007869749329984188, "cur_lr": 0.0005000000237487257, "kl": 0.013075700961053371, "vf_loss": 21.45941734313965}, "num_steps_trained": 1618269, "update_time_ms": 8.564, "num_steps_sampled": 1618269, "grad_time_ms": 10929.556, "sample_time_ms": 20053.656}}
{"time_this_iter_s": 31.460808277130127, "timesteps_total": 1662804, "num_metric_batches_dropped": 0, "timestamp": 1558575128, "time_since_restore": 1184.4716033935547, "episode_reward_max": -21.715195943172514, "hostname": "flow-main", "episode_len_mean": 319.76, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-32-08", "episode_reward_mean": -553.433052330535, "episode_reward_min": -904.2550730916746, "time_total_s": 1184.4716033935547, "iterations_since_restore": 38, "custom_metrics": {"cost1_max": 223.52360269696067, "outflow_rate_mean": 1208.7495223392327, "outflow_rate_min": 440.0050268646629, "cost2_max": -16.95747634098609, "cost2_min": -91.58982904144052, "outflow_rate_max": 1452.3250498188092, "system_level_velocity_min": 11.013524726020178, "system_level_velocity_max": 18.727698389670948, "cost1_min": 17.945595177440673, "cost2_mean": -80.81909202258704, "system_level_velocity_mean": 14.976879458713809, "cost1_mean": 176.57673142050862}, "timesteps_since_restore": 1662804, "episodes_this_iter": 45, "training_iteration": 38, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44535, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91339e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133fd0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1759, "info": {"load_time_ms": 6.201, "default": {"vf_explained_var": 0.8856686353683472, "total_loss": 22.239288330078125, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.2140840291976929, "policy_loss": -0.00818556360900402, "cur_lr": 0.0005000000237487257, "kl": 0.013228668831288815, "vf_loss": 22.244827270507812}, "num_steps_trained": 1662804, "update_time_ms": 8.532, "num_steps_sampled": 1662804, "grad_time_ms": 10962.422, "sample_time_ms": 20042.123}}
{"time_this_iter_s": 34.8468964099884, "timesteps_total": 1708709, "num_metric_batches_dropped": 0, "timestamp": 1558575163, "time_since_restore": 1219.318499803543, "episode_reward_max": -263.55397297367193, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-32-43", "episode_reward_mean": -568.575069028098, "episode_reward_min": -904.2550730916746, "time_total_s": 1219.318499803543, "iterations_since_restore": 39, "custom_metrics": {"cost1_max": 223.96009612366998, "outflow_rate_mean": 1221.66512702626, "outflow_rate_min": 981.6656755285815, "cost2_max": -65.79671088079554, "cost2_min": -90.92699714758383, "outflow_rate_max": 1452.3250498188092, "system_level_velocity_min": 11.013524726020178, "system_level_velocity_max": 18.727698389670948, "cost1_min": 131.13874823045052, "cost2_mean": -81.26619739522282, "system_level_velocity_mean": 14.841447566115356, "cost1_mean": 178.4187064274405}, "timesteps_since_restore": 1708709, "episodes_this_iter": 48, "training_iteration": 39, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45905, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133eb8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1807, "info": {"load_time_ms": 6.334, "default": {"vf_explained_var": 0.8781216740608215, "total_loss": 22.577978134155273, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.2215560674667358, "policy_loss": -0.007898318581283092, "cur_lr": 0.0005000000237487257, "kl": 0.014661340974271297, "vf_loss": 22.582942962646484}, "num_steps_trained": 1708709, "update_time_ms": 8.41, "num_steps_sampled": 1708709, "grad_time_ms": 11047.592, "sample_time_ms": 20148.003}}
{"time_this_iter_s": 30.898438930511475, "timesteps_total": 1753890, "num_metric_batches_dropped": 0, "timestamp": 1558575194, "time_since_restore": 1250.2169387340546, "episode_reward_max": -263.55397297367193, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-33-14", "episode_reward_mean": -569.3317969128159, "episode_reward_min": -882.995805333545, "time_total_s": 1250.2169387340546, "iterations_since_restore": 40, "custom_metrics": {"cost1_max": 223.96009612366998, "outflow_rate_mean": 1222.0355677267526, "outflow_rate_min": 983.7181891394387, "cost2_max": -60.80864426448133, "cost2_min": -90.92699714758383, "outflow_rate_max": 1452.3250498188092, "system_level_velocity_min": 11.14982089017641, "system_level_velocity_max": 18.727698389670948, "cost1_min": 135.640209043006, "cost2_mean": -79.66724341794753, "system_level_velocity_mean": 14.712435412315317, "cost1_mean": 176.9477134196222}, "timesteps_since_restore": 1753890, "episodes_this_iter": 45, "training_iteration": 40, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45181, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ac50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ac88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114780>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1852, "info": {"load_time_ms": 6.507, "default": {"vf_explained_var": 0.8966957330703735, "total_loss": 20.249958038330078, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.2119866609573364, "policy_loss": -0.007583997678011656, "cur_lr": 0.0005000000237487257, "kl": 0.012189063243567944, "vf_loss": 20.255104064941406}, "num_steps_trained": 1753890, "update_time_ms": 8.432, "num_steps_sampled": 1753890, "grad_time_ms": 11078.384, "sample_time_ms": 20098.552}}
{"time_this_iter_s": 30.288720846176147, "timesteps_total": 1797683, "num_metric_batches_dropped": 0, "timestamp": 1558575224, "time_since_restore": 1280.5056595802307, "episode_reward_max": -92.83697335127678, "hostname": "flow-main", "episode_len_mean": 322.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-33-44", "episode_reward_mean": -557.0651925643042, "episode_reward_min": -841.9566299800864, "time_total_s": 1280.5056595802307, "iterations_since_restore": 41, "custom_metrics": {"cost1_max": 223.96009612366998, "outflow_rate_mean": 1219.6022660936003, "outflow_rate_min": 778.0188275601051, "cost2_max": -46.76271488301526, "cost2_min": -91.34566004795334, "outflow_rate_max": 1451.5676606147865, "system_level_velocity_min": 10.84546049799645, "system_level_velocity_max": 18.705557710221083, "cost1_min": 79.73090748496587, "cost2_mean": -79.51184118639416, "system_level_velocity_mean": 14.841508236000946, "cost1_mean": 176.92787301614715}, "timesteps_since_restore": 1797683, "episodes_this_iter": 46, "training_iteration": 41, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43793, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133f98>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1898, "info": {"load_time_ms": 6.463, "default": {"vf_explained_var": 0.8743736147880554, "total_loss": 25.046873092651367, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.201630711555481, "policy_loss": -0.007761483080685139, "cur_lr": 0.0005000000237487257, "kl": 0.013432717882096767, "vf_loss": 25.05194664001465}, "num_steps_trained": 1797683, "update_time_ms": 8.386, "num_steps_sampled": 1797683, "grad_time_ms": 11056.676, "sample_time_ms": 19953.66}}
{"time_this_iter_s": 30.80751609802246, "timesteps_total": 1842735, "num_metric_batches_dropped": 0, "timestamp": 1558575255, "time_since_restore": 1311.3131756782532, "episode_reward_max": -92.83697335127678, "hostname": "flow-main", "episode_len_mean": 322.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-34-15", "episode_reward_mean": -544.3419292396411, "episode_reward_min": -1182.451626659295, "time_total_s": 1311.3131756782532, "iterations_since_restore": 42, "custom_metrics": {"cost1_max": 224.43253466470253, "outflow_rate_mean": 1226.7582883500047, "outflow_rate_min": 722.4206896551726, "cost2_max": -46.76271488301526, "cost2_min": -91.71192618184506, "outflow_rate_max": 1451.9008285881264, "system_level_velocity_min": 6.484704372335543, "system_level_velocity_max": 18.783507319114683, "cost1_min": 74.92991295130925, "cost2_mean": -80.71319603694734, "system_level_velocity_mean": 15.0671703150709, "cost1_mean": 179.41921641471038}, "timesteps_since_restore": 1842735, "episodes_this_iter": 43, "training_iteration": 42, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45052, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ab70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ae80>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1941, "info": {"load_time_ms": 6.479, "default": {"vf_explained_var": 0.8783586621284485, "total_loss": 24.896860122680664, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.199546217918396, "policy_loss": -0.007438655477017164, "cur_lr": 0.0005000000237487257, "kl": 0.013185741379857063, "vf_loss": 24.90166473388672}, "num_steps_trained": 1842735, "update_time_ms": 8.348, "num_steps_sampled": 1842735, "grad_time_ms": 11094.395, "sample_time_ms": 20013.909}}
{"time_this_iter_s": 31.2498300075531, "timesteps_total": 1887147, "num_metric_batches_dropped": 0, "timestamp": 1558575286, "time_since_restore": 1342.5630056858063, "episode_reward_max": -269.3887881097308, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-34-46", "episode_reward_mean": -554.4364687336821, "episode_reward_min": -1182.451626659295, "time_total_s": 1342.5630056858063, "iterations_since_restore": 43, "custom_metrics": {"cost1_max": 224.43253466470253, "outflow_rate_mean": 1229.246523448468, "outflow_rate_min": 722.4206896551726, "cost2_max": -52.43579678292901, "cost2_min": -91.71192618184506, "outflow_rate_max": 1451.9008285881264, "system_level_velocity_min": 6.484704372335543, "system_level_velocity_max": 18.783507319114683, "cost1_min": 74.92991295130925, "cost2_mean": -81.69150150046704, "system_level_velocity_mean": 15.013605177285394, "cost1_mean": 179.9611185537116}, "timesteps_since_restore": 1887147, "episodes_this_iter": 51, "training_iteration": 43, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44412, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a6d8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 1992, "info": {"load_time_ms": 6.438, "default": {"vf_explained_var": 0.8573341965675354, "total_loss": 29.65399742126465, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.2182872295379639, "policy_loss": -0.00820638332515955, "cur_lr": 0.0005000000237487257, "kl": 0.01326677855104208, "vf_loss": 29.6595458984375}, "num_steps_trained": 1887147, "update_time_ms": 8.344, "num_steps_sampled": 1887147, "grad_time_ms": 11095.35, "sample_time_ms": 19971.644}}
{"time_this_iter_s": 31.607215881347656, "timesteps_total": 1931485, "num_metric_batches_dropped": 0, "timestamp": 1558575318, "time_since_restore": 1374.170221567154, "episode_reward_max": -103.62045459150686, "hostname": "flow-main", "episode_len_mean": 323.05, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-35-18", "episode_reward_mean": -549.2667458713371, "episode_reward_min": -890.9514892970891, "time_total_s": 1374.170221567154, "iterations_since_restore": 44, "custom_metrics": {"cost1_max": 223.38025110057447, "outflow_rate_mean": 1226.8920536561193, "outflow_rate_min": 844.6543926920909, "cost2_max": -45.55490371503779, "cost2_min": -95.56665042590296, "outflow_rate_max": 1454.4102268168906, "system_level_velocity_min": 10.514362039792456, "system_level_velocity_max": 19.0026520142127, "cost1_min": 89.02290836293892, "cost2_mean": -82.91454573430846, "system_level_velocity_mean": 15.095803952561253, "cost1_mean": 179.6052770378202}, "timesteps_since_restore": 1931485, "episodes_this_iter": 47, "training_iteration": 44, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44338, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a048>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2039, "info": {"load_time_ms": 6.394, "default": {"vf_explained_var": 0.8638894557952881, "total_loss": 28.3336124420166, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1886097192764282, "policy_loss": -0.008910463191568851, "cur_lr": 0.0005000000237487257, "kl": 0.013599217869341373, "vf_loss": 28.339797973632812}, "num_steps_trained": 1931485, "update_time_ms": 8.204, "num_steps_sampled": 1931485, "grad_time_ms": 11163.476, "sample_time_ms": 19993.696}}
{"time_this_iter_s": 32.75378203392029, "timesteps_total": 1976243, "num_metric_batches_dropped": 0, "timestamp": 1558575350, "time_since_restore": 1406.9240036010742, "episode_reward_max": -28.380821071944347, "hostname": "flow-main", "episode_len_mean": 320.15, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-35-50", "episode_reward_mean": -546.9650544009719, "episode_reward_min": -890.9514892970891, "time_total_s": 1406.9240036010742, "iterations_since_restore": 45, "custom_metrics": {"cost1_max": 223.38025110057447, "outflow_rate_mean": 1220.3131027489599, "outflow_rate_min": 498.38897513043713, "cost2_max": -17.32287879182168, "cost2_min": -95.56665042590296, "outflow_rate_max": 1454.4102268168906, "system_level_velocity_min": 11.026332847942927, "system_level_velocity_max": 19.0026520142127, "cost1_min": 23.19717220980517, "cost2_mean": -82.76976038965284, "system_level_velocity_mean": 15.095524459144293, "cost1_mean": 177.7389447822661}, "timesteps_since_restore": 1976243, "episodes_this_iter": 44, "training_iteration": 45, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44758, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ada0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913af28>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2083, "info": {"load_time_ms": 6.628, "default": {"vf_explained_var": 0.8794858455657959, "total_loss": 24.611417770385742, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.190354824066162, "policy_loss": -0.007437828462570906, "cur_lr": 0.0005000000237487257, "kl": 0.013023772276937962, "vf_loss": 24.616252899169922}, "num_steps_trained": 1976243, "update_time_ms": 8.047, "num_steps_sampled": 1976243, "grad_time_ms": 11277.603, "sample_time_ms": 20063.23}}
{"time_this_iter_s": 32.58172035217285, "timesteps_total": 2022512, "num_metric_batches_dropped": 0, "timestamp": 1558575383, "time_since_restore": 1439.505723953247, "episode_reward_max": -28.380821071944347, "hostname": "flow-main", "episode_len_mean": 322.1, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-36-23", "episode_reward_mean": -556.4994643730366, "episode_reward_min": -871.2244147887176, "time_total_s": 1439.505723953247, "iterations_since_restore": 46, "custom_metrics": {"cost1_max": 223.30863019920722, "outflow_rate_mean": 1219.9003625705564, "outflow_rate_min": 498.38897513043713, "cost2_max": -17.32287879182168, "cost2_min": -95.3559045191019, "outflow_rate_max": 1449.9427113820557, "system_level_velocity_min": 11.38899397564725, "system_level_velocity_max": 18.76820637707787, "cost1_min": 23.19717220980517, "cost2_mean": -82.28654033119106, "system_level_velocity_mean": 15.003061240322163, "cost1_mean": 178.1245248641713}, "timesteps_since_restore": 2022512, "episodes_this_iter": 49, "training_iteration": 46, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 46269, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ab70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913afd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a9b0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2132, "info": {"load_time_ms": 6.752, "default": {"vf_explained_var": 0.8561344742774963, "total_loss": 29.32520866394043, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1913131475448608, "policy_loss": -0.008073433302342892, "cur_lr": 0.0005000000237487257, "kl": 0.014153811149299145, "vf_loss": 29.33045196533203}, "num_steps_trained": 2022512, "update_time_ms": 8.08, "num_steps_sampled": 2022512, "grad_time_ms": 11530.095, "sample_time_ms": 20102.765}}
{"time_this_iter_s": 32.02019453048706, "timesteps_total": 2066910, "num_metric_batches_dropped": 0, "timestamp": 1558575415, "time_since_restore": 1471.5259184837341, "episode_reward_max": -28.380821071944347, "hostname": "flow-main", "episode_len_mean": 322.1, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-36-55", "episode_reward_mean": -559.9764282985269, "episode_reward_min": -871.2244147887176, "time_total_s": 1471.5259184837341, "iterations_since_restore": 47, "custom_metrics": {"cost1_max": 222.75589257210885, "outflow_rate_mean": 1214.8348369006874, "outflow_rate_min": 498.38897513043713, "cost2_max": -17.32287879182168, "cost2_min": -95.3559045191019, "outflow_rate_max": 1449.9427113820557, "system_level_velocity_min": 11.38899397564725, "system_level_velocity_max": 18.75762735261365, "cost1_min": 23.19717220980517, "cost2_mean": -81.67856260246677, "system_level_velocity_mean": 14.955993657237082, "cost1_mean": 177.5055545594783}, "timesteps_since_restore": 2066910, "episodes_this_iter": 46, "training_iteration": 47, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44398, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133d30>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2178, "info": {"load_time_ms": 6.682, "default": {"vf_explained_var": 0.8686398267745972, "total_loss": 25.629840850830078, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1852024793624878, "policy_loss": -0.008860769681632519, "cur_lr": 0.0005000000237487257, "kl": 0.015536341816186905, "vf_loss": 25.635595321655273}, "num_steps_trained": 2066910, "update_time_ms": 8.26, "num_steps_sampled": 2066910, "grad_time_ms": 11692.618, "sample_time_ms": 20057.066}}
{"time_this_iter_s": 33.19030952453613, "timesteps_total": 2111521, "num_metric_batches_dropped": 0, "timestamp": 1558575448, "time_since_restore": 1504.7162280082703, "episode_reward_max": -267.78931145110346, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-37-28", "episode_reward_mean": -556.0818296274308, "episode_reward_min": -824.063777036775, "time_total_s": 1504.7162280082703, "iterations_since_restore": 48, "custom_metrics": {"cost1_max": 223.43172283526798, "outflow_rate_mean": 1225.6278444267584, "outflow_rate_min": 1013.7691315476678, "cost2_max": -65.37267800945136, "cost2_min": -93.47117363342934, "outflow_rate_max": 1454.8487692540016, "system_level_velocity_min": 11.512732730965888, "system_level_velocity_max": 18.741536275127526, "cost1_min": 136.34881840799423, "cost2_mean": -82.87663350561903, "system_level_velocity_mean": 15.04637363319358, "cost1_mean": 180.4939115811121}, "timesteps_since_restore": 2111521, "episodes_this_iter": 44, "training_iteration": 48, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44611, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ad30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913abe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a470>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2222, "info": {"load_time_ms": 6.736, "default": {"vf_explained_var": 0.8832629919052124, "total_loss": 22.905250549316406, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1874809265136719, "policy_loss": -0.008013000711798668, "cur_lr": 0.0005000000237487257, "kl": 0.013216542080044746, "vf_loss": 22.910621643066406}, "num_steps_trained": 2111521, "update_time_ms": 8.311, "num_steps_sampled": 2111521, "grad_time_ms": 11800.343, "sample_time_ms": 20122.507}}
{"time_this_iter_s": 31.86984944343567, "timesteps_total": 2154694, "num_metric_batches_dropped": 0, "timestamp": 1558575480, "time_since_restore": 1536.586077451706, "episode_reward_max": -21.574376047493672, "hostname": "flow-main", "episode_len_mean": 322.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-38-00", "episode_reward_mean": -532.1817445529335, "episode_reward_min": -815.3169496684004, "time_total_s": 1536.586077451706, "iterations_since_restore": 49, "custom_metrics": {"cost1_max": 224.70899121784998, "outflow_rate_mean": 1231.5503625907074, "outflow_rate_min": 431.75782487237836, "cost2_max": -17.564463768916525, "cost2_min": -95.86710386857605, "outflow_rate_max": 1454.8487692540016, "system_level_velocity_min": 11.512732730965888, "system_level_velocity_max": 18.82328182521097, "cost1_min": 18.028738660134444, "cost2_mean": -82.72032248834115, "system_level_velocity_mean": 15.278873022912732, "cost1_mean": 181.33706712143822}, "timesteps_since_restore": 2154694, "episodes_this_iter": 47, "training_iteration": 49, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43173, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133fd0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2269, "info": {"load_time_ms": 6.732, "default": {"vf_explained_var": 0.8553559184074402, "total_loss": 28.113983154296875, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1758912801742554, "policy_loss": -0.009077144786715508, "cur_lr": 0.0005000000237487257, "kl": 0.014607504941523075, "vf_loss": 28.12013816833496}, "num_steps_trained": 2154694, "update_time_ms": 8.51, "num_steps_sampled": 2154694, "grad_time_ms": 11722.136, "sample_time_ms": 19902.142}}
{"time_this_iter_s": 31.444047451019287, "timesteps_total": 2200513, "num_metric_batches_dropped": 0, "timestamp": 1558575512, "time_since_restore": 1568.0301249027252, "episode_reward_max": -21.574376047493672, "hostname": "flow-main", "episode_len_mean": 322.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-38-32", "episode_reward_mean": -529.5672726418217, "episode_reward_min": -825.0004887618668, "time_total_s": 1568.0301249027252, "iterations_since_restore": 50, "custom_metrics": {"cost1_max": 225.25984261836788, "outflow_rate_mean": 1234.2399974168354, "outflow_rate_min": 431.75782487237836, "cost2_max": -17.564463768916525, "cost2_min": -95.86710386857605, "outflow_rate_max": 1460.2162235091976, "system_level_velocity_min": 11.719492748282471, "system_level_velocity_max": 18.92078663382128, "cost1_min": 18.028738660134444, "cost2_mean": -84.48269116446706, "system_level_velocity_mean": 15.374645863950095, "cost1_mean": 182.27608190745573}, "timesteps_since_restore": 2200513, "episodes_this_iter": 48, "training_iteration": 50, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45819, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91214e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121be0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2317, "info": {"load_time_ms": 6.555, "default": {"vf_explained_var": 0.8787462115287781, "total_loss": 24.264404296875, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1821976900100708, "policy_loss": -0.007690851576626301, "cur_lr": 0.0005000000237487257, "kl": 0.01514771394431591, "vf_loss": 24.26906967163086}, "num_steps_trained": 2200513, "update_time_ms": 8.488, "num_steps_sampled": 2200513, "grad_time_ms": 11732.627, "sample_time_ms": 19946.45}}
{"time_this_iter_s": 31.22249722480774, "timesteps_total": 2245143, "num_metric_batches_dropped": 0, "timestamp": 1558575543, "time_since_restore": 1599.252622127533, "episode_reward_max": -29.30359452102691, "hostname": "flow-main", "episode_len_mean": 322.1, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-39-03", "episode_reward_mean": -557.1434181430902, "episode_reward_min": -825.0004887618668, "time_total_s": 1599.252622127533, "iterations_since_restore": 51, "custom_metrics": {"cost1_max": 225.25984261836788, "outflow_rate_mean": 1216.4177952091018, "outflow_rate_min": 463.7321904813336, "cost2_max": -20.5985778351178, "cost2_min": -97.7454013464359, "outflow_rate_max": 1460.2162235091976, "system_level_velocity_min": 11.679596119119958, "system_level_velocity_max": 18.92078663382128, "cost1_min": 23.10813972667824, "cost2_mean": -85.19998278400104, "system_level_velocity_mean": 15.089732686178547, "cost1_mean": 178.59082512118087}, "timesteps_since_restore": 2245143, "episodes_this_iter": 46, "training_iteration": 51, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44630, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133470>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2363, "info": {"load_time_ms": 6.542, "default": {"vf_explained_var": 0.8888388276100159, "total_loss": 22.209537506103516, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.183758020401001, "policy_loss": -0.007350032217800617, "cur_lr": 0.0005000000237487257, "kl": 0.014375361613929272, "vf_loss": 22.21401023864746}, "num_steps_trained": 2245143, "update_time_ms": 8.409, "num_steps_sampled": 2245143, "grad_time_ms": 11766.522, "sample_time_ms": 20006.422}}
{"time_this_iter_s": 31.81251358985901, "timesteps_total": 2290426, "num_metric_batches_dropped": 0, "timestamp": 1558575575, "time_since_restore": 1631.065135717392, "episode_reward_max": -29.30359452102691, "hostname": "flow-main", "episode_len_mean": 322.1, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-39-35", "episode_reward_mean": -552.6107213929147, "episode_reward_min": -826.7720810077143, "time_total_s": 1631.065135717392, "iterations_since_restore": 52, "custom_metrics": {"cost1_max": 225.25984261836788, "outflow_rate_mean": 1220.527777008975, "outflow_rate_min": 463.7321904813336, "cost2_max": -20.5985778351178, "cost2_min": -97.7454013464359, "outflow_rate_max": 1460.2162235091976, "system_level_velocity_min": 11.679596119119958, "system_level_velocity_max": 18.92078663382128, "cost1_min": 23.10813972667824, "cost2_mean": -83.98975170907886, "system_level_velocity_mean": 15.155504123588017, "cost1_mean": 179.24126171685697}, "timesteps_since_restore": 2290426, "episodes_this_iter": 47, "training_iteration": 52, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45283, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912ba58>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2410, "info": {"load_time_ms": 6.492, "default": {"vf_explained_var": 0.870597243309021, "total_loss": 25.22221565246582, "cur_kl_coeff": 0.20000001788139343, "entropy": 1.1648712158203125, "policy_loss": -0.009443474002182484, "cur_lr": 0.0005000000237487257, "kl": 0.01601325534284115, "vf_loss": 25.228458404541016}, "num_steps_trained": 2290426, "update_time_ms": 8.35, "num_steps_sampled": 2290426, "grad_time_ms": 11804.604, "sample_time_ms": 20069.558}}
{"time_this_iter_s": 30.794657707214355, "timesteps_total": 2335420, "num_metric_batches_dropped": 0, "timestamp": 1558575606, "time_since_restore": 1661.8597934246063, "episode_reward_max": -263.8589584496277, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-40-06", "episode_reward_mean": -573.6351879890108, "episode_reward_min": -826.7720810077143, "time_total_s": 1661.8597934246063, "iterations_since_restore": 53, "custom_metrics": {"cost1_max": 224.1874160798725, "outflow_rate_mean": 1217.2799783605524, "outflow_rate_min": 1011.4511367771274, "cost2_max": -69.21570199732076, "cost2_min": -94.60623975639368, "outflow_rate_max": 1453.1153510835013, "system_level_velocity_min": 11.773709033608482, "system_level_velocity_max": 18.775254545214835, "cost1_min": 139.88407400146582, "cost2_mean": -83.86966006946288, "system_level_velocity_mean": 14.888927703921617, "cost1_mean": 178.22781680101846}, "timesteps_since_restore": 2335420, "episodes_this_iter": 45, "training_iteration": 53, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44994, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a9e8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2455, "info": {"load_time_ms": 6.479, "default": {"vf_explained_var": 0.8737603425979614, "total_loss": 23.405746459960938, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.18476402759552, "policy_loss": -0.009669965133070946, "cur_lr": 0.0005000000237487257, "kl": 0.016894884407520294, "vf_loss": 23.412036895751953}, "num_steps_trained": 2335420, "update_time_ms": 8.362, "num_steps_sampled": 2335420, "grad_time_ms": 11720.71, "sample_time_ms": 20107.224}}
{"time_this_iter_s": 30.562577962875366, "timesteps_total": 2378943, "num_metric_batches_dropped": 0, "timestamp": 1558575636, "time_since_restore": 1692.4223713874817, "episode_reward_max": -102.7651566566583, "hostname": "flow-main", "episode_len_mean": 323.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-40-36", "episode_reward_mean": -537.381440165682, "episode_reward_min": -808.9457539773, "time_total_s": 1692.4223713874817, "iterations_since_restore": 54, "custom_metrics": {"cost1_max": 224.02749569694055, "outflow_rate_mean": 1240.1489267954184, "outflow_rate_min": 812.8683863677427, "cost2_max": -47.65103896005, "cost2_min": -94.60623975639368, "outflow_rate_max": 1457.2496826338631, "system_level_velocity_min": 11.752472243148825, "system_level_velocity_max": 18.82282543638948, "cost1_min": 86.96708978893862, "cost2_mean": -83.07045074986878, "system_level_velocity_mean": 15.321449526765857, "cost1_mean": 182.17905712146435}, "timesteps_since_restore": 2378943, "episodes_this_iter": 48, "training_iteration": 54, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43523, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91219e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91212e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121dd8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2503, "info": {"load_time_ms": 6.605, "default": {"vf_explained_var": 0.8349472284317017, "total_loss": 30.33454704284668, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.1608349084854126, "policy_loss": -0.009710976853966713, "cur_lr": 0.0005000000237487257, "kl": 0.016981912776827812, "vf_loss": 30.34086036682129}, "num_steps_trained": 2378943, "update_time_ms": 8.436, "num_steps_sampled": 2378943, "grad_time_ms": 11660.002, "sample_time_ms": 20063.589}}
{"time_this_iter_s": 32.04302978515625, "timesteps_total": 2424498, "num_metric_batches_dropped": 0, "timestamp": 1558575668, "time_since_restore": 1724.465401172638, "episode_reward_max": -102.7651566566583, "hostname": "flow-main", "episode_len_mean": 323.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-41-08", "episode_reward_mean": -538.7664173464759, "episode_reward_min": -922.4923198131262, "time_total_s": 1724.465401172638, "iterations_since_restore": 55, "custom_metrics": {"cost1_max": 224.43252914717047, "outflow_rate_mean": 1236.811953810798, "outflow_rate_min": 812.8683863677427, "cost2_max": -47.65103896005, "cost2_min": -94.60623975639368, "outflow_rate_max": 1457.2496826338631, "system_level_velocity_min": 10.713084015550537, "system_level_velocity_max": 18.82282543638948, "cost1_min": 86.96708978893862, "cost2_mean": -83.6354411209094, "system_level_velocity_mean": 15.363234986322873, "cost1_mean": 182.61490103846322}, "timesteps_since_restore": 2424498, "episodes_this_iter": 43, "training_iteration": 55, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45555, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ac88>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2546, "info": {"load_time_ms": 6.452, "default": {"vf_explained_var": 0.8719980120658875, "total_loss": 24.5628662109375, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.1724982261657715, "policy_loss": -0.008852708153426647, "cur_lr": 0.0005000000237487257, "kl": 0.016781052574515343, "vf_loss": 24.5683650970459}, "num_steps_trained": 2424498, "update_time_ms": 8.509, "num_steps_sampled": 2424498, "grad_time_ms": 11599.092, "sample_time_ms": 20054.526}}
{"time_this_iter_s": 31.97889757156372, "timesteps_total": 2469082, "num_metric_batches_dropped": 0, "timestamp": 1558575700, "time_since_restore": 1756.4442987442017, "episode_reward_max": -102.7651566566583, "hostname": "flow-main", "episode_len_mean": 323.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-41-40", "episode_reward_mean": -554.6115873981618, "episode_reward_min": -922.4923198131262, "time_total_s": 1756.4442987442017, "iterations_since_restore": 56, "custom_metrics": {"cost1_max": 224.43252914717047, "outflow_rate_mean": 1224.3808526147284, "outflow_rate_min": 812.8683863677427, "cost2_max": -47.65103896005, "cost2_min": -95.86850025650197, "outflow_rate_max": 1453.6310047088527, "system_level_velocity_min": 10.313450121751178, "system_level_velocity_max": 18.770144630004225, "cost1_min": 86.96708978893862, "cost2_mean": -84.62895003853289, "system_level_velocity_mean": 15.107930356371972, "cost1_mean": 179.6332368781194}, "timesteps_since_restore": 2469082, "episodes_this_iter": 49, "training_iteration": 56, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44584, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912beb8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2595, "info": {"load_time_ms": 6.446, "default": {"vf_explained_var": 0.8762652277946472, "total_loss": 24.54863739013672, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1577425003051758, "policy_loss": -0.008354525081813335, "cur_lr": 0.0005000000237487257, "kl": 0.016393572092056274, "vf_loss": 24.5537109375}, "num_steps_trained": 2469082, "update_time_ms": 8.429, "num_steps_sampled": 2469082, "grad_time_ms": 11622.395, "sample_time_ms": 19971.631}}
{"time_this_iter_s": 32.42042946815491, "timesteps_total": 2514342, "num_metric_batches_dropped": 0, "timestamp": 1558575733, "time_since_restore": 1788.8647282123566, "episode_reward_max": -175.48862727903565, "hostname": "flow-main", "episode_len_mean": 323.93, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-42-13", "episode_reward_mean": -557.7787022497309, "episode_reward_min": -895.4928111733581, "time_total_s": 1788.8647282123566, "iterations_since_restore": 57, "custom_metrics": {"cost1_max": 224.67881054810903, "outflow_rate_mean": 1228.4584704242998, "outflow_rate_min": 1018.436851981454, "cost2_max": -70.85127008273354, "cost2_min": -95.86850025650197, "outflow_rate_max": 1463.103485358571, "system_level_velocity_min": 10.313450121751178, "system_level_velocity_max": 18.957454137107707, "cost1_min": 125.69704995911566, "cost2_mean": -85.77966760349287, "system_level_velocity_mean": 15.032587041305392, "cost1_mean": 179.54986172540077}, "timesteps_since_restore": 2514342, "episodes_this_iter": 47, "training_iteration": 57, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45260, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143b00>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2642, "info": {"load_time_ms": 6.743, "default": {"vf_explained_var": 0.8794583082199097, "total_loss": 24.251522064208984, "cur_kl_coeff": 0.20000001788139343, "entropy": 1.1671130657196045, "policy_loss": -0.008373510092496872, "cur_lr": 0.0005000000237487257, "kl": 0.015166870318353176, "vf_loss": 24.256860733032227}, "num_steps_trained": 2514342, "update_time_ms": 8.489, "num_steps_sampled": 2514342, "grad_time_ms": 11634.951, "sample_time_ms": 19998.217}}
{"time_this_iter_s": 31.94857907295227, "timesteps_total": 2559488, "num_metric_batches_dropped": 0, "timestamp": 1558575765, "time_since_restore": 1820.8133072853088, "episode_reward_max": -103.91832749446897, "hostname": "flow-main", "episode_len_mean": 321.96, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-42-45", "episode_reward_mean": -555.818717820033, "episode_reward_min": -895.4928111733581, "time_total_s": 1820.8133072853088, "iterations_since_restore": 58, "custom_metrics": {"cost1_max": 224.67881054810903, "outflow_rate_mean": 1219.86114207801, "outflow_rate_min": 822.9660955960613, "cost2_max": -49.57007728478402, "cost2_min": -95.97296355106121, "outflow_rate_max": 1463.103485358571, "system_level_velocity_min": 10.313450121751178, "system_level_velocity_max": 18.957454137107707, "cost1_min": 87.53721109163075, "cost2_mean": -85.52887838367371, "system_level_velocity_mean": 15.04632912249292, "cost1_mean": 178.45546826501223}, "timesteps_since_restore": 2559488, "episodes_this_iter": 44, "training_iteration": 58, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45146, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91437b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143a58>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2686, "info": {"load_time_ms": 6.697, "default": {"vf_explained_var": 0.8953761458396912, "total_loss": 21.261741638183594, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.14997398853302, "policy_loss": -0.00889682862907648, "cur_lr": 0.0005000000237487257, "kl": 0.01532173715531826, "vf_loss": 21.2675724029541}, "num_steps_trained": 2559488, "update_time_ms": 8.458, "num_steps_sampled": 2559488, "grad_time_ms": 11546.85, "sample_time_ms": 19961.775}}
{"time_this_iter_s": 32.8467800617218, "timesteps_total": 2603544, "num_metric_batches_dropped": 0, "timestamp": 1558575798, "time_since_restore": 1853.6600873470306, "episode_reward_max": -103.91832749446897, "hostname": "flow-main", "episode_len_mean": 323.03, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-43-18", "episode_reward_mean": -543.3517222003729, "episode_reward_min": -852.4332477451946, "time_total_s": 1853.6600873470306, "iterations_since_restore": 59, "custom_metrics": {"cost1_max": 224.95834907575488, "outflow_rate_mean": 1230.5424133385675, "outflow_rate_min": 822.9660955960613, "cost2_max": -49.57007728478402, "cost2_min": -97.9047421447815, "outflow_rate_max": 1461.9023778152, "system_level_velocity_min": 9.968563674008054, "system_level_velocity_max": 18.926644780739803, "cost1_min": 87.53721109163075, "cost2_mean": -85.49583664403883, "system_level_velocity_mean": 15.210940733022898, "cost1_mean": 181.0880329175874}, "timesteps_since_restore": 2603544, "episodes_this_iter": 50, "training_iteration": 59, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44056, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91431d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143e80>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2736, "info": {"load_time_ms": 6.644, "default": {"vf_explained_var": 0.8840740323066711, "total_loss": 23.347148895263672, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1752792596817017, "policy_loss": -0.00996879767626524, "cur_lr": 0.0005000000237487257, "kl": 0.01517295278608799, "vf_loss": 23.354084014892578}, "num_steps_trained": 2603544, "update_time_ms": 8.269, "num_steps_sampled": 2603544, "grad_time_ms": 11554.838, "sample_time_ms": 20051.204}}
{"time_this_iter_s": 30.026609659194946, "timesteps_total": 2647489, "num_metric_batches_dropped": 0, "timestamp": 1558575828, "time_since_restore": 1883.6866970062256, "episode_reward_max": -29.78055969163878, "hostname": "flow-main", "episode_len_mean": 319.05, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-43-48", "episode_reward_mean": -525.499929198593, "episode_reward_min": -852.4332477451946, "time_total_s": 1883.6866970062256, "iterations_since_restore": 60, "custom_metrics": {"cost1_max": 225.1458396201615, "outflow_rate_mean": 1231.7961183904563, "outflow_rate_min": 460.7989278777953, "cost2_max": -19.788678341893448, "cost2_min": -97.9047421447815, "outflow_rate_max": 1461.9023778152, "system_level_velocity_min": 9.968563674008054, "system_level_velocity_max": 18.926644780739803, "cost1_min": 23.019488476350627, "cost2_mean": -84.67293040823688, "system_level_velocity_mean": 15.387625045267693, "cost1_mean": 180.1676631563609}, "timesteps_since_restore": 2647489, "episodes_this_iter": 44, "training_iteration": 60, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43945, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133780>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2780, "info": {"load_time_ms": 6.659, "default": {"vf_explained_var": 0.897396981716156, "total_loss": 20.805326461791992, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.160696268081665, "policy_loss": -0.010312111116945744, "cur_lr": 0.0005000000237487257, "kl": 0.01694958657026291, "vf_loss": 20.8122501373291}, "num_steps_trained": 2647489, "update_time_ms": 8.374, "num_steps_sampled": 2647489, "grad_time_ms": 11480.139, "sample_time_ms": 19983.86}}
{"time_this_iter_s": 31.06460189819336, "timesteps_total": 2692442, "num_metric_batches_dropped": 0, "timestamp": 1558575859, "time_since_restore": 1914.751298904419, "episode_reward_max": -29.78055969163878, "hostname": "flow-main", "episode_len_mean": 319.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-44-19", "episode_reward_mean": -532.1458529237437, "episode_reward_min": -814.8144809252689, "time_total_s": 1914.751298904419, "iterations_since_restore": 61, "custom_metrics": {"cost1_max": 225.1458396201615, "outflow_rate_mean": 1227.97801147509, "outflow_rate_min": 460.7989278777953, "cost2_max": -19.788678341893448, "cost2_min": -98.88758187846186, "outflow_rate_max": 1461.2788592347663, "system_level_velocity_min": 11.939065936779912, "system_level_velocity_max": 18.921222678095276, "cost1_min": 23.019488476350627, "cost2_mean": -85.0886169722757, "system_level_velocity_mean": 15.30154573732068, "cost1_mean": 179.16282795920586}, "timesteps_since_restore": 2692442, "episodes_this_iter": 47, "training_iteration": 61, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44953, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91437b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91430f0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2827, "info": {"load_time_ms": 6.679, "default": {"vf_explained_var": 0.8918955326080322, "total_loss": 22.13118553161621, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1665005683898926, "policy_loss": -0.008273917250335217, "cur_lr": 0.0005000000237487257, "kl": 0.01577216200530529, "vf_loss": 22.13630485534668}, "num_steps_trained": 2692442, "update_time_ms": 8.499, "num_steps_sampled": 2692442, "grad_time_ms": 11462.162, "sample_time_ms": 19985.597}}
{"time_this_iter_s": 31.660271406173706, "timesteps_total": 2736730, "num_metric_batches_dropped": 0, "timestamp": 1558575891, "time_since_restore": 1946.4115703105927, "episode_reward_max": -28.675810514408134, "hostname": "flow-main", "episode_len_mean": 316.1, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-44-51", "episode_reward_mean": -530.6944929241437, "episode_reward_min": -963.6823812303357, "time_total_s": 1946.4115703105927, "iterations_since_restore": 62, "custom_metrics": {"cost1_max": 224.66736498749322, "outflow_rate_mean": 1213.3890138869097, "outflow_rate_min": 502.9433862365724, "cost2_max": -17.12983282542536, "cost2_min": -98.88758187846186, "outflow_rate_max": 1455.9380412350379, "system_level_velocity_min": 11.917101009994663, "system_level_velocity_max": 18.921222678095276, "cost1_min": 23.054052274237772, "cost2_mean": -83.47433165170668, "system_level_velocity_mean": 15.318038561830683, "cost1_mean": 177.48210914253536}, "timesteps_since_restore": 2736730, "episodes_this_iter": 50, "training_iteration": 62, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44288, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ae48>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2877, "info": {"load_time_ms": 6.71, "default": {"vf_explained_var": 0.8723847270011902, "total_loss": 25.7779483795166, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1678690910339355, "policy_loss": -0.007832254283130169, "cur_lr": 0.0005000000237487257, "kl": 0.014758042059838772, "vf_loss": 25.782825469970703}, "num_steps_trained": 2736730, "update_time_ms": 8.49, "num_steps_sampled": 2736730, "grad_time_ms": 11411.0, "sample_time_ms": 20021.65}}
{"time_this_iter_s": 31.27186131477356, "timesteps_total": 2779237, "num_metric_batches_dropped": 0, "timestamp": 1558575922, "time_since_restore": 1977.6834316253662, "episode_reward_max": -28.675810514408134, "hostname": "flow-main", "episode_len_mean": 318.1, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-45-22", "episode_reward_mean": -514.8397305204157, "episode_reward_min": -963.6823812303357, "time_total_s": 1977.6834316253662, "iterations_since_restore": 63, "custom_metrics": {"cost1_max": 224.9873442659626, "outflow_rate_mean": 1228.422339542675, "outflow_rate_min": 502.9433862365724, "cost2_max": -17.12983282542536, "cost2_min": -100.09783207336707, "outflow_rate_max": 1467.6789587808553, "system_level_velocity_min": 11.345281216613762, "system_level_velocity_max": 18.862594422283852, "cost1_min": 23.054052274237772, "cost2_mean": -84.31793120443594, "system_level_velocity_mean": 15.550217127895419, "cost1_mean": 181.50823943980606}, "timesteps_since_restore": 2779237, "episodes_this_iter": 46, "training_iteration": 63, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 42507, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121710>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2923, "info": {"load_time_ms": 6.704, "default": {"vf_explained_var": 0.8595048189163208, "total_loss": 26.604904174804688, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1383893489837646, "policy_loss": -0.010595690459012985, "cur_lr": 0.0005000000237487257, "kl": 0.015872042626142502, "vf_loss": 26.612327575683594}, "num_steps_trained": 2779237, "update_time_ms": 8.348, "num_steps_sampled": 2779237, "grad_time_ms": 11477.215, "sample_time_ms": 20003.278}}
{"time_this_iter_s": 32.534658908843994, "timesteps_total": 2823962, "num_metric_batches_dropped": 0, "timestamp": 1558575955, "time_since_restore": 2010.2180905342102, "episode_reward_max": -107.28481785893294, "hostname": "flow-main", "episode_len_mean": 323.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-45-55", "episode_reward_mean": -522.5408625389592, "episode_reward_min": -838.4623912059773, "time_total_s": 2010.2180905342102, "iterations_since_restore": 64, "custom_metrics": {"cost1_max": 224.9873442659626, "outflow_rate_mean": 1240.1658275050352, "outflow_rate_min": 764.4894814153413, "cost2_max": -50.22100306454331, "cost2_min": -100.09783207336707, "outflow_rate_max": 1467.6789587808553, "system_level_velocity_min": 11.324740373435102, "system_level_velocity_max": 18.862594422283852, "cost1_min": 84.35495267823386, "cost2_mean": -85.97842705030574, "system_level_velocity_mean": 15.48823128606125, "cost1_mean": 184.03839569098753}, "timesteps_since_restore": 2823962, "episodes_this_iter": 45, "training_iteration": 64, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44725, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91432e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143518>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 2968, "info": {"load_time_ms": 6.608, "default": {"vf_explained_var": 0.8685781955718994, "total_loss": 25.80895233154297, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.1476688385009766, "policy_loss": -0.008760426193475723, "cur_lr": 0.0005000000237487257, "kl": 0.01675889641046524, "vf_loss": 25.814363479614258}, "num_steps_trained": 2823962, "update_time_ms": 8.309, "num_steps_sampled": 2823962, "grad_time_ms": 11700.015, "sample_time_ms": 19977.638}}
{"time_this_iter_s": 31.182503700256348, "timesteps_total": 2867235, "num_metric_batches_dropped": 0, "timestamp": 1558575986, "time_since_restore": 2041.4005942344666, "episode_reward_max": -103.50643578487025, "hostname": "flow-main", "episode_len_mean": 319.82, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-46-26", "episode_reward_mean": -518.5455887843224, "episode_reward_min": -805.3498596150963, "time_total_s": 2041.4005942344666, "iterations_since_restore": 65, "custom_metrics": {"cost1_max": 225.92384496922406, "outflow_rate_mean": 1232.157428775342, "outflow_rate_min": 764.4894814153413, "cost2_max": -50.22100306454331, "cost2_min": -98.49545761908031, "outflow_rate_max": 1461.0581632231865, "system_level_velocity_min": 11.324740373435102, "system_level_velocity_max": 18.94221266479672, "cost1_min": 84.35495267823386, "cost2_mean": -85.43601053566243, "system_level_velocity_mean": 15.484345006004043, "cost1_mean": 181.8478289639145}, "timesteps_since_restore": 2867235, "episodes_this_iter": 48, "training_iteration": 65, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43273, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91435f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91431d0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3016, "info": {"load_time_ms": 6.526, "default": {"vf_explained_var": 0.8749891519546509, "total_loss": 23.998577117919922, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.153921127319336, "policy_loss": -0.010786881670355797, "cur_lr": 0.0005000000237487257, "kl": 0.017878791317343712, "vf_loss": 24.00579071044922}, "num_steps_trained": 2867235, "update_time_ms": 8.384, "num_steps_sampled": 2867235, "grad_time_ms": 11652.033, "sample_time_ms": 19939.536}}
{"time_this_iter_s": 32.75312566757202, "timesteps_total": 2910707, "num_metric_batches_dropped": 0, "timestamp": 1558576019, "time_since_restore": 2074.1537199020386, "episode_reward_max": -103.50643578487025, "hostname": "flow-main", "episode_len_mean": 319.82, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-46-59", "episode_reward_mean": -506.41324002452376, "episode_reward_min": -854.4736175897494, "time_total_s": 2074.1537199020386, "iterations_since_restore": 66, "custom_metrics": {"cost1_max": 225.92384496922406, "outflow_rate_mean": 1245.4238524624627, "outflow_rate_min": 764.4894814153413, "cost2_max": -50.22100306454331, "cost2_min": -98.49545761908031, "outflow_rate_max": 1463.698887852645, "system_level_velocity_min": 10.628404894382687, "system_level_velocity_max": 18.94531283109932, "cost1_min": 84.35495267823386, "cost2_mean": -85.16540890897866, "system_level_velocity_mean": 15.594261620910498, "cost1_mean": 183.24509496680037}, "timesteps_since_restore": 2910707, "episodes_this_iter": 47, "training_iteration": 66, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43472, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143d68>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3063, "info": {"load_time_ms": 6.542, "default": {"vf_explained_var": 0.8842701315879822, "total_loss": 21.6441593170166, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1689635515213013, "policy_loss": -0.009990816935896873, "cur_lr": 0.0005000000237487257, "kl": 0.015799997374415398, "vf_loss": 21.650989532470703}, "num_steps_trained": 2910707, "update_time_ms": 8.591, "num_steps_sampled": 2910707, "grad_time_ms": 11735.867, "sample_time_ms": 19932.01}}
{"time_this_iter_s": 30.892524003982544, "timesteps_total": 2954428, "num_metric_batches_dropped": 0, "timestamp": 1558576050, "time_since_restore": 2105.046243906021, "episode_reward_max": -258.2575646839975, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-47-30", "episode_reward_mean": -528.6641579213397, "episode_reward_min": -854.4736175897494, "time_total_s": 2105.046243906021, "iterations_since_restore": 67, "custom_metrics": {"cost1_max": 225.6015651613534, "outflow_rate_mean": 1253.5286636037997, "outflow_rate_min": 971.5542857142855, "cost2_max": -61.097506480942705, "cost2_min": -95.67179929214142, "outflow_rate_max": 1463.698887852645, "system_level_velocity_min": 10.628404894382687, "system_level_velocity_max": 18.94531283109932, "cost1_min": 126.78467913377385, "cost2_mean": -84.78102075797402, "system_level_velocity_mean": 15.312389935478256, "cost1_mean": 183.5262319581066}, "timesteps_since_restore": 2954428, "episodes_this_iter": 46, "training_iteration": 67, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43721, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143588>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3109, "info": {"load_time_ms": 6.391, "default": {"vf_explained_var": 0.8872140049934387, "total_loss": 22.291494369506836, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1624150276184082, "policy_loss": -0.01101596001535654, "cur_lr": 0.0005000000237487257, "kl": 0.01751607656478882, "vf_loss": 22.299007415771484}, "num_steps_trained": 2954428, "update_time_ms": 8.42, "num_steps_sampled": 2954428, "grad_time_ms": 11621.447, "sample_time_ms": 19894.513}}
{"time_this_iter_s": 29.472883939743042, "timesteps_total": 2998733, "num_metric_batches_dropped": 0, "timestamp": 1558576079, "time_since_restore": 2134.519127845764, "episode_reward_max": -258.65687277521903, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-47-59", "episode_reward_mean": -545.2770666995531, "episode_reward_min": -809.540332089123, "time_total_s": 2134.519127845764, "iterations_since_restore": 68, "custom_metrics": {"cost1_max": 225.30901586610344, "outflow_rate_mean": 1238.2768330124613, "outflow_rate_min": 1068.651664239072, "cost2_max": -61.097506480942705, "cost2_min": -95.67179929214142, "outflow_rate_max": 1461.8408336519933, "system_level_velocity_min": 11.655019689105266, "system_level_velocity_max": 18.86626269663478, "cost1_min": 140.7725668072336, "cost2_mean": -83.36469258183304, "system_level_velocity_mean": 15.052308628738688, "cost1_mean": 180.56384794075188}, "timesteps_since_restore": 2998733, "episodes_this_iter": 43, "training_iteration": 68, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44305, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143eb8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3152, "info": {"load_time_ms": 6.44, "default": {"vf_explained_var": 0.8784553408622742, "total_loss": 24.955095291137695, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1701254844665527, "policy_loss": -0.010005898773670197, "cur_lr": 0.0005000000237487257, "kl": 0.016846513375639915, "vf_loss": 24.961732864379883}, "num_steps_trained": 2998733, "update_time_ms": 8.333, "num_steps_sampled": 2998733, "grad_time_ms": 11406.175, "sample_time_ms": 19863.653}}
{"time_this_iter_s": 30.623717546463013, "timesteps_total": 3041474, "num_metric_batches_dropped": 0, "timestamp": 1558576110, "time_since_restore": 2165.142845392227, "episode_reward_max": -258.65687277521903, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-48-30", "episode_reward_mean": -534.1536013631369, "episode_reward_min": -809.540332089123, "time_total_s": 2165.142845392227, "iterations_since_restore": 69, "custom_metrics": {"cost1_max": 225.7305883466571, "outflow_rate_mean": 1240.6266440555498, "outflow_rate_min": 1058.6978742017322, "cost2_max": -63.61182234379326, "cost2_min": -93.89611629029406, "outflow_rate_max": 1462.881881269401, "system_level_velocity_min": 10.977616497721547, "system_level_velocity_max": 18.932890873107358, "cost1_min": 133.00871468651695, "cost2_mean": -82.26873615583614, "system_level_velocity_mean": 15.171881520895006, "cost1_mean": 182.07855016464327}, "timesteps_since_restore": 3041474, "episodes_this_iter": 51, "training_iteration": 69, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 42741, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ac88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a9e8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3203, "info": {"load_time_ms": 6.511, "default": {"vf_explained_var": 0.8662324547767639, "total_loss": 26.73291778564453, "cur_kl_coeff": 0.20000001788139343, "entropy": 1.170735478401184, "policy_loss": -0.009490779601037502, "cur_lr": 0.0005000000237487257, "kl": 0.016333019360899925, "vf_loss": 26.73914337158203}, "num_steps_trained": 3041474, "update_time_ms": 8.172, "num_steps_sampled": 3041474, "grad_time_ms": 11150.993, "sample_time_ms": 19898.465}}
{"time_this_iter_s": 29.56563091278076, "timesteps_total": 3085037, "num_metric_batches_dropped": 0, "timestamp": 1558576139, "time_since_restore": 2194.708476305008, "episode_reward_max": -102.03173577872158, "hostname": "flow-main", "episode_len_mean": 323.03, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-48-59", "episode_reward_mean": -524.0540104401174, "episode_reward_min": -757.1843692945686, "time_total_s": 2194.708476305008, "iterations_since_restore": 70, "custom_metrics": {"cost1_max": 225.7305883466571, "outflow_rate_mean": 1235.0183988106064, "outflow_rate_min": 826.7777284718816, "cost2_max": -47.82629804151826, "cost2_min": -93.89611629029406, "outflow_rate_max": 1462.881881269401, "system_level_velocity_min": 10.977616497721547, "system_level_velocity_max": 18.932890873107358, "cost1_min": 87.60486361014846, "cost2_mean": -80.92243029774043, "system_level_velocity_mean": 15.244796853765399, "cost1_mean": 181.64703211473284}, "timesteps_since_restore": 3085037, "episodes_this_iter": 47, "training_iteration": 70, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43563, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143f98>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3250, "info": {"load_time_ms": 6.476, "default": {"vf_explained_var": 0.8667082190513611, "total_loss": 26.463815689086914, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.1776200532913208, "policy_loss": -0.00981228705495596, "cur_lr": 0.0005000000237487257, "kl": 0.016526231542229652, "vf_loss": 26.470317840576172}, "num_steps_trained": 3085037, "update_time_ms": 8.033, "num_steps_sampled": 3085037, "grad_time_ms": 10953.351, "sample_time_ms": 20050.055}}
{"time_this_iter_s": 28.9084632396698, "timesteps_total": 3128231, "num_metric_batches_dropped": 0, "timestamp": 1558576168, "time_since_restore": 2223.6169395446777, "episode_reward_max": -102.03173577872158, "hostname": "flow-main", "episode_len_mean": 323.03, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-49-28", "episode_reward_mean": -538.9509674210877, "episode_reward_min": -810.9658821861497, "time_total_s": 2223.6169395446777, "iterations_since_restore": 71, "custom_metrics": {"cost1_max": 224.4738321571707, "outflow_rate_mean": 1219.7160997644112, "outflow_rate_min": 826.7777284718816, "cost2_max": -47.82629804151826, "cost2_min": -93.89611629029406, "outflow_rate_max": 1461.6247891303024, "system_level_velocity_min": 11.27087342664937, "system_level_velocity_max": 18.89979484991364, "cost1_min": 87.60486361014846, "cost2_mean": -79.75057455893574, "system_level_velocity_mean": 15.00527788818356, "cost1_mean": 178.68664040429644}, "timesteps_since_restore": 3128231, "episodes_this_iter": 42, "training_iteration": 71, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43194, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bf28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bf60>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3292, "info": {"load_time_ms": 6.547, "default": {"vf_explained_var": 0.8795881271362305, "total_loss": 24.29836654663086, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.175451397895813, "policy_loss": -0.00884705688804388, "cur_lr": 0.0005000000237487257, "kl": 0.016173584386706352, "vf_loss": 24.303979873657227}, "num_steps_trained": 3128231, "update_time_ms": 7.977, "num_steps_sampled": 3128231, "grad_time_ms": 10813.369, "sample_time_ms": 19974.423}}
{"time_this_iter_s": 29.82688021659851, "timesteps_total": 3172159, "num_metric_batches_dropped": 0, "timestamp": 1558576198, "time_since_restore": 2253.4438197612762, "episode_reward_max": -28.486268096457586, "hostname": "flow-main", "episode_len_mean": 317.07, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-49-58", "episode_reward_mean": -521.3313003719518, "episode_reward_min": -843.2361756976843, "time_total_s": 2253.4438197612762, "iterations_since_restore": 72, "custom_metrics": {"cost1_max": 224.4738321571707, "outflow_rate_mean": 1212.4198511716859, "outflow_rate_min": 494.02018216404343, "cost2_max": -16.4931994201321, "cost2_min": -91.9075771777915, "outflow_rate_max": 1462.11393876285, "system_level_velocity_min": 10.334961644296113, "system_level_velocity_max": 19.031060334197477, "cost1_min": 23.25174695082227, "cost2_mean": -78.31923869888186, "system_level_velocity_mean": 15.213035942516738, "cost1_mean": 176.86424537742158}, "timesteps_since_restore": 3172159, "episodes_this_iter": 53, "training_iteration": 72, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43928, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143ac8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3345, "info": {"load_time_ms": 6.614, "default": {"vf_explained_var": 0.8568508625030518, "total_loss": 28.958250045776367, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1870743036270142, "policy_loss": -0.010598111897706985, "cur_lr": 0.0005000000237487257, "kl": 0.01681760512292385, "vf_loss": 28.96548080444336}, "num_steps_trained": 3172159, "update_time_ms": 7.991, "num_steps_sampled": 3172159, "grad_time_ms": 10612.818, "sample_time_ms": 19991.998}}
{"time_this_iter_s": 28.06128716468811, "timesteps_total": 3215423, "num_metric_batches_dropped": 0, "timestamp": 1558576226, "time_since_restore": 2281.5051069259644, "episode_reward_max": -28.486268096457586, "hostname": "flow-main", "episode_len_mean": 319.04, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-50-26", "episode_reward_mean": -526.3996555683241, "episode_reward_min": -851.6971943149384, "time_total_s": 2281.5051069259644, "iterations_since_restore": 73, "custom_metrics": {"cost1_max": 225.1519772222317, "outflow_rate_mean": 1223.1757750780762, "outflow_rate_min": 494.02018216404343, "cost2_max": -16.4931994201321, "cost2_min": -91.9075771777915, "outflow_rate_max": 1462.11393876285, "system_level_velocity_min": 10.272789703367087, "system_level_velocity_max": 19.031060334197477, "cost1_min": 23.25174695082227, "cost2_mean": -79.13447025142345, "system_level_velocity_mean": 15.219874159216909, "cost1_mean": 178.3750865171286}, "timesteps_since_restore": 3215423, "episodes_this_iter": 42, "training_iteration": 73, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43264, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91436d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143e10>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3387, "info": {"load_time_ms": 6.615, "default": {"vf_explained_var": 0.860103189945221, "total_loss": 27.658702850341797, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.1652841567993164, "policy_loss": -0.009863140992820263, "cur_lr": 0.0005000000237487257, "kl": 0.016902217641472816, "vf_loss": 27.665185928344727}, "num_steps_trained": 3215423, "update_time_ms": 7.94, "num_steps_sampled": 3215423, "grad_time_ms": 10444.13, "sample_time_ms": 19840.479}}
{"time_this_iter_s": 30.554134130477905, "timesteps_total": 3259800, "num_metric_batches_dropped": 0, "timestamp": 1558576257, "time_since_restore": 2312.0592410564423, "episode_reward_max": -102.11296162988722, "hostname": "flow-main", "episode_len_mean": 323.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-50-57", "episode_reward_mean": -553.502395408413, "episode_reward_min": -851.6971943149384, "time_total_s": 2312.0592410564423, "iterations_since_restore": 74, "custom_metrics": {"cost1_max": 225.1519772222317, "outflow_rate_mean": 1220.3160119904446, "outflow_rate_min": 818.9341842854653, "cost2_max": -47.99375217414359, "cost2_min": -90.45883907228506, "outflow_rate_max": 1459.4148795055714, "system_level_velocity_min": 10.272789703367087, "system_level_velocity_max": 18.87401453888857, "cost1_min": 86.96148919634484, "cost2_mean": -79.41418227029943, "system_level_velocity_mean": 14.899888665110534, "cost1_mean": 177.41049206728817}, "timesteps_since_restore": 3259800, "episodes_this_iter": 45, "training_iteration": 74, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44377, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143fd0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3432, "info": {"load_time_ms": 6.598, "default": {"vf_explained_var": 0.8737612962722778, "total_loss": 26.299327850341797, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.2004979848861694, "policy_loss": -0.009395640343427658, "cur_lr": 0.0005000000237487257, "kl": 0.017227517440915108, "vf_loss": 26.30527687072754}, "num_steps_trained": 3259800, "update_time_ms": 7.904, "num_steps_sampled": 3259800, "grad_time_ms": 10281.902, "sample_time_ms": 19804.752}}
{"time_this_iter_s": 29.923513174057007, "timesteps_total": 3303281, "num_metric_batches_dropped": 0, "timestamp": 1558576287, "time_since_restore": 2341.9827542304993, "episode_reward_max": -95.05014707326733, "hostname": "flow-main", "episode_len_mean": 321.57, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-51-27", "episode_reward_mean": -531.2114429431534, "episode_reward_min": -838.4641722702944, "time_total_s": 2341.9827542304993, "iterations_since_restore": 75, "custom_metrics": {"cost1_max": 224.80076015741423, "outflow_rate_mean": 1230.3926236442803, "outflow_rate_min": 750.4299963893278, "cost2_max": -48.79168514033958, "cost2_min": -90.40455171163063, "outflow_rate_max": 1456.0000813728318, "system_level_velocity_min": 10.87277919546116, "system_level_velocity_max": 18.95292220860366, "cost1_min": 79.80285638522287, "cost2_mean": -79.35499436473037, "system_level_velocity_mean": 15.146104323600346, "cost1_mean": 179.43101237668398}, "timesteps_since_restore": 3303281, "episodes_this_iter": 49, "training_iteration": 75, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43481, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91435f8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3481, "info": {"load_time_ms": 6.628, "default": {"vf_explained_var": 0.8542863726615906, "total_loss": 29.892024993896484, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1745657920837402, "policy_loss": -0.008978856727480888, "cur_lr": 0.0005000000237487257, "kl": 0.01607632450759411, "vf_loss": 29.89778709411621}, "num_steps_trained": 3303281, "update_time_ms": 7.931, "num_steps_sampled": 3303281, "grad_time_ms": 10143.088, "sample_time_ms": 19818.435}}
{"time_this_iter_s": 30.01740789413452, "timesteps_total": 3345246, "num_metric_batches_dropped": 0, "timestamp": 1558576317, "time_since_restore": 2372.000162124634, "episode_reward_max": -95.05014707326733, "hostname": "flow-main", "episode_len_mean": 320.47, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-51-57", "episode_reward_mean": -520.1518961575744, "episode_reward_min": -806.4767691362576, "time_total_s": 2372.000162124634, "iterations_since_restore": 76, "custom_metrics": {"cost1_max": 224.56563699162538, "outflow_rate_mean": 1228.4508497341867, "outflow_rate_min": 750.4299963893278, "cost2_max": -48.79168514033958, "cost2_min": -90.63982917841699, "outflow_rate_max": 1456.0000813728318, "system_level_velocity_min": 10.61221631076783, "system_level_velocity_max": 18.95292220860366, "cost1_min": 79.80285638522287, "cost2_mean": -77.75211655611332, "system_level_velocity_mean": 15.173731180964216, "cost1_mean": 178.97743695312573}, "timesteps_since_restore": 3345246, "episodes_this_iter": 48, "training_iteration": 76, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 41965, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91436a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143a90>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3529, "info": {"load_time_ms": 6.535, "default": {"vf_explained_var": 0.889691948890686, "total_loss": 24.65692710876465, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1843295097351074, "policy_loss": -0.011707836762070656, "cur_lr": 0.0005000000237487257, "kl": 0.017889486625790596, "vf_loss": 24.665056228637695}, "num_steps_trained": 3345246, "update_time_ms": 7.716, "num_steps_sampled": 3345246, "grad_time_ms": 9890.198, "sample_time_ms": 19799.665}}
{"time_this_iter_s": 30.219257831573486, "timesteps_total": 3388275, "num_metric_batches_dropped": 0, "timestamp": 1558576347, "time_since_restore": 2402.2194199562073, "episode_reward_max": -172.92189111734163, "hostname": "flow-main", "episode_len_mean": 323.9, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-52-27", "episode_reward_mean": -524.4101048629373, "episode_reward_min": -742.891132213309, "time_total_s": 2402.2194199562073, "iterations_since_restore": 77, "custom_metrics": {"cost1_max": 224.34170607384397, "outflow_rate_mean": 1231.6952308740338, "outflow_rate_min": 928.0213953488374, "cost2_max": -50.55325465135547, "cost2_min": -92.97266928386617, "outflow_rate_max": 1455.621675035272, "system_level_velocity_min": 10.61221631076783, "system_level_velocity_max": 18.816355846504553, "cost1_min": 126.7474018501049, "cost2_mean": -77.29647727243733, "system_level_velocity_mean": 15.073294259932926, "cost1_mean": 180.1500305853054}, "timesteps_since_restore": 3388275, "episodes_this_iter": 43, "training_iteration": 77, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43029, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bc18>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3572, "info": {"load_time_ms": 6.471, "default": {"vf_explained_var": 0.8802065849304199, "total_loss": 25.98184585571289, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1667639017105103, "policy_loss": -0.01053489837795496, "cur_lr": 0.0005000000237487257, "kl": 0.01776760257780552, "vf_loss": 25.988826751708984}, "num_steps_trained": 3388275, "update_time_ms": 7.686, "num_steps_sampled": 3388275, "grad_time_ms": 9859.715, "sample_time_ms": 19762.203}}
{"time_this_iter_s": 29.822821855545044, "timesteps_total": 3432612, "num_metric_batches_dropped": 0, "timestamp": 1558576377, "time_since_restore": 2432.0422418117523, "episode_reward_max": -260.44974003297045, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-52-57", "episode_reward_mean": -551.3286473604456, "episode_reward_min": -752.7553271883164, "time_total_s": 2432.0422418117523, "iterations_since_restore": 78, "custom_metrics": {"cost1_max": 224.34170607384397, "outflow_rate_mean": 1217.4469491028838, "outflow_rate_min": 968.2725371588623, "cost2_max": -50.14283385261062, "cost2_min": -92.97266928386617, "outflow_rate_max": 1455.621675035272, "system_level_velocity_min": 11.401575334965594, "system_level_velocity_max": 18.77061692537181, "cost1_min": 136.11280322411534, "cost2_mean": -76.89172114216375, "system_level_velocity_mean": 14.81361178786301, "cost1_mean": 177.79812176954832}, "timesteps_since_restore": 3432612, "episodes_this_iter": 48, "training_iteration": 78, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44337, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121be0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3620, "info": {"load_time_ms": 6.465, "default": {"vf_explained_var": 0.8787635564804077, "total_loss": 27.415925979614258, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.229630708694458, "policy_loss": -0.010716834105551243, "cur_lr": 0.0005000000237487257, "kl": 0.017642509192228317, "vf_loss": 27.423114776611328}, "num_steps_trained": 3432612, "update_time_ms": 7.662, "num_steps_sampled": 3432612, "grad_time_ms": 9795.223, "sample_time_ms": 19861.392}}
{"time_this_iter_s": 29.07749915122986, "timesteps_total": 3474873, "num_metric_batches_dropped": 0, "timestamp": 1558576406, "time_since_restore": 2461.119740962982, "episode_reward_max": -27.749935066383106, "hostname": "flow-main", "episode_len_mean": 322.1, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-53-26", "episode_reward_mean": -545.8572649164004, "episode_reward_min": -798.243435433299, "time_total_s": 2461.119740962982, "iterations_since_restore": 79, "custom_metrics": {"cost1_max": 223.75044677530482, "outflow_rate_mean": 1207.5114677530196, "outflow_rate_min": 504.4246753466945, "cost2_max": -18.566864104955307, "cost2_min": -92.97266928386617, "outflow_rate_max": 1453.3113029178612, "system_level_velocity_min": 10.475680896989566, "system_level_velocity_max": 18.814617125275905, "cost1_min": 23.152171440859977, "cost2_mean": -75.81861529430218, "system_level_velocity_mean": 14.830392829408073, "cost1_mean": 175.80750876072517}, "timesteps_since_restore": 3474873, "episodes_this_iter": 50, "training_iteration": 79, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 42261, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143dd8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3670, "info": {"load_time_ms": 6.506, "default": {"vf_explained_var": 0.8780725002288818, "total_loss": 26.854042053222656, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.195183277130127, "policy_loss": -0.012710120528936386, "cur_lr": 0.0005000000237487257, "kl": 0.01961793377995491, "vf_loss": 26.862831115722656}, "num_steps_trained": 3474873, "update_time_ms": 7.744, "num_steps_sampled": 3474873, "grad_time_ms": 9629.704, "sample_time_ms": 19871.933}}
{"time_this_iter_s": 27.690784692764282, "timesteps_total": 3516098, "num_metric_batches_dropped": 0, "timestamp": 1558576434, "time_since_restore": 2488.8105256557465, "episode_reward_max": -27.749935066383106, "hostname": "flow-main", "episode_len_mean": 320.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-53-54", "episode_reward_mean": -498.4297686981681, "episode_reward_min": -798.243435433299, "time_total_s": 2488.8105256557465, "iterations_since_restore": 80, "custom_metrics": {"cost1_max": 224.64621670390733, "outflow_rate_mean": 1240.8207564770164, "outflow_rate_min": 504.4246753466945, "cost2_max": -18.566864104955307, "cost2_min": -89.73873121781529, "outflow_rate_max": 1458.9884984761688, "system_level_velocity_min": 10.475680896989566, "system_level_velocity_max": 18.87644553716087, "cost1_min": 23.152171440859977, "cost2_mean": -77.61883826004781, "system_level_velocity_mean": 15.460682287014047, "cost1_mean": 182.47352381181747}, "timesteps_since_restore": 3516098, "episodes_this_iter": 42, "training_iteration": 80, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 41225, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7ab900fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91434a8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3712, "info": {"load_time_ms": 6.522, "default": {"vf_explained_var": 0.9023312330245972, "total_loss": 21.059982299804688, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1409378051757812, "policy_loss": -0.011622253805398941, "cur_lr": 0.0005000000237487257, "kl": 0.01932189241051674, "vf_loss": 21.06774139404297}, "num_steps_trained": 3516098, "update_time_ms": 7.698, "num_steps_sampled": 3516098, "grad_time_ms": 9606.445, "sample_time_ms": 19708.562}}
{"time_this_iter_s": 30.061516523361206, "timesteps_total": 3559483, "num_metric_batches_dropped": 0, "timestamp": 1558576464, "time_since_restore": 2518.8720421791077, "episode_reward_max": -163.49090791320796, "hostname": "flow-main", "episode_len_mean": 323.82, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-54-24", "episode_reward_mean": -506.68877474003807, "episode_reward_min": -760.025318213704, "time_total_s": 2518.8720421791077, "iterations_since_restore": 81, "custom_metrics": {"cost1_max": 225.3367076318117, "outflow_rate_mean": 1244.5235445434334, "outflow_rate_min": 930.6968595041321, "cost2_max": -54.85722195195365, "cost2_min": -89.73873121781529, "outflow_rate_max": 1458.9884984761688, "system_level_velocity_min": 10.253457361351701, "system_level_velocity_max": 18.96416527972828, "cost1_min": 123.23397257300135, "cost2_mean": -78.08208610831994, "system_level_velocity_mean": 15.379095785740152, "cost1_mean": 183.34001491877032}, "timesteps_since_restore": 3559483, "episodes_this_iter": 45, "training_iteration": 81, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43385, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bcf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b828>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3757, "info": {"load_time_ms": 6.438, "default": {"vf_explained_var": 0.8880710005760193, "total_loss": 24.762666702270508, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.2228823900222778, "policy_loss": -0.010169421322643757, "cur_lr": 0.0005000000237487257, "kl": 0.018341852352023125, "vf_loss": 24.769166946411133}, "num_steps_trained": 3559483, "update_time_ms": 7.646, "num_steps_sampled": 3559483, "grad_time_ms": 9612.76, "sample_time_ms": 19818.142}}
{"time_this_iter_s": 30.792096614837646, "timesteps_total": 3603387, "num_metric_batches_dropped": 0, "timestamp": 1558576495, "time_since_restore": 2549.6641387939453, "episode_reward_max": -261.0944096386726, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-54-55", "episode_reward_mean": -551.6224337039722, "episode_reward_min": -764.6574742319996, "time_total_s": 2549.6641387939453, "iterations_since_restore": 82, "custom_metrics": {"cost1_max": 225.3367076318117, "outflow_rate_mean": 1212.9166177168922, "outflow_rate_min": 930.6968595041321, "cost2_max": -54.85722195195365, "cost2_min": -91.64461381650335, "outflow_rate_max": 1456.4400012121869, "system_level_velocity_min": 10.253457361351701, "system_level_velocity_max": 18.96416527972828, "cost1_min": 123.23397257300135, "cost2_mean": -77.87887969292412, "system_level_velocity_mean": 14.772829370793831, "cost1_mean": 176.88849921785243}, "timesteps_since_restore": 3603387, "episodes_this_iter": 53, "training_iteration": 82, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43904, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91437b8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3810, "info": {"load_time_ms": 6.479, "default": {"vf_explained_var": 0.8719720244407654, "total_loss": 28.96051025390625, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.2072193622589111, "policy_loss": -0.009362621232867241, "cur_lr": 0.0005000000237487257, "kl": 0.017903948202729225, "vf_loss": 28.966293334960938}, "num_steps_trained": 3603387, "update_time_ms": 7.623, "num_steps_sampled": 3603387, "grad_time_ms": 9764.33, "sample_time_ms": 19761.804}}
{"time_this_iter_s": 31.197383403778076, "timesteps_total": 3646898, "num_metric_batches_dropped": 0, "timestamp": 1558576526, "time_since_restore": 2580.8615221977234, "episode_reward_max": -262.00950219851273, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-55-26", "episode_reward_mean": -557.6992333260229, "episode_reward_min": -780.062963532628, "time_total_s": 2580.8615221977234, "iterations_since_restore": 83, "custom_metrics": {"cost1_max": 224.6761188417321, "outflow_rate_mean": 1212.3805314642434, "outflow_rate_min": 1038.9104330963155, "cost2_max": -58.677072838623275, "cost2_min": -91.81052340416096, "outflow_rate_max": 1453.5320686456398, "system_level_velocity_min": 11.293777606672158, "system_level_velocity_max": 18.758171282867362, "cost1_min": 135.55966032763286, "cost2_mean": -79.44858429910506, "system_level_velocity_mean": 14.711151259537669, "cost1_mean": 176.5054118696075}, "timesteps_since_restore": 3646898, "episodes_this_iter": 42, "training_iteration": 83, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43511, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ada0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a470>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3852, "info": {"load_time_ms": 6.454, "default": {"vf_explained_var": 0.8774083852767944, "total_loss": 27.442638397216797, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.160122036933899, "policy_loss": -0.010453159920871258, "cur_lr": 0.0005000000237487257, "kl": 0.017656542360782623, "vf_loss": 27.449562072753906}, "num_steps_trained": 3646898, "update_time_ms": 7.78, "num_steps_sampled": 3646898, "grad_time_ms": 9913.549, "sample_time_ms": 19924.953}}
{"time_this_iter_s": 30.925610065460205, "timesteps_total": 3689998, "num_metric_batches_dropped": 0, "timestamp": 1558576557, "time_since_restore": 2611.7871322631836, "episode_reward_max": -241.1259536460829, "hostname": "flow-main", "episode_len_mean": 324.72, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-55-57", "episode_reward_mean": -529.8203270639059, "episode_reward_min": -840.2077694141059, "time_total_s": 2611.7871322631836, "iterations_since_restore": 84, "custom_metrics": {"cost1_max": 225.48762848059715, "outflow_rate_mean": 1235.9361232255264, "outflow_rate_min": 972.0857142857142, "cost2_max": -58.677072838623275, "cost2_min": -93.35459259724075, "outflow_rate_max": 1462.5143624204604, "system_level_velocity_min": 10.613169548928722, "system_level_velocity_max": 18.989908768034393, "cost1_min": 128.01263904906426, "cost2_mean": -81.38352008932942, "system_level_velocity_mean": 15.198477526051866, "cost1_mean": 182.10924910270222}, "timesteps_since_restore": 3689998, "episodes_this_iter": 44, "training_iteration": 84, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43100, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b9e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bcf8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3896, "info": {"load_time_ms": 6.44, "default": {"vf_explained_var": 0.8663987517356873, "total_loss": 28.44485855102539, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1412304639816284, "policy_loss": -0.010037645697593689, "cur_lr": 0.0005000000237487257, "kl": 0.016451478004455566, "vf_loss": 28.451608657836914}, "num_steps_trained": 3689998, "update_time_ms": 7.844, "num_steps_sampled": 3689998, "grad_time_ms": 9804.821, "sample_time_ms": 20071.625}}
{"time_this_iter_s": 31.552956104278564, "timesteps_total": 3733683, "num_metric_batches_dropped": 0, "timestamp": 1558576589, "time_since_restore": 2643.340088367462, "episode_reward_max": -241.1259536460829, "hostname": "flow-main", "episode_len_mean": 324.72, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-56-29", "episode_reward_mean": -518.0362473224457, "episode_reward_min": -840.2077694141059, "time_total_s": 2643.340088367462, "iterations_since_restore": 85, "custom_metrics": {"cost1_max": 225.48762848059715, "outflow_rate_mean": 1250.8337560696712, "outflow_rate_min": 972.0857142857142, "cost2_max": -65.44210813678275, "cost2_min": -97.66601858872704, "outflow_rate_max": 1462.5143624204604, "system_level_velocity_min": 10.613169548928722, "system_level_velocity_max": 18.989908768034393, "cost1_min": 128.01263904906426, "cost2_mean": -83.36279672350773, "system_level_velocity_mean": 15.466008425527802, "cost1_mean": 185.2456016388018}, "timesteps_since_restore": 3733683, "episodes_this_iter": 52, "training_iteration": 85, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43685, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ad30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a470>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3948, "info": {"load_time_ms": 6.442, "default": {"vf_explained_var": 0.8582719564437866, "total_loss": 28.113664627075195, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1579036712646484, "policy_loss": -0.009656750597059727, "cur_lr": 0.0005000000237487257, "kl": 0.017025373876094818, "vf_loss": 28.119918823242188}, "num_steps_trained": 3733683, "update_time_ms": 7.596, "num_steps_sampled": 3733683, "grad_time_ms": 9913.725, "sample_time_ms": 20125.237}}
{"time_this_iter_s": 30.244500875473022, "timesteps_total": 3777282, "num_metric_batches_dropped": 0, "timestamp": 1558576619, "time_since_restore": 2673.584589242935, "episode_reward_max": -260.86922964903385, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-56-59", "episode_reward_mean": -539.6639074952285, "episode_reward_min": -809.4710758418018, "time_total_s": 2673.584589242935, "iterations_since_restore": 86, "custom_metrics": {"cost1_max": 225.16776094523954, "outflow_rate_mean": 1237.3973974304856, "outflow_rate_min": 1043.2336657681944, "cost2_max": -65.22132134466996, "cost2_min": -97.66601858872704, "outflow_rate_max": 1461.449955161157, "system_level_velocity_min": 11.605801911404036, "system_level_velocity_max": 18.903175004919653, "cost1_min": 139.23568946723378, "cost2_mean": -83.00024144618874, "system_level_velocity_mean": 15.152245642366529, "cost1_mean": 181.7609649161287}, "timesteps_since_restore": 3777282, "episodes_this_iter": 42, "training_iteration": 86, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43599, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bb70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bcf8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 3990, "info": {"load_time_ms": 6.456, "default": {"vf_explained_var": 0.886553943157196, "total_loss": 23.519330978393555, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.1938776969909668, "policy_loss": -0.011564522050321102, "cur_lr": 0.0005000000237487257, "kl": 0.018271494656801224, "vf_loss": 23.52724266052246}, "num_steps_trained": 3777282, "update_time_ms": 7.668, "num_steps_sampled": 3777282, "grad_time_ms": 9908.622, "sample_time_ms": 20152.96}}
{"time_this_iter_s": 32.596051931381226, "timesteps_total": 3820499, "num_metric_batches_dropped": 0, "timestamp": 1558576652, "time_since_restore": 2706.1806411743164, "episode_reward_max": -163.59721913475326, "hostname": "flow-main", "episode_len_mean": 323.82, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-57-32", "episode_reward_mean": -535.9818668360657, "episode_reward_min": -789.527359594849, "time_total_s": 2706.1806411743164, "iterations_since_restore": 87, "custom_metrics": {"cost1_max": 225.16776094523954, "outflow_rate_mean": 1237.874171366986, "outflow_rate_min": 1069.8330128116822, "cost2_max": -58.735164791100345, "cost2_min": -94.06443761320381, "outflow_rate_max": 1459.2006095780275, "system_level_velocity_min": 11.42738183726346, "system_level_velocity_max": 18.83364391399607, "cost1_min": 135.77767418149173, "cost2_mean": -81.28378131261316, "system_level_velocity_mean": 15.162289524497714, "cost1_mean": 180.99460465626413}, "timesteps_since_restore": 3820499, "episodes_this_iter": 46, "training_iteration": 87, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43217, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143668>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4036, "info": {"load_time_ms": 6.546, "default": {"vf_explained_var": 0.875796914100647, "total_loss": 25.70456314086914, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.2027984857559204, "policy_loss": -0.011076999828219414, "cur_lr": 0.0005000000237487257, "kl": 0.018899422138929367, "vf_loss": 25.71185874938965}, "num_steps_trained": 3820499, "update_time_ms": 7.592, "num_steps_sampled": 3820499, "grad_time_ms": 10051.361, "sample_time_ms": 20248.649}}
{"time_this_iter_s": 31.528187036514282, "timesteps_total": 3863673, "num_metric_batches_dropped": 0, "timestamp": 1558576683, "time_since_restore": 2737.7088282108307, "episode_reward_max": -103.12306306472816, "hostname": "flow-main", "episode_len_mean": 321.82, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-58-03", "episode_reward_mean": -528.8562355146554, "episode_reward_min": -789.527359594849, "time_total_s": 2737.7088282108307, "iterations_since_restore": 88, "custom_metrics": {"cost1_max": 225.4284705988283, "outflow_rate_mean": 1235.8349858330673, "outflow_rate_min": 794.8368074155791, "cost2_max": -49.41261987069043, "cost2_min": -94.06443761320381, "outflow_rate_max": 1459.2006095780275, "system_level_velocity_min": 11.42738183726346, "system_level_velocity_max": 18.86931919950528, "cost1_min": 85.33351416051578, "cost2_mean": -80.89450543919966, "system_level_velocity_mean": 15.230989939038501, "cost1_mean": 180.26063958620173}, "timesteps_since_restore": 3863673, "episodes_this_iter": 48, "training_iteration": 88, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43174, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91335f8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4084, "info": {"load_time_ms": 6.37, "default": {"vf_explained_var": 0.8628708720207214, "total_loss": 28.7186222076416, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.203065037727356, "policy_loss": -0.00974118523299694, "cur_lr": 0.0005000000237487257, "kl": 0.018022876232862473, "vf_loss": 28.724760055541992}, "num_steps_trained": 3863673, "update_time_ms": 7.671, "num_steps_sampled": 3863673, "grad_time_ms": 10351.524, "sample_time_ms": 20118.954}}
{"time_this_iter_s": 32.2218120098114, "timesteps_total": 3907627, "num_metric_batches_dropped": 0, "timestamp": 1558576715, "time_since_restore": 2769.930640220642, "episode_reward_max": -103.12306306472816, "hostname": "flow-main", "episode_len_mean": 321.82, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-58-35", "episode_reward_mean": -549.2812552323462, "episode_reward_min": -861.1625519403224, "time_total_s": 2769.930640220642, "iterations_since_restore": 89, "custom_metrics": {"cost1_max": 225.4284705988283, "outflow_rate_mean": 1222.1125750266165, "outflow_rate_min": 794.8368074155791, "cost2_max": -49.41261987069043, "cost2_min": -92.03039370917814, "outflow_rate_max": 1458.524998267917, "system_level_velocity_min": 10.34595156948838, "system_level_velocity_max": 18.86931919950528, "cost1_min": 85.33351416051578, "cost2_mean": -80.24703702612109, "system_level_velocity_mean": 14.959989799926252, "cost1_mean": 177.0949366923373}, "timesteps_since_restore": 3907627, "episodes_this_iter": 47, "training_iteration": 89, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43954, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91408d0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4131, "info": {"load_time_ms": 6.692, "default": {"vf_explained_var": 0.8631505370140076, "total_loss": 29.44176483154297, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.2145270109176636, "policy_loss": -0.009632155299186707, "cur_lr": 0.0005000000237487257, "kl": 0.017989279702305794, "vf_loss": 29.447803497314453}, "num_steps_trained": 3907627, "update_time_ms": 7.782, "num_steps_sampled": 3907627, "grad_time_ms": 10774.588, "sample_time_ms": 20009.371}}
{"time_this_iter_s": 31.95142674446106, "timesteps_total": 3950943, "num_metric_batches_dropped": 0, "timestamp": 1558576747, "time_since_restore": 2801.882066965103, "episode_reward_max": -177.56378019239406, "hostname": "flow-main", "episode_len_mean": 323.82, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-59-07", "episode_reward_mean": -550.0603493509939, "episode_reward_min": -861.1625519403224, "time_total_s": 2801.882066965103, "iterations_since_restore": 90, "custom_metrics": {"cost1_max": 224.95883387185498, "outflow_rate_mean": 1227.7376766927869, "outflow_rate_min": 969.2730520312864, "cost2_max": -57.78271178039702, "cost2_min": -96.24760917143777, "outflow_rate_max": 1468.0291662007266, "system_level_velocity_min": 10.34595156948838, "system_level_velocity_max": 18.880931950001067, "cost1_min": 122.77853040293863, "cost2_mean": -81.31915596188713, "system_level_velocity_mean": 15.018889493095667, "cost1_mean": 179.017009752728}, "timesteps_since_restore": 3950943, "episodes_this_iter": 45, "training_iteration": 90, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43316, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140048>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4176, "info": {"load_time_ms": 6.871, "default": {"vf_explained_var": 0.8688349723815918, "total_loss": 29.177509307861328, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.176593542098999, "policy_loss": -0.010835985653102398, "cur_lr": 0.0005000000237487257, "kl": 0.01662323996424675, "vf_loss": 29.185020446777344}, "num_steps_trained": 3950943, "update_time_ms": 7.907, "num_steps_sampled": 3950943, "grad_time_ms": 11184.517, "sample_time_ms": 20024.625}}
{"time_this_iter_s": 30.24310564994812, "timesteps_total": 3994509, "num_metric_batches_dropped": 0, "timestamp": 1558576778, "time_since_restore": 2832.1251726150513, "episode_reward_max": -258.6366349490077, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_01-59-38", "episode_reward_mean": -541.4765057196944, "episode_reward_min": -871.0695575057742, "time_total_s": 2832.1251726150513, "iterations_since_restore": 91, "custom_metrics": {"cost1_max": 225.21147091845836, "outflow_rate_mean": 1235.0708489524877, "outflow_rate_min": 935.0306438218104, "cost2_max": -50.998081339533826, "cost2_min": -96.24760917143777, "outflow_rate_max": 1468.0291662007266, "system_level_velocity_min": 9.911057167774379, "system_level_velocity_max": 18.91018828021399, "cost1_min": 118.38654251065388, "cost2_mean": -82.76890668973388, "system_level_velocity_mean": 15.118819609771116, "cost1_mean": 180.73861951183127}, "timesteps_since_restore": 3994509, "episodes_this_iter": 46, "training_iteration": 91, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43566, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9114cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91335f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133e80>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4222, "info": {"load_time_ms": 6.832, "default": {"vf_explained_var": 0.8820821642875671, "total_loss": 25.721616744995117, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.1998320817947388, "policy_loss": -0.010479463264346123, "cur_lr": 0.0005000000237487257, "kl": 0.017368150874972343, "vf_loss": 25.728622436523438}, "num_steps_trained": 3994509, "update_time_ms": 7.928, "num_steps_sampled": 3994509, "grad_time_ms": 11329.95, "sample_time_ms": 19896.691}}
{"time_this_iter_s": 32.80237102508545, "timesteps_total": 4038886, "num_metric_batches_dropped": 0, "timestamp": 1558576811, "time_since_restore": 2864.9275436401367, "episode_reward_max": -21.642838501489827, "hostname": "flow-main", "episode_len_mean": 322.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-00-11", "episode_reward_mean": -544.0535965766117, "episode_reward_min": -871.0695575057742, "time_total_s": 2864.9275436401367, "iterations_since_restore": 92, "custom_metrics": {"cost1_max": 225.39662657747428, "outflow_rate_mean": 1222.1423961946446, "outflow_rate_min": 471.3669816052633, "cost2_max": -12.26245791786262, "cost2_min": -97.56374011978025, "outflow_rate_max": 1465.834583757053, "system_level_velocity_min": 9.911057167774379, "system_level_velocity_max": 18.93193498174852, "cost1_min": 17.75283625601363, "cost2_mean": -82.9126503119602, "system_level_velocity_mean": 15.044778629330933, "cost1_mean": 177.86283234948803}, "timesteps_since_restore": 4038886, "episodes_this_iter": 50, "training_iteration": 92, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44377, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140cf8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4272, "info": {"load_time_ms": 6.848, "default": {"vf_explained_var": 0.8683570623397827, "total_loss": 29.748674392700195, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.1828746795654297, "policy_loss": -0.01085549034178257, "cur_lr": 0.0005000000237487257, "kl": 0.01803869940340519, "vf_loss": 29.755922317504883}, "num_steps_trained": 4038886, "update_time_ms": 8.136, "num_steps_sampled": 4038886, "grad_time_ms": 11403.349, "sample_time_ms": 20024.15}}
{"time_this_iter_s": 31.344250679016113, "timesteps_total": 4083173, "num_metric_batches_dropped": 0, "timestamp": 1558576842, "time_since_restore": 2896.271794319153, "episode_reward_max": -21.642838501489827, "hostname": "flow-main", "episode_len_mean": 322.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-00-42", "episode_reward_mean": -555.1916491694615, "episode_reward_min": -808.3112136512174, "time_total_s": 2896.271794319153, "iterations_since_restore": 93, "custom_metrics": {"cost1_max": 225.39662657747428, "outflow_rate_mean": 1217.0443886852152, "outflow_rate_min": 471.3669816052633, "cost2_max": -12.26245791786262, "cost2_min": -97.58379053876938, "outflow_rate_max": 1465.834583757053, "system_level_velocity_min": 11.1206966589646, "system_level_velocity_max": 18.93193498174852, "cost1_min": 17.75283625601363, "cost2_mean": -82.80123618157714, "system_level_velocity_mean": 14.918166311883159, "cost1_mean": 176.59500639355522}, "timesteps_since_restore": 4083173, "episodes_this_iter": 43, "training_iteration": 93, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44287, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ada0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ad30>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4315, "info": {"load_time_ms": 6.84, "default": {"vf_explained_var": 0.8962001800537109, "total_loss": 24.38788414001465, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.1855597496032715, "policy_loss": -0.012094035744667053, "cur_lr": 0.0005000000237487257, "kl": 0.019122356548905373, "vf_loss": 24.39615821838379}, "num_steps_trained": 4083173, "update_time_ms": 9.373, "num_steps_sampled": 4083173, "grad_time_ms": 11424.882, "sample_time_ms": 20016.628}}
{"time_this_iter_s": 31.183443546295166, "timesteps_total": 4127394, "num_metric_batches_dropped": 0, "timestamp": 1558576873, "time_since_restore": 2927.455237865448, "episode_reward_max": -175.38983313544557, "hostname": "flow-main", "episode_len_mean": 323.93, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-01-13", "episode_reward_mean": -561.4136207276126, "episode_reward_min": -842.3964591658722, "time_total_s": 2927.455237865448, "iterations_since_restore": 94, "custom_metrics": {"cost1_max": 224.69943640826614, "outflow_rate_mean": 1222.8068049592243, "outflow_rate_min": 991.3544293122118, "cost2_max": -68.14815126062398, "cost2_min": -97.58379053876938, "outflow_rate_max": 1461.1124254317108, "system_level_velocity_min": 10.083306168967226, "system_level_velocity_max": 18.84070120456599, "cost1_min": 122.02870598251647, "cost2_mean": -83.12240224560712, "system_level_velocity_mean": 14.891394298313728, "cost1_mean": 177.3058266972902}, "timesteps_since_restore": 4127394, "episodes_this_iter": 46, "training_iteration": 94, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44221, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91335f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91335c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140470>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4361, "info": {"load_time_ms": 6.777, "default": {"vf_explained_var": 0.8929961919784546, "total_loss": 25.441009521484375, "cur_kl_coeff": 0.20000004768371582, "entropy": 1.1942203044891357, "policy_loss": -0.011384459212422371, "cur_lr": 0.0005000000237487257, "kl": 0.020072145387530327, "vf_loss": 25.448375701904297}, "num_steps_trained": 4127394, "update_time_ms": 9.34, "num_steps_sampled": 4127394, "grad_time_ms": 11575.324, "sample_time_ms": 19891.007}}
{"time_this_iter_s": 31.298142910003662, "timesteps_total": 4171973, "num_metric_batches_dropped": 0, "timestamp": 1558576905, "time_since_restore": 2958.7533807754517, "episode_reward_max": -21.632656042885667, "hostname": "flow-main", "episode_len_mean": 320.95, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-01-45", "episode_reward_mean": -560.7326074239796, "episode_reward_min": -842.3964591658722, "time_total_s": 2958.7533807754517, "iterations_since_restore": 95, "custom_metrics": {"cost1_max": 224.69943640826614, "outflow_rate_mean": 1209.9754511272577, "outflow_rate_min": 451.264202181489, "cost2_max": -15.131287534945074, "cost2_min": -94.93858117593226, "outflow_rate_max": 1461.1124254317108, "system_level_velocity_min": 10.083306168967226, "system_level_velocity_max": 18.84070120456599, "cost1_min": 17.893718139155464, "cost2_mean": -83.17711187541046, "system_level_velocity_mean": 14.844620941100816, "cost1_mean": 174.97891025335568}, "timesteps_since_restore": 4171973, "episodes_this_iter": 52, "training_iteration": 95, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44579, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143be0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4413, "info": {"load_time_ms": 6.888, "default": {"vf_explained_var": 0.876970648765564, "total_loss": 28.130220413208008, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.1660901308059692, "policy_loss": -0.009985705837607384, "cur_lr": 0.0005000000237487257, "kl": 0.01420090813189745, "vf_loss": 28.135940551757812}, "num_steps_trained": 4171973, "update_time_ms": 9.403, "num_steps_sampled": 4171973, "grad_time_ms": 11575.157, "sample_time_ms": 19865.48}}
{"time_this_iter_s": 29.80484127998352, "timesteps_total": 4215229, "num_metric_batches_dropped": 0, "timestamp": 1558576934, "time_since_restore": 2988.558222055435, "episode_reward_max": -21.632656042885667, "hostname": "flow-main", "episode_len_mean": 319.12, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-02-14", "episode_reward_mean": -539.369860215121, "episode_reward_min": -818.6856859365004, "time_total_s": 2988.558222055435, "iterations_since_restore": 96, "custom_metrics": {"cost1_max": 224.62437204635705, "outflow_rate_mean": 1218.456995573814, "outflow_rate_min": 451.264202181489, "cost2_max": -15.131287534945074, "cost2_min": -95.17180102729463, "outflow_rate_max": 1461.7251482731817, "system_level_velocity_min": 9.448480037896662, "system_level_velocity_max": 18.86708603859501, "cost1_min": 17.893718139155464, "cost2_mean": -83.78178576781431, "system_level_velocity_mean": 15.136788311779382, "cost1_mean": 177.3070978929693}, "timesteps_since_restore": 4215229, "episodes_this_iter": 42, "training_iteration": 96, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43256, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140c18>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4455, "info": {"load_time_ms": 7.101, "default": {"vf_explained_var": 0.8845997452735901, "total_loss": 25.83186912536621, "cur_kl_coeff": 0.29999998211860657, "entropy": 1.148571491241455, "policy_loss": -0.00980740413069725, "cur_lr": 0.0005000000237487257, "kl": 0.01363719068467617, "vf_loss": 25.837583541870117}, "num_steps_trained": 4215229, "update_time_ms": 9.55, "num_steps_sampled": 4215229, "grad_time_ms": 11617.106, "sample_time_ms": 19779.115}}
{"time_this_iter_s": 31.42434287071228, "timesteps_total": 4258400, "num_metric_batches_dropped": 0, "timestamp": 1558576966, "time_since_restore": 3019.9825649261475, "episode_reward_max": -28.557847578851394, "hostname": "flow-main", "episode_len_mean": 318.77, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-02-46", "episode_reward_mean": -521.8551176419762, "episode_reward_min": -818.6856859365004, "time_total_s": 3019.9825649261475, "iterations_since_restore": 97, "custom_metrics": {"cost1_max": 226.50558477520212, "outflow_rate_mean": 1231.0398822046836, "outflow_rate_min": 493.8745706160326, "cost2_max": -18.134024636681996, "cost2_min": -95.38837471572306, "outflow_rate_max": 1463.824997818719, "system_level_velocity_min": 9.448480037896662, "system_level_velocity_max": 18.938406860462713, "cost1_min": 23.163986182834577, "cost2_mean": -84.23756347936946, "system_level_velocity_mean": 15.394998457532893, "cost1_mean": 179.73100746630428}, "timesteps_since_restore": 4258400, "episodes_this_iter": 49, "training_iteration": 97, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43171, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91409b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140470>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4504, "info": {"load_time_ms": 6.829, "default": {"vf_explained_var": 0.8704202175140381, "total_loss": 29.825963973999023, "cur_kl_coeff": 0.29999998211860657, "entropy": 1.1586874723434448, "policy_loss": -0.010420085862278938, "cur_lr": 0.0005000000237487257, "kl": 0.01474964339286089, "vf_loss": 29.831954956054688}, "num_steps_trained": 4258400, "update_time_ms": 9.557, "num_steps_sampled": 4258400, "grad_time_ms": 11529.939, "sample_time_ms": 19748.737}}
{"time_this_iter_s": 30.800649404525757, "timesteps_total": 4301236, "num_metric_batches_dropped": 0, "timestamp": 1558576997, "time_since_restore": 3050.783214330673, "episode_reward_max": -28.030068286431337, "hostname": "flow-main", "episode_len_mean": 318.77, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-03-17", "episode_reward_mean": -504.75156851492926, "episode_reward_min": -813.4116666373703, "time_total_s": 3050.783214330673, "iterations_since_restore": 98, "custom_metrics": {"cost1_max": 226.50558477520212, "outflow_rate_mean": 1241.8021868785604, "outflow_rate_min": 502.9433862365724, "cost2_max": -16.91357788182925, "cost2_min": -97.18052424485879, "outflow_rate_max": 1463.824997818719, "system_level_velocity_min": 11.033562228446995, "system_level_velocity_max": 18.938406860462713, "cost1_min": 23.328356519451493, "cost2_mean": -84.07916723002609, "system_level_velocity_mean": 15.608347752683732, "cost1_mean": 182.47629810719704}, "timesteps_since_restore": 4301236, "episodes_this_iter": 50, "training_iteration": 98, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 42836, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140978>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4554, "info": {"load_time_ms": 7.075, "default": {"vf_explained_var": 0.8662618398666382, "total_loss": 28.123584747314453, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.14760160446167, "policy_loss": -0.01284274272620678, "cur_lr": 0.0005000000237487257, "kl": 0.01659696362912655, "vf_loss": 28.131444931030273}, "num_steps_trained": 4301236, "update_time_ms": 9.558, "num_steps_sampled": 4301236, "grad_time_ms": 11371.283, "sample_time_ms": 19834.473}}
{"time_this_iter_s": 32.87546348571777, "timesteps_total": 4346475, "num_metric_batches_dropped": 0, "timestamp": 1558577030, "time_since_restore": 3083.658677816391, "episode_reward_max": -28.030068286431337, "hostname": "flow-main", "episode_len_mean": 322.1, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-03-50", "episode_reward_mean": -547.1048827563069, "episode_reward_min": -813.4116666373703, "time_total_s": 3083.658677816391, "iterations_since_restore": 99, "custom_metrics": {"cost1_max": 226.11795088938058, "outflow_rate_mean": 1224.6335630926847, "outflow_rate_min": 502.9433862365724, "cost2_max": -16.91357788182925, "cost2_min": -97.18052424485879, "outflow_rate_max": 1463.6242684389656, "system_level_velocity_min": 10.726014335440043, "system_level_velocity_max": 18.990035011751978, "cost1_min": 23.328356519451493, "cost2_mean": -83.72486547566143, "system_level_velocity_mean": 15.082961013896089, "cost1_mean": 178.68838230804408}, "timesteps_since_restore": 4346475, "episodes_this_iter": 42, "training_iteration": 99, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45239, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912ba58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bbe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b358>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4596, "info": {"load_time_ms": 6.825, "default": {"vf_explained_var": 0.892377495765686, "total_loss": 22.615875244140625, "cur_kl_coeff": 0.29999998211860657, "entropy": 1.1890842914581299, "policy_loss": -0.010394333861768246, "cur_lr": 0.0005000000237487257, "kl": 0.01600835472345352, "vf_loss": 22.62146759033203}, "num_steps_trained": 4346475, "update_time_ms": 9.495, "num_steps_sampled": 4346475, "grad_time_ms": 11265.581, "sample_time_ms": 20005.113}}
{"time_this_iter_s": 33.64898991584778, "timesteps_total": 4392146, "num_metric_batches_dropped": 0, "timestamp": 1558577063, "time_since_restore": 3117.3076677322388, "episode_reward_max": -28.030068286431337, "hostname": "flow-main", "episode_len_mean": 322.1, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-04-23", "episode_reward_mean": -578.7287769375364, "episode_reward_min": -1415.9815269831658, "time_total_s": 3117.3076677322388, "iterations_since_restore": 100, "custom_metrics": {"cost1_max": 226.11795088938058, "outflow_rate_mean": 1194.588168731244, "outflow_rate_min": 72.36, "cost2_max": -16.91357788182925, "cost2_min": -94.5922688057949, "outflow_rate_max": 1464.074988939366, "system_level_velocity_min": 4.99577784534637, "system_level_velocity_max": 18.990035011751978, "cost1_min": 23.328356519451493, "cost2_mean": -82.50422222939362, "system_level_velocity_mean": 14.695771380304748, "cost1_mean": 173.76163548567771}, "timesteps_since_restore": 4392146, "episodes_this_iter": 47, "training_iteration": 100, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45671, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91432b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91436d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143240>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4643, "info": {"load_time_ms": 6.883, "default": {"vf_explained_var": 0.8792054057121277, "total_loss": 28.653839111328125, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2489136457443237, "policy_loss": -0.01023798156529665, "cur_lr": 0.0005000000237487257, "kl": 0.015180954709649086, "vf_loss": 28.659523010253906}, "num_steps_trained": 4392146, "update_time_ms": 9.462, "num_steps_sampled": 4392146, "grad_time_ms": 11326.744, "sample_time_ms": 20112.91}}
{"time_this_iter_s": 31.142691135406494, "timesteps_total": 4436961, "num_metric_batches_dropped": 0, "timestamp": 1558577095, "time_since_restore": 3148.4503588676453, "episode_reward_max": -237.84019758594738, "hostname": "flow-main", "episode_len_mean": 324.72, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-04-55", "episode_reward_mean": -590.8700769702044, "episode_reward_min": -1415.9815269831658, "time_total_s": 3148.4503588676453, "iterations_since_restore": 101, "custom_metrics": {"cost1_max": 227.42083872919417, "outflow_rate_mean": 1193.3942601254557, "outflow_rate_min": 72.36, "cost2_max": -46.44304583058028, "cost2_min": -94.72877567560275, "outflow_rate_max": 1469.9406492568896, "system_level_velocity_min": 4.99577784534637, "system_level_velocity_max": 19.113159392150003, "cost1_min": 58.692463248324586, "cost2_mean": -82.0763426691699, "system_level_velocity_mean": 14.517527946940676, "cost1_mean": 173.35040095648074}, "timesteps_since_restore": 4436961, "episodes_this_iter": 46, "training_iteration": 101, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44815, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91409e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140ba8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4689, "info": {"load_time_ms": 7.187, "default": {"vf_explained_var": 0.9011816382408142, "total_loss": 22.954742431640625, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2269911766052246, "policy_loss": -0.010317668318748474, "cur_lr": 0.0005000000237487257, "kl": 0.0160069540143013, "vf_loss": 22.96025848388672}, "num_steps_trained": 4436961, "update_time_ms": 9.583, "num_steps_sampled": 4436961, "grad_time_ms": 11348.498, "sample_time_ms": 20181.486}}
{"time_this_iter_s": 30.287342309951782, "timesteps_total": 4480505, "num_metric_batches_dropped": 0, "timestamp": 1558577125, "time_since_restore": 3178.737701177597, "episode_reward_max": -237.84019758594738, "hostname": "flow-main", "episode_len_mean": 324.72, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-05-25", "episode_reward_mean": -565.878061687715, "episode_reward_min": -985.7642319207529, "time_total_s": 3178.737701177597, "iterations_since_restore": 102, "custom_metrics": {"cost1_max": 227.42083872919417, "outflow_rate_mean": 1213.7634978910578, "outflow_rate_min": 730.5623285379727, "cost2_max": -62.77959798439053, "cost2_min": -95.93672776068388, "outflow_rate_max": 1469.9406492568896, "system_level_velocity_min": 10.852471570185331, "system_level_velocity_max": 19.113159392150003, "cost1_min": 130.59111424772294, "cost2_mean": -82.60398989573663, "system_level_velocity_mean": 14.899833998927647, "cost1_mean": 177.88047647516123}, "timesteps_since_restore": 4480505, "episodes_this_iter": 47, "training_iteration": 102, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43544, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b320>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4736, "info": {"load_time_ms": 7.393, "default": {"vf_explained_var": 0.8664884567260742, "total_loss": 32.13949203491211, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.1824510097503662, "policy_loss": -0.010757612995803356, "cur_lr": 0.0005000000237487257, "kl": 0.01604682207107544, "vf_loss": 32.14543151855469}, "num_steps_trained": 4480505, "update_time_ms": 9.408, "num_steps_sampled": 4480505, "grad_time_ms": 11308.921, "sample_time_ms": 19968.607}}
{"time_this_iter_s": 31.77496886253357, "timesteps_total": 4525379, "num_metric_batches_dropped": 0, "timestamp": 1558577157, "time_since_restore": 3210.5126700401306, "episode_reward_max": -264.36975615422705, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-05-57", "episode_reward_mean": -552.150023307939, "episode_reward_min": -1098.8276081709726, "time_total_s": 3210.5126700401306, "iterations_since_restore": 103, "custom_metrics": {"cost1_max": 224.96458067242406, "outflow_rate_mean": 1218.1340878606516, "outflow_rate_min": 73.8, "cost2_max": -26.314873676678022, "cost2_min": -95.93672776068388, "outflow_rate_max": 1465.5709517939238, "system_level_velocity_min": 3.5569030222670572, "system_level_velocity_max": 18.925460877486707, "cost1_min": 43.14212494721453, "cost2_mean": -83.06949461945297, "system_level_velocity_mean": 15.092150674699848, "cost1_mean": 180.49377372292872}, "timesteps_since_restore": 4525379, "episodes_this_iter": 45, "training_iteration": 103, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44874, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91402b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140278>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4781, "info": {"load_time_ms": 7.285, "default": {"vf_explained_var": 0.8694678544998169, "total_loss": 30.617746353149414, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2165173292160034, "policy_loss": -0.009548207744956017, "cur_lr": 0.0005000000237487257, "kl": 0.014410730451345444, "vf_loss": 30.622968673706055}, "num_steps_trained": 4525379, "update_time_ms": 8.163, "num_steps_sampled": 4525379, "grad_time_ms": 11332.456, "sample_time_ms": 19990.169}}
{"time_this_iter_s": 31.190210103988647, "timesteps_total": 4569382, "num_metric_batches_dropped": 0, "timestamp": 1558577188, "time_since_restore": 3241.7028801441193, "episode_reward_max": -261.2478041051283, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-06-28", "episode_reward_mean": -568.7662343377287, "episode_reward_min": -1098.8276081709726, "time_total_s": 3241.7028801441193, "iterations_since_restore": 104, "custom_metrics": {"cost1_max": 225.76483718685154, "outflow_rate_mean": 1208.831899538755, "outflow_rate_min": 73.8, "cost2_max": -26.314873676678022, "cost2_min": -98.76068875374565, "outflow_rate_max": 1465.5709517939238, "system_level_velocity_min": 3.5569030222670572, "system_level_velocity_max": 18.88294091966565, "cost1_min": 43.14212494721453, "cost2_mean": -82.3348583012593, "system_level_velocity_mean": 14.68291989376521, "cost1_mean": 175.86968341184038}, "timesteps_since_restore": 4569382, "episodes_this_iter": 46, "training_iteration": 104, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44003, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91409b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140e48>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4827, "info": {"load_time_ms": 7.62, "default": {"vf_explained_var": 0.8753315210342407, "total_loss": 27.484045028686523, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2169870138168335, "policy_loss": -0.00919850543141365, "cur_lr": 0.0005000000237487257, "kl": 0.015201649628579617, "vf_loss": 27.488685607910156}, "num_steps_trained": 4569382, "update_time_ms": 8.184, "num_steps_sampled": 4569382, "grad_time_ms": 11279.732, "sample_time_ms": 20044.042}}
{"time_this_iter_s": 30.257568836212158, "timesteps_total": 4612449, "num_metric_batches_dropped": 0, "timestamp": 1558577218, "time_since_restore": 3271.9604489803314, "episode_reward_max": -261.2478041051283, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-06-58", "episode_reward_mean": -551.1111802028349, "episode_reward_min": -867.158243488604, "time_total_s": 3271.9604489803314, "iterations_since_restore": 105, "custom_metrics": {"cost1_max": 225.76483718685154, "outflow_rate_mean": 1230.7688995788901, "outflow_rate_min": 964.7239285714282, "cost2_max": -58.56246952615452, "cost2_min": -98.76068875374565, "outflow_rate_max": 1465.6768132964214, "system_level_velocity_min": 10.289390750010194, "system_level_velocity_max": 18.88294091966565, "cost1_min": 121.62297247206102, "cost2_mean": -83.2629216020677, "system_level_velocity_mean": 14.917721299744205, "cost1_mean": 178.84342504862587}, "timesteps_since_restore": 4612449, "episodes_this_iter": 49, "training_iteration": 105, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43067, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140f28>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4876, "info": {"load_time_ms": 7.508, "default": {"vf_explained_var": 0.8818167448043823, "total_loss": 26.76482582092285, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.1562674045562744, "policy_loss": -0.01097473967820406, "cur_lr": 0.0005000000237487257, "kl": 0.01500274334102869, "vf_loss": 26.771297454833984}, "num_steps_trained": 4612449, "update_time_ms": 8.193, "num_steps_sampled": 4612449, "grad_time_ms": 11251.863, "sample_time_ms": 19968.015}}
{"time_this_iter_s": 30.80933666229248, "timesteps_total": 4656908, "num_metric_batches_dropped": 0, "timestamp": 1558577249, "time_since_restore": 3302.769785642624, "episode_reward_max": -28.950816259815785, "hostname": "flow-main", "episode_len_mean": 320.12, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-07-29", "episode_reward_mean": -550.4309299689593, "episode_reward_min": -815.2088869398635, "time_total_s": 3302.769785642624, "iterations_since_restore": 106, "custom_metrics": {"cost1_max": 224.49846510916984, "outflow_rate_mean": 1213.399110110703, "outflow_rate_min": 462.43348918263234, "cost2_max": -20.7988561128748, "cost2_min": -93.76375526091029, "outflow_rate_max": 1465.6768132964214, "system_level_velocity_min": 11.37921800394044, "system_level_velocity_max": 18.954807324991705, "cost1_min": 23.252355290525173, "cost2_mean": -81.8785692257435, "system_level_velocity_mean": 14.952812054021386, "cost1_mean": 175.60061354642627}, "timesteps_since_restore": 4656908, "episodes_this_iter": 44, "training_iteration": 106, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44459, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91402b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140c18>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4920, "info": {"load_time_ms": 7.515, "default": {"vf_explained_var": 0.8926615715026855, "total_loss": 25.04808235168457, "cur_kl_coeff": 0.29999998211860657, "entropy": 1.2010983228683472, "policy_loss": -0.009599104523658752, "cur_lr": 0.0005000000237487257, "kl": 0.015405119396746159, "vf_loss": 25.05306053161621}, "num_steps_trained": 4656908, "update_time_ms": 8.638, "num_steps_sampled": 4656908, "grad_time_ms": 11275.86, "sample_time_ms": 20043.742}}
{"time_this_iter_s": 30.80325150489807, "timesteps_total": 4700987, "num_metric_batches_dropped": 0, "timestamp": 1558577280, "time_since_restore": 3333.573037147522, "episode_reward_max": -28.950816259815785, "hostname": "flow-main", "episode_len_mean": 320.12, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-08-00", "episode_reward_mean": -549.4012212684278, "episode_reward_min": -895.426383826084, "time_total_s": 3333.573037147522, "iterations_since_restore": 107, "custom_metrics": {"cost1_max": 225.31881190085966, "outflow_rate_mean": 1212.4887392822707, "outflow_rate_min": 462.43348918263234, "cost2_max": -20.7988561128748, "cost2_min": -94.45011992163245, "outflow_rate_max": 1463.5552256333679, "system_level_velocity_min": 11.270726077454794, "system_level_velocity_max": 18.954807324991705, "cost1_min": 23.252355290525173, "cost2_mean": -81.80536980445522, "system_level_velocity_mean": 15.086122032788758, "cost1_mean": 177.03210562492305}, "timesteps_since_restore": 4700987, "episodes_this_iter": 47, "training_iteration": 107, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44079, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140cf8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 4967, "info": {"load_time_ms": 7.835, "default": {"vf_explained_var": 0.8631826639175415, "total_loss": 31.826915740966797, "cur_kl_coeff": 0.29999998211860657, "entropy": 1.1957122087478638, "policy_loss": -0.012641585431993008, "cur_lr": 0.0005000000237487257, "kl": 0.017432015389204025, "vf_loss": 31.834327697753906}, "num_steps_trained": 4700987, "update_time_ms": 8.61, "num_steps_sampled": 4700987, "grad_time_ms": 11253.785, "sample_time_ms": 20004.058}}
{"time_this_iter_s": 30.42478108406067, "timesteps_total": 4744887, "num_metric_batches_dropped": 0, "timestamp": 1558577310, "time_since_restore": 3363.9978182315826, "episode_reward_max": -253.04263769182674, "hostname": "flow-main", "episode_len_mean": 324.62, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-08-30", "episode_reward_mean": -556.4276097157622, "episode_reward_min": -971.5069616569655, "time_total_s": 3363.9978182315826, "iterations_since_restore": 108, "custom_metrics": {"cost1_max": 225.31881190085966, "outflow_rate_mean": 1218.249556926468, "outflow_rate_min": 725.0397365339576, "cost2_max": -52.9459033823837, "cost2_min": -94.45011992163245, "outflow_rate_max": 1463.5129036859091, "system_level_velocity_min": 11.092084813901566, "system_level_velocity_max": 18.87345180949959, "cost1_min": 132.9397444539327, "cost2_mean": -81.50007674149023, "system_level_velocity_mean": 15.041727716479205, "cost1_mean": 179.69287199085502}, "timesteps_since_restore": 4744887, "episodes_this_iter": 49, "training_iteration": 108, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43900, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91219e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121c88>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5016, "info": {"load_time_ms": 7.964, "default": {"vf_explained_var": 0.8473671078681946, "total_loss": 34.569976806640625, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.239659309387207, "policy_loss": -0.010456958785653114, "cur_lr": 0.0005000000237487257, "kl": 0.015300828963518143, "vf_loss": 34.575843811035156}, "num_steps_trained": 4744887, "update_time_ms": 8.787, "num_steps_sampled": 4744887, "grad_time_ms": 11227.051, "sample_time_ms": 19992.243}}
{"time_this_iter_s": 29.592922687530518, "timesteps_total": 4789157, "num_metric_batches_dropped": 0, "timestamp": 1558577340, "time_since_restore": 3393.590740919113, "episode_reward_max": -253.04263769182674, "hostname": "flow-main", "episode_len_mean": 324.62, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-09-00", "episode_reward_mean": -544.1546380388279, "episode_reward_min": -971.5069616569655, "time_total_s": 3393.590740919113, "iterations_since_restore": 109, "custom_metrics": {"cost1_max": 225.31881190085966, "outflow_rate_mean": 1228.5865112230163, "outflow_rate_min": 725.0397365339576, "cost2_max": -58.141251396165785, "cost2_min": -95.58462043972526, "outflow_rate_max": 1463.5129036859091, "system_level_velocity_min": 11.092084813901566, "system_level_velocity_max": 18.87345180949959, "cost1_min": 132.9397444539327, "cost2_mean": -81.21361085013244, "system_level_velocity_mean": 15.146339133327647, "cost1_mean": 181.12425090886026}, "timesteps_since_restore": 4789157, "episodes_this_iter": 42, "training_iteration": 109, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44270, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140438>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5058, "info": {"load_time_ms": 7.874, "default": {"vf_explained_var": 0.8677587509155273, "total_loss": 29.335906982421875, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2015348672866821, "policy_loss": -0.011061265133321285, "cur_lr": 0.0005000000237487257, "kl": 0.015935143455863, "vf_loss": 29.342187881469727}, "num_steps_trained": 4789157, "update_time_ms": 8.723, "num_steps_sampled": 4789157, "grad_time_ms": 11010.099, "sample_time_ms": 19882.324}}
{"time_this_iter_s": 30.62296724319458, "timesteps_total": 4833885, "num_metric_batches_dropped": 0, "timestamp": 1558577371, "time_since_restore": 3424.2137081623077, "episode_reward_max": -267.87603984013157, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-09-31", "episode_reward_mean": -567.57396810811, "episode_reward_min": -971.5069616569655, "time_total_s": 3424.2137081623077, "iterations_since_restore": 110, "custom_metrics": {"cost1_max": 224.47485306515887, "outflow_rate_mean": 1215.7212482853774, "outflow_rate_min": 725.0397365339576, "cost2_max": -59.93944151596894, "cost2_min": -98.01883983013141, "outflow_rate_max": 1462.0130946510658, "system_level_velocity_min": 11.351140704962349, "system_level_velocity_max": 18.783086408887335, "cost1_min": 135.00742213893412, "cost2_mean": -81.38006347721264, "system_level_velocity_mean": 14.870355599177229, "cost1_mean": 178.18593796147334}, "timesteps_since_restore": 4833885, "episodes_this_iter": 48, "training_iteration": 110, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44728, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91400b8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5106, "info": {"load_time_ms": 7.932, "default": {"vf_explained_var": 0.8657263517379761, "total_loss": 29.29840850830078, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.205893635749817, "policy_loss": -0.008977537974715233, "cur_lr": 0.0005000000237487257, "kl": 0.015636738389730453, "vf_loss": 29.302692413330078}, "num_steps_trained": 4833885, "update_time_ms": 8.621, "num_steps_sampled": 4833885, "grad_time_ms": 10617.215, "sample_time_ms": 19971.788}}
{"time_this_iter_s": 30.460232973098755, "timesteps_total": 4878898, "num_metric_batches_dropped": 0, "timestamp": 1558577401, "time_since_restore": 3454.6739411354065, "episode_reward_max": -268.0010627448877, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-10-01", "episode_reward_mean": -569.77753065418, "episode_reward_min": -809.2482738689353, "time_total_s": 3454.6739411354065, "iterations_since_restore": 111, "custom_metrics": {"cost1_max": 223.8801107661343, "outflow_rate_mean": 1220.7383075210398, "outflow_rate_min": 1010.423323204366, "cost2_max": -67.35851376809933, "cost2_min": -98.01883983013141, "outflow_rate_max": 1460.6518510164897, "system_level_velocity_min": 11.351140704962349, "system_level_velocity_max": 18.703802855669135, "cost1_min": 135.00742213893412, "cost2_mean": -82.72663554203592, "system_level_velocity_mean": 14.85380796039473, "cost1_mean": 178.12808492087788}, "timesteps_since_restore": 4878898, "episodes_this_iter": 48, "training_iteration": 111, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45013, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140d30>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5154, "info": {"load_time_ms": 7.732, "default": {"vf_explained_var": 0.8780899047851562, "total_loss": 27.413021087646484, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2008839845657349, "policy_loss": -0.01006622426211834, "cur_lr": 0.0005000000237487257, "kl": 0.016083136200904846, "vf_loss": 27.41826629638672}, "num_steps_trained": 4878898, "update_time_ms": 8.524, "num_steps_sampled": 4878898, "grad_time_ms": 10415.653, "sample_time_ms": 20102.945}}
{"time_this_iter_s": 29.47008204460144, "timesteps_total": 4922558, "num_metric_batches_dropped": 0, "timestamp": 1558577431, "time_since_restore": 3484.144023180008, "episode_reward_max": -91.45929533212494, "hostname": "flow-main", "episode_len_mean": 322.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-10-31", "episode_reward_mean": -552.6048502503461, "episode_reward_min": -807.9683021375624, "time_total_s": 3484.144023180008, "iterations_since_restore": 112, "custom_metrics": {"cost1_max": 223.8801107661343, "outflow_rate_mean": 1223.9481355789162, "outflow_rate_min": 779.9097337147545, "cost2_max": -44.90234780137204, "cost2_min": -96.4583408563875, "outflow_rate_max": 1460.6518510164897, "system_level_velocity_min": 11.218105376726168, "system_level_velocity_max": 18.703802855669135, "cost1_min": 80.09190432613633, "cost2_mean": -82.15400888418755, "system_level_velocity_mean": 15.045869180760405, "cost1_mean": 178.97643388810735}, "timesteps_since_restore": 4922558, "episodes_this_iter": 45, "training_iteration": 112, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43660, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140eb8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5199, "info": {"load_time_ms": 7.488, "default": {"vf_explained_var": 0.8916294574737549, "total_loss": 24.343006134033203, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.1613408327102661, "policy_loss": -0.009550521150231361, "cur_lr": 0.0005000000237487257, "kl": 0.014898885041475296, "vf_loss": 24.34808921813965}, "num_steps_trained": 4922558, "update_time_ms": 8.744, "num_steps_sampled": 4922558, "grad_time_ms": 10216.814, "sample_time_ms": 20220.792}}
{"time_this_iter_s": 30.517656326293945, "timesteps_total": 4966181, "num_metric_batches_dropped": 0, "timestamp": 1558577461, "time_since_restore": 3514.661679506302, "episode_reward_max": -91.45929533212494, "hostname": "flow-main", "episode_len_mean": 322.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-11-01", "episode_reward_mean": -531.1605734580079, "episode_reward_min": -965.034266160562, "time_total_s": 3514.661679506302, "iterations_since_restore": 113, "custom_metrics": {"cost1_max": 223.660835106474, "outflow_rate_mean": 1238.448073750624, "outflow_rate_min": 714.8606089532587, "cost2_max": -44.90234780137204, "cost2_min": -97.59702938043425, "outflow_rate_max": 1461.5184105314088, "system_level_velocity_min": 11.218105376726168, "system_level_velocity_max": 18.72885654447257, "cost1_min": 80.09190432613633, "cost2_mean": -82.53530386072126, "system_level_velocity_mean": 15.266699640541177, "cost1_mean": 181.86309304720228}, "timesteps_since_restore": 4966181, "episodes_this_iter": 46, "training_iteration": 113, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43623, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b0b8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5245, "info": {"load_time_ms": 7.754, "default": {"vf_explained_var": 0.8771200776100159, "total_loss": 25.56777572631836, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.186827301979065, "policy_loss": -0.011791080236434937, "cur_lr": 0.0005000000237487257, "kl": 0.018381359055638313, "vf_loss": 25.574052810668945}, "num_steps_trained": 4966181, "update_time_ms": 8.809, "num_steps_sampled": 4966181, "grad_time_ms": 10086.08, "sample_time_ms": 20222.388}}
{"time_this_iter_s": 32.73602628707886, "timesteps_total": 5010182, "num_metric_batches_dropped": 0, "timestamp": 1558577494, "time_since_restore": 3547.3977057933807, "episode_reward_max": -266.0252936280191, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-11-34", "episode_reward_mean": -539.1232035405523, "episode_reward_min": -965.034266160562, "time_total_s": 3547.3977057933807, "iterations_since_restore": 114, "custom_metrics": {"cost1_max": 225.0175263099388, "outflow_rate_mean": 1236.3432000591836, "outflow_rate_min": 714.8606089532587, "cost2_max": -59.70332880246253, "cost2_min": -97.59702938043425, "outflow_rate_max": 1464.1833033127791, "system_level_velocity_min": 9.726418727268603, "system_level_velocity_max": 18.911012583903336, "cost1_min": 115.95442873147167, "cost2_mean": -82.30266948971243, "system_level_velocity_mean": 15.064681857468818, "cost1_mean": 180.82585166165}, "timesteps_since_restore": 5010182, "episodes_this_iter": 46, "training_iteration": 114, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44001, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140320>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5291, "info": {"load_time_ms": 7.756, "default": {"vf_explained_var": 0.8736193180084229, "total_loss": 26.631855010986328, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2464487552642822, "policy_loss": -0.010591186583042145, "cur_lr": 0.0005000000237487257, "kl": 0.015911752358078957, "vf_loss": 26.637672424316406}, "num_steps_trained": 5010182, "update_time_ms": 9.182, "num_steps_sampled": 5010182, "grad_time_ms": 10238.754, "sample_time_ms": 20222.946}}
{"time_this_iter_s": 31.132755756378174, "timesteps_total": 5053221, "num_metric_batches_dropped": 0, "timestamp": 1558577525, "time_since_restore": 3578.530461549759, "episode_reward_max": -254.81644470764166, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-12-05", "episode_reward_mean": -549.9414203794975, "episode_reward_min": -927.4565287179585, "time_total_s": 3578.530461549759, "iterations_since_restore": 115, "custom_metrics": {"cost1_max": 225.97712250429234, "outflow_rate_mean": 1226.5823440764934, "outflow_rate_min": 729.1565100403604, "cost2_max": -57.50294822461597, "cost2_min": -94.41481105620682, "outflow_rate_max": 1470.058878546034, "system_level_velocity_min": 9.726418727268603, "system_level_velocity_max": 19.040179707252207, "cost1_min": 115.95442873147167, "cost2_mean": -81.47529423783783, "system_level_velocity_mean": 14.96723608466058, "cost1_mean": 179.34914349516347}, "timesteps_since_restore": 5053221, "episodes_this_iter": 47, "training_iteration": 115, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43039, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912beb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b6a0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5338, "info": {"load_time_ms": 7.941, "default": {"vf_explained_var": 0.8635537028312683, "total_loss": 30.480823516845703, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2161223888397217, "policy_loss": -0.011030408553779125, "cur_lr": 0.0005000000237487257, "kl": 0.015482194721698761, "vf_loss": 30.487211227416992}, "num_steps_trained": 5053221, "update_time_ms": 9.309, "num_steps_sampled": 5053221, "grad_time_ms": 10366.379, "sample_time_ms": 20182.096}}
{"time_this_iter_s": 30.283464670181274, "timesteps_total": 5096673, "num_metric_batches_dropped": 0, "timestamp": 1558577556, "time_since_restore": 3608.81392621994, "episode_reward_max": -254.81644470764166, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-12-36", "episode_reward_mean": -529.844161836925, "episode_reward_min": -927.4565287179585, "time_total_s": 3608.81392621994, "iterations_since_restore": 116, "custom_metrics": {"cost1_max": 225.97712250429234, "outflow_rate_mean": 1244.1549039642846, "outflow_rate_min": 729.1565100403604, "cost2_max": -57.50294822461597, "cost2_min": -95.85384275794785, "outflow_rate_max": 1470.058878546034, "system_level_velocity_min": 10.775016549159862, "system_level_velocity_max": 19.040179707252207, "cost1_min": 128.17508742790886, "cost2_mean": -83.1804053330467, "system_level_velocity_mean": 15.321799432327031, "cost1_mean": 183.3425471047794}, "timesteps_since_restore": 5096673, "episodes_this_iter": 45, "training_iteration": 116, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43452, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91330f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91335f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913aeb8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5383, "info": {"load_time_ms": 7.771, "default": {"vf_explained_var": 0.8899862170219421, "total_loss": 25.186641693115234, "cur_kl_coeff": 0.29999998211860657, "entropy": 1.2045304775238037, "policy_loss": -0.010001023299992085, "cur_lr": 0.0005000000237487257, "kl": 0.014751968905329704, "vf_loss": 25.192214965820312}, "num_steps_trained": 5096673, "update_time_ms": 8.715, "num_steps_sampled": 5096673, "grad_time_ms": 10446.942, "sample_time_ms": 20049.781}}
{"time_this_iter_s": 32.30444097518921, "timesteps_total": 5139903, "num_metric_batches_dropped": 0, "timestamp": 1558577588, "time_since_restore": 3641.1183671951294, "episode_reward_max": -176.81197794658246, "hostname": "flow-main", "episode_len_mean": 323.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-13-08", "episode_reward_mean": -529.4845844991854, "episode_reward_min": -817.3660330485478, "time_total_s": 3641.1183671951294, "iterations_since_restore": 117, "custom_metrics": {"cost1_max": 224.93937832732908, "outflow_rate_mean": 1245.3620582703747, "outflow_rate_min": 1007.3054599179815, "cost2_max": -67.07702902780291, "cost2_min": -97.06757484301912, "outflow_rate_max": 1467.4377066724521, "system_level_velocity_min": 11.219071703896434, "system_level_velocity_max": 18.886189928479457, "cost1_min": 134.60172047689292, "cost2_mean": -84.00052413121485, "system_level_velocity_mean": 15.332197192732833, "cost1_mean": 182.65041118893484}, "timesteps_since_restore": 5139903, "episodes_this_iter": 48, "training_iteration": 117, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43230, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912beb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b518>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5431, "info": {"load_time_ms": 7.763, "default": {"vf_explained_var": 0.8778855204582214, "total_loss": 28.025653839111328, "cur_kl_coeff": 0.29999998211860657, "entropy": 1.1787605285644531, "policy_loss": -0.011096537113189697, "cur_lr": 0.0005000000237487257, "kl": 0.015660814940929413, "vf_loss": 28.032052993774414}, "num_steps_trained": 5139903, "update_time_ms": 8.987, "num_steps_sampled": 5139903, "grad_time_ms": 10622.173, "sample_time_ms": 20023.406}}
{"time_this_iter_s": 34.90260696411133, "timesteps_total": 5184528, "num_metric_batches_dropped": 0, "timestamp": 1558577623, "time_since_restore": 3676.0209741592407, "episode_reward_max": -29.33848956867781, "hostname": "flow-main", "episode_len_mean": 321.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-13-43", "episode_reward_mean": -549.4651528189353, "episode_reward_min": -817.3660330485478, "time_total_s": 3676.0209741592407, "iterations_since_restore": 118, "custom_metrics": {"cost1_max": 225.1503570433366, "outflow_rate_mean": 1216.5905886865737, "outflow_rate_min": 462.43348918263234, "cost2_max": -20.64803536698826, "cost2_min": -97.06757484301912, "outflow_rate_max": 1467.4377066724521, "system_level_velocity_min": 11.148578910942444, "system_level_velocity_max": 18.832542120937187, "cost1_min": 23.092731719228528, "cost2_mean": -83.56758790022525, "system_level_velocity_mean": 15.004027657203943, "cost1_mean": 176.77909114619814}, "timesteps_since_restore": 5184528, "episodes_this_iter": 48, "training_iteration": 118, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44625, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140f60>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5479, "info": {"load_time_ms": 7.777, "default": {"vf_explained_var": 0.8830147981643677, "total_loss": 26.882986068725586, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2183010578155518, "policy_loss": -0.010705986060202122, "cur_lr": 0.0005000000237487257, "kl": 0.01556274015456438, "vf_loss": 26.88902473449707}, "num_steps_trained": 5184528, "update_time_ms": 8.874, "num_steps_sampled": 5184528, "grad_time_ms": 10928.45, "sample_time_ms": 20162.986}}
{"time_this_iter_s": 31.609317302703857, "timesteps_total": 5229905, "num_metric_batches_dropped": 0, "timestamp": 1558577655, "time_since_restore": 3707.6302914619446, "episode_reward_max": -29.33848956867781, "hostname": "flow-main", "episode_len_mean": 322.1, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-14-15", "episode_reward_mean": -570.601010484789, "episode_reward_min": -811.5144862519744, "time_total_s": 3707.6302914619446, "iterations_since_restore": 119, "custom_metrics": {"cost1_max": 226.0682440098445, "outflow_rate_mean": 1204.1012404780586, "outflow_rate_min": 462.43348918263234, "cost2_max": -20.64803536698826, "cost2_min": -97.81600966032778, "outflow_rate_max": 1466.8943322573382, "system_level_velocity_min": 11.148578910942444, "system_level_velocity_max": 18.873635098923064, "cost1_min": 23.092731719228528, "cost2_mean": -83.99587269024705, "system_level_velocity_mean": 14.75964817393281, "cost1_mean": 174.49521797341222}, "timesteps_since_restore": 5229905, "episodes_this_iter": 43, "training_iteration": 119, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45377, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91330f0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5522, "info": {"load_time_ms": 8.07, "default": {"vf_explained_var": 0.8924146890640259, "total_loss": 25.501039505004883, "cur_kl_coeff": 0.29999998211860657, "entropy": 1.2248879671096802, "policy_loss": -0.010194186121225357, "cur_lr": 0.0005000000237487257, "kl": 0.015807272866368294, "vf_loss": 25.506494522094727}, "num_steps_trained": 5229905, "update_time_ms": 9.046, "num_steps_sampled": 5229905, "grad_time_ms": 11145.572, "sample_time_ms": 20146.725}}
{"time_this_iter_s": 30.000410556793213, "timesteps_total": 5273680, "num_metric_batches_dropped": 0, "timestamp": 1558577685, "time_since_restore": 3737.630702018738, "episode_reward_max": -28.660755684714832, "hostname": "flow-main", "episode_len_mean": 322.1, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-14-45", "episode_reward_mean": -565.6001303588732, "episode_reward_min": -811.270272040264, "time_total_s": 3737.630702018738, "iterations_since_restore": 120, "custom_metrics": {"cost1_max": 226.0682440098445, "outflow_rate_mean": 1207.6192299756826, "outflow_rate_min": 494.93822963381507, "cost2_max": -16.331874276578525, "cost2_min": -99.63093313342293, "outflow_rate_max": 1471.6839323310385, "system_level_velocity_min": 11.538459436305546, "system_level_velocity_max": 18.901347682019843, "cost1_min": 23.161226377849793, "cost2_mean": -82.87344299243603, "system_level_velocity_mean": 14.889476629361758, "cost1_mean": 175.91703657162572}, "timesteps_since_restore": 5273680, "episodes_this_iter": 47, "training_iteration": 120, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43775, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912beb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bf60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b4a8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5569, "info": {"load_time_ms": 7.781, "default": {"vf_explained_var": 0.8804189562797546, "total_loss": 27.581369400024414, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.194460153579712, "policy_loss": -0.009686768986284733, "cur_lr": 0.0005000000237487257, "kl": 0.01592594012618065, "vf_loss": 27.586278915405273}, "num_steps_trained": 5273680, "update_time_ms": 9.122, "num_steps_sampled": 5273680, "grad_time_ms": 11274.921, "sample_time_ms": 19956.235}}
{"time_this_iter_s": 31.355303049087524, "timesteps_total": 5317907, "num_metric_batches_dropped": 0, "timestamp": 1558577716, "time_since_restore": 3768.9860050678253, "episode_reward_max": -28.660755684714832, "hostname": "flow-main", "episode_len_mean": 322.1, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-15-16", "episode_reward_mean": -557.7630181211384, "episode_reward_min": -837.3824469725887, "time_total_s": 3768.9860050678253, "iterations_since_restore": 121, "custom_metrics": {"cost1_max": 225.24473985686382, "outflow_rate_mean": 1215.586121161686, "outflow_rate_min": 494.93822963381507, "cost2_max": -16.331874276578525, "cost2_min": -99.63093313342293, "outflow_rate_max": 1471.6839323310385, "system_level_velocity_min": 11.538459436305546, "system_level_velocity_max": 18.901347682019843, "cost1_min": 23.161226377849793, "cost2_mean": -82.32329991653447, "system_level_velocity_mean": 14.972603871375263, "cost1_mean": 177.060405995627}, "timesteps_since_restore": 5317907, "episodes_this_iter": 50, "training_iteration": 121, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44227, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133898>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5619, "info": {"load_time_ms": 7.684, "default": {"vf_explained_var": 0.8597598075866699, "total_loss": 30.943775177001953, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2171133756637573, "policy_loss": -0.009011375717818737, "cur_lr": 0.0005000000237487257, "kl": 0.015084167011082172, "vf_loss": 30.948261260986328}, "num_steps_trained": 5317907, "update_time_ms": 9.126, "num_steps_sampled": 5317907, "grad_time_ms": 11467.965, "sample_time_ms": 19855.019}}
{"time_this_iter_s": 30.125598430633545, "timesteps_total": 5361981, "num_metric_batches_dropped": 0, "timestamp": 1558577746, "time_since_restore": 3799.111603498459, "episode_reward_max": -28.660755684714832, "hostname": "flow-main", "episode_len_mean": 320.12, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-15-46", "episode_reward_mean": -544.8155129784341, "episode_reward_min": -837.3824469725887, "time_total_s": 3799.111603498459, "iterations_since_restore": 122, "custom_metrics": {"cost1_max": 224.80184236258597, "outflow_rate_mean": 1218.806734514814, "outflow_rate_min": 494.93822963381507, "cost2_max": -16.331874276578525, "cost2_min": -101.8602194722328, "outflow_rate_max": 1463.0223582432754, "system_level_velocity_min": 10.982329636027126, "system_level_velocity_max": 18.79948311719753, "cost1_min": 23.161226377849793, "cost2_mean": -82.92741509858732, "system_level_velocity_mean": 15.05873767289893, "cost1_mean": 176.9703275062457}, "timesteps_since_restore": 5361981, "episodes_this_iter": 44, "training_iteration": 122, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44074, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91339e8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5663, "info": {"load_time_ms": 7.683, "default": {"vf_explained_var": 0.8902694582939148, "total_loss": 24.205907821655273, "cur_kl_coeff": 0.29999998211860657, "entropy": 1.178842306137085, "policy_loss": -0.010100685991346836, "cur_lr": 0.0005000000237487257, "kl": 0.015532121993601322, "vf_loss": 24.211345672607422}, "num_steps_trained": 5361981, "update_time_ms": 8.974, "num_steps_sampled": 5361981, "grad_time_ms": 11730.231, "sample_time_ms": 19657.902}}
{"time_this_iter_s": 32.48361587524414, "timesteps_total": 5405579, "num_metric_batches_dropped": 0, "timestamp": 1558577779, "time_since_restore": 3831.595219373703, "episode_reward_max": -103.40428508389662, "hostname": "flow-main", "episode_len_mean": 323.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-16-19", "episode_reward_mean": -540.4511905480146, "episode_reward_min": -817.205378469713, "time_total_s": 3831.595219373703, "iterations_since_restore": 123, "custom_metrics": {"cost1_max": 226.38975046295513, "outflow_rate_mean": 1232.40949543968, "outflow_rate_min": 814.0339879799526, "cost2_max": -52.59952675922804, "cost2_min": -101.8602194722328, "outflow_rate_max": 1471.943128826776, "system_level_velocity_min": 10.982329636027126, "system_level_velocity_max": 18.950504256803264, "cost1_min": 87.23341182958049, "cost2_mean": -84.84185552718276, "system_level_velocity_mean": 15.184133568151328, "cost1_mean": 180.36482875296352}, "timesteps_since_restore": 5405579, "episodes_this_iter": 46, "training_iteration": 123, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43598, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140fd0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5709, "info": {"load_time_ms": 7.609, "default": {"vf_explained_var": 0.8737499713897705, "total_loss": 28.143917083740234, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.1880627870559692, "policy_loss": -0.011220285668969154, "cur_lr": 0.0005000000237487257, "kl": 0.015634825453162193, "vf_loss": 28.150447845458984}, "num_steps_trained": 5405579, "update_time_ms": 8.903, "num_steps_sampled": 5405579, "grad_time_ms": 12051.698, "sample_time_ms": 19535.625}}
{"time_this_iter_s": 31.749150276184082, "timesteps_total": 5449948, "num_metric_batches_dropped": 0, "timestamp": 1558577811, "time_since_restore": 3863.344369649887, "episode_reward_max": -103.40428508389662, "hostname": "flow-main", "episode_len_mean": 323.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-16-51", "episode_reward_mean": -541.929286953574, "episode_reward_min": -797.4791021973231, "time_total_s": 3863.344369649887, "iterations_since_restore": 124, "custom_metrics": {"cost1_max": 226.52230717169002, "outflow_rate_mean": 1235.965163208422, "outflow_rate_min": 814.0339879799526, "cost2_max": -52.59952675922804, "cost2_min": -101.8602194722328, "outflow_rate_max": 1471.943128826776, "system_level_velocity_min": 11.630331745330702, "system_level_velocity_max": 19.007765278625122, "cost1_min": 87.23341182958049, "cost2_mean": -85.45827405947887, "system_level_velocity_mean": 15.207382353908931, "cost1_mean": 180.48150822828876}, "timesteps_since_restore": 5449948, "episodes_this_iter": 47, "training_iteration": 124, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44369, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143c18>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5756, "info": {"load_time_ms": 7.598, "default": {"vf_explained_var": 0.8873828053474426, "total_loss": 25.502574920654297, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.1936122179031372, "policy_loss": -0.009706569835543633, "cur_lr": 0.0005000000237487257, "kl": 0.01719742827117443, "vf_loss": 25.507123947143555}, "num_steps_trained": 5449948, "update_time_ms": 8.626, "num_steps_sampled": 5449948, "grad_time_ms": 11935.36, "sample_time_ms": 19553.996}}
{"time_this_iter_s": 30.747965335845947, "timesteps_total": 5493706, "num_metric_batches_dropped": 0, "timestamp": 1558577841, "time_since_restore": 3894.092334985733, "episode_reward_max": -103.50258156407877, "hostname": "flow-main", "episode_len_mean": 322.83, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-17-21", "episode_reward_mean": -537.6616403176171, "episode_reward_min": -773.9640539192573, "time_total_s": 3894.092334985733, "iterations_since_restore": 125, "custom_metrics": {"cost1_max": 226.7733724196268, "outflow_rate_mean": 1239.0150559491904, "outflow_rate_min": 811.838858823264, "cost2_max": -50.804626995322415, "cost2_min": -96.37988531340915, "outflow_rate_max": 1471.943128826776, "system_level_velocity_min": 11.05601887369208, "system_level_velocity_max": 19.007765278625122, "cost1_min": 87.26182777350813, "cost2_mean": -85.15657202333446, "system_level_velocity_mean": 15.257770491365703, "cost1_mean": 180.85828629016746}, "timesteps_since_restore": 5493706, "episodes_this_iter": 48, "training_iteration": 125, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43758, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ab00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ac50>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5804, "info": {"load_time_ms": 7.733, "default": {"vf_explained_var": 0.873543381690979, "total_loss": 27.554105758666992, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.1781809329986572, "policy_loss": -0.009578320197761059, "cur_lr": 0.0005000000237487257, "kl": 0.015406628139317036, "vf_loss": 27.55906105041504}, "num_steps_trained": 5493706, "update_time_ms": 8.531, "num_steps_sampled": 5493706, "grad_time_ms": 11927.39, "sample_time_ms": 19524.04}}
{"time_this_iter_s": 30.872049808502197, "timesteps_total": 5538752, "num_metric_batches_dropped": 0, "timestamp": 1558577872, "time_since_restore": 3924.9643847942352, "episode_reward_max": -103.50258156407877, "hostname": "flow-main", "episode_len_mean": 322.83, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-17-52", "episode_reward_mean": -566.5590656321402, "episode_reward_min": -812.3385573732232, "time_total_s": 3924.9643847942352, "iterations_since_restore": 126, "custom_metrics": {"cost1_max": 226.7733724196268, "outflow_rate_mean": 1220.9701885976078, "outflow_rate_min": 811.838858823264, "cost2_max": -50.804626995322415, "cost2_min": -96.52491573573585, "outflow_rate_max": 1469.3508177756773, "system_level_velocity_min": 11.05601887369208, "system_level_velocity_max": 18.971493074941606, "cost1_min": 87.26182777350813, "cost2_mean": -84.93918186720734, "system_level_velocity_mean": 14.840937807822465, "cost1_mean": 176.15751481607424}, "timesteps_since_restore": 5538752, "episodes_this_iter": 44, "training_iteration": 126, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45046, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9121908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a90fafd0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5848, "info": {"load_time_ms": 7.879, "default": {"vf_explained_var": 0.8955255746841431, "total_loss": 22.901155471801758, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2005597352981567, "policy_loss": -0.010781274177134037, "cur_lr": 0.0005000000237487257, "kl": 0.01584860496222973, "vf_loss": 22.907180786132812}, "num_steps_trained": 5538752, "update_time_ms": 8.502, "num_steps_sampled": 5538752, "grad_time_ms": 11923.962, "sample_time_ms": 19585.482}}
{"time_this_iter_s": 31.624964237213135, "timesteps_total": 5582289, "num_metric_batches_dropped": 0, "timestamp": 1558577904, "time_since_restore": 3956.5893490314484, "episode_reward_max": -179.4531929516889, "hostname": "flow-main", "episode_len_mean": 323.93, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-18-24", "episode_reward_mean": -552.2513096068186, "episode_reward_min": -841.2787494291922, "time_total_s": 3956.5893490314484, "iterations_since_restore": 127, "custom_metrics": {"cost1_max": 227.00569074589052, "outflow_rate_mean": 1234.4082000753615, "outflow_rate_min": 1014.3474548127176, "cost2_max": -66.64437715794152, "cost2_min": -97.94653686975978, "outflow_rate_max": 1472.165344004648, "system_level_velocity_min": 11.264501985397347, "system_level_velocity_max": 19.02405706422814, "cost1_min": 133.95349533718598, "cost2_mean": -86.96593898469635, "system_level_velocity_mean": 15.0851920943741, "cost1_mean": 179.79195221332415}, "timesteps_since_restore": 5582289, "episodes_this_iter": 46, "training_iteration": 127, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43537, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140b00>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5894, "info": {"load_time_ms": 7.735, "default": {"vf_explained_var": 0.8880172967910767, "total_loss": 25.028974533081055, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.156769037246704, "policy_loss": -0.009796504862606525, "cur_lr": 0.0005000000237487257, "kl": 0.01683705300092697, "vf_loss": 25.033720016479492}, "num_steps_trained": 5582289, "update_time_ms": 8.248, "num_steps_sampled": 5582289, "grad_time_ms": 11878.851, "sample_time_ms": 19563.27}}
{"time_this_iter_s": 31.851863861083984, "timesteps_total": 5625207, "num_metric_batches_dropped": 0, "timestamp": 1558577936, "time_since_restore": 3988.4412128925323, "episode_reward_max": -179.4531929516889, "hostname": "flow-main", "episode_len_mean": 323.93, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-18-56", "episode_reward_mean": -516.4652196865941, "episode_reward_min": -841.2787494291922, "time_total_s": 3988.4412128925323, "iterations_since_restore": 128, "custom_metrics": {"cost1_max": 227.00569074589052, "outflow_rate_mean": 1259.6675976850381, "outflow_rate_min": 1014.3474548127176, "cost2_max": -73.37136327520643, "cost2_min": -97.98886987326588, "outflow_rate_max": 1472.165344004648, "system_level_velocity_min": 11.605184662080184, "system_level_velocity_max": 19.02405706422814, "cost1_min": 137.91875591848535, "cost2_mean": -88.44621289902646, "system_level_velocity_mean": 15.638153852470142, "cost1_mean": 186.33117665211665}, "timesteps_since_restore": 5625207, "episodes_this_iter": 50, "training_iteration": 128, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 42918, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91488d0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5944, "info": {"load_time_ms": 7.618, "default": {"vf_explained_var": 0.8866846561431885, "total_loss": 23.868627548217773, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.1498684883117676, "policy_loss": -0.009270315989851952, "cur_lr": 0.0005000000237487257, "kl": 0.015084272250533104, "vf_loss": 23.87337303161621}, "num_steps_trained": 5625207, "update_time_ms": 8.251, "num_steps_sampled": 5625207, "grad_time_ms": 11821.007, "sample_time_ms": 19317.858}}
{"time_this_iter_s": 29.780174016952515, "timesteps_total": 5669455, "num_metric_batches_dropped": 0, "timestamp": 1558577966, "time_since_restore": 4018.221386909485, "episode_reward_max": -21.428606983344757, "hostname": "flow-main", "episode_len_mean": 322.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-19-26", "episode_reward_mean": -534.4427857152626, "episode_reward_min": -824.8504562320164, "time_total_s": 4018.221386909485, "iterations_since_restore": 129, "custom_metrics": {"cost1_max": 226.14426301417632, "outflow_rate_mean": 1239.541654988822, "outflow_rate_min": 474.3699846082663, "cost2_max": -11.539453041366581, "cost2_min": -98.27485218916812, "outflow_rate_max": 1470.6929275534098, "system_level_velocity_min": 11.605184662080184, "system_level_velocity_max": 18.925297295427555, "cost1_min": 17.809977451025283, "cost2_mean": -86.28726925891843, "system_level_velocity_mean": 15.301682492523158, "cost1_mean": 181.1318014037815}, "timesteps_since_restore": 5669455, "episodes_this_iter": 43, "training_iteration": 129, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44248, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91487b8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 5987, "info": {"load_time_ms": 7.284, "default": {"vf_explained_var": 0.8952039480209351, "total_loss": 22.639816284179688, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.1743212938308716, "policy_loss": -0.0111857820302248, "cur_lr": 0.0005000000237487257, "kl": 0.015129095874726772, "vf_loss": 22.646461486816406}, "num_steps_trained": 5669455, "update_time_ms": 8.132, "num_steps_sampled": 5669455, "grad_time_ms": 11767.343, "sample_time_ms": 19187.551}}
{"time_this_iter_s": 31.359052896499634, "timesteps_total": 5714111, "num_metric_batches_dropped": 0, "timestamp": 1558577997, "time_since_restore": 4049.5804398059845, "episode_reward_max": -21.428606983344757, "hostname": "flow-main", "episode_len_mean": 315.94, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-19-57", "episode_reward_mean": -529.0831841191441, "episode_reward_min": -826.7931269643677, "time_total_s": 4049.5804398059845, "iterations_since_restore": 130, "custom_metrics": {"cost1_max": 226.49357929823896, "outflow_rate_mean": 1220.6198408063437, "outflow_rate_min": 462.43348918263234, "cost2_max": -11.539453041366581, "cost2_min": -98.27485218916812, "outflow_rate_max": 1469.4117755647405, "system_level_velocity_min": 10.66213163121276, "system_level_velocity_max": 19.2923783512574, "cost1_min": 17.809977451025283, "cost2_mean": -83.97553489204134, "system_level_velocity_mean": 15.29324951507706, "cost1_mean": 176.71276053843096}, "timesteps_since_restore": 5714111, "episodes_this_iter": 48, "training_iteration": 130, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44656, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91432e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140898>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6035, "info": {"load_time_ms": 7.217, "default": {"vf_explained_var": 0.9044345617294312, "total_loss": 21.278413772583008, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.22208571434021, "policy_loss": -0.010331100784242153, "cur_lr": 0.0005000000237487257, "kl": 0.01584404706954956, "vf_loss": 21.28399085998535}, "num_steps_trained": 5714111, "update_time_ms": 8.348, "num_steps_sampled": 5714111, "grad_time_ms": 11816.093, "sample_time_ms": 19273.313}}
{"time_this_iter_s": 33.48171043395996, "timesteps_total": 5758621, "num_metric_batches_dropped": 0, "timestamp": 1558578031, "time_since_restore": 4083.0621502399445, "episode_reward_max": -29.407470923274257, "hostname": "flow-main", "episode_len_mean": 318.64, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-20-31", "episode_reward_mean": -549.4289797040096, "episode_reward_min": -826.7931269643677, "time_total_s": 4083.0621502399445, "iterations_since_restore": 131, "custom_metrics": {"cost1_max": 226.49357929823896, "outflow_rate_mean": 1216.644588029094, "outflow_rate_min": 462.43348918263234, "cost2_max": -20.309754354367286, "cost2_min": -98.03207924459689, "outflow_rate_max": 1469.4117755647405, "system_level_velocity_min": 10.66213163121276, "system_level_velocity_max": 19.2923783512574, "cost1_min": 23.050085114502224, "cost2_mean": -83.82132624500454, "system_level_velocity_mean": 15.09836332938511, "cost1_mean": 176.06177282836572}, "timesteps_since_restore": 5758621, "episodes_this_iter": 50, "training_iteration": 131, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44510, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148ef0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6085, "info": {"load_time_ms": 7.281, "default": {"vf_explained_var": 0.8770834803581238, "total_loss": 27.645912170410156, "cur_kl_coeff": 0.29999998211860657, "entropy": 1.2167928218841553, "policy_loss": -0.00969016831368208, "cur_lr": 0.0005000000237487257, "kl": 0.014788228087127209, "vf_loss": 27.651166915893555}, "num_steps_trained": 5758621, "update_time_ms": 8.344, "num_steps_sampled": 5758621, "grad_time_ms": 11969.809, "sample_time_ms": 19332.121}}
{"time_this_iter_s": 30.734987497329712, "timesteps_total": 5802660, "num_metric_batches_dropped": 0, "timestamp": 1558578061, "time_since_restore": 4113.797137737274, "episode_reward_max": -21.25540092394498, "hostname": "flow-main", "episode_len_mean": 321.74, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-21-01", "episode_reward_mean": -564.5691497622312, "episode_reward_min": -822.9761077867412, "time_total_s": 4113.797137737274, "iterations_since_restore": 132, "custom_metrics": {"cost1_max": 227.3572587889349, "outflow_rate_mean": 1218.6758695387466, "outflow_rate_min": 462.55509215489616, "cost2_max": -16.24123683934758, "cost2_min": -98.03207924459689, "outflow_rate_max": 1472.4450402764621, "system_level_velocity_min": 11.174113169008498, "system_level_velocity_max": 19.104337290044704, "cost1_min": 18.207361177421756, "cost2_mean": -83.46750364482268, "system_level_velocity_mean": 14.886770998246085, "cost1_mean": 175.84796238680715}, "timesteps_since_restore": 5802660, "episodes_this_iter": 44, "training_iteration": 132, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44039, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140438>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6129, "info": {"load_time_ms": 7.361, "default": {"vf_explained_var": 0.892620325088501, "total_loss": 23.843358993530273, "cur_kl_coeff": 0.29999998211860657, "entropy": 1.2320458889007568, "policy_loss": -0.010464409366250038, "cur_lr": 0.0005000000237487257, "kl": 0.01663120649755001, "vf_loss": 23.848834991455078}, "num_steps_trained": 5802660, "update_time_ms": 8.21, "num_steps_sampled": 5802660, "grad_time_ms": 11957.056, "sample_time_ms": 19406.634}}
{"time_this_iter_s": 31.178244829177856, "timesteps_total": 5847206, "num_metric_batches_dropped": 0, "timestamp": 1558578093, "time_since_restore": 4144.975382566452, "episode_reward_max": -21.25540092394498, "hostname": "flow-main", "episode_len_mean": 322.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-21-33", "episode_reward_mean": -557.9593420024015, "episode_reward_min": -816.6137652207763, "time_total_s": 4144.975382566452, "iterations_since_restore": 133, "custom_metrics": {"cost1_max": 227.3572587889349, "outflow_rate_mean": 1223.2716973821405, "outflow_rate_min": 462.55509215489616, "cost2_max": -16.24123683934758, "cost2_min": -98.03207924459689, "outflow_rate_max": 1472.4450402764621, "system_level_velocity_min": 11.174113169008498, "system_level_velocity_max": 19.104337290044704, "cost1_min": 18.207361177421756, "cost2_mean": -84.09598620716625, "system_level_velocity_mean": 15.014012101117064, "cost1_mean": 177.48226285631154}, "timesteps_since_restore": 5847206, "episodes_this_iter": 45, "training_iteration": 133, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44546, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143eb8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6174, "info": {"load_time_ms": 7.504, "default": {"vf_explained_var": 0.8862200975418091, "total_loss": 26.120630264282227, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.202914834022522, "policy_loss": -0.009149051271378994, "cur_lr": 0.0005000000237487257, "kl": 0.014787498861551285, "vf_loss": 26.125341415405273}, "num_steps_trained": 5847206, "update_time_ms": 8.257, "num_steps_sampled": 5847206, "grad_time_ms": 11826.027, "sample_time_ms": 19406.247}}
{"time_this_iter_s": 31.89485788345337, "timesteps_total": 5892113, "num_metric_batches_dropped": 0, "timestamp": 1558578124, "time_since_restore": 4176.870240449905, "episode_reward_max": -111.3445636251772, "hostname": "flow-main", "episode_len_mean": 323.03, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-22-04", "episode_reward_mean": -546.3947709811854, "episode_reward_min": -792.9811628983225, "time_total_s": 4176.870240449905, "iterations_since_restore": 134, "custom_metrics": {"cost1_max": 226.49947187510782, "outflow_rate_mean": 1235.5673754340255, "outflow_rate_min": 779.3336832891193, "cost2_max": -54.277671387498586, "cost2_min": -96.61459862768884, "outflow_rate_max": 1469.3802037250312, "system_level_velocity_min": 11.433133610776467, "system_level_velocity_max": 18.952023202165634, "cost1_min": 86.56189503328497, "cost2_mean": -86.67195198161821, "system_level_velocity_mean": 15.266040459270043, "cost1_mean": 181.14944069280418}, "timesteps_since_restore": 5892113, "episodes_this_iter": 50, "training_iteration": 134, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44907, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91489e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148828>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6224, "info": {"load_time_ms": 7.374, "default": {"vf_explained_var": 0.8718498945236206, "total_loss": 28.188783645629883, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2175427675247192, "policy_loss": -0.011269421316683292, "cur_lr": 0.0005000000237487257, "kl": 0.016666429117321968, "vf_loss": 28.195053100585938}, "num_steps_trained": 5892113, "update_time_ms": 8.154, "num_steps_sampled": 5892113, "grad_time_ms": 11832.846, "sample_time_ms": 19413.543}}
{"time_this_iter_s": 30.454969882965088, "timesteps_total": 5935721, "num_metric_batches_dropped": 0, "timestamp": 1558578155, "time_since_restore": 4207.3252103328705, "episode_reward_max": -111.3445636251772, "hostname": "flow-main", "episode_len_mean": 323.03, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-22-35", "episode_reward_mean": -545.5450009632676, "episode_reward_min": -814.4701909387948, "time_total_s": 4207.3252103328705, "iterations_since_restore": 135, "custom_metrics": {"cost1_max": 225.87368950604832, "outflow_rate_mean": 1237.477167384441, "outflow_rate_min": 779.3336832891193, "cost2_max": -54.277671387498586, "cost2_min": -99.39977165897365, "outflow_rate_max": 1468.7988919810348, "system_level_velocity_min": 11.397715510984087, "system_level_velocity_max": 18.909141215486716, "cost1_min": 86.56189503328497, "cost2_mean": -87.1658245364634, "system_level_velocity_mean": 15.260889097451921, "cost1_mean": 181.17978512364647}, "timesteps_since_restore": 5935721, "episodes_this_iter": 44, "training_iteration": 135, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43608, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91404e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91482b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91488d0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6268, "info": {"load_time_ms": 7.045, "default": {"vf_explained_var": 0.8938124775886536, "total_loss": 23.333812713623047, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.1832727193832397, "policy_loss": -0.010700312443077564, "cur_lr": 0.0005000000237487257, "kl": 0.016184480860829353, "vf_loss": 23.339656829833984}, "num_steps_trained": 5935721, "update_time_ms": 8.332, "num_steps_sampled": 5935721, "grad_time_ms": 11793.683, "sample_time_ms": 19424.457}}
{"time_this_iter_s": 34.69175100326538, "timesteps_total": 5982139, "num_metric_batches_dropped": 0, "timestamp": 1558578190, "time_since_restore": 4242.016961336136, "episode_reward_max": -22.095055762885014, "hostname": "flow-main", "episode_len_mean": 318.06, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-23-10", "episode_reward_mean": -557.0161966375939, "episode_reward_min": -1064.7901738668988, "time_total_s": 4242.016961336136, "iterations_since_restore": 136, "custom_metrics": {"cost1_max": 225.87368950604832, "outflow_rate_mean": 1206.2969363710351, "outflow_rate_min": 444.6769763958757, "cost2_max": -16.696344601483343, "cost2_min": -99.39977165897365, "outflow_rate_max": 1468.507489850455, "system_level_velocity_min": 7.13968776074689, "system_level_velocity_max": 18.909141215486716, "cost1_min": 18.1385546019889, "cost2_mean": -84.74314896579405, "system_level_velocity_mean": 15.05259589673719, "cost1_mean": 175.38854130303417}, "timesteps_since_restore": 5982139, "episodes_this_iter": 49, "training_iteration": 136, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 46418, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148908>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6317, "info": {"load_time_ms": 6.928, "default": {"vf_explained_var": 0.8740541338920593, "total_loss": 28.1962890625, "cur_kl_coeff": 0.29999998211860657, "entropy": 1.2614171504974365, "policy_loss": -0.010570039972662926, "cur_lr": 0.0005000000237487257, "kl": 0.015822414308786392, "vf_loss": 28.202110290527344}, "num_steps_trained": 5982139, "update_time_ms": 8.349, "num_steps_sampled": 5982139, "grad_time_ms": 11991.469, "sample_time_ms": 19607.674}}
{"time_this_iter_s": 32.29630661010742, "timesteps_total": 6026906, "num_metric_batches_dropped": 0, "timestamp": 1558578222, "time_since_restore": 4274.313267946243, "episode_reward_max": -22.095055762885014, "hostname": "flow-main", "episode_len_mean": 318.06, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-23-42", "episode_reward_mean": -576.927056907502, "episode_reward_min": -1064.7901738668988, "time_total_s": 4274.313267946243, "iterations_since_restore": 137, "custom_metrics": {"cost1_max": 224.90924519295953, "outflow_rate_mean": 1190.748062853298, "outflow_rate_min": 444.6769763958757, "cost2_max": -16.696344601483343, "cost2_min": -97.10547617630421, "outflow_rate_max": 1464.7371499835344, "system_level_velocity_min": 7.13968776074689, "system_level_velocity_max": 18.863886307106608, "cost1_min": 18.1385546019889, "cost2_mean": -83.55013254944123, "system_level_velocity_mean": 14.789957950152946, "cost1_mean": 172.0860633842962}, "timesteps_since_restore": 6026906, "episodes_this_iter": 48, "training_iteration": 137, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44767, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91484a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91489e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148a20>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6365, "info": {"load_time_ms": 6.962, "default": {"vf_explained_var": 0.900526762008667, "total_loss": 22.521648406982422, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2263977527618408, "policy_loss": -0.01048173289746046, "cur_lr": 0.0005000000237487257, "kl": 0.015519645065069199, "vf_loss": 22.52747344970703}, "num_steps_trained": 6026906, "update_time_ms": 8.69, "num_steps_sampled": 6026906, "grad_time_ms": 11978.201, "sample_time_ms": 19688.448}}
{"time_this_iter_s": 30.69842219352722, "timesteps_total": 6070620, "num_metric_batches_dropped": 0, "timestamp": 1558578253, "time_since_restore": 4305.0116901397705, "episode_reward_max": -20.462243250207, "hostname": "flow-main", "episode_len_mean": 322.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-24-13", "episode_reward_mean": -555.3109463279651, "episode_reward_min": -990.3098024627934, "time_total_s": 4305.0116901397705, "iterations_since_restore": 138, "custom_metrics": {"cost1_max": 225.1772523246987, "outflow_rate_mean": 1221.5997370847729, "outflow_rate_min": 492.0625426222078, "cost2_max": -14.823869787691153, "cost2_min": -97.10547617630421, "outflow_rate_max": 1468.8499852590915, "system_level_velocity_min": 10.777328019922038, "system_level_velocity_max": 18.872688137772663, "cost1_min": 18.084219838684536, "cost2_mean": -84.21168636969833, "system_level_velocity_mean": 15.094713871471203, "cost1_mean": 178.53655604573862}, "timesteps_since_restore": 6070620, "episodes_this_iter": 46, "training_iteration": 138, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43714, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148c50>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6411, "info": {"load_time_ms": 6.998, "default": {"vf_explained_var": 0.8816544413566589, "total_loss": 25.372325897216797, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2155261039733887, "policy_loss": -0.010807412676513195, "cur_lr": 0.0005000000237487257, "kl": 0.01516992412507534, "vf_loss": 25.37858009338379}, "num_steps_trained": 6070620, "update_time_ms": 8.598, "num_steps_sampled": 6070620, "grad_time_ms": 11803.712, "sample_time_ms": 19747.86}}
{"time_this_iter_s": 31.07026171684265, "timesteps_total": 6115443, "num_metric_batches_dropped": 0, "timestamp": 1558578284, "time_since_restore": 4336.081951856613, "episode_reward_max": -20.462243250207, "hostname": "flow-main", "episode_len_mean": 319.94, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-24-44", "episode_reward_mean": -545.1270706993623, "episode_reward_min": -847.4965343852427, "time_total_s": 4336.081951856613, "iterations_since_restore": 139, "custom_metrics": {"cost1_max": 225.1772523246987, "outflow_rate_mean": 1223.3102843101392, "outflow_rate_min": 492.0625426222078, "cost2_max": -14.823869787691153, "cost2_min": -96.31502783876954, "outflow_rate_max": 1468.8499852590915, "system_level_velocity_min": 10.777328019922038, "system_level_velocity_max": 18.872688137772663, "cost1_min": 18.084219838684536, "cost2_mean": -84.24106102211553, "system_level_velocity_mean": 15.165161450407687, "cost1_mean": 177.89402140631145}, "timesteps_since_restore": 6115443, "episodes_this_iter": 46, "training_iteration": 139, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44823, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91484e0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6457, "info": {"load_time_ms": 7.003, "default": {"vf_explained_var": 0.8959382772445679, "total_loss": 22.520700454711914, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2121936082839966, "policy_loss": -0.009565353393554688, "cur_lr": 0.0005000000237487257, "kl": 0.015673160552978516, "vf_loss": 22.525564193725586}, "num_steps_trained": 6115443, "update_time_ms": 8.525, "num_steps_sampled": 6115443, "grad_time_ms": 11725.806, "sample_time_ms": 19955.581}}
{"time_this_iter_s": 30.214927196502686, "timesteps_total": 6160199, "num_metric_batches_dropped": 0, "timestamp": 1558578314, "time_since_restore": 4366.296879053116, "episode_reward_max": -20.462243250207, "hostname": "flow-main", "episode_len_mean": 316.96, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-25-14", "episode_reward_mean": -555.1146605923099, "episode_reward_min": -806.9475695241979, "time_total_s": 4366.296879053116, "iterations_since_restore": 140, "custom_metrics": {"cost1_max": 225.89682452869368, "outflow_rate_mean": 1202.2246709346657, "outflow_rate_min": 483.934671032216, "cost2_max": -13.43276485916165, "cost2_min": -95.37386704615962, "outflow_rate_max": 1468.3962530921463, "system_level_velocity_min": 11.38105246888236, "system_level_velocity_max": 18.895205945718452, "cost1_min": 17.76814053267475, "cost2_mean": -83.42649297354055, "system_level_velocity_mean": 14.95925227525928, "cost1_mean": 173.5714641647023}, "timesteps_since_restore": 6160199, "episodes_this_iter": 45, "training_iteration": 140, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44756, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91489e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91484a8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6502, "info": {"load_time_ms": 7.176, "default": {"vf_explained_var": 0.8956748247146606, "total_loss": 22.394628524780273, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2469717264175415, "policy_loss": -0.012086589820683002, "cur_lr": 0.0005000000237487257, "kl": 0.018066946417093277, "vf_loss": 22.401296615600586}, "num_steps_trained": 6160199, "update_time_ms": 8.333, "num_steps_sampled": 6160199, "grad_time_ms": 11614.159, "sample_time_ms": 19954.767}}
{"time_this_iter_s": 30.667019367218018, "timesteps_total": 6204913, "num_metric_batches_dropped": 0, "timestamp": 1558578345, "time_since_restore": 4396.963898420334, "episode_reward_max": -22.30630182497398, "hostname": "flow-main", "episode_len_mean": 322.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-25-45", "episode_reward_mean": -564.6756806527567, "episode_reward_min": -994.6187962310264, "time_total_s": 4396.963898420334, "iterations_since_restore": 141, "custom_metrics": {"cost1_max": 225.89682452869368, "outflow_rate_mean": 1209.6815256116645, "outflow_rate_min": 483.934671032216, "cost2_max": -13.43276485916165, "cost2_min": -97.82117631781941, "outflow_rate_max": 1463.953307170351, "system_level_velocity_min": 11.38105246888236, "system_level_velocity_max": 18.895205945718452, "cost1_min": 17.76814053267475, "cost2_mean": -84.1689772479606, "system_level_velocity_mean": 14.972200101616151, "cost1_mean": 177.26870463081536}, "timesteps_since_restore": 6204913, "episodes_this_iter": 49, "training_iteration": 141, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44714, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148828>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6551, "info": {"load_time_ms": 6.982, "default": {"vf_explained_var": 0.8509661555290222, "total_loss": 31.602846145629883, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2309013605117798, "policy_loss": -0.011610256507992744, "cur_lr": 0.0005000000237487257, "kl": 0.01608297973871231, "vf_loss": 31.60962677001953}, "num_steps_trained": 6204913, "update_time_ms": 8.301, "num_steps_sampled": 6204913, "grad_time_ms": 11388.254, "sample_time_ms": 19899.635}}
{"time_this_iter_s": 30.689443111419678, "timesteps_total": 6249376, "num_metric_batches_dropped": 0, "timestamp": 1558578376, "time_since_restore": 4427.6533415317535, "episode_reward_max": -22.30630182497398, "hostname": "flow-main", "episode_len_mean": 322.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-26-16", "episode_reward_mean": -558.9363358735392, "episode_reward_min": -994.6187962310264, "time_total_s": 4427.6533415317535, "iterations_since_restore": 142, "custom_metrics": {"cost1_max": 225.0530012028893, "outflow_rate_mean": 1210.964548556742, "outflow_rate_min": 483.934671032216, "cost2_max": -13.43276485916165, "cost2_min": -97.82117631781941, "outflow_rate_max": 1464.2494573051406, "system_level_velocity_min": 11.83566217765544, "system_level_velocity_max": 18.860431389153174, "cost1_min": 17.76814053267475, "cost2_mean": -83.27181216824951, "system_level_velocity_mean": 15.06494038554813, "cost1_mean": 178.48931014951006}, "timesteps_since_restore": 6249376, "episodes_this_iter": 44, "training_iteration": 142, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44463, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b0b8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6595, "info": {"load_time_ms": 7.021, "default": {"vf_explained_var": 0.8812211751937866, "total_loss": 25.297048568725586, "cur_kl_coeff": 0.29999998211860657, "entropy": 1.2494018077850342, "policy_loss": -0.010224955156445503, "cur_lr": 0.0005000000237487257, "kl": 0.015954723581671715, "vf_loss": 25.302486419677734}, "num_steps_trained": 6249376, "update_time_ms": 8.428, "num_steps_sampled": 6249376, "grad_time_ms": 11342.714, "sample_time_ms": 19939.65}}
{"time_this_iter_s": 32.29242563247681, "timesteps_total": 6293286, "num_metric_batches_dropped": 0, "timestamp": 1558578408, "time_since_restore": 4459.94576716423, "episode_reward_max": -21.08591176441493, "hostname": "flow-main", "episode_len_mean": 317.94, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-26-48", "episode_reward_mean": -537.2515991477201, "episode_reward_min": -989.2831085785338, "time_total_s": 4459.94576716423, "iterations_since_restore": 143, "custom_metrics": {"cost1_max": 225.0530012028893, "outflow_rate_mean": 1213.4119660627805, "outflow_rate_min": 476.10320957347216, "cost2_max": -14.927651913288443, "cost2_min": -97.82117631781941, "outflow_rate_max": 1464.2494573051406, "system_level_velocity_min": 10.37355517103104, "system_level_velocity_max": 18.81541024230981, "cost1_min": 18.098924363924898, "cost2_mean": -81.60526872838136, "system_level_velocity_mean": 15.20768040243159, "cost1_mean": 177.48596556691533}, "timesteps_since_restore": 6293286, "episodes_this_iter": 50, "training_iteration": 143, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43910, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913ae10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a9b0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6645, "info": {"load_time_ms": 6.757, "default": {"vf_explained_var": 0.873860776424408, "total_loss": 28.019405364990234, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2547436952590942, "policy_loss": -0.011699345894157887, "cur_lr": 0.0005000000237487257, "kl": 0.015674017369747162, "vf_loss": 28.026397705078125}, "num_steps_trained": 6293286, "update_time_ms": 8.489, "num_steps_sampled": 6293286, "grad_time_ms": 11362.167, "sample_time_ms": 20029.93}}
{"time_this_iter_s": 31.427666425704956, "timesteps_total": 6338770, "num_metric_batches_dropped": 0, "timestamp": 1558578439, "time_since_restore": 4491.373433589935, "episode_reward_max": -21.08591176441493, "hostname": "flow-main", "episode_len_mean": 315.94, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-27-19", "episode_reward_mean": -548.808916277437, "episode_reward_min": -971.7545424264591, "time_total_s": 4491.373433589935, "iterations_since_restore": 144, "custom_metrics": {"cost1_max": 224.87399092151927, "outflow_rate_mean": 1197.6766555363681, "outflow_rate_min": 476.10320957347216, "cost2_max": -14.927651913288443, "cost2_min": -95.16078016332725, "outflow_rate_max": 1464.3779958561502, "system_level_velocity_min": 9.125345196699975, "system_level_velocity_max": 18.80337781290372, "cost1_min": 18.098924363924898, "cost2_mean": -80.54518891836796, "system_level_velocity_mean": 15.028276816762537, "cost1_mean": 173.7431284225694}, "timesteps_since_restore": 6338770, "episodes_this_iter": 49, "training_iteration": 144, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45484, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140668>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6694, "info": {"load_time_ms": 6.745, "default": {"vf_explained_var": 0.8902698159217834, "total_loss": 25.095895767211914, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2588956356048584, "policy_loss": -0.009342246688902378, "cur_lr": 0.0005000000237487257, "kl": 0.016143854707479477, "vf_loss": 25.100393295288086}, "num_steps_trained": 6338770, "update_time_ms": 8.688, "num_steps_sampled": 6338770, "grad_time_ms": 11342.256, "sample_time_ms": 20002.648}}
{"time_this_iter_s": 29.888481616973877, "timesteps_total": 6383521, "num_metric_batches_dropped": 0, "timestamp": 1558578469, "time_since_restore": 4521.261915206909, "episode_reward_max": -21.687530398676067, "hostname": "flow-main", "episode_len_mean": 318.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-27-49", "episode_reward_mean": -565.2988613132134, "episode_reward_min": -971.7545424264591, "time_total_s": 4521.261915206909, "iterations_since_restore": 145, "custom_metrics": {"cost1_max": 224.30266919174127, "outflow_rate_mean": 1194.4840970853772, "outflow_rate_min": 440.0050268646629, "cost2_max": -17.266594583182716, "cost2_min": -94.22310733714937, "outflow_rate_max": 1464.7749852590914, "system_level_velocity_min": 9.125345196699975, "system_level_velocity_max": 18.80337781290372, "cost1_min": 17.969963112816362, "cost2_mean": -80.91939887746094, "system_level_velocity_mean": 14.828455564682804, "cost1_mean": 172.71354130230054}, "timesteps_since_restore": 6383521, "episodes_this_iter": 45, "training_iteration": 145, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44751, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143f98>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6739, "info": {"load_time_ms": 6.785, "default": {"vf_explained_var": 0.8990265130996704, "total_loss": 23.67255401611328, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2351962327957153, "policy_loss": -0.010841581039130688, "cur_lr": 0.0005000000237487257, "kl": 0.015957757830619812, "vf_loss": 23.678607940673828}, "num_steps_trained": 6383521, "update_time_ms": 8.502, "num_steps_sampled": 6383521, "grad_time_ms": 11311.903, "sample_time_ms": 19974.742}}
{"time_this_iter_s": 31.602869272232056, "timesteps_total": 6428642, "num_metric_batches_dropped": 0, "timestamp": 1558578501, "time_since_restore": 4552.864784479141, "episode_reward_max": -21.687530398676067, "hostname": "flow-main", "episode_len_mean": 318.04, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-28-21", "episode_reward_mean": -570.8891353451149, "episode_reward_min": -852.9900968406284, "time_total_s": 4552.864784479141, "iterations_since_restore": 146, "custom_metrics": {"cost1_max": 224.30266919174127, "outflow_rate_mean": 1191.430898941533, "outflow_rate_min": 440.0050268646629, "cost2_max": -17.266594583182716, "cost2_min": -93.57094651701115, "outflow_rate_max": 1464.7749852590914, "system_level_velocity_min": 10.615299372413968, "system_level_velocity_max": 18.80337781290372, "cost1_min": 17.969963112816362, "cost2_mean": -81.0846562698101, "system_level_velocity_mean": 14.70298847492527, "cost1_mean": 171.41917105556706}, "timesteps_since_restore": 6428642, "episodes_this_iter": 46, "training_iteration": 146, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45121, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91480f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148cc0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6785, "info": {"load_time_ms": 6.899, "default": {"vf_explained_var": 0.8924140930175781, "total_loss": 24.982484817504883, "cur_kl_coeff": 0.29999998211860657, "entropy": 1.278241753578186, "policy_loss": -0.011511141434311867, "cur_lr": 0.0005000000237487257, "kl": 0.016019152477383614, "vf_loss": 24.98919105529785}, "num_steps_trained": 6428642, "update_time_ms": 8.508, "num_steps_sampled": 6428642, "grad_time_ms": 11134.256, "sample_time_ms": 19843.841}}
{"time_this_iter_s": 31.2472243309021, "timesteps_total": 6472629, "num_metric_batches_dropped": 0, "timestamp": 1558578532, "time_since_restore": 4584.112008810043, "episode_reward_max": -92.6033390051197, "hostname": "flow-main", "episode_len_mean": 317.84, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-28-52", "episode_reward_mean": -558.6024104065604, "episode_reward_min": -852.9900968406284, "time_total_s": 4584.112008810043, "iterations_since_restore": 147, "custom_metrics": {"cost1_max": 224.833327699749, "outflow_rate_mean": 1199.1798960682627, "outflow_rate_min": 772.3063052429276, "cost2_max": -48.50784939307442, "cost2_min": -95.07442514543004, "outflow_rate_max": 1463.777452530886, "system_level_velocity_min": 10.615299372413968, "system_level_velocity_max": 18.99836596115644, "cost1_min": 80.0836526162058, "cost2_mean": -81.62408498348617, "system_level_velocity_mean": 14.856567921844233, "cost1_mean": 172.84354515013922}, "timesteps_since_restore": 6472629, "episodes_this_iter": 49, "training_iteration": 147, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43987, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91406a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140048>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6834, "info": {"load_time_ms": 7.149, "default": {"vf_explained_var": 0.9042002558708191, "total_loss": 22.895376205444336, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2191351652145386, "policy_loss": -0.009983357973396778, "cur_lr": 0.0005000000237487257, "kl": 0.015647226944565773, "vf_loss": 22.900667190551758}, "num_steps_trained": 6472629, "update_time_ms": 8.25, "num_steps_sampled": 6472629, "grad_time_ms": 11061.009, "sample_time_ms": 19810.93}}
{"time_this_iter_s": 30.832003831863403, "timesteps_total": 6517437, "num_metric_batches_dropped": 0, "timestamp": 1558578563, "time_since_restore": 4614.944012641907, "episode_reward_max": -92.6033390051197, "hostname": "flow-main", "episode_len_mean": 317.84, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-29-23", "episode_reward_mean": -538.605740987005, "episode_reward_min": -837.8830685320975, "time_total_s": 4614.944012641907, "iterations_since_restore": 148, "custom_metrics": {"cost1_max": 224.833327699749, "outflow_rate_mean": 1216.63923042672, "outflow_rate_min": 772.3063052429276, "cost2_max": -48.50784939307442, "cost2_min": -95.07442514543004, "outflow_rate_max": 1463.777452530886, "system_level_velocity_min": 10.90836945098477, "system_level_velocity_max": 18.99836596115644, "cost1_min": 80.0836526162058, "cost2_mean": -82.02088619836111, "system_level_velocity_mean": 15.142852909402427, "cost1_mean": 176.49765857198193}, "timesteps_since_restore": 6517437, "episodes_this_iter": 46, "training_iteration": 148, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44808, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a2e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913aeb8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6880, "info": {"load_time_ms": 7.021, "default": {"vf_explained_var": 0.8854860067367554, "total_loss": 26.64436912536621, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2421901226043701, "policy_loss": -0.012437189929187298, "cur_lr": 0.0005000000237487257, "kl": 0.01719817891716957, "vf_loss": 26.65164566040039}, "num_steps_trained": 6517437, "update_time_ms": 8.346, "num_steps_sampled": 6517437, "grad_time_ms": 11055.519, "sample_time_ms": 19830.28}}
{"time_this_iter_s": 29.427786111831665, "timesteps_total": 6560682, "num_metric_batches_dropped": 0, "timestamp": 1558578593, "time_since_restore": 4644.371798753738, "episode_reward_max": -92.6033390051197, "hostname": "flow-main", "episode_len_mean": 318.94, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-29-53", "episode_reward_mean": -541.782469132261, "episode_reward_min": -883.7462198204132, "time_total_s": 4644.371798753738, "iterations_since_restore": 149, "custom_metrics": {"cost1_max": 224.833327699749, "outflow_rate_mean": 1221.808462640787, "outflow_rate_min": 772.3063052429276, "cost2_max": -48.50784939307442, "cost2_min": -95.28523817580535, "outflow_rate_max": 1462.0121251475796, "system_level_velocity_min": 9.282264930995026, "system_level_velocity_max": 18.99836596115644, "cost1_min": 80.0836526162058, "cost2_mean": -81.73648376427815, "system_level_velocity_mean": 15.07757646016048, "cost1_mean": 176.7349693343379}, "timesteps_since_restore": 6560682, "episodes_this_iter": 47, "training_iteration": 149, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43245, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140e48>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6927, "info": {"load_time_ms": 7.244, "default": {"vf_explained_var": 0.8799902200698853, "total_loss": 26.02779197692871, "cur_kl_coeff": 0.29999998211860657, "entropy": 1.2353037595748901, "policy_loss": -0.01071783248335123, "cur_lr": 0.0005000000237487257, "kl": 0.016932370141148567, "vf_loss": 26.033432006835938}, "num_steps_trained": 6560682, "update_time_ms": 8.349, "num_steps_sampled": 6560682, "grad_time_ms": 10917.326, "sample_time_ms": 19804.123}}
{"time_this_iter_s": 31.245628833770752, "timesteps_total": 6605705, "num_metric_batches_dropped": 0, "timestamp": 1558578624, "time_since_restore": 4675.617427587509, "episode_reward_max": -267.9741576019812, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-30-24", "episode_reward_mean": -561.837136869709, "episode_reward_min": -959.2108828729674, "time_total_s": 4675.617427587509, "iterations_since_restore": 150, "custom_metrics": {"cost1_max": 223.9974681000186, "outflow_rate_mean": 1226.169019820669, "outflow_rate_min": 715.646748768473, "cost2_max": -58.90603455899449, "cost2_min": -95.28523817580535, "outflow_rate_max": 1462.0121251475796, "system_level_velocity_min": 9.282264930995026, "system_level_velocity_max": 18.757799985965764, "cost1_min": 111.65315159061566, "cost2_mean": -81.89969060922678, "system_level_velocity_mean": 14.918925751107409, "cost1_mean": 178.89091059653333}, "timesteps_since_restore": 6605705, "episodes_this_iter": 46, "training_iteration": 150, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45023, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140208>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 6973, "info": {"load_time_ms": 7.281, "default": {"vf_explained_var": 0.8773584365844727, "total_loss": 28.074636459350586, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.277694821357727, "policy_loss": -0.011556864716112614, "cur_lr": 0.0005000000237487257, "kl": 0.016639817506074905, "vf_loss": 28.081205368041992}, "num_steps_trained": 6605705, "update_time_ms": 8.294, "num_steps_sampled": 6605705, "grad_time_ms": 10961.783, "sample_time_ms": 19861.876}}
{"time_this_iter_s": 29.923755645751953, "timesteps_total": 6649768, "num_metric_batches_dropped": 0, "timestamp": 1558578654, "time_since_restore": 4705.541183233261, "episode_reward_max": -268.51215917575104, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-30-54", "episode_reward_mean": -549.7522716809544, "episode_reward_min": -960.5288504268907, "time_total_s": 4705.541183233261, "iterations_since_restore": 151, "custom_metrics": {"cost1_max": 224.36835576060724, "outflow_rate_mean": 1232.031532901619, "outflow_rate_min": 713.9463046044865, "cost2_max": -58.61616818067772, "cost2_min": -94.83781411559065, "outflow_rate_max": 1462.0121251475796, "system_level_velocity_min": 9.815487079296883, "system_level_velocity_max": 18.800186932800095, "cost1_min": 120.21620090576246, "cost2_mean": -81.02978863100645, "system_level_velocity_mean": 15.096982016238746, "cost1_mean": 181.03722196145043}, "timesteps_since_restore": 6649768, "episodes_this_iter": 46, "training_iteration": 151, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44063, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91430b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143940>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7019, "info": {"load_time_ms": 7.364, "default": {"vf_explained_var": 0.8716523051261902, "total_loss": 28.06428337097168, "cur_kl_coeff": 0.29999998211860657, "entropy": 1.2578132152557373, "policy_loss": -0.01152594294399023, "cur_lr": 0.0005000000237487257, "kl": 0.017253246158361435, "vf_loss": 28.070636749267578}, "num_steps_trained": 6649768, "update_time_ms": 8.299, "num_steps_sampled": 6649768, "grad_time_ms": 10934.32, "sample_time_ms": 19814.451}}
{"time_this_iter_s": 30.404848098754883, "timesteps_total": 6694452, "num_metric_batches_dropped": 0, "timestamp": 1558578684, "time_since_restore": 4735.946031332016, "episode_reward_max": -266.66971366477327, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-31-24", "episode_reward_mean": -549.738173694294, "episode_reward_min": -973.2384639270872, "time_total_s": 4735.946031332016, "iterations_since_restore": 152, "custom_metrics": {"cost1_max": 224.36835576060724, "outflow_rate_mean": 1233.769768858352, "outflow_rate_min": 713.9463046044865, "cost2_max": -58.61616818067772, "cost2_min": -91.3225168155488, "outflow_rate_max": 1460.3861546459636, "system_level_velocity_min": 10.802313091800663, "system_level_velocity_max": 18.800186932800095, "cost1_min": 127.50684209255141, "cost2_mean": -80.82529962586801, "system_level_velocity_mean": 15.128361572730139, "cost1_mean": 181.63521994820724}, "timesteps_since_restore": 6694452, "episodes_this_iter": 46, "training_iteration": 152, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44684, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91337f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91337b8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7065, "info": {"load_time_ms": 7.44, "default": {"vf_explained_var": 0.8766493201255798, "total_loss": 27.201400756835938, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.281325340270996, "policy_loss": -0.011676020920276642, "cur_lr": 0.0005000000237487257, "kl": 0.017172470688819885, "vf_loss": 27.20792579650879}, "num_steps_trained": 6694452, "update_time_ms": 8.365, "num_steps_sampled": 6694452, "grad_time_ms": 10928.147, "sample_time_ms": 19793.604}}
{"time_this_iter_s": 31.144728183746338, "timesteps_total": 6737749, "num_metric_batches_dropped": 0, "timestamp": 1558578716, "time_since_restore": 4767.090759515762, "episode_reward_max": -101.58391235913123, "hostname": "flow-main", "episode_len_mean": 323.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-31-56", "episode_reward_mean": -556.9109107265989, "episode_reward_min": -973.2384639270872, "time_total_s": 4767.090759515762, "iterations_since_restore": 153, "custom_metrics": {"cost1_max": 224.35560784781637, "outflow_rate_mean": 1222.3019861954867, "outflow_rate_min": 730.5713796593016, "cost2_max": -48.47388137903731, "cost2_min": -93.30269370640528, "outflow_rate_max": 1466.1528102677723, "system_level_velocity_min": 10.037780379242966, "system_level_velocity_max": 18.801775260976765, "cost1_min": 85.37385747631046, "cost2_mean": -80.3475480327982, "system_level_velocity_mean": 14.939510443588988, "cost1_mean": 178.02643993856566}, "timesteps_since_restore": 6737749, "episodes_this_iter": 46, "training_iteration": 153, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43297, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913acf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91339b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143080>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7111, "info": {"load_time_ms": 7.464, "default": {"vf_explained_var": 0.8783773183822632, "total_loss": 26.768375396728516, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.219527244567871, "policy_loss": -0.010057295672595501, "cur_lr": 0.0005000000237487257, "kl": 0.016432100906968117, "vf_loss": 26.773500442504883}, "num_steps_trained": 6737749, "update_time_ms": 8.239, "num_steps_sampled": 6737749, "grad_time_ms": 10871.322, "sample_time_ms": 19738.118}}
{"time_this_iter_s": 30.04585838317871, "timesteps_total": 6781682, "num_metric_batches_dropped": 0, "timestamp": 1558578746, "time_since_restore": 4797.136617898941, "episode_reward_max": -91.03629047399295, "hostname": "flow-main", "episode_len_mean": 320.72, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-32-26", "episode_reward_mean": -543.8740131180915, "episode_reward_min": -852.6835420407664, "time_total_s": 4797.136617898941, "iterations_since_restore": 154, "custom_metrics": {"cost1_max": 224.35560784781637, "outflow_rate_mean": 1224.4087996886062, "outflow_rate_min": 782.7180276556481, "cost2_max": -45.151250374078494, "cost2_min": -93.30269370640528, "outflow_rate_max": 1469.6587419311172, "system_level_velocity_min": 10.037780379242966, "system_level_velocity_max": 18.94648958769703, "cost1_min": 80.52871751464697, "cost2_mean": -80.3516415226583, "system_level_velocity_mean": 15.116156994673595, "cost1_mean": 178.26499933723898}, "timesteps_since_restore": 6781682, "episodes_this_iter": 49, "training_iteration": 154, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43933, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143c18>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7160, "info": {"load_time_ms": 7.417, "default": {"vf_explained_var": 0.8791799545288086, "total_loss": 25.927734375, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2395684719085693, "policy_loss": -0.012505683116614819, "cur_lr": 0.0005000000237487257, "kl": 0.017077714204788208, "vf_loss": 25.93511390686035}, "num_steps_trained": 6781682, "update_time_ms": 8.079, "num_steps_sampled": 6781682, "grad_time_ms": 10760.567, "sample_time_ms": 19711.878}}
{"time_this_iter_s": 30.31945490837097, "timesteps_total": 6825540, "num_metric_batches_dropped": 0, "timestamp": 1558578776, "time_since_restore": 4827.456072807312, "episode_reward_max": -91.03629047399295, "hostname": "flow-main", "episode_len_mean": 320.72, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-32-56", "episode_reward_mean": -537.2171528916717, "episode_reward_min": -855.9011335922643, "time_total_s": 4827.456072807312, "iterations_since_restore": 155, "custom_metrics": {"cost1_max": 225.16533131399484, "outflow_rate_mean": 1228.8219773649218, "outflow_rate_min": 782.7180276556481, "cost2_max": -45.151250374078494, "cost2_min": -93.48656949996361, "outflow_rate_max": 1469.6587419311172, "system_level_velocity_min": 10.480460913539709, "system_level_velocity_max": 18.94648958769703, "cost1_min": 80.52871751464697, "cost2_mean": -80.33429446046887, "system_level_velocity_mean": 15.231191376912353, "cost1_mean": 179.5842211504456}, "timesteps_since_restore": 6825540, "episodes_this_iter": 45, "training_iteration": 155, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43858, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140d68>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7205, "info": {"load_time_ms": 7.389, "default": {"vf_explained_var": 0.8887452483177185, "total_loss": 24.594491958618164, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2454489469528198, "policy_loss": -0.011751470156013966, "cur_lr": 0.0005000000237487257, "kl": 0.016842005774378777, "vf_loss": 24.6011905670166}, "num_steps_trained": 6825540, "update_time_ms": 8.142, "num_steps_sampled": 6825540, "grad_time_ms": 10771.896, "sample_time_ms": 19745.128}}
{"time_this_iter_s": 31.046698570251465, "timesteps_total": 6869786, "num_metric_batches_dropped": 0, "timestamp": 1558578807, "time_since_restore": 4858.5027713775635, "episode_reward_max": -92.82782906511676, "hostname": "flow-main", "episode_len_mean": 317.84, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-33-27", "episode_reward_mean": -533.9267292733545, "episode_reward_min": -952.0948809170131, "time_total_s": 4858.5027713775635, "iterations_since_restore": 156, "custom_metrics": {"cost1_max": 225.16533131399484, "outflow_rate_mean": 1215.8178448162105, "outflow_rate_min": 714.1559249506254, "cost2_max": -47.720934718671195, "cost2_min": -94.02335623135608, "outflow_rate_max": 1464.62801107828, "system_level_velocity_min": 10.480460913539709, "system_level_velocity_max": 18.879954032044058, "cost1_min": 80.27816909520078, "cost2_mean": -80.35160180920043, "system_level_velocity_mean": 15.235396745469957, "cost1_mean": 177.92126084199654}, "timesteps_since_restore": 6869786, "episodes_this_iter": 49, "training_iteration": 156, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44246, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913acf8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7254, "info": {"load_time_ms": 7.342, "default": {"vf_explained_var": 0.861682653427124, "total_loss": 30.527881622314453, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2329908609390259, "policy_loss": -0.010843824595212936, "cur_lr": 0.0005000000237487257, "kl": 0.01740225777029991, "vf_loss": 30.533506393432617}, "num_steps_trained": 6869786, "update_time_ms": 8.12, "num_steps_sampled": 6869786, "grad_time_ms": 10695.459, "sample_time_ms": 19765.591}}
{"time_this_iter_s": 32.10636305809021, "timesteps_total": 6914747, "num_metric_batches_dropped": 0, "timestamp": 1558578839, "time_since_restore": 4890.609134435654, "episode_reward_max": -92.82782906511676, "hostname": "flow-main", "episode_len_mean": 319.84, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-33-59", "episode_reward_mean": -555.2294638728722, "episode_reward_min": -952.0948809170131, "time_total_s": 4890.609134435654, "iterations_since_restore": 157, "custom_metrics": {"cost1_max": 225.48622965901217, "outflow_rate_mean": 1210.4857326276413, "outflow_rate_min": 714.1559249506254, "cost2_max": -47.720934718671195, "cost2_min": -94.919841138212, "outflow_rate_max": 1464.1395022700485, "system_level_velocity_min": 11.129579348244214, "system_level_velocity_max": 18.89143540533553, "cost1_min": 80.27816909520078, "cost2_mean": -80.39132247539708, "system_level_velocity_mean": 14.911466165932218, "cost1_mean": 175.58948791879385}, "timesteps_since_restore": 6914747, "episodes_this_iter": 47, "training_iteration": 157, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44961, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143160>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7301, "info": {"load_time_ms": 7.204, "default": {"vf_explained_var": 0.9029449820518494, "total_loss": 21.027109146118164, "cur_kl_coeff": 0.2999999523162842, "entropy": 1.2620818614959717, "policy_loss": -0.012602686882019043, "cur_lr": 0.0005000000237487257, "kl": 0.020191043615341187, "vf_loss": 21.03365707397461}, "num_steps_trained": 6914747, "update_time_ms": 8.305, "num_steps_sampled": 6914747, "grad_time_ms": 10729.549, "sample_time_ms": 19817.196}}
{"time_this_iter_s": 30.475910425186157, "timesteps_total": 6959398, "num_metric_batches_dropped": 0, "timestamp": 1558578870, "time_since_restore": 4921.08504486084, "episode_reward_max": -102.64418222295376, "hostname": "flow-main", "episode_len_mean": 323.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-34-30", "episode_reward_mean": -571.3973675753346, "episode_reward_min": -952.0948809170131, "time_total_s": 4921.08504486084, "iterations_since_restore": 158, "custom_metrics": {"cost1_max": 225.48622965901217, "outflow_rate_mean": 1211.1192137378828, "outflow_rate_min": 714.1559249506254, "cost2_max": -49.76203960782852, "cost2_min": -94.919841138212, "outflow_rate_max": 1464.1395022700485, "system_level_velocity_min": 11.129579348244214, "system_level_velocity_max": 18.89143540533553, "cost1_min": 85.08668005329781, "cost2_mean": -80.65700887107847, "system_level_velocity_mean": 14.690943034571326, "cost1_mean": 175.0787051143109}, "timesteps_since_restore": 6959398, "episodes_this_iter": 45, "training_iteration": 158, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44651, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91337b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133d68>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7346, "info": {"load_time_ms": 7.253, "default": {"vf_explained_var": 0.8920950889587402, "total_loss": 23.183048248291016, "cur_kl_coeff": 0.45000001788139343, "entropy": 1.2525349855422974, "policy_loss": -0.011512435972690582, "cur_lr": 0.0005000000237487257, "kl": 0.013378001749515533, "vf_loss": 23.188539505004883}, "num_steps_trained": 6959398, "update_time_ms": 8.325, "num_steps_sampled": 6959398, "grad_time_ms": 10708.805, "sample_time_ms": 19802.317}}
{"time_this_iter_s": 31.738537549972534, "timesteps_total": 7003504, "num_metric_batches_dropped": 0, "timestamp": 1558578902, "time_since_restore": 4952.823582410812, "episode_reward_max": -21.12485718237922, "hostname": "flow-main", "episode_len_mean": 318.05, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-35-02", "episode_reward_mean": -541.2860166860116, "episode_reward_min": -827.4535412227495, "time_total_s": 4952.823582410812, "iterations_since_restore": 159, "custom_metrics": {"cost1_max": 223.82117254581578, "outflow_rate_mean": 1215.238830158644, "outflow_rate_min": 497.50056700217027, "cost2_max": -15.14250811094404, "cost2_min": -96.1773831982965, "outflow_rate_max": 1454.927381357175, "system_level_velocity_min": 11.441453000736436, "system_level_velocity_max": 18.855787668067098, "cost1_min": 18.78113588870166, "cost2_mean": -79.96114232857909, "system_level_velocity_mean": 15.01116754424975, "cost1_mean": 175.53317141074098}, "timesteps_since_restore": 7003504, "episodes_this_iter": 48, "training_iteration": 159, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44106, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913acf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91435f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143f98>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7394, "info": {"load_time_ms": 6.974, "default": {"vf_explained_var": 0.8904569745063782, "total_loss": 23.635042190551758, "cur_kl_coeff": 0.44999995827674866, "entropy": 1.2694066762924194, "policy_loss": -0.011388489045202732, "cur_lr": 0.0005000000237487257, "kl": 0.013567421585321426, "vf_loss": 23.640323638916016}, "num_steps_trained": 7003504, "update_time_ms": 8.331, "num_steps_sampled": 7003504, "grad_time_ms": 10840.5, "sample_time_ms": 19902.194}}
{"time_this_iter_s": 30.0213565826416, "timesteps_total": 7047179, "num_metric_batches_dropped": 0, "timestamp": 1558578932, "time_since_restore": 4982.844938993454, "episode_reward_max": -21.12485718237922, "hostname": "flow-main", "episode_len_mean": 316.79, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-35-32", "episode_reward_mean": -544.993738501398, "episode_reward_min": -837.4769572977573, "time_total_s": 4982.844938993454, "iterations_since_restore": 160, "custom_metrics": {"cost1_max": 223.82117254581578, "outflow_rate_mean": 1208.2595503528134, "outflow_rate_min": 497.50056700217027, "cost2_max": -15.14250811094404, "cost2_min": -96.1773831982965, "outflow_rate_max": 1456.8438089367803, "system_level_velocity_min": 10.526796292232312, "system_level_velocity_max": 18.855787668067098, "cost1_min": 18.78113588870166, "cost2_mean": -78.92719087518505, "system_level_velocity_mean": 14.958468789952105, "cost1_mean": 174.009106936215}, "timesteps_since_restore": 7047179, "episodes_this_iter": 46, "training_iteration": 160, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43675, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91337b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bd68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d860>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7440, "info": {"load_time_ms": 6.84, "default": {"vf_explained_var": 0.8846585750579834, "total_loss": 24.204547882080078, "cur_kl_coeff": 0.4500000476837158, "entropy": 1.2649174928665161, "policy_loss": -0.009807039052248001, "cur_lr": 0.0005000000237487257, "kl": 0.013504368253052235, "vf_loss": 24.208280563354492}, "num_steps_trained": 7047179, "update_time_ms": 8.375, "num_steps_sampled": 7047179, "grad_time_ms": 10763.751, "sample_time_ms": 19856.906}}
{"time_this_iter_s": 29.97040104866028, "timesteps_total": 7091224, "num_metric_batches_dropped": 0, "timestamp": 1558578962, "time_since_restore": 5012.815340042114, "episode_reward_max": -94.46697024589248, "hostname": "flow-main", "episode_len_mean": 320.66, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-36-02", "episode_reward_mean": -530.5620855353602, "episode_reward_min": -982.7890517685572, "time_total_s": 5012.815340042114, "iterations_since_restore": 161, "custom_metrics": {"cost1_max": 225.6486605174411, "outflow_rate_mean": 1227.2348157930244, "outflow_rate_min": 720.7787265917603, "cost2_max": -48.61625859104227, "cost2_min": -97.57003717756649, "outflow_rate_max": 1460.2707533462706, "system_level_velocity_min": 10.238982326044763, "system_level_velocity_max": 19.071290892346017, "cost1_min": 79.88406546413135, "cost2_mean": -81.51511743981423, "system_level_velocity_mean": 15.266975785084528, "cost1_mean": 180.36705880763114}, "timesteps_since_restore": 7091224, "episodes_this_iter": 48, "training_iteration": 161, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44045, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91336a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914de10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914dd68>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7488, "info": {"load_time_ms": 6.983, "default": {"vf_explained_var": 0.8660837411880493, "total_loss": 29.8079776763916, "cur_kl_coeff": 0.44999995827674866, "entropy": 1.2256789207458496, "policy_loss": -0.010816126130521297, "cur_lr": 0.0005000000237487257, "kl": 0.014128335751593113, "vf_loss": 29.812437057495117}, "num_steps_trained": 7091224, "update_time_ms": 8.463, "num_steps_sampled": 7091224, "grad_time_ms": 10746.366, "sample_time_ms": 19879.487}}
{"time_this_iter_s": 29.83585810661316, "timesteps_total": 7135040, "num_metric_batches_dropped": 0, "timestamp": 1558578992, "time_since_restore": 5042.651198148727, "episode_reward_max": -104.63460628210449, "hostname": "flow-main", "episode_len_mean": 321.94, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-36-32", "episode_reward_mean": -528.4046920612819, "episode_reward_min": -982.7890517685572, "time_total_s": 5042.651198148727, "iterations_since_restore": 162, "custom_metrics": {"cost1_max": 225.6486605174411, "outflow_rate_mean": 1230.6859374897388, "outflow_rate_min": 720.7787265917603, "cost2_max": -51.02160429881356, "cost2_min": -99.18764365629104, "outflow_rate_max": 1460.2707533462706, "system_level_velocity_min": 10.238982326044763, "system_level_velocity_max": 19.071290892346017, "cost1_min": 86.57106827160406, "cost2_mean": -82.87384994448607, "system_level_velocity_mean": 15.294772223530078, "cost1_mean": 181.41664950290397}, "timesteps_since_restore": 7135040, "episodes_this_iter": 46, "training_iteration": 162, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43816, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91487b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91484a8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7534, "info": {"load_time_ms": 6.816, "default": {"vf_explained_var": 0.8725892901420593, "total_loss": 26.679790496826172, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.2349326610565186, "policy_loss": -0.011457749642431736, "cur_lr": 0.0005000000237487257, "kl": 0.013639843091368675, "vf_loss": 26.68510627746582}, "num_steps_trained": 7135040, "update_time_ms": 8.364, "num_steps_sampled": 7135040, "grad_time_ms": 10606.629, "sample_time_ms": 19962.448}}
{"time_this_iter_s": 31.9652316570282, "timesteps_total": 7179879, "num_metric_batches_dropped": 0, "timestamp": 1558579024, "time_since_restore": 5074.616429805756, "episode_reward_max": -104.63460628210449, "hostname": "flow-main", "episode_len_mean": 323.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-37-04", "episode_reward_mean": -559.9704663836737, "episode_reward_min": -827.9602309146276, "time_total_s": 5074.616429805756, "iterations_since_restore": 163, "custom_metrics": {"cost1_max": 224.28773334992945, "outflow_rate_mean": 1217.6643712707698, "outflow_rate_min": 811.6540275500619, "cost2_max": -51.02160429881356, "cost2_min": -99.18764365629104, "outflow_rate_max": 1464.093016103471, "system_level_velocity_min": 10.791727490890752, "system_level_velocity_max": 18.78859223721225, "cost1_min": 86.57106827160406, "cost2_mean": -82.42661208927807, "system_level_velocity_mean": 14.859044241263542, "cost1_mean": 176.96315499695652}, "timesteps_since_restore": 7179879, "episodes_this_iter": 47, "training_iteration": 163, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44839, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914df98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914db38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914dda0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7581, "info": {"load_time_ms": 6.96, "default": {"vf_explained_var": 0.8681761622428894, "total_loss": 29.507192611694336, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.2906391620635986, "policy_loss": -0.009820831939578056, "cur_lr": 0.0005000000237487257, "kl": 0.013070987537503242, "vf_loss": 29.51112937927246}, "num_steps_trained": 7179879, "update_time_ms": 8.327, "num_steps_sampled": 7179879, "grad_time_ms": 10634.295, "sample_time_ms": 20016.022}}
{"time_this_iter_s": 31.347304105758667, "timesteps_total": 7223461, "num_metric_batches_dropped": 0, "timestamp": 1558579055, "time_since_restore": 5105.963733911514, "episode_reward_max": -257.1358926742497, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-37-35", "episode_reward_mean": -559.8361739664674, "episode_reward_min": -827.9602309146276, "time_total_s": 5105.963733911514, "iterations_since_restore": 164, "custom_metrics": {"cost1_max": 225.51653817360966, "outflow_rate_mean": 1227.8994083642613, "outflow_rate_min": 975.6323389153823, "cost2_max": -64.48195595938613, "cost2_min": -98.08693660223514, "outflow_rate_max": 1469.0301783169807, "system_level_velocity_min": 10.791727490890752, "system_level_velocity_max": 18.87467414612385, "cost1_min": 127.11990393890852, "cost2_mean": -83.07632164316777, "system_level_velocity_mean": 14.882176389536507, "cost1_mean": 178.6277230231204}, "timesteps_since_restore": 7223461, "episodes_this_iter": 47, "training_iteration": 164, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43582, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91480f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148f60>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7628, "info": {"load_time_ms": 6.992, "default": {"vf_explained_var": 0.8855871558189392, "total_loss": 25.084434509277344, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.2209539413452148, "policy_loss": -0.010072172619402409, "cur_lr": 0.0005000000237487257, "kl": 0.013061604462563992, "vf_loss": 25.0886287689209}, "num_steps_trained": 7223461, "update_time_ms": 8.406, "num_steps_sampled": 7223461, "grad_time_ms": 10708.714, "sample_time_ms": 20071.49}}
{"time_this_iter_s": 30.966742277145386, "timesteps_total": 7268439, "num_metric_batches_dropped": 0, "timestamp": 1558579086, "time_since_restore": 5136.93047618866, "episode_reward_max": -100.37058018967878, "hostname": "flow-main", "episode_len_mean": 323.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-38-06", "episode_reward_mean": -558.8661944248873, "episode_reward_min": -838.4975189912202, "time_total_s": 5136.93047618866, "iterations_since_restore": 165, "custom_metrics": {"cost1_max": 225.51653817360966, "outflow_rate_mean": 1221.6253569220253, "outflow_rate_min": 811.1907881711055, "cost2_max": -47.32254877102702, "cost2_min": -95.49798018666658, "outflow_rate_max": 1469.0301783169807, "system_level_velocity_min": 10.835286602462574, "system_level_velocity_max": 18.87467414612385, "cost1_min": 85.52139799524859, "cost2_mean": -82.48000382556621, "system_level_velocity_mean": 14.923291027567807, "cost1_mean": 177.32680020877277}, "timesteps_since_restore": 7268439, "episodes_this_iter": 44, "training_iteration": 165, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44978, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140a58>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7672, "info": {"load_time_ms": 7.082, "default": {"vf_explained_var": 0.8918836116790771, "total_loss": 24.85455894470215, "cur_kl_coeff": 0.4500000476837158, "entropy": 1.289344310760498, "policy_loss": -0.009378805756568909, "cur_lr": 0.0005000000237487257, "kl": 0.014743722975254059, "vf_loss": 24.8573055267334}, "num_steps_trained": 7268439, "update_time_ms": 8.409, "num_steps_sampled": 7268439, "grad_time_ms": 10648.197, "sample_time_ms": 20196.483}}
{"time_this_iter_s": 30.121623516082764, "timesteps_total": 7311329, "num_metric_batches_dropped": 0, "timestamp": 1558579116, "time_since_restore": 5167.052099704742, "episode_reward_max": -100.37058018967878, "hostname": "flow-main", "episode_len_mean": 323.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-38-36", "episode_reward_mean": -542.9520417361385, "episode_reward_min": -838.4975189912202, "time_total_s": 5167.052099704742, "iterations_since_restore": 166, "custom_metrics": {"cost1_max": 225.73164082130202, "outflow_rate_mean": 1234.3710378860262, "outflow_rate_min": 811.1907881711055, "cost2_max": -47.32254877102702, "cost2_min": -95.13943910335666, "outflow_rate_max": 1470.8442181951054, "system_level_velocity_min": 10.835286602462574, "system_level_velocity_max": 18.9685729257363, "cost1_min": 85.52139799524859, "cost2_mean": -82.19500954470136, "system_level_velocity_mean": 15.139817155658532, "cost1_mean": 179.86669455484625}, "timesteps_since_restore": 7311329, "episodes_this_iter": 47, "training_iteration": 166, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 42890, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d438>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7719, "info": {"load_time_ms": 6.987, "default": {"vf_explained_var": 0.8815265893936157, "total_loss": 25.596349716186523, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.2189851999282837, "policy_loss": -0.010780224576592445, "cur_lr": 0.0005000000237487257, "kl": 0.013679612427949905, "vf_loss": 25.600976943969727}, "num_steps_trained": 7311329, "update_time_ms": 8.436, "num_steps_sampled": 7311329, "grad_time_ms": 10536.064, "sample_time_ms": 20217.941}}
{"time_this_iter_s": 31.936057329177856, "timesteps_total": 7355363, "num_metric_batches_dropped": 0, "timestamp": 1558579148, "time_since_restore": 5198.98815703392, "episode_reward_max": -174.34569712176406, "hostname": "flow-main", "episode_len_mean": 323.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-39-08", "episode_reward_mean": -536.4537295524605, "episode_reward_min": -838.4975189912202, "time_total_s": 5198.98815703392, "iterations_since_restore": 167, "custom_metrics": {"cost1_max": 225.73164082130202, "outflow_rate_mean": 1245.7928220857355, "outflow_rate_min": 967.4050719963323, "cost2_max": -63.735380095268184, "cost2_min": -92.33344226686016, "outflow_rate_max": 1470.8442181951054, "system_level_velocity_min": 10.835286602462574, "system_level_velocity_max": 18.9685729257363, "cost1_min": 128.23963588082896, "cost2_mean": -81.96707123355203, "system_level_velocity_mean": 15.228112324501756, "cost1_mean": 181.85484846865563}, "timesteps_since_restore": 7355363, "episodes_this_iter": 48, "training_iteration": 167, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44034, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a913a6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b4a8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7767, "info": {"load_time_ms": 6.969, "default": {"vf_explained_var": 0.8911056518554688, "total_loss": 23.601030349731445, "cur_kl_coeff": 0.44999995827674866, "entropy": 1.2697393894195557, "policy_loss": -0.011702566407620907, "cur_lr": 0.0005000000237487257, "kl": 0.014080222696065903, "vf_loss": 23.606393814086914}, "num_steps_trained": 7355363, "update_time_ms": 8.494, "num_steps_sampled": 7355363, "grad_time_ms": 10504.953, "sample_time_ms": 20233.385}}
{"time_this_iter_s": 30.97835397720337, "timesteps_total": 7400458, "num_metric_batches_dropped": 0, "timestamp": 1558579179, "time_since_restore": 5229.966511011124, "episode_reward_max": -167.70644925751895, "hostname": "flow-main", "episode_len_mean": 322.74, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-39-39", "episode_reward_mean": -567.0660977546228, "episode_reward_min": -930.9301045747059, "time_total_s": 5229.966511011124, "iterations_since_restore": 168, "custom_metrics": {"cost1_max": 223.736707246933, "outflow_rate_mean": 1216.8031980922065, "outflow_rate_min": 729.7661835263378, "cost2_max": -59.40893210915978, "cost2_min": -92.33344226686016, "outflow_rate_max": 1460.5471894001948, "system_level_velocity_min": 11.459913747114513, "system_level_velocity_max": 18.898806220109122, "cost1_min": 135.79088533449595, "cost2_mean": -80.57022003183562, "system_level_velocity_mean": 14.818276812327499, "cost1_mean": 176.11526378657064}, "timesteps_since_restore": 7400458, "episodes_this_iter": 44, "training_iteration": 168, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45095, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914dc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d048>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7811, "info": {"load_time_ms": 6.973, "default": {"vf_explained_var": 0.8857988715171814, "total_loss": 24.794445037841797, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.3397438526153564, "policy_loss": -0.011581563390791416, "cur_lr": 0.0005000000237487257, "kl": 0.014042247086763382, "vf_loss": 24.799707412719727}, "num_steps_trained": 7400458, "update_time_ms": 8.349, "num_steps_sampled": 7400458, "grad_time_ms": 10546.506, "sample_time_ms": 20241.645}}
{"time_this_iter_s": 31.540070295333862, "timesteps_total": 7444388, "num_metric_batches_dropped": 0, "timestamp": 1558579211, "time_since_restore": 5261.5065813064575, "episode_reward_max": -167.70644925751895, "hostname": "flow-main", "episode_len_mean": 323.82, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-40-11", "episode_reward_mean": -561.2404831799594, "episode_reward_min": -930.9301045747059, "time_total_s": 5261.5065813064575, "iterations_since_restore": 169, "custom_metrics": {"cost1_max": 223.80762345644638, "outflow_rate_mean": 1220.8786393544924, "outflow_rate_min": 729.7661835263378, "cost2_max": -59.40893210915978, "cost2_min": -92.2817729599014, "outflow_rate_max": 1461.184161825303, "system_level_velocity_min": 11.384720360822092, "system_level_velocity_max": 18.69398294736585, "cost1_min": 133.92294815982513, "cost2_mean": -81.7017428037207, "system_level_velocity_mean": 14.855176684654033, "cost1_mean": 177.4188471844975}, "timesteps_since_restore": 7444388, "episodes_this_iter": 50, "training_iteration": 169, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43930, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912b4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d438>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7861, "info": {"load_time_ms": 7.153, "default": {"vf_explained_var": 0.898663341999054, "total_loss": 22.511749267578125, "cur_kl_coeff": 0.45000001788139343, "entropy": 1.2288026809692383, "policy_loss": -0.012409044429659843, "cur_lr": 0.0005000000237487257, "kl": 0.013863101601600647, "vf_loss": 22.517919540405273}, "num_steps_trained": 7444388, "update_time_ms": 8.653, "num_steps_sampled": 7444388, "grad_time_ms": 10685.958, "sample_time_ms": 20081.54}}
{"time_this_iter_s": 32.9084107875824, "timesteps_total": 7489417, "num_metric_batches_dropped": 0, "timestamp": 1558579244, "time_since_restore": 5294.41499209404, "episode_reward_max": -29.253623448197512, "hostname": "flow-main", "episode_len_mean": 322.1, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-40-44", "episode_reward_mean": -551.2611884848933, "episode_reward_min": -804.8205830771504, "time_total_s": 5294.41499209404, "iterations_since_restore": 170, "custom_metrics": {"cost1_max": 226.4449416307725, "outflow_rate_mean": 1222.719601816638, "outflow_rate_min": 465.8227828158284, "cost2_max": -19.04928168262978, "cost2_min": -92.2817729599014, "outflow_rate_max": 1464.1839981983335, "system_level_velocity_min": 11.384720360822092, "system_level_velocity_max": 18.90692752276542, "cost1_min": 23.0482999793115, "cost2_mean": -81.43537769334284, "system_level_velocity_mean": 14.896417968454013, "cost1_mean": 176.915774575401}, "timesteps_since_restore": 7489417, "episodes_this_iter": 46, "training_iteration": 170, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45029, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91485f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148048>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7907, "info": {"load_time_ms": 7.204, "default": {"vf_explained_var": 0.9019794464111328, "total_loss": 21.450700759887695, "cur_kl_coeff": 0.4500000476837158, "entropy": 1.3222850561141968, "policy_loss": -0.012274108827114105, "cur_lr": 0.0005000000237487257, "kl": 0.014291399158537388, "vf_loss": 21.456544876098633}, "num_steps_trained": 7489417, "update_time_ms": 8.753, "num_steps_sampled": 7489417, "grad_time_ms": 10993.41, "sample_time_ms": 20062.356}}
{"time_this_iter_s": 31.83664584159851, "timesteps_total": 7533665, "num_metric_batches_dropped": 0, "timestamp": 1558579276, "time_since_restore": 5326.251637935638, "episode_reward_max": -29.253623448197512, "hostname": "flow-main", "episode_len_mean": 322.1, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-41-16", "episode_reward_mean": -566.0682366825026, "episode_reward_min": -989.8322654730475, "time_total_s": 5326.251637935638, "iterations_since_restore": 171, "custom_metrics": {"cost1_max": 226.4449416307725, "outflow_rate_mean": 1211.301888559387, "outflow_rate_min": 465.8227828158284, "cost2_max": -19.04928168262978, "cost2_min": -95.64147078147943, "outflow_rate_max": 1465.1273211741238, "system_level_velocity_min": 10.457793906283127, "system_level_velocity_max": 18.90692752276542, "cost1_min": 23.0482999793115, "cost2_mean": -81.11877919227355, "system_level_velocity_mean": 14.767166850268916, "cost1_mean": 175.0562100844529}, "timesteps_since_restore": 7533665, "episodes_this_iter": 44, "training_iteration": 171, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44248, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914de80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914dc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d198>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7951, "info": {"load_time_ms": 7.303, "default": {"vf_explained_var": 0.8882124423980713, "total_loss": 24.85927963256836, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.27924644947052, "policy_loss": -0.009355616755783558, "cur_lr": 0.0005000000237487257, "kl": 0.015173377469182014, "vf_loss": 24.86180877685547}, "num_steps_trained": 7533665, "update_time_ms": 8.753, "num_steps_sampled": 7533665, "grad_time_ms": 11274.214, "sample_time_ms": 19965.075}}
{"time_this_iter_s": 31.42706847190857, "timesteps_total": 7578135, "num_metric_batches_dropped": 0, "timestamp": 1558579307, "time_since_restore": 5357.678706407547, "episode_reward_max": -262.6971589411753, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-41-47", "episode_reward_mean": -565.2716693640083, "episode_reward_min": -989.8322654730475, "time_total_s": 5357.678706407547, "iterations_since_restore": 172, "custom_metrics": {"cost1_max": 225.1379791700156, "outflow_rate_mean": 1222.7161086785802, "outflow_rate_min": 730.7153545019572, "cost2_max": -64.85345852688718, "cost2_min": -95.74880983451897, "outflow_rate_max": 1470.82798926807, "system_level_velocity_min": 10.457793906283127, "system_level_velocity_max": 18.815370097033334, "cost1_min": 123.17561139789296, "cost2_mean": -82.27439402730093, "system_level_velocity_mean": 14.843800561545734, "cost1_mean": 177.79739305554102}, "timesteps_since_restore": 7578135, "episodes_this_iter": 48, "training_iteration": 172, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44470, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914df98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d438>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 7999, "info": {"load_time_ms": 7.334, "default": {"vf_explained_var": 0.8822006583213806, "total_loss": 27.020875930786133, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.279632329940796, "policy_loss": -0.00989707000553608, "cur_lr": 0.0005000000237487257, "kl": 0.0135477464646101, "vf_loss": 27.02467918395996}, "num_steps_trained": 7578135, "update_time_ms": 8.782, "num_steps_sampled": 7578135, "grad_time_ms": 11440.086, "sample_time_ms": 19958.085}}
{"time_this_iter_s": 30.808573007583618, "timesteps_total": 7622767, "num_metric_batches_dropped": 0, "timestamp": 1558579338, "time_since_restore": 5388.487279415131, "episode_reward_max": -176.33827934441143, "hostname": "flow-main", "episode_len_mean": 323.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-42-18", "episode_reward_mean": -566.1900999432615, "episode_reward_min": -876.6018030834078, "time_total_s": 5388.487279415131, "iterations_since_restore": 173, "custom_metrics": {"cost1_max": 225.1379791700156, "outflow_rate_mean": 1217.9084915004908, "outflow_rate_min": 946.5016677440206, "cost2_max": -64.85345852688718, "cost2_min": -95.74880983451897, "outflow_rate_max": 1470.82798926807, "system_level_velocity_min": 10.113118726254822, "system_level_velocity_max": 18.810646872695905, "cost1_min": 121.50288703772564, "cost2_mean": -81.92031363103466, "system_level_velocity_mean": 14.787489431433869, "cost1_mean": 176.35590353196986}, "timesteps_since_restore": 7622767, "episodes_this_iter": 45, "training_iteration": 173, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44632, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91339e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a912bd68>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8044, "info": {"load_time_ms": 7.438, "default": {"vf_explained_var": 0.893771231174469, "total_loss": 24.01015281677246, "cur_kl_coeff": 0.45000001788139343, "entropy": 1.335464358329773, "policy_loss": -0.011866758577525616, "cur_lr": 0.0005000000237487257, "kl": 0.014666534960269928, "vf_loss": 24.015422821044922}, "num_steps_trained": 7622767, "update_time_ms": 8.819, "num_steps_sampled": 7622767, "grad_time_ms": 11396.451, "sample_time_ms": 19887.101}}
{"time_this_iter_s": 30.462804079055786, "timesteps_total": 7668179, "num_metric_batches_dropped": 0, "timestamp": 1558579368, "time_since_restore": 5418.950083494186, "episode_reward_max": -176.33827934441143, "hostname": "flow-main", "episode_len_mean": 323.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-42-48", "episode_reward_mean": -593.6074944261873, "episode_reward_min": -976.8561500545111, "time_total_s": 5418.950083494186, "iterations_since_restore": 174, "custom_metrics": {"cost1_max": 225.1379791700156, "outflow_rate_mean": 1196.0188867023955, "outflow_rate_min": 730.2386908909906, "cost2_max": -64.33758819668375, "cost2_min": -93.3046525710553, "outflow_rate_max": 1464.7763648196496, "system_level_velocity_min": 10.113118726254822, "system_level_velocity_max": 18.80856962806012, "cost1_min": 121.50288703772564, "cost2_mean": -80.79218682661427, "system_level_velocity_mean": 14.463871594855464, "cost1_mean": 172.51681953819866}, "timesteps_since_restore": 7668179, "episodes_this_iter": 47, "training_iteration": 174, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45412, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914de80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914da90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914dc88>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8091, "info": {"load_time_ms": 7.487, "default": {"vf_explained_var": 0.8943105340003967, "total_loss": 25.028581619262695, "cur_kl_coeff": 0.44999995827674866, "entropy": 1.3468369245529175, "policy_loss": -0.009299230761826038, "cur_lr": 0.0005000000237487257, "kl": 0.01348840817809105, "vf_loss": 25.031810760498047}, "num_steps_trained": 7668179, "update_time_ms": 8.669, "num_steps_sampled": 7668179, "grad_time_ms": 11438.772, "sample_time_ms": 19756.996}}
{"time_this_iter_s": 30.649282217025757, "timesteps_total": 7712770, "num_metric_batches_dropped": 0, "timestamp": 1558579399, "time_since_restore": 5449.599365711212, "episode_reward_max": -261.6102797078346, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-43-19", "episode_reward_mean": -584.3253878628634, "episode_reward_min": -976.8561500545111, "time_total_s": 5449.599365711212, "iterations_since_restore": 175, "custom_metrics": {"cost1_max": 225.2844841829281, "outflow_rate_mean": 1206.9935972813091, "outflow_rate_min": 730.2386908909906, "cost2_max": -64.33758819668375, "cost2_min": -93.2044443511558, "outflow_rate_max": 1464.7763648196496, "system_level_velocity_min": 11.319134140071997, "system_level_velocity_max": 18.823136669214804, "cost1_min": 133.31594768610597, "cost2_mean": -81.03306391430424, "system_level_velocity_mean": 14.671042590865769, "cost1_mean": 175.69074149531133}, "timesteps_since_restore": 7712770, "episodes_this_iter": 45, "training_iteration": 175, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44591, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914de10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d780>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8136, "info": {"load_time_ms": 7.531, "default": {"vf_explained_var": 0.883457601070404, "total_loss": 28.722488403320312, "cur_kl_coeff": 0.45000001788139343, "entropy": 1.2923415899276733, "policy_loss": -0.010659265331923962, "cur_lr": 0.0005000000237487257, "kl": 0.013708923012018204, "vf_loss": 28.726978302001953}, "num_steps_trained": 7712770, "update_time_ms": 8.648, "num_steps_sampled": 7712770, "grad_time_ms": 11552.634, "sample_time_ms": 19610.685}}
{"time_this_iter_s": 30.32667088508606, "timesteps_total": 7756811, "num_metric_batches_dropped": 0, "timestamp": 1558579429, "time_since_restore": 5479.926036596298, "episode_reward_max": -176.82242211875837, "hostname": "flow-main", "episode_len_mean": 323.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-43-49", "episode_reward_mean": -565.2611278663663, "episode_reward_min": -976.8561500545111, "time_total_s": 5479.926036596298, "iterations_since_restore": 176, "custom_metrics": {"cost1_max": 225.2844841829281, "outflow_rate_mean": 1213.7229748096095, "outflow_rate_min": 730.2386908909906, "cost2_max": -61.7003092593047, "cost2_min": -92.59916309633036, "outflow_rate_max": 1464.339158519195, "system_level_velocity_min": 10.850364197479745, "system_level_velocity_max": 18.826004844757573, "cost1_min": 129.9246538334409, "cost2_mean": -81.37781123544767, "system_level_velocity_mean": 14.852576246150965, "cost1_mean": 177.19171822272085}, "timesteps_since_restore": 7756811, "episodes_this_iter": 48, "training_iteration": 176, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44041, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914da58>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8184, "info": {"load_time_ms": 7.617, "default": {"vf_explained_var": 0.8789874911308289, "total_loss": 27.915388107299805, "cur_kl_coeff": 0.44999995827674866, "entropy": 1.282140851020813, "policy_loss": -0.011311500333249569, "cur_lr": 0.0005000000237487257, "kl": 0.01392827183008194, "vf_loss": 27.920429229736328}, "num_steps_trained": 7756811, "update_time_ms": 8.67, "num_steps_sampled": 7756811, "grad_time_ms": 11709.678, "sample_time_ms": 19474.014}}
{"time_this_iter_s": 32.301042318344116, "timesteps_total": 7801969, "num_metric_batches_dropped": 0, "timestamp": 1558579462, "time_since_restore": 5512.227078914642, "episode_reward_max": -91.62450246629699, "hostname": "flow-main", "episode_len_mean": 319.76, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-44-22", "episode_reward_mean": -564.0086019246826, "episode_reward_min": -830.4493905860008, "time_total_s": 5512.227078914642, "iterations_since_restore": 177, "custom_metrics": {"cost1_max": 225.97328428798608, "outflow_rate_mean": 1198.8306767182285, "outflow_rate_min": 757.7394442759208, "cost2_max": -46.153152796401805, "cost2_min": -94.2317575560879, "outflow_rate_max": 1469.9169923429167, "system_level_velocity_min": 10.850364197479745, "system_level_velocity_max": 18.9497048939804, "cost1_min": 79.69764396109989, "cost2_mean": -81.02714686325913, "system_level_velocity_mean": 14.741717498868288, "cost1_mean": 172.88515518472934}, "timesteps_since_restore": 7801969, "episodes_this_iter": 49, "training_iteration": 177, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45158, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140c88>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8233, "info": {"load_time_ms": 7.506, "default": {"vf_explained_var": 0.9016087055206299, "total_loss": 23.738649368286133, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.3103200197219849, "policy_loss": -0.00911734253168106, "cur_lr": 0.0005000000237487257, "kl": 0.015818767249584198, "vf_loss": 23.740650177001953}, "num_steps_trained": 7801969, "update_time_ms": 8.433, "num_steps_sampled": 7801969, "grad_time_ms": 11837.119, "sample_time_ms": 19382.819}}
{"time_this_iter_s": 30.493306636810303, "timesteps_total": 7845701, "num_metric_batches_dropped": 0, "timestamp": 1558579492, "time_since_restore": 5542.720385551453, "episode_reward_max": -91.62450246629699, "hostname": "flow-main", "episode_len_mean": 320.84, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-44-52", "episode_reward_mean": -562.1164955009708, "episode_reward_min": -792.8543663833685, "time_total_s": 5542.720385551453, "iterations_since_restore": 178, "custom_metrics": {"cost1_max": 226.52160603339226, "outflow_rate_mean": 1205.894465413104, "outflow_rate_min": 757.7394442759208, "cost2_max": -46.153152796401805, "cost2_min": -96.1704802948967, "outflow_rate_max": 1469.9169923429167, "system_level_velocity_min": 11.009099157373026, "system_level_velocity_max": 18.9497048939804, "cost1_min": 79.69764396109989, "cost2_mean": -82.0407965390934, "system_level_velocity_mean": 14.783451845940993, "cost1_mean": 174.0769184816093}, "timesteps_since_restore": 7845701, "episodes_this_iter": 43, "training_iteration": 178, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43732, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914db38>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8276, "info": {"load_time_ms": 7.396, "default": {"vf_explained_var": 0.909326434135437, "total_loss": 21.952640533447266, "cur_kl_coeff": 0.4500000476837158, "entropy": 1.246579647064209, "policy_loss": -0.010797500610351562, "cur_lr": 0.0005000000237487257, "kl": 0.013904529623687267, "vf_loss": 21.957181930541992}, "num_steps_trained": 7845701, "update_time_ms": 8.394, "num_steps_sampled": 7845701, "grad_time_ms": 11865.912, "sample_time_ms": 19306.477}}
{"time_this_iter_s": 30.55362582206726, "timesteps_total": 7890633, "num_metric_batches_dropped": 0, "timestamp": 1558579523, "time_since_restore": 5573.27401137352, "episode_reward_max": -94.61523178443065, "hostname": "flow-main", "episode_len_mean": 322.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-45-23", "episode_reward_mean": -564.4039153572751, "episode_reward_min": -841.9708832644628, "time_total_s": 5573.27401137352, "iterations_since_restore": 179, "custom_metrics": {"cost1_max": 226.52160603339226, "outflow_rate_mean": 1211.5045521026286, "outflow_rate_min": 756.4835867111939, "cost2_max": -49.309094074346866, "cost2_min": -96.1704802948967, "outflow_rate_max": 1468.3469138949288, "system_level_velocity_min": 10.751150684183626, "system_level_velocity_max": 18.93746577558879, "cost1_min": 79.87842824165581, "cost2_mean": -82.87417156883234, "system_level_velocity_mean": 14.810563597491749, "cost1_mean": 175.8043293740323}, "timesteps_since_restore": 7890633, "episodes_this_iter": 47, "training_iteration": 179, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44932, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133470>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8323, "info": {"load_time_ms": 7.174, "default": {"vf_explained_var": 0.9021271467208862, "total_loss": 23.441022872924805, "cur_kl_coeff": 0.4500000476837158, "entropy": 1.2959500551223755, "policy_loss": -0.012040174566209316, "cur_lr": 0.0005000000237487257, "kl": 0.013733777217566967, "vf_loss": 23.446884155273438}, "num_steps_trained": 7890633, "update_time_ms": 8.187, "num_steps_sampled": 7890633, "grad_time_ms": 11773.778, "sample_time_ms": 19301.148}}
{"time_this_iter_s": 30.640406608581543, "timesteps_total": 7935416, "num_metric_batches_dropped": 0, "timestamp": 1558579554, "time_since_restore": 5603.914417982101, "episode_reward_max": -94.61523178443065, "hostname": "flow-main", "episode_len_mean": 322.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-45-54", "episode_reward_mean": -572.692978666868, "episode_reward_min": -994.8905713018354, "time_total_s": 5603.914417982101, "iterations_since_restore": 180, "custom_metrics": {"cost1_max": 225.72675557744193, "outflow_rate_mean": 1205.0791851342547, "outflow_rate_min": 730.8336518286103, "cost2_max": -49.309094074346866, "cost2_min": -95.7584122965102, "outflow_rate_max": 1469.7135181266297, "system_level_velocity_min": 10.751150684183626, "system_level_velocity_max": 18.9542478917051, "cost1_min": 79.87842824165581, "cost2_mean": -82.69351389329248, "system_level_velocity_mean": 14.715078480764879, "cost1_mean": 174.6433634079772}, "timesteps_since_restore": 7935416, "episodes_this_iter": 48, "training_iteration": 180, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44783, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d5f8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8371, "info": {"load_time_ms": 7.203, "default": {"vf_explained_var": 0.8881914615631104, "total_loss": 26.2125244140625, "cur_kl_coeff": 0.44999995827674866, "entropy": 1.3035361766815186, "policy_loss": -0.009778696112334728, "cur_lr": 0.0005000000237487257, "kl": 0.013188570737838745, "vf_loss": 26.216365814208984}, "num_steps_trained": 7935416, "update_time_ms": 7.979, "num_steps_sampled": 7935416, "grad_time_ms": 11568.635, "sample_time_ms": 19279.781}}
{"time_this_iter_s": 30.112796306610107, "timesteps_total": 7979283, "num_metric_batches_dropped": 0, "timestamp": 1558579584, "time_since_restore": 5634.027214288712, "episode_reward_max": -94.61523178443065, "hostname": "flow-main", "episode_len_mean": 322.92, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-46-24", "episode_reward_mean": -570.2050843823414, "episode_reward_min": -994.8905713018354, "time_total_s": 5634.027214288712, "iterations_since_restore": 181, "custom_metrics": {"cost1_max": 225.72675557744193, "outflow_rate_mean": 1204.9757362823884, "outflow_rate_min": 730.8336518286103, "cost2_max": -49.309094074346866, "cost2_min": -95.7584122965102, "outflow_rate_max": 1469.7135181266297, "system_level_velocity_min": 10.67440541345704, "system_level_velocity_max": 18.958021576535835, "cost1_min": 79.87842824165581, "cost2_mean": -81.75435774608296, "system_level_velocity_mean": 14.722823153532254, "cost1_mean": 174.82676856294734}, "timesteps_since_restore": 7979283, "episodes_this_iter": 44, "training_iteration": 181, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43867, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914de48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d978>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8415, "info": {"load_time_ms": 7.178, "default": {"vf_explained_var": 0.8980804085731506, "total_loss": 23.762052536010742, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.2922701835632324, "policy_loss": -0.010669302195310593, "cur_lr": 0.0005000000237487257, "kl": 0.013203735463321209, "vf_loss": 23.76677894592285}, "num_steps_trained": 7979283, "update_time_ms": 7.881, "num_steps_sampled": 7979283, "grad_time_ms": 11367.808, "sample_time_ms": 19311.021}}
{"time_this_iter_s": 30.769742488861084, "timesteps_total": 8023244, "num_metric_batches_dropped": 0, "timestamp": 1558579615, "time_since_restore": 5664.796956777573, "episode_reward_max": -165.79887482478017, "hostname": "flow-main", "episode_len_mean": 322.64, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-46-55", "episode_reward_mean": -555.2635454765638, "episode_reward_min": -985.106223491749, "time_total_s": 5664.796956777573, "iterations_since_restore": 182, "custom_metrics": {"cost1_max": 225.57877060733273, "outflow_rate_mean": 1210.8796369245504, "outflow_rate_min": 730.5519449450076, "cost2_max": -63.69351079715074, "cost2_min": -94.91317986023905, "outflow_rate_max": 1472.0010563848346, "system_level_velocity_min": 10.67440541345704, "system_level_velocity_max": 18.958021576535835, "cost1_min": 127.22772359713923, "cost2_mean": -81.0946766049607, "system_level_velocity_mean": 14.871918706065061, "cost1_mean": 176.4256177835185}, "timesteps_since_restore": 8023244, "episodes_this_iter": 49, "training_iteration": 182, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43961, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d470>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8464, "info": {"load_time_ms": 7.248, "default": {"vf_explained_var": 0.8942235708236694, "total_loss": 25.790794372558594, "cur_kl_coeff": 0.45000001788139343, "entropy": 1.3064603805541992, "policy_loss": -0.011154497042298317, "cur_lr": 0.0005000000237487257, "kl": 0.013726367615163326, "vf_loss": 25.795772552490234}, "num_steps_trained": 8023244, "update_time_ms": 7.827, "num_steps_sampled": 8023244, "grad_time_ms": 11361.249, "sample_time_ms": 19250.93}}
{"time_this_iter_s": 30.80541205406189, "timesteps_total": 8066112, "num_metric_batches_dropped": 0, "timestamp": 1558579645, "time_since_restore": 5695.6023688316345, "episode_reward_max": -165.79887482478017, "hostname": "flow-main", "episode_len_mean": 322.64, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-47-25", "episode_reward_mean": -545.6110144019483, "episode_reward_min": -985.106223491749, "time_total_s": 5695.6023688316345, "iterations_since_restore": 183, "custom_metrics": {"cost1_max": 226.0179651939967, "outflow_rate_mean": 1220.304456872615, "outflow_rate_min": 730.5519449450076, "cost2_max": -66.05256956892774, "cost2_min": -94.91317986023905, "outflow_rate_max": 1472.0010563848346, "system_level_velocity_min": 11.276238376739245, "system_level_velocity_max": 18.86791146945388, "cost1_min": 135.62836867768695, "cost2_mean": -82.00892573720473, "system_level_velocity_mean": 15.07461332812425, "cost1_mean": 178.72664077271526}, "timesteps_since_restore": 8066112, "episodes_this_iter": 46, "training_iteration": 183, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 42868, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914ddd8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8510, "info": {"load_time_ms": 6.975, "default": {"vf_explained_var": 0.8924954533576965, "total_loss": 25.624414443969727, "cur_kl_coeff": 0.45000001788139343, "entropy": 1.2507790327072144, "policy_loss": -0.010427338071167469, "cur_lr": 0.0005000000237487257, "kl": 0.013131421059370041, "vf_loss": 25.628934860229492}, "num_steps_trained": 8066112, "update_time_ms": 7.845, "num_steps_sampled": 8066112, "grad_time_ms": 11352.075, "sample_time_ms": 19259.872}}
{"time_this_iter_s": 29.74778652191162, "timesteps_total": 8109034, "num_metric_batches_dropped": 0, "timestamp": 1558579675, "time_since_restore": 5725.350155353546, "episode_reward_max": -103.63792146757284, "hostname": "flow-main", "episode_len_mean": 323.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-47-55", "episode_reward_mean": -527.4904352633315, "episode_reward_min": -822.9768255774012, "time_total_s": 5725.350155353546, "iterations_since_restore": 184, "custom_metrics": {"cost1_max": 226.18002260796118, "outflow_rate_mean": 1235.6028358464353, "outflow_rate_min": 809.0907683095064, "cost2_max": -51.901845104301124, "cost2_min": -97.36460746892118, "outflow_rate_max": 1472.2742875404997, "system_level_velocity_min": 11.278307395940134, "system_level_velocity_max": 18.972161569090712, "cost1_min": 86.48464328126701, "cost2_mean": -83.23100167465071, "system_level_velocity_mean": 15.284933614798014, "cost1_mean": 181.43627524249766}, "timesteps_since_restore": 8109034, "episodes_this_iter": 45, "training_iteration": 184, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 42922, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914de48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914db38>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8555, "info": {"load_time_ms": 7.075, "default": {"vf_explained_var": 0.890426516532898, "total_loss": 25.544153213500977, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.2284880876541138, "policy_loss": -0.012930994853377342, "cur_lr": 0.0005000000237487257, "kl": 0.014085360802710056, "vf_loss": 25.55074119567871}, "num_steps_trained": 8109034, "update_time_ms": 7.976, "num_steps_sampled": 8109034, "grad_time_ms": 11311.92, "sample_time_ms": 19228.909}}
{"time_this_iter_s": 29.91238260269165, "timesteps_total": 8150940, "num_metric_batches_dropped": 0, "timestamp": 1558579705, "time_since_restore": 5755.262537956238, "episode_reward_max": -27.606952626597874, "hostname": "flow-main", "episode_len_mean": 320.12, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-48-25", "episode_reward_mean": -489.5422316348579, "episode_reward_min": -843.5741011058967, "time_total_s": 5755.262537956238, "iterations_since_restore": 185, "custom_metrics": {"cost1_max": 226.18002260796118, "outflow_rate_mean": 1251.9340522664286, "outflow_rate_min": 509.16419877491666, "cost2_max": -17.51502341045193, "cost2_min": -97.36460746892118, "outflow_rate_max": 1472.2742875404997, "system_level_velocity_min": 10.697246498513175, "system_level_velocity_max": 18.972161569090712, "cost1_min": 22.985249283196186, "cost2_mean": -84.0043173232275, "system_level_velocity_mean": 15.737723443081263, "cost1_mean": 184.97432418470189}, "timesteps_since_restore": 8150940, "episodes_this_iter": 49, "training_iteration": 185, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 41906, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914dd30>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8604, "info": {"load_time_ms": 7.327, "default": {"vf_explained_var": 0.8807210922241211, "total_loss": 26.749061584472656, "cur_kl_coeff": 0.45000001788139343, "entropy": 1.2214473485946655, "policy_loss": -0.011915301904082298, "cur_lr": 0.0005000000237487257, "kl": 0.014468814246356487, "vf_loss": 26.754467010498047}, "num_steps_trained": 8150940, "update_time_ms": 7.874, "num_steps_sampled": 8150940, "grad_time_ms": 11249.873, "sample_time_ms": 19216.474}}
{"time_this_iter_s": 28.51647925376892, "timesteps_total": 8194424, "num_metric_batches_dropped": 0, "timestamp": 1558579734, "time_since_restore": 5783.779017210007, "episode_reward_max": -27.606952626597874, "hostname": "flow-main", "episode_len_mean": 322.1, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-48-54", "episode_reward_mean": -509.2514454124716, "episode_reward_min": -843.5741011058967, "time_total_s": 5783.779017210007, "iterations_since_restore": 186, "custom_metrics": {"cost1_max": 225.88819299534384, "outflow_rate_mean": 1242.0560086343835, "outflow_rate_min": 509.16419877491666, "cost2_max": -17.51502341045193, "cost2_min": -95.02615548653898, "outflow_rate_max": 1465.7689290739102, "system_level_velocity_min": 10.697246498513175, "system_level_velocity_max": 18.904045219327845, "cost1_min": 22.985249283196186, "cost2_mean": -83.71569941205411, "system_level_velocity_mean": 15.51018056922129, "cost1_mean": 183.39330784060076}, "timesteps_since_restore": 8194424, "episodes_this_iter": 43, "training_iteration": 186, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43484, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91409b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140dd8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8647, "info": {"load_time_ms": 7.173, "default": {"vf_explained_var": 0.8981168270111084, "total_loss": 23.621959686279297, "cur_kl_coeff": 0.44999995827674866, "entropy": 1.2644158601760864, "policy_loss": -0.011609364300966263, "cur_lr": 0.0005000000237487257, "kl": 0.014488141052424908, "vf_loss": 23.627050399780273}, "num_steps_trained": 8194424, "update_time_ms": 8.004, "num_steps_sampled": 8194424, "grad_time_ms": 11185.733, "sample_time_ms": 19097.721}}
{"time_this_iter_s": 33.23133444786072, "timesteps_total": 8238342, "num_metric_batches_dropped": 0, "timestamp": 1558579767, "time_since_restore": 5817.010351657867, "episode_reward_max": -177.8395055455465, "hostname": "flow-main", "episode_len_mean": 323.9, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-49-27", "episode_reward_mean": -550.3648096755261, "episode_reward_min": -978.4215179024342, "time_total_s": 5817.010351657867, "iterations_since_restore": 187, "custom_metrics": {"cost1_max": 225.88819299534384, "outflow_rate_mean": 1218.8359163494977, "outflow_rate_min": 729.4463467701129, "cost2_max": -59.218118730219516, "cost2_min": -96.92906070673803, "outflow_rate_max": 1467.8939323310385, "system_level_velocity_min": 10.76070684841416, "system_level_velocity_max": 18.904045219327845, "cost1_min": 128.42630965889688, "cost2_mean": -83.90498682870077, "system_level_velocity_mean": 15.064543132717109, "cost1_mean": 179.07666500336802}, "timesteps_since_restore": 8238342, "episodes_this_iter": 49, "training_iteration": 187, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43918, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914d0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140a20>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8696, "info": {"load_time_ms": 7.296, "default": {"vf_explained_var": 0.8777673840522766, "total_loss": 30.1584415435791, "cur_kl_coeff": 0.45000001788139343, "entropy": 1.2920763492584229, "policy_loss": -0.011706075631082058, "cur_lr": 0.0005000000237487257, "kl": 0.013497566804289818, "vf_loss": 30.164079666137695}, "num_steps_trained": 8238342, "update_time_ms": 8.03, "num_steps_sampled": 8238342, "grad_time_ms": 11338.829, "sample_time_ms": 19036.225}}
{"time_this_iter_s": 31.21442151069641, "timesteps_total": 8283016, "num_metric_batches_dropped": 0, "timestamp": 1558579798, "time_since_restore": 5848.224773168564, "episode_reward_max": -172.89853926266258, "hostname": "flow-main", "episode_len_mean": 322.8, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-49-58", "episode_reward_mean": -562.4916156610988, "episode_reward_min": -978.4215179024342, "time_total_s": 5848.224773168564, "iterations_since_restore": 188, "custom_metrics": {"cost1_max": 224.93383742416665, "outflow_rate_mean": 1204.1275897606042, "outflow_rate_min": 729.4463467701129, "cost2_max": -66.45923988805897, "cost2_min": -96.92906070673803, "outflow_rate_max": 1467.8939323310385, "system_level_velocity_min": 10.913632870440463, "system_level_velocity_max": 18.96034374325764, "cost1_min": 128.6523108310506, "cost2_mean": -83.71318296553297, "system_level_velocity_mean": 14.908298561938512, "cost1_mean": 176.48778660245299}, "timesteps_since_restore": 8283016, "episodes_this_iter": 45, "training_iteration": 188, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44674, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914dd30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a914de80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133e48>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8741, "info": {"load_time_ms": 7.569, "default": {"vf_explained_var": 0.8909770250320435, "total_loss": 24.676651000976562, "cur_kl_coeff": 0.44999995827674866, "entropy": 1.3222317695617676, "policy_loss": -0.010734622366726398, "cur_lr": 0.0005000000237487257, "kl": 0.014029745012521744, "vf_loss": 24.681072235107422}, "num_steps_trained": 8283016, "update_time_ms": 8.178, "num_steps_sampled": 8283016, "grad_time_ms": 11341.857, "sample_time_ms": 19104.235}}
{"time_this_iter_s": 30.493874311447144, "timesteps_total": 8327396, "num_metric_batches_dropped": 0, "timestamp": 1558579829, "time_since_restore": 5878.718647480011, "episode_reward_max": -172.89853926266258, "hostname": "flow-main", "episode_len_mean": 323.9, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-50-29", "episode_reward_mean": -568.2057984000586, "episode_reward_min": -963.2930213748958, "time_total_s": 5878.718647480011, "iterations_since_restore": 189, "custom_metrics": {"cost1_max": 224.7846159299532, "outflow_rate_mean": 1203.8470107163694, "outflow_rate_min": 731.9473833115953, "cost2_max": -66.45923988805897, "cost2_min": -95.70839846677427, "outflow_rate_max": 1462.5498741227575, "system_level_velocity_min": 10.913632870440463, "system_level_velocity_max": 18.96034374325764, "cost1_min": 128.6523108310506, "cost2_mean": -83.40873949992589, "system_level_velocity_mean": 14.74283425563739, "cost1_mean": 175.37250633522896}, "timesteps_since_restore": 8327396, "episodes_this_iter": 48, "training_iteration": 189, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44380, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143940>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8789, "info": {"load_time_ms": 7.822, "default": {"vf_explained_var": 0.9038629531860352, "total_loss": 22.329471588134766, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.2926362752914429, "policy_loss": -0.010892946273088455, "cur_lr": 0.0005000000237487257, "kl": 0.013606623746454716, "vf_loss": 22.33424186706543}, "num_steps_trained": 8327396, "update_time_ms": 8.123, "num_steps_sampled": 8327396, "grad_time_ms": 11369.699, "sample_time_ms": 19070.202}}
{"time_this_iter_s": 32.201756715774536, "timesteps_total": 8371605, "num_metric_batches_dropped": 0, "timestamp": 1558579861, "time_since_restore": 5910.9204041957855, "episode_reward_max": -29.51714645185928, "hostname": "flow-main", "episode_len_mean": 319.2, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-51-01", "episode_reward_mean": -564.743488976522, "episode_reward_min": -823.303272938955, "time_total_s": 5910.9204041957855, "iterations_since_restore": 190, "custom_metrics": {"cost1_max": 224.7846159299532, "outflow_rate_mean": 1190.7831229295248, "outflow_rate_min": 466.74083028559994, "cost2_max": -19.34575584407577, "cost2_min": -96.63556468925177, "outflow_rate_max": 1464.1339191675136, "system_level_velocity_min": 11.231664519846792, "system_level_velocity_max": 18.88713819091669, "cost1_min": 22.95755215780544, "cost2_mean": -81.7590406839098, "system_level_velocity_mean": 14.700306094513108, "cost1_mean": 171.4851520843484}, "timesteps_since_restore": 8371605, "episodes_this_iter": 49, "training_iteration": 190, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44209, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9133e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9140fd0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8838, "info": {"load_time_ms": 7.833, "default": {"vf_explained_var": 0.9035781025886536, "total_loss": 22.960914611816406, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.2777245044708252, "policy_loss": -0.01305916253477335, "cur_lr": 0.0005000000237487257, "kl": 0.01562635414302349, "vf_loss": 22.966941833496094}, "num_steps_trained": 8371605, "update_time_ms": 8.164, "num_steps_sampled": 8371605, "grad_time_ms": 11381.937, "sample_time_ms": 19214.057}}
{"time_this_iter_s": 29.382590770721436, "timesteps_total": 8414686, "num_metric_batches_dropped": 0, "timestamp": 1558579891, "time_since_restore": 5940.302994966507, "episode_reward_max": -29.51714645185928, "hostname": "flow-main", "episode_len_mean": 318.1, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-51-31", "episode_reward_mean": -542.1699270319679, "episode_reward_min": -791.2931376879263, "time_total_s": 5940.302994966507, "iterations_since_restore": 191, "custom_metrics": {"cost1_max": 225.31144091106512, "outflow_rate_mean": 1204.7214705383576, "outflow_rate_min": 466.74083028559994, "cost2_max": -19.34575584407577, "cost2_min": -97.68385872831797, "outflow_rate_max": 1469.1508529990074, "system_level_velocity_min": 11.146219500610425, "system_level_velocity_max": 18.913420768444603, "cost1_min": 22.95755215780544, "cost2_mean": -82.18328829710137, "system_level_velocity_mean": 14.996312722958372, "cost1_mean": 174.49886036950193}, "timesteps_since_restore": 8414686, "episodes_this_iter": 43, "training_iteration": 191, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43081, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91435f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143358>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8881, "info": {"load_time_ms": 7.809, "default": {"vf_explained_var": 0.9059069752693176, "total_loss": 21.65785789489746, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.2032663822174072, "policy_loss": -0.011156877502799034, "cur_lr": 0.0005000000237487257, "kl": 0.014078822918236256, "vf_loss": 21.66267967224121}, "num_steps_trained": 8414686, "update_time_ms": 8.202, "num_steps_sampled": 8414686, "grad_time_ms": 11375.704, "sample_time_ms": 19147.566}}
{"time_this_iter_s": 28.674707651138306, "timesteps_total": 8458556, "num_metric_batches_dropped": 0, "timestamp": 1558579919, "time_since_restore": 5968.977702617645, "episode_reward_max": -175.75202074792205, "hostname": "flow-main", "episode_len_mean": 322.8, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-51-59", "episode_reward_mean": -530.2343500226075, "episode_reward_min": -892.5947407699996, "time_total_s": 5968.977702617645, "iterations_since_restore": 192, "custom_metrics": {"cost1_max": 225.31144091106512, "outflow_rate_mean": 1232.2258963828165, "outflow_rate_min": 765.6025684420108, "cost2_max": -60.72381192628182, "cost2_min": -97.68385872831797, "outflow_rate_max": 1469.1508529990074, "system_level_velocity_min": 11.146219500610425, "system_level_velocity_max": 18.913420768444603, "cost1_min": 131.32993595283125, "cost2_mean": -83.24368713891545, "system_level_velocity_mean": 15.222689444128687, "cost1_mean": 180.7015268629305}, "timesteps_since_restore": 8458556, "episodes_this_iter": 48, "training_iteration": 192, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43870, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a90faa20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a90fa9e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a90fa908>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8929, "info": {"load_time_ms": 7.645, "default": {"vf_explained_var": 0.8808387517929077, "total_loss": 26.989269256591797, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.2868015766143799, "policy_loss": -0.011023818515241146, "cur_lr": 0.0005000000237487257, "kl": 0.01396776083856821, "vf_loss": 26.994007110595703}, "num_steps_trained": 8458556, "update_time_ms": 8.271, "num_steps_sampled": 8458556, "grad_time_ms": 11255.5, "sample_time_ms": 19060.047}}
{"time_this_iter_s": 30.51853656768799, "timesteps_total": 8502953, "num_metric_batches_dropped": 0, "timestamp": 1558579950, "time_since_restore": 5999.496239185333, "episode_reward_max": -175.75202074792205, "hostname": "flow-main", "episode_len_mean": 323.9, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-52-30", "episode_reward_mean": -561.5098295786742, "episode_reward_min": -892.5947407699996, "time_total_s": 5999.496239185333, "iterations_since_restore": 193, "custom_metrics": {"cost1_max": 225.4427350369946, "outflow_rate_mean": 1206.535110573485, "outflow_rate_min": 765.6025684420108, "cost2_max": -58.59190850940367, "cost2_min": -94.40753798903823, "outflow_rate_max": 1469.2566121551267, "system_level_velocity_min": 9.739296685053198, "system_level_velocity_max": 18.878659344525087, "cost1_min": 115.36104106703385, "cost2_mean": -80.89103686640165, "system_level_velocity_mean": 14.732164211204593, "cost1_mean": 175.40980810960292}, "timesteps_since_restore": 8502953, "episodes_this_iter": 46, "training_iteration": 193, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44397, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91489e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91486d8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 8975, "info": {"load_time_ms": 7.737, "default": {"vf_explained_var": 0.911448061466217, "total_loss": 20.09501075744629, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.3632478713989258, "policy_loss": -0.010545866563916206, "cur_lr": 0.0005000000237487257, "kl": 0.013576134108006954, "vf_loss": 20.099449157714844}, "num_steps_trained": 8502953, "update_time_ms": 8.187, "num_steps_sampled": 8502953, "grad_time_ms": 11288.852, "sample_time_ms": 18997.308}}
{"time_this_iter_s": 29.69462299346924, "timesteps_total": 8547037, "num_metric_batches_dropped": 0, "timestamp": 1558579980, "time_since_restore": 6029.1908621788025, "episode_reward_max": -256.83822155334684, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-53-00", "episode_reward_mean": -584.8403230746999, "episode_reward_min": -814.1293605115525, "time_total_s": 6029.1908621788025, "iterations_since_restore": 194, "custom_metrics": {"cost1_max": 226.3137860980074, "outflow_rate_mean": 1195.110060836844, "outflow_rate_min": 958.1998305768456, "cost2_max": -58.59190850940367, "cost2_min": -94.40753798903823, "outflow_rate_max": 1469.2566121551267, "system_level_velocity_min": 9.739296685053198, "system_level_velocity_max": 18.968842891668327, "cost1_min": 115.36104106703385, "cost2_mean": -81.06759815348653, "system_level_velocity_mean": 14.38624303467655, "cost1_mean": 171.9996040388082}, "timesteps_since_restore": 8547037, "episodes_this_iter": 46, "training_iteration": 194, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44084, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a90fab38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a90facc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a90fac88>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 9021, "info": {"load_time_ms": 7.654, "default": {"vf_explained_var": 0.9031003713607788, "total_loss": 23.90323829650879, "cur_kl_coeff": 0.44999995827674866, "entropy": 1.3256988525390625, "policy_loss": -0.01001508254557848, "cur_lr": 0.0005000000237487257, "kl": 0.015164912678301334, "vf_loss": 23.906429290771484}, "num_steps_trained": 8547037, "update_time_ms": 8.146, "num_steps_sampled": 8547037, "grad_time_ms": 11360.796, "sample_time_ms": 18919.497}}
{"time_this_iter_s": 30.173019647598267, "timesteps_total": 8592634, "num_metric_batches_dropped": 0, "timestamp": 1558580010, "time_since_restore": 6059.363881826401, "episode_reward_max": -108.29684434677866, "hostname": "flow-main", "episode_len_mean": 322.8, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-53-30", "episode_reward_mean": -586.7621590424279, "episode_reward_min": -1431.6387517883168, "time_total_s": 6059.363881826401, "iterations_since_restore": 195, "custom_metrics": {"cost1_max": 226.3137860980074, "outflow_rate_mean": 1180.333208500686, "outflow_rate_min": 63.72, "cost2_max": -38.953606460917946, "cost2_min": -95.11621684205991, "outflow_rate_max": 1469.6824370721824, "system_level_velocity_min": 4.805944856331648, "system_level_velocity_max": 18.968842891668327, "cost1_min": 55.53008339628852, "cost2_mean": -80.91859085375194, "system_level_velocity_mean": 14.477299089102065, "cost1_mean": 171.52417987540383}, "timesteps_since_restore": 8592634, "episodes_this_iter": 48, "training_iteration": 195, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 45597, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91481d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148c88>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 9069, "info": {"load_time_ms": 7.286, "default": {"vf_explained_var": 0.8635106682777405, "total_loss": 34.940101623535156, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.3774834871292114, "policy_loss": -0.009013423696160316, "cur_lr": 0.0005000000237487257, "kl": 0.013616693206131458, "vf_loss": 34.94298553466797}, "num_steps_trained": 8592634, "update_time_ms": 8.246, "num_steps_sampled": 8592634, "grad_time_ms": 11466.471, "sample_time_ms": 18840.518}}
{"time_this_iter_s": 29.074604034423828, "timesteps_total": 8636081, "num_metric_batches_dropped": 0, "timestamp": 1558580039, "time_since_restore": 6088.438485860825, "episode_reward_max": -102.79386514008857, "hostname": "flow-main", "episode_len_mean": 320.8, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-53-59", "episode_reward_mean": -569.6374352814557, "episode_reward_min": -1431.6387517883168, "time_total_s": 6088.438485860825, "iterations_since_restore": 196, "custom_metrics": {"cost1_max": 225.85622284942247, "outflow_rate_mean": 1192.3651147780147, "outflow_rate_min": 63.72, "cost2_max": -38.953606460917946, "cost2_min": -96.70356511097155, "outflow_rate_max": 1469.6824370721824, "system_level_velocity_min": 4.805944856331648, "system_level_velocity_max": 18.949114352767666, "cost1_min": 55.53008339628852, "cost2_mean": -82.14303588476447, "system_level_velocity_mean": 14.77575183680227, "cost1_mean": 173.8221125907824}, "timesteps_since_restore": 8636081, "episodes_this_iter": 44, "training_iteration": 196, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43447, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a90fac18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a90fab00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a90fa358>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 9113, "info": {"load_time_ms": 7.394, "default": {"vf_explained_var": 0.903956949710846, "total_loss": 23.685840606689453, "cur_kl_coeff": 0.44999995827674866, "entropy": 1.2557334899902344, "policy_loss": -0.010677947662770748, "cur_lr": 0.0005000000237487257, "kl": 0.013571218587458134, "vf_loss": 23.690412521362305}, "num_steps_trained": 8636081, "update_time_ms": 8.03, "num_steps_sampled": 8636081, "grad_time_ms": 11528.021, "sample_time_ms": 18836.481}}
{"time_this_iter_s": 31.610747814178467, "timesteps_total": 8679229, "num_metric_batches_dropped": 0, "timestamp": 1558580071, "time_since_restore": 6120.049233675003, "episode_reward_max": -102.79386514008857, "hostname": "flow-main", "episode_len_mean": 323.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-54-31", "episode_reward_mean": -557.4111944433458, "episode_reward_min": -836.1841490622927, "time_total_s": 6120.049233675003, "iterations_since_restore": 197, "custom_metrics": {"cost1_max": 226.32989936341102, "outflow_rate_mean": 1213.1878193269995, "outflow_rate_min": 809.2201565543879, "cost2_max": -51.85217165170797, "cost2_min": -96.70356511097155, "outflow_rate_max": 1469.0856090641382, "system_level_velocity_min": 10.215566011441979, "system_level_velocity_max": 18.894010536334687, "cost1_min": 85.6925518370089, "cost2_mean": -82.9363378242293, "system_level_velocity_mean": 14.801561765807628, "cost1_mean": 175.7080451570339}, "timesteps_since_restore": 8679229, "episodes_this_iter": 47, "training_iteration": 197, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43148, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91486a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148a90>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 9160, "info": {"load_time_ms": 7.437, "default": {"vf_explained_var": 0.9028812646865845, "total_loss": 22.67800521850586, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.2773324251174927, "policy_loss": -0.011291737668216228, "cur_lr": 0.0005000000237487257, "kl": 0.014267975464463234, "vf_loss": 22.682876586914062}, "num_steps_trained": 8679229, "update_time_ms": 7.771, "num_steps_sampled": 8679229, "grad_time_ms": 11400.262, "sample_time_ms": 18804.266}}
{"time_this_iter_s": 29.884514093399048, "timesteps_total": 8722320, "num_metric_batches_dropped": 0, "timestamp": 1558580100, "time_since_restore": 6149.933747768402, "episode_reward_max": -258.5290037946521, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-55-00", "episode_reward_mean": -536.2727053419127, "episode_reward_min": -836.1841490622927, "time_total_s": 6149.933747768402, "iterations_since_restore": 198, "custom_metrics": {"cost1_max": 226.32989936341102, "outflow_rate_mean": 1234.2569863600238, "outflow_rate_min": 974.264053156146, "cost2_max": -63.07879129088556, "cost2_min": -95.45316621144792, "outflow_rate_max": 1469.0856090641382, "system_level_velocity_min": 10.215566011441979, "system_level_velocity_max": 18.888354137453682, "cost1_min": 123.64763780168516, "cost2_mean": -84.43180374513572, "system_level_velocity_mean": 15.111092705179683, "cost1_mean": 180.77095593854298}, "timesteps_since_restore": 8722320, "episodes_this_iter": 50, "training_iteration": 198, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43091, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a90fad30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143940>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 9210, "info": {"load_time_ms": 7.267, "default": {"vf_explained_var": 0.8970199823379517, "total_loss": 24.32967758178711, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.2562605142593384, "policy_loss": -0.012694458477199078, "cur_lr": 0.0005000000237487257, "kl": 0.014953719452023506, "vf_loss": 24.335641860961914}, "num_steps_trained": 8722320, "update_time_ms": 7.67, "num_steps_sampled": 8722320, "grad_time_ms": 11378.005, "sample_time_ms": 18694.14}}
{"time_this_iter_s": 30.113715648651123, "timesteps_total": 8766491, "num_metric_batches_dropped": 0, "timestamp": 1558580131, "time_since_restore": 6180.047463417053, "episode_reward_max": -258.5290037946521, "hostname": "flow-main", "episode_len_mean": 325.0, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-55-31", "episode_reward_mean": -544.5089056537012, "episode_reward_min": -836.1841490622927, "time_total_s": 6180.047463417053, "iterations_since_restore": 199, "custom_metrics": {"cost1_max": 226.32989936341102, "outflow_rate_mean": 1232.4242039332116, "outflow_rate_min": 716.9067835166883, "cost2_max": -52.79656407224302, "cost2_min": -97.1696868744568, "outflow_rate_max": 1469.0856090641382, "system_level_velocity_min": 10.215566011441979, "system_level_velocity_max": 18.888354137453682, "cost1_min": 123.64763780168516, "cost2_mean": -83.90019828638697, "system_level_velocity_mean": 15.048688085772985, "cost1_mean": 180.0194484230751}, "timesteps_since_restore": 8766491, "episodes_this_iter": 43, "training_iteration": 199, "done": false, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 44171, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9148cf8>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 9253, "info": {"load_time_ms": 7.199, "default": {"vf_explained_var": 0.9055232405662537, "total_loss": 21.485641479492188, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.3305312395095825, "policy_loss": -0.010371520183980465, "cur_lr": 0.0005000000237487257, "kl": 0.01366709265857935, "vf_loss": 21.4898624420166}, "num_steps_trained": 8766491, "update_time_ms": 7.632, "num_steps_sampled": 8766491, "grad_time_ms": 11404.909, "sample_time_ms": 18629.482}}
{"time_this_iter_s": 29.205172538757324, "timesteps_total": 8809580, "num_metric_batches_dropped": 0, "timestamp": 1558580160, "time_since_restore": 6209.252635955811, "episode_reward_max": -102.76680225316241, "hostname": "flow-main", "episode_len_mean": 321.02, "experiment_id": "9c9d14b11ca64b19ad241f31fe2128ee", "date": "2019-05-23_02-56-00", "episode_reward_mean": -551.4241549430603, "episode_reward_min": -833.6585959174487, "time_total_s": 6209.252635955811, "iterations_since_restore": 200, "custom_metrics": {"cost1_max": 225.74814813548375, "outflow_rate_mean": 1212.9645174109546, "outflow_rate_min": 716.9067835166883, "cost2_max": -52.79656407224302, "cost2_min": -97.1696868744568, "outflow_rate_max": 1467.5942181951052, "system_level_velocity_min": 11.447014475368563, "system_level_velocity_max": 18.929421571396446, "cost1_min": 85.16374530132538, "cost2_mean": -82.58411312719765, "system_level_velocity_mean": 14.93919809914217, "cost1_mean": 175.88449331312768}, "timesteps_since_restore": 8809580, "episodes_this_iter": 47, "training_iteration": 200, "done": true, "node_ip": "10.138.0.2", "policy_reward_mean": {}, "pid": 47658, "timesteps_this_iter": 43089, "config": {"output": null, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "clip_actions": false, "sgd_minibatch_size": 128, "monitor": false, "vf_share_layers": false, "train_batch_size": 15000, "kl_target": 0.01, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "optimizer": {}, "num_envs_per_worker": 1, "kl_coeff": 0.2, "output_compress_columns": ["obs", "new_obs"], "custom_resources_per_worker": {}, "num_gpus": 0, "batch_mode": "truncate_episodes", "lambda": 0.97, "use_gae": true, "model": {"conv_filters": null, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "channel_major": false, "use_lstm": false, "max_seq_len": 20, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "conv_activation": "relu", "fcnet_activation": "tanh", "framestack": true, "custom_preprocessor": null, "grayscale": false, "zero_mean": true, "lstm_use_prev_action_reward": false, "free_log_std": false, "custom_model": null}, "num_gpus_per_worker": 0, "vf_loss_coeff": 1.0, "output_max_file_size": 67108864, "entropy_coeff": 0.0, "num_workers": 20, "clip_rewards": null, "vf_clip_param": 1000000.0, "gamma": 0.99, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "observation_filter": "MeanStdFilter", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "num_sgd_iter": 10, "input": "sampler", "lr_schedule": null, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a9143860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb7a91439b0>", "on_sample_end": null, "on_train_result": null}, "straggler_mitigation": false, "num_cpus_for_driver": 1, "clip_param": 0.3, "num_cpus_per_worker": 1, "simple_optimizer": false, "sample_batch_size": 750, "lr": 0.0005, "horizon": 750, "sample_async": false, "collect_metrics_timeout": 180, "synchronize_filters": true, "input_evaluation": null, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "allow_soft_placement": true}, "compress_observations": false, "preprocessor_pref": "deepmind"}, "episodes_total": 9300, "info": {"load_time_ms": 7.176, "default": {"vf_explained_var": 0.8994260430335999, "total_loss": 23.46038818359375, "cur_kl_coeff": 0.44999998807907104, "entropy": 1.295290231704712, "policy_loss": -0.012046901509165764, "cur_lr": 0.0005000000237487257, "kl": 0.01568692922592163, "vf_loss": 23.465375900268555}, "num_steps_trained": 8809580, "update_time_ms": 7.682, "num_steps_sampled": 8809580, "grad_time_ms": 11379.309, "sample_time_ms": 18356.179}}

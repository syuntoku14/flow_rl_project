{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f536ae01a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f536ae019e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f536ae01a20>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 41004, "episodes_this_iter": 40, "pid": 45007, "timesteps_this_iter": 41004, "time_since_restore": 31.300025701522827, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "training_iteration": 1, "iterations_since_restore": 1, "episode_reward_max": -310.16236361025915, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 31.300025701522827, "episodes_total": 40, "timesteps_total": 41004, "episode_reward_mean": -694.4031547956881, "timestamp": 1558583040, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-44-00", "custom_metrics": {"cost2_min": -78.78194879273917, "cost1_mean": 123.9942769964201, "outflow_rate_min": 426.1761290322579, "cost2_mean": -45.57314859970881, "outflow_rate_max": 945.0268159647837, "cost1_max": 143.61833454036466, "system_level_velocity_min": 8.299907758940572, "cost2_max": -21.89654514438914, "cost1_min": 98.51307727719175, "system_level_velocity_mean": 10.324900458379851, "outflow_rate_mean": 742.5550872815329, "system_level_velocity_max": 12.419045399902334}, "time_total_s": 31.300025701522827, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.20000001788139343, "entropy": 1.4176300764083862, "vf_explained_var": 0.5287904739379883, "kl": 0.0034581527579575777, "vf_loss": 16.7158260345459, "total_loss": 16.714529037475586, "policy_loss": -0.0019890395924448967}, "sample_time_ms": 19712.295, "num_steps_sampled": 41004, "num_steps_trained": 41004, "grad_time_ms": 10528.408, "load_time_ms": 64.547, "update_time_ms": 832.717}, "episode_reward_min": -918.3406490687083}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad6a0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 82689, "episodes_this_iter": 40, "pid": 45007, "timesteps_this_iter": 41685, "time_since_restore": 59.66114830970764, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "training_iteration": 2, "iterations_since_restore": 2, "episode_reward_max": -310.16236361025915, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 28.361122608184814, "episodes_total": 80, "timesteps_total": 82689, "episode_reward_mean": -686.8294898884682, "timestamp": 1558583069, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-44-29", "custom_metrics": {"cost2_min": -78.78194879273917, "cost1_mean": 125.06639957576749, "outflow_rate_min": 426.1761290322579, "cost2_mean": -47.123388177222196, "outflow_rate_max": 960.6583275261324, "cost1_max": 150.9686006246784, "system_level_velocity_min": 8.299907758940572, "cost2_max": -21.89654514438914, "cost1_min": 98.51307727719175, "system_level_velocity_mean": 10.402115177122718, "outflow_rate_mean": 758.4155069348496, "system_level_velocity_max": 12.419045399902334}, "time_total_s": 59.66114830970764, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.10000002384185791, "entropy": 1.4088751077651978, "vf_explained_var": 0.5489255785942078, "kl": 0.008430731482803822, "vf_loss": 36.2707633972168, "total_loss": 36.268341064453125, "policy_loss": -0.003264717059209943}, "sample_time_ms": 18828.867, "num_steps_sampled": 82689, "num_steps_trained": 82689, "grad_time_ms": 10424.194, "load_time_ms": 35.04, "update_time_ms": 420.556}, "episode_reward_min": -918.3406490687083}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba49b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4be0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 126939, "episodes_this_iter": 41, "pid": 45007, "timesteps_this_iter": 44250, "time_since_restore": 88.38794255256653, "node_ip": "10.138.0.2", "episode_len_mean": 322.1, "hostname": "flow-main", "training_iteration": 3, "iterations_since_restore": 3, "episode_reward_max": -33.26071674692898, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 28.726794242858887, "episodes_total": 121, "timesteps_total": 126939, "episode_reward_mean": -668.7626367649307, "timestamp": 1558583097, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-44-57", "custom_metrics": {"cost2_min": -83.23377542148435, "cost1_mean": 128.53375142283022, "outflow_rate_min": 491.0341917764782, "cost2_mean": -50.36056595905041, "outflow_rate_max": 1146.6221510855112, "cost1_max": 177.95693161796999, "system_level_velocity_min": 8.915183048780973, "cost2_max": -19.512354920312728, "cost1_min": 22.402069469614744, "system_level_velocity_mean": 10.826530395444307, "outflow_rate_mean": 798.6491003991, "system_level_velocity_max": 18.071007943386856}, "time_total_s": 88.38794255256653, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.10000002384185791, "entropy": 1.3939757347106934, "vf_explained_var": 0.6765230298042297, "kl": 0.007692585699260235, "vf_loss": 44.57404327392578, "total_loss": 44.57101058959961, "policy_loss": -0.003799367928877473}, "sample_time_ms": 18696.453, "num_steps_sampled": 126939, "num_steps_trained": 126939, "grad_time_ms": 10347.276, "load_time_ms": 26.496, "update_time_ms": 283.016}, "episode_reward_min": -855.0159027036135}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb52b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5080>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 168049, "episodes_this_iter": 62, "pid": 45007, "timesteps_this_iter": 41110, "time_since_restore": 119.61708927154541, "node_ip": "10.138.0.2", "episode_len_mean": 316.22, "hostname": "flow-main", "training_iteration": 4, "iterations_since_restore": 4, "episode_reward_max": -25.029371313477803, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 31.229146718978882, "episodes_total": 183, "timesteps_total": 168049, "episode_reward_mean": -617.086103398093, "timestamp": 1558583129, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-45-29", "custom_metrics": {"cost2_min": -92.0333092832132, "cost1_mean": 141.51470370025788, "outflow_rate_min": 454.1881787896761, "cost2_mean": -60.41228952036068, "outflow_rate_max": 1167.114396485867, "cost1_max": 181.54131040828713, "system_level_velocity_min": 9.302585254505766, "cost2_max": -19.430468517002296, "cost1_min": 17.661287832189156, "system_level_velocity_mean": 12.158308400040962, "outflow_rate_mean": 928.9518311891785, "system_level_velocity_max": 18.10053549052487}, "time_total_s": 119.61708927154541, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.394075632095337, "vf_explained_var": 0.7565914392471313, "kl": 0.011990384198725224, "vf_loss": 46.97489547729492, "total_loss": 46.970333099365234, "policy_loss": -0.005758365616202354}, "sample_time_ms": 19099.457, "num_steps_sampled": 168049, "num_steps_trained": 168049, "grad_time_ms": 10465.398, "load_time_ms": 22.893, "update_time_ms": 214.129}, "episode_reward_min": -855.0159027036135}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad4e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad630>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 210080, "episodes_this_iter": 40, "pid": 45007, "timesteps_this_iter": 42031, "time_since_restore": 147.69769263267517, "node_ip": "10.138.0.2", "episode_len_mean": 319.12, "hostname": "flow-main", "training_iteration": 5, "iterations_since_restore": 5, "episode_reward_max": -25.029371313477803, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 28.08060336112976, "episodes_total": 223, "timesteps_total": 210080, "episode_reward_mean": -564.7638329093601, "timestamp": 1558583157, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-45-57", "custom_metrics": {"cost2_min": -107.92704660072857, "cost1_mean": 158.04839438080973, "outflow_rate_min": 454.1881787896761, "cost2_mean": -72.91515262250694, "outflow_rate_max": 1296.1243106092993, "cost1_max": 198.36743406960957, "system_level_velocity_min": 9.877705781102815, "cost2_max": -19.430468517002296, "cost1_min": 17.661287832189156, "system_level_velocity_mean": 13.310572440217197, "outflow_rate_mean": 1043.5879647340364, "system_level_velocity_max": 18.10053549052487}, "time_total_s": 147.69769263267517, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.10000000894069672, "entropy": 1.3978735208511353, "vf_explained_var": 0.8145086765289307, "kl": 0.00818269420415163, "vf_loss": 35.01796340942383, "total_loss": 35.01509094238281, "policy_loss": -0.0036965797189623117}, "sample_time_ms": 18726.542, "num_steps_sampled": 210080, "num_steps_trained": 210080, "grad_time_ms": 10522.432, "load_time_ms": 20.181, "update_time_ms": 172.87}, "episode_reward_min": -809.2353371305418}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badd68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bada20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad828>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 251340, "episodes_this_iter": 40, "pid": 45007, "timesteps_this_iter": 41260, "time_since_restore": 177.42333960533142, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "training_iteration": 6, "iterations_since_restore": 6, "episode_reward_max": -359.3245619018411, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 29.72564697265625, "episodes_total": 263, "timesteps_total": 251340, "episode_reward_mean": -536.6136630815075, "timestamp": 1558583187, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-46-27", "custom_metrics": {"cost2_min": -112.17444832589388, "cost1_mean": 171.85967082471183, "outflow_rate_min": 754.3851866225584, "cost2_mean": -82.94419159378681, "outflow_rate_max": 1310.8786874332986, "cost1_max": 204.18226408745014, "system_level_velocity_min": 9.877705781102815, "cost2_max": -49.30199728414485, "cost1_min": 117.38556176103226, "system_level_velocity_mean": 14.110051428178883, "outflow_rate_mean": 1118.7413328051575, "system_level_velocity_max": 16.956147991462107}, "time_total_s": 177.42333960533142, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.3887860774993896, "vf_explained_var": 0.834577739238739, "kl": 0.0116431238129735, "vf_loss": 28.751039505004883, "total_loss": 28.74571990966797, "policy_loss": -0.006482008844614029}, "sample_time_ms": 18683.393, "num_steps_sampled": 251340, "num_steps_trained": 251340, "grad_time_ms": 10628.593, "load_time_ms": 17.82, "update_time_ms": 145.536}, "episode_reward_min": -814.1809996489039}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5128>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 290699, "episodes_this_iter": 59, "pid": 45007, "timesteps_this_iter": 39359, "time_since_restore": 208.06068015098572, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "training_iteration": 7, "iterations_since_restore": 7, "episode_reward_max": -338.74441930206274, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 30.637340545654297, "episodes_total": 322, "timesteps_total": 290699, "episode_reward_mean": -474.03372978837086, "timestamp": 1558583217, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-46-57", "custom_metrics": {"cost2_min": -118.03754606822102, "cost1_mean": 183.56409317246352, "outflow_rate_min": 842.5888995215314, "cost2_mean": -86.40206904884455, "outflow_rate_max": 1357.8829559889375, "cost1_max": 209.4563062265321, "system_level_velocity_min": 10.882893471894324, "cost2_max": -57.273095567961896, "cost1_min": 132.1486557396155, "system_level_velocity_mean": 15.117009932756348, "outflow_rate_mean": 1189.8667230209473, "system_level_velocity_max": 17.362601682568247}, "time_total_s": 208.06068015098572, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.3936101198196411, "vf_explained_var": 0.8059095740318298, "kl": 0.010078322142362595, "vf_loss": 32.537540435791016, "total_loss": 32.53305435180664, "policy_loss": -0.005496364552527666}, "sample_time_ms": 18802.158, "num_steps_sampled": 290699, "num_steps_trained": 290699, "grad_time_ms": 10686.441, "load_time_ms": 16.125, "update_time_ms": 125.908}, "episode_reward_min": -819.6814990794419}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad2e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad5c0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 330767, "episodes_this_iter": 42, "pid": 45007, "timesteps_this_iter": 40068, "time_since_restore": 237.76085567474365, "node_ip": "10.138.0.2", "episode_len_mean": 322.03, "hostname": "flow-main", "training_iteration": 8, "iterations_since_restore": 8, "episode_reward_max": -24.029633704539663, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 29.700175523757935, "episodes_total": 364, "timesteps_total": 330767, "episode_reward_mean": -465.5906162701365, "timestamp": 1558583247, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-47-27", "custom_metrics": {"cost2_min": -118.03754606822102, "cost1_mean": 182.70159616649687, "outflow_rate_min": 495.38848385431965, "cost2_mean": -86.02110366537998, "outflow_rate_max": 1360.639522589633, "cost1_max": 210.28155733993637, "system_level_velocity_min": 11.263602833795241, "cost2_max": -19.022317943336283, "cost1_min": 18.807984220655733, "system_level_velocity_mean": 15.27424391369433, "outflow_rate_mean": 1182.8076601586695, "system_level_velocity_max": 18.421187199993625}, "time_total_s": 237.76085567474365, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.10000000894069672, "entropy": 1.3883880376815796, "vf_explained_var": 0.8421440720558167, "kl": 0.012813050299882889, "vf_loss": 24.906904220581055, "total_loss": 24.899526596069336, "policy_loss": -0.008658349514007568}, "sample_time_ms": 18656.766, "num_steps_sampled": 330767, "num_steps_trained": 330767, "grad_time_ms": 10845.09, "load_time_ms": 14.896, "update_time_ms": 111.301}, "episode_reward_min": -826.9959228054191}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5400>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5748>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 371909, "episodes_this_iter": 40, "pid": 45007, "timesteps_this_iter": 41142, "time_since_restore": 265.0990080833435, "node_ip": "10.138.0.2", "episode_len_mean": 322.03, "hostname": "flow-main", "training_iteration": 9, "iterations_since_restore": 9, "episode_reward_max": -24.029633704539663, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 27.338152408599854, "episodes_total": 404, "timesteps_total": 371909, "episode_reward_mean": -480.43478529995235, "timestamp": 1558583274, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-47-54", "custom_metrics": {"cost2_min": -109.43535379560706, "cost1_mean": 181.7051329038782, "outflow_rate_min": 495.38848385431965, "cost2_mean": -88.53503430939932, "outflow_rate_max": 1360.639522589633, "cost1_max": 210.28155733993637, "system_level_velocity_min": 11.263602833795241, "cost2_max": -19.022317943336283, "cost1_min": 18.807984220655733, "system_level_velocity_mean": 15.217736961536286, "outflow_rate_mean": 1179.1109188864818, "system_level_velocity_max": 18.421187199993625}, "time_total_s": 265.0990080833435, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.3863348960876465, "vf_explained_var": 0.8466705679893494, "kl": 0.012440425343811512, "vf_loss": 24.647438049316406, "total_loss": 24.642047882080078, "policy_loss": -0.006634715013206005}, "sample_time_ms": 18454.297, "num_steps_sampled": 371909, "num_steps_trained": 371909, "grad_time_ms": 10794.608, "load_time_ms": 13.923, "update_time_ms": 100.036}, "episode_reward_min": -826.9959228054191}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb53c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb55c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5c50>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 412436, "episodes_this_iter": 58, "pid": 45007, "timesteps_this_iter": 40527, "time_since_restore": 296.39819073677063, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "training_iteration": 10, "iterations_since_restore": 10, "episode_reward_max": -330.4867852751967, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 31.299182653427124, "episodes_total": 462, "timesteps_total": 412436, "episode_reward_mean": -500.0986751830923, "timestamp": 1558583306, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-48-26", "custom_metrics": {"cost2_min": -109.43535379560706, "cost1_mean": 180.17704751400538, "outflow_rate_min": 933.2441637103052, "cost2_mean": -90.51896547210461, "outflow_rate_max": 1366.9331571564323, "cost1_max": 213.2733146368397, "system_level_velocity_min": 11.736233256087052, "cost2_max": -73.82059764785353, "cost1_min": 139.31234528339382, "system_level_velocity_mean": 14.936862912824973, "outflow_rate_mean": 1176.5537563780633, "system_level_velocity_max": 17.760968938062003}, "time_total_s": 296.39819073677063, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.3731935024261475, "vf_explained_var": 0.8171064257621765, "kl": 0.011422290466725826, "vf_loss": 28.66468620300293, "total_loss": 28.659971237182617, "policy_loss": -0.00585912773385644}, "sample_time_ms": 18465.12, "num_steps_sampled": 412436, "num_steps_trained": 412436, "grad_time_ms": 10979.584, "load_time_ms": 13.121, "update_time_ms": 91.024}, "episode_reward_min": -788.673381250774}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f536dde3be0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5940>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 449520, "episodes_this_iter": 43, "pid": 45007, "timesteps_this_iter": 37084, "time_since_restore": 322.78908228874207, "node_ip": "10.138.0.2", "episode_len_mean": 322.1, "hostname": "flow-main", "training_iteration": 11, "iterations_since_restore": 11, "episode_reward_max": -33.35354961228862, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 26.390891551971436, "episodes_total": 505, "timesteps_total": 449520, "episode_reward_mean": -463.37919674897233, "timestamp": 1558583332, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-48-52", "custom_metrics": {"cost2_min": -105.22013484437929, "cost1_mean": 181.56192201862518, "outflow_rate_min": 468.8485586228365, "cost2_mean": -84.94349501295648, "outflow_rate_max": 1379.394896543249, "cost1_max": 213.7884557215741, "system_level_velocity_min": 10.418003443124185, "cost2_max": -24.191299044401365, "cost1_min": 22.85597684962139, "system_level_velocity_mean": 15.263792671978171, "outflow_rate_mean": 1184.5716389353342, "system_level_velocity_max": 18.307745856375973}, "time_total_s": 322.78908228874207, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.10000000894069672, "entropy": 1.3486907482147217, "vf_explained_var": 0.8597713112831116, "kl": 0.012477823533117771, "vf_loss": 19.110286712646484, "total_loss": 19.10352897644043, "policy_loss": -0.008006380870938301}, "sample_time_ms": 18228.13, "num_steps_sampled": 449520, "num_steps_trained": 449520, "grad_time_ms": 10822.825, "load_time_ms": 7.494, "update_time_ms": 8.519}, "episode_reward_min": -731.9926456651029}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb54e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5780>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 486844, "episodes_this_iter": 40, "pid": 45007, "timesteps_this_iter": 37324, "time_since_restore": 348.19129729270935, "node_ip": "10.138.0.2", "episode_len_mean": 322.1, "hostname": "flow-main", "training_iteration": 12, "iterations_since_restore": 12, "episode_reward_max": -33.35354961228862, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 25.402215003967285, "episodes_total": 545, "timesteps_total": 486844, "episode_reward_mean": -428.04639473697586, "timestamp": 1558583358, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-49-18", "custom_metrics": {"cost2_min": -105.22013484437929, "cost1_mean": 185.26871844482213, "outflow_rate_min": 468.8485586228365, "cost2_mean": -79.38057482032386, "outflow_rate_max": 1379.394896543249, "cost1_max": 213.7884557215741, "system_level_velocity_min": 10.418003443124185, "cost2_max": -24.191299044401365, "cost1_min": 22.85597684962139, "system_level_velocity_mean": 15.61442492605889, "outflow_rate_mean": 1194.1227613155424, "system_level_velocity_max": 18.307745856375973}, "time_total_s": 348.19129729270935, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.10000000894069672, "entropy": 1.3395150899887085, "vf_explained_var": 0.874764084815979, "kl": 0.01615441031754017, "vf_loss": 16.437732696533203, "total_loss": 16.429412841796875, "policy_loss": -0.009936854243278503}, "sample_time_ms": 18030.255, "num_steps_sampled": 486844, "num_steps_trained": 486844, "grad_time_ms": 10726.006, "load_time_ms": 7.543, "update_time_ms": 8.334}, "episode_reward_min": -697.9173226200669}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb53c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5160>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 521661, "episodes_this_iter": 57, "pid": 45007, "timesteps_this_iter": 34817, "time_since_restore": 373.8399729728699, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "training_iteration": 13, "iterations_since_restore": 13, "episode_reward_max": -316.97327287023404, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 25.648675680160522, "episodes_total": 602, "timesteps_total": 521661, "episode_reward_mean": -402.8246265180707, "timestamp": 1558583383, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-49-43", "custom_metrics": {"cost2_min": -97.2243684344836, "cost1_mean": 186.62038852922305, "outflow_rate_min": 1000.098567073171, "cost2_mean": -70.3206967662039, "outflow_rate_max": 1330.6608411108455, "cost1_max": 208.7002171315785, "system_level_velocity_min": 12.110895006776959, "cost2_max": -47.031360707527355, "cost1_min": 145.2768276915096, "system_level_velocity_mean": 15.603861856001886, "outflow_rate_mean": 1178.8306333279695, "system_level_velocity_max": 17.506017300465697}, "time_total_s": 373.8399729728699, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.10000000894069672, "entropy": 1.326114296913147, "vf_explained_var": 0.8427250385284424, "kl": 0.010989701375365257, "vf_loss": 17.23693084716797, "total_loss": 17.23142433166504, "policy_loss": -0.006607347633689642}, "sample_time_ms": 17881.405, "num_steps_sampled": 521661, "num_steps_trained": 521661, "grad_time_ms": 10568.358, "load_time_ms": 7.099, "update_time_ms": 8.25}, "episode_reward_min": -606.7969878517505}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad748>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 554931, "episodes_this_iter": 43, "pid": 45007, "timesteps_this_iter": 33270, "time_since_restore": 397.8570032119751, "node_ip": "10.138.0.2", "episode_len_mean": 324.82, "hostname": "flow-main", "training_iteration": 14, "iterations_since_restore": 14, "episode_reward_max": -296.86939772886944, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.017030239105225, "episodes_total": 645, "timesteps_total": 554931, "episode_reward_mean": -382.54834242338677, "timestamp": 1558583407, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-50-07", "custom_metrics": {"cost2_min": -85.67891253509012, "cost1_mean": 184.99754256029402, "outflow_rate_min": 913.846177350905, "cost2_mean": -62.580050956262085, "outflow_rate_max": 1295.2297223470293, "cost1_max": 206.67214997914292, "system_level_velocity_min": 12.793357445491688, "cost2_max": -42.63279012380718, "cost1_min": 155.29876881876203, "system_level_velocity_mean": 15.5172420661657, "outflow_rate_mean": 1144.9653916480663, "system_level_velocity_max": 17.49468774420879}, "time_total_s": 397.8570032119751, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.10000000894069672, "entropy": 1.3372846841812134, "vf_explained_var": 0.8872151374816895, "kl": 0.021707797423005104, "vf_loss": 12.171910285949707, "total_loss": 12.160993576049805, "policy_loss": -0.013087933883070946}, "sample_time_ms": 17409.721, "num_steps_sampled": 554931, "num_steps_trained": 554931, "grad_time_ms": 10319.148, "load_time_ms": 6.416, "update_time_ms": 8.461}, "episode_reward_min": -557.9856477430903}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb57b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb54e0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 587862, "episodes_this_iter": 40, "pid": 45007, "timesteps_this_iter": 32931, "time_since_restore": 420.8482930660248, "node_ip": "10.138.0.2", "episode_len_mean": 324.82, "hostname": "flow-main", "training_iteration": 15, "iterations_since_restore": 15, "episode_reward_max": -280.6648165902007, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.991289854049683, "episodes_total": 685, "timesteps_total": 587862, "episode_reward_mean": -368.9499301181047, "timestamp": 1558583430, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-50-30", "custom_metrics": {"cost2_min": -82.7819666985534, "cost1_mean": 184.87170768413694, "outflow_rate_min": 875.1799007658291, "cost2_mean": -58.41273565353845, "outflow_rate_max": 1295.2297223470293, "cost1_max": 206.67214997914292, "system_level_velocity_min": 11.558594428410126, "cost2_max": -41.705200324720835, "cost1_min": 137.72097224282095, "system_level_velocity_mean": 15.553257150067695, "outflow_rate_mean": 1125.0949998206643, "system_level_velocity_max": 17.49468774420879}, "time_total_s": 420.8482930660248, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.3258750438690186, "vf_explained_var": 0.890075147151947, "kl": 0.012909719720482826, "vf_loss": 12.302377700805664, "total_loss": 12.293901443481445, "policy_loss": -0.01041253749281168}, "sample_time_ms": 17116.087, "num_steps_sampled": 587862, "num_steps_trained": 587862, "grad_time_ms": 10104.805, "load_time_ms": 6.225, "update_time_ms": 8.576}, "episode_reward_min": -546.5152277816968}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb55f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb50f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5710>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 621104, "episodes_this_iter": 40, "pid": 45007, "timesteps_this_iter": 33242, "time_since_restore": 445.6354703903198, "node_ip": "10.138.0.2", "episode_len_mean": 324.82, "hostname": "flow-main", "training_iteration": 16, "iterations_since_restore": 16, "episode_reward_max": -280.6648165902007, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.787177324295044, "episodes_total": 725, "timesteps_total": 621104, "episode_reward_mean": -366.91152144331545, "timestamp": 1558583455, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-50-55", "custom_metrics": {"cost2_min": -79.85048864549222, "cost1_mean": 184.90466708574382, "outflow_rate_min": 875.1799007658291, "cost2_mean": -57.19943061373753, "outflow_rate_max": 1292.6580212759588, "cost1_max": 206.63823244409178, "system_level_velocity_min": 11.558594428410126, "cost2_max": -41.705200324720835, "cost1_min": 137.72097224282095, "system_level_velocity_mean": 15.571759231806276, "outflow_rate_mean": 1119.703408275923, "system_level_velocity_max": 17.61026340251841}, "time_total_s": 445.6354703903198, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.328474998474121, "vf_explained_var": 0.8930081129074097, "kl": 0.013266492635011673, "vf_loss": 13.86063003540039, "total_loss": 13.85326099395752, "policy_loss": -0.009357605129480362}, "sample_time_ms": 16732.398, "num_steps_sampled": 621104, "num_steps_trained": 621104, "grad_time_ms": 9995.897, "load_time_ms": 6.028, "update_time_ms": 8.457}, "episode_reward_min": -546.5152277816968}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5ba8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb54a8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 654351, "episodes_this_iter": 60, "pid": 45007, "timesteps_this_iter": 33247, "time_since_restore": 472.22288250923157, "node_ip": "10.138.0.2", "episode_len_mean": 321.64, "hostname": "flow-main", "training_iteration": 17, "iterations_since_restore": 17, "episode_reward_max": -112.64106469845436, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 26.587412118911743, "episodes_total": 785, "timesteps_total": 654351, "episode_reward_mean": -365.2505455811408, "timestamp": 1558583482, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-51-22", "custom_metrics": {"cost2_min": -84.36971969759013, "cost1_mean": 183.41599489164548, "outflow_rate_min": 802.2934676616813, "cost2_mean": -58.67006728382272, "outflow_rate_max": 1302.9517544437128, "cost1_max": 208.3256558071228, "system_level_velocity_min": 11.892105527683082, "cost2_max": -38.61929296457055, "cost1_min": 82.76355816018214, "system_level_velocity_mean": 15.643498470763369, "outflow_rate_mean": 1125.3341675786717, "system_level_velocity_max": 18.392064300053445}, "time_total_s": 472.22288250923157, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.3084577322006226, "vf_explained_var": 0.8705769777297974, "kl": 0.01466086134314537, "vf_loss": 18.314125061035156, "total_loss": 18.305431365966797, "policy_loss": -0.010892613790929317}, "sample_time_ms": 16427.722, "num_steps_sampled": 654351, "num_steps_trained": 654351, "grad_time_ms": 9896.244, "load_time_ms": 5.831, "update_time_ms": 8.568}, "episode_reward_min": -517.243728287428}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb57b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb59e8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 687844, "episodes_this_iter": 41, "pid": 45007, "timesteps_this_iter": 33493, "time_since_restore": 496.8239495754242, "node_ip": "10.138.0.2", "episode_len_mean": 321.64, "hostname": "flow-main", "training_iteration": 18, "iterations_since_restore": 18, "episode_reward_max": -112.64106469845436, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.601067066192627, "episodes_total": 826, "timesteps_total": 687844, "episode_reward_mean": -367.06776258679804, "timestamp": 1558583507, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-51-47", "custom_metrics": {"cost2_min": -84.36971969759013, "cost1_mean": 182.79713242084733, "outflow_rate_min": 802.2934676616813, "cost2_mean": -59.49789330799094, "outflow_rate_max": 1302.9517544437128, "cost1_max": 208.3256558071228, "system_level_velocity_min": 11.892105527683082, "cost2_max": -38.61929296457055, "cost1_min": 82.76355816018214, "system_level_velocity_mean": 15.616041868869074, "outflow_rate_mean": 1128.6981630781788, "system_level_velocity_max": 18.392064300053445}, "time_total_s": 496.8239495754242, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.3039473295211792, "vf_explained_var": 0.9203780293464661, "kl": 0.013611244969069958, "vf_loss": 12.027106285095215, "total_loss": 12.019755363464355, "policy_loss": -0.009392420761287212}, "sample_time_ms": 16204.307, "num_steps_sampled": 687844, "num_steps_trained": 687844, "grad_time_ms": 9611.841, "load_time_ms": 5.581, "update_time_ms": 8.554}, "episode_reward_min": -564.4624788364825}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb53c8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 720780, "episodes_this_iter": 42, "pid": 45007, "timesteps_this_iter": 32936, "time_since_restore": 521.4947791099548, "node_ip": "10.138.0.2", "episode_len_mean": 322.46, "hostname": "flow-main", "training_iteration": 19, "iterations_since_restore": 19, "episode_reward_max": -191.46053315027848, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.67082953453064, "episodes_total": 868, "timesteps_total": 720780, "episode_reward_mean": -364.8074938337271, "timestamp": 1558583531, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-52-11", "custom_metrics": {"cost2_min": -78.16255034006356, "cost1_mean": 184.72867173896094, "outflow_rate_min": 933.7162314049588, "cost2_mean": -58.87397473267437, "outflow_rate_max": 1302.9517544437128, "cost1_max": 208.18652209736018, "system_level_velocity_min": 12.056209099814609, "cost2_max": -39.76857712442843, "cost1_min": 128.95598076797532, "system_level_velocity_mean": 15.752707504103602, "outflow_rate_mean": 1138.3381834983838, "system_level_velocity_max": 17.80610986850626}, "time_total_s": 521.4947791099548, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.2686209678649902, "vf_explained_var": 0.8957043886184692, "kl": 0.013951512984931469, "vf_loss": 13.186015129089355, "total_loss": 13.179337501525879, "policy_loss": -0.008770219050347805}, "sample_time_ms": 16108.292, "num_steps_sampled": 720780, "num_steps_trained": 720780, "grad_time_ms": 9444.496, "load_time_ms": 5.461, "update_time_ms": 8.361}, "episode_reward_min": -564.4624788364825}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb56d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5940>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 753392, "episodes_this_iter": 55, "pid": 45007, "timesteps_this_iter": 32612, "time_since_restore": 545.580073595047, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "training_iteration": 20, "iterations_since_restore": 20, "episode_reward_max": -193.2746064322163, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.085294485092163, "episodes_total": 923, "timesteps_total": 753392, "episode_reward_mean": -357.5156763647509, "timestamp": 1558583555, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-52-35", "custom_metrics": {"cost2_min": -76.3055231954751, "cost1_mean": 186.16227768218022, "outflow_rate_min": 909.9590654729805, "cost2_mean": -55.66344448055656, "outflow_rate_max": 1259.6349292562081, "cost1_max": 208.0532531374049, "system_level_velocity_min": 12.2656605130639, "cost2_max": -40.258143447958055, "cost1_min": 128.95598076797532, "system_level_velocity_mean": 15.850309684571876, "outflow_rate_mean": 1138.7420865886522, "system_level_velocity_max": 17.80610986850626}, "time_total_s": 545.580073595047, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.268413782119751, "vf_explained_var": 0.8870909810066223, "kl": 0.012907259166240692, "vf_loss": 13.184752464294434, "total_loss": 13.177721977233887, "policy_loss": -0.008967673406004906}, "sample_time_ms": 15837.032, "num_steps_sampled": 753392, "num_steps_trained": 753392, "grad_time_ms": 8994.179, "load_time_ms": 5.433, "update_time_ms": 8.206}, "episode_reward_min": -523.7116424406446}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bada90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badfd0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badf60>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 785852, "episodes_this_iter": 43, "pid": 45007, "timesteps_this_iter": 32460, "time_since_restore": 570.2310976982117, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "training_iteration": 21, "iterations_since_restore": 21, "episode_reward_max": -182.71467339426394, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.651024103164673, "episodes_total": 966, "timesteps_total": 785852, "episode_reward_mean": -345.0446973766297, "timestamp": 1558583580, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-53-00", "custom_metrics": {"cost2_min": -76.3055231954751, "cost1_mean": 188.05633184727486, "outflow_rate_min": 909.9590654729805, "cost2_mean": -51.86189520227634, "outflow_rate_max": 1255.3112262415693, "cost1_max": 204.38638075538285, "system_level_velocity_min": 12.2656605130639, "cost2_max": -38.565122224133276, "cost1_min": 132.39106200118562, "system_level_velocity_mean": 16.058048811937738, "outflow_rate_mean": 1139.7559619311571, "system_level_velocity_max": 17.730017180032963}, "time_total_s": 570.2310976982117, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.2496514320373535, "vf_explained_var": 0.896532416343689, "kl": 0.01189761608839035, "vf_loss": 11.424549102783203, "total_loss": 11.419069290161133, "policy_loss": -0.00726495822891593}, "sample_time_ms": 15608.674, "num_steps_sampled": 785852, "num_steps_trained": 785852, "grad_time_ms": 9049.592, "load_time_ms": 5.031, "update_time_ms": 8.154}, "episode_reward_min": -523.7116424406446}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad7f0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 818007, "episodes_this_iter": 43, "pid": 45007, "timesteps_this_iter": 32155, "time_since_restore": 595.6154897212982, "node_ip": "10.138.0.2", "episode_len_mean": 320.97, "hostname": "flow-main", "training_iteration": 22, "iterations_since_restore": 22, "episode_reward_max": -36.540135406712146, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 25.384392023086548, "episodes_total": 1009, "timesteps_total": 818007, "episode_reward_mean": -333.31806960605337, "timestamp": 1558583605, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-53-25", "custom_metrics": {"cost2_min": -70.29928031710317, "cost1_mean": 187.55640724354154, "outflow_rate_min": 491.7311933508565, "cost2_mean": -49.48736975292101, "outflow_rate_max": 1228.5918207803759, "cost1_max": 204.7075456481209, "system_level_velocity_min": 12.638265367272677, "cost2_max": -24.27437819371533, "cost1_min": 26.22887326495496, "system_level_velocity_mean": 16.191193365769827, "outflow_rate_mean": 1132.3468745198243, "system_level_velocity_max": 18.409978387700384}, "time_total_s": 595.6154897212982, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.228031039237976, "vf_explained_var": 0.8826798796653748, "kl": 0.013550085946917534, "vf_loss": 12.792763710021973, "total_loss": 12.7872896194458, "policy_loss": -0.007507197558879852}, "sample_time_ms": 15560.7, "num_steps_sampled": 818007, "num_steps_trained": 818007, "grad_time_ms": 9093.716, "load_time_ms": 4.842, "update_time_ms": 8.356}, "episode_reward_min": -457.47222151419356}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb54a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5a58>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 850381, "episodes_this_iter": 54, "pid": 45007, "timesteps_this_iter": 32374, "time_since_restore": 619.656919002533, "node_ip": "10.138.0.2", "episode_len_mean": 322.15, "hostname": "flow-main", "training_iteration": 23, "iterations_since_restore": 23, "episode_reward_max": -36.540135406712146, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.04142928123474, "episodes_total": 1063, "timesteps_total": 850381, "episode_reward_mean": -339.24956190928526, "timestamp": 1558583630, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-53-50", "custom_metrics": {"cost2_min": -70.29928031710317, "cost1_mean": 185.97667444799413, "outflow_rate_min": 491.7311933508565, "cost2_mean": -49.94237176715913, "outflow_rate_max": 1230.1551026649668, "cost1_max": 204.7075456481209, "system_level_velocity_min": 12.676106659283189, "cost2_max": -24.27437819371533, "cost1_min": 26.22887326495496, "system_level_velocity_mean": 15.943055042216269, "outflow_rate_mean": 1124.5091388660119, "system_level_velocity_max": 18.409978387700384}, "time_total_s": 619.656919002533, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "entropy": 1.231597661972046, "vf_explained_var": 0.8745129108428955, "kl": 0.013198984786868095, "vf_loss": 13.576007843017578, "total_loss": 13.570599555969238, "policy_loss": -0.007388314697891474}, "sample_time_ms": 15463.418, "num_steps_sampled": 850381, "num_steps_trained": 850381, "grad_time_ms": 9030.642, "load_time_ms": 4.741, "update_time_ms": 8.887}, "episode_reward_min": -438.0776347425288}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5b70>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 882594, "episodes_this_iter": 44, "pid": 45007, "timesteps_this_iter": 32213, "time_since_restore": 642.556227684021, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "training_iteration": 24, "iterations_since_restore": 24, "episode_reward_max": -277.7842453220968, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.899308681488037, "episodes_total": 1107, "timesteps_total": 882594, "episode_reward_mean": -339.69287886997574, "timestamp": 1558583653, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-54-13", "custom_metrics": {"cost2_min": -65.2531744925625, "cost1_mean": 188.5992861888701, "outflow_rate_min": 893.0282614678898, "cost2_mean": -50.10464447076145, "outflow_rate_max": 1230.1551026649668, "cost1_max": 206.21950465150076, "system_level_velocity_min": 12.991622524660734, "cost2_max": -38.25167362234682, "cost1_min": 152.84215438845206, "system_level_velocity_mean": 16.015577454076134, "outflow_rate_mean": 1132.3157650250782, "system_level_velocity_max": 17.749715003748445}, "time_total_s": 642.556227684021, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.2173672914505005, "vf_explained_var": 0.9000105857849121, "kl": 0.011322563514113426, "vf_loss": 10.754634857177734, "total_loss": 10.750441551208496, "policy_loss": -0.00589111028239131}, "sample_time_ms": 15394.347, "num_steps_sampled": 882594, "num_steps_trained": 882594, "grad_time_ms": 8990.026, "load_time_ms": 4.597, "update_time_ms": 8.73}, "episode_reward_min": -423.2776338862279}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4f98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4860>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 915387, "episodes_this_iter": 42, "pid": 45007, "timesteps_this_iter": 32793, "time_since_restore": 665.6870920658112, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "training_iteration": 25, "iterations_since_restore": 25, "episode_reward_max": -277.7842453220968, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.13086438179016, "episodes_total": 1149, "timesteps_total": 915387, "episode_reward_mean": -338.18874086551347, "timestamp": 1558583676, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-54-36", "custom_metrics": {"cost2_min": -65.2531744925625, "cost1_mean": 190.3067319106362, "outflow_rate_min": 925.2781875000001, "cost2_mean": -50.229255982884325, "outflow_rate_max": 1230.1551026649668, "cost1_max": 206.21950465150076, "system_level_velocity_min": 13.088466446695053, "cost2_max": -40.75231053071167, "cost1_min": 154.5835925811424, "system_level_velocity_mean": 16.14713448009287, "outflow_rate_mean": 1140.5072330249711, "system_level_velocity_max": 17.775794436463134}, "time_total_s": 665.6870920658112, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.15000000596046448, "entropy": 1.2190525531768799, "vf_explained_var": 0.8935118913650513, "kl": 0.012024850584566593, "vf_loss": 11.543155670166016, "total_loss": 11.538372039794922, "policy_loss": -0.006586885079741478}, "sample_time_ms": 15459.38, "num_steps_sampled": 915387, "num_steps_trained": 915387, "grad_time_ms": 8938.801, "load_time_ms": 4.334, "update_time_ms": 8.789}, "episode_reward_min": -424.1554924221343}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd6a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd6d8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 947643, "episodes_this_iter": 54, "pid": 45007, "timesteps_this_iter": 32256, "time_since_restore": 691.050304889679, "node_ip": "10.138.0.2", "episode_len_mean": 324.8, "hostname": "flow-main", "training_iteration": 26, "iterations_since_restore": 26, "episode_reward_max": -277.8758544707432, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 25.363212823867798, "episodes_total": 1203, "timesteps_total": 947643, "episode_reward_mean": -338.155228758449, "timestamp": 1558583701, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-55-01", "custom_metrics": {"cost2_min": -68.81329645311597, "cost1_mean": 190.5104180923696, "outflow_rate_min": 973.5821732283464, "cost2_mean": -50.01831117757861, "outflow_rate_max": 1243.042887422482, "cost1_max": 208.22781498087357, "system_level_velocity_min": 13.078202289690388, "cost2_max": -39.93133772797172, "cost1_min": 156.67974534348895, "system_level_velocity_mean": 16.161199908144617, "outflow_rate_mean": 1141.1726636753226, "system_level_velocity_max": 17.93146451654343}, "time_total_s": 691.050304889679, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "entropy": 1.213422417640686, "vf_explained_var": 0.8866885304450989, "kl": 0.014254048466682434, "vf_loss": 12.124271392822266, "total_loss": 12.116663932800293, "policy_loss": -0.009743859991431236}, "sample_time_ms": 15556.168, "num_steps_sampled": 947643, "num_steps_trained": 947643, "grad_time_ms": 8899.904, "load_time_ms": 4.424, "update_time_ms": 9.009}, "episode_reward_min": -455.2214953126819}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4be0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4cf8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 980219, "episodes_this_iter": 43, "pid": 45007, "timesteps_this_iter": 32576, "time_since_restore": 715.2217798233032, "node_ip": "10.138.0.2", "episode_len_mean": 324.52, "hostname": "flow-main", "training_iteration": 27, "iterations_since_restore": 27, "episode_reward_max": -278.509522694336, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.171474933624268, "episodes_total": 1246, "timesteps_total": 980219, "episode_reward_mean": -336.2537772015305, "timestamp": 1558583725, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-55-25", "custom_metrics": {"cost2_min": -68.81329645311597, "cost1_mean": 190.2263617330304, "outflow_rate_min": 973.5821732283464, "cost2_mean": -49.576834102617546, "outflow_rate_max": 1243.042887422482, "cost1_max": 208.22781498087357, "system_level_velocity_min": 12.541714477929983, "cost2_max": -36.63937260780258, "cost1_min": 152.7691504776717, "system_level_velocity_mean": 16.15402866583133, "outflow_rate_mean": 1136.4524489722523, "system_level_velocity_max": 17.93146451654343}, "time_total_s": 715.2217798233032, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.2126091718673706, "vf_explained_var": 0.8968081474304199, "kl": 0.01309623196721077, "vf_loss": 11.469234466552734, "total_loss": 11.463645935058594, "policy_loss": -0.0075525809079408646}, "sample_time_ms": 15447.798, "num_steps_sampled": 980219, "num_steps_trained": 980219, "grad_time_ms": 8766.256, "load_time_ms": 4.544, "update_time_ms": 9.021}, "episode_reward_min": -455.2214953126819}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc60f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6518>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1011628, "episodes_this_iter": 44, "pid": 45007, "timesteps_this_iter": 31409, "time_since_restore": 738.1188132762909, "node_ip": "10.138.0.2", "episode_len_mean": 321.54, "hostname": "flow-main", "training_iteration": 28, "iterations_since_restore": 28, "episode_reward_max": -24.80088435917288, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.89703345298767, "episodes_total": 1290, "timesteps_total": 1011628, "episode_reward_mean": -331.3104907451457, "timestamp": 1558583748, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-55-48", "custom_metrics": {"cost2_min": -63.77575960983297, "cost1_mean": 186.79620764940736, "outflow_rate_min": 437.2949997643919, "cost2_mean": -48.50656896032834, "outflow_rate_max": 1230.4736175617538, "cost1_max": 207.4543923286999, "system_level_velocity_min": 12.541714477929983, "cost2_max": -20.640963026707983, "cost1_min": 17.851845730752526, "system_level_velocity_mean": 16.046829240136784, "outflow_rate_mean": 1115.0452348486187, "system_level_velocity_max": 17.93146451654343}, "time_total_s": 738.1188132762909, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.15000000596046448, "entropy": 1.2193678617477417, "vf_explained_var": 0.8966289162635803, "kl": 0.015371328219771385, "vf_loss": 11.100634574890137, "total_loss": 11.094524383544922, "policy_loss": -0.008416863158345222}, "sample_time_ms": 15414.225, "num_steps_sampled": 1011628, "num_steps_trained": 1011628, "grad_time_ms": 8629.763, "load_time_ms": 4.59, "update_time_ms": 8.94}, "episode_reward_min": -455.2214953126819}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbda20>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1042945, "episodes_this_iter": 43, "pid": 45007, "timesteps_this_iter": 31317, "time_since_restore": 760.9704813957214, "node_ip": "10.138.0.2", "episode_len_mean": 320.36, "hostname": "flow-main", "training_iteration": 29, "iterations_since_restore": 29, "episode_reward_max": -24.80088435917288, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.851668119430542, "episodes_total": 1333, "timesteps_total": 1042945, "episode_reward_mean": -327.7939051823321, "timestamp": 1558583771, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-56-11", "custom_metrics": {"cost2_min": -63.77575960983297, "cost1_mean": 185.51214580884113, "outflow_rate_min": 437.2949997643919, "cost2_mean": -48.05482837609361, "outflow_rate_max": 1223.6132640116846, "cost1_max": 206.6900192868517, "system_level_velocity_min": 13.536218259923203, "cost2_max": -20.640963026707983, "cost1_min": 17.851845730752526, "system_level_velocity_mean": 16.012673805532057, "outflow_rate_mean": 1107.2058657948207, "system_level_velocity_max": 17.91562796586139}, "time_total_s": 760.9704813957214, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.2170249223709106, "vf_explained_var": 0.8850540518760681, "kl": 0.013248738832771778, "vf_loss": 11.686385154724121, "total_loss": 11.681710243225098, "policy_loss": -0.00666319252923131}, "sample_time_ms": 15330.313, "num_steps_sampled": 1042945, "num_steps_trained": 1042945, "grad_time_ms": 8531.097, "load_time_ms": 4.553, "update_time_ms": 8.944}, "episode_reward_min": -428.2364818330035}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbda58>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1073974, "episodes_this_iter": 54, "pid": 45007, "timesteps_this_iter": 31029, "time_since_restore": 787.2886981964111, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "training_iteration": 30, "iterations_since_restore": 30, "episode_reward_max": -179.83494833431556, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 26.318216800689697, "episodes_total": 1387, "timesteps_total": 1073974, "episode_reward_mean": -324.5691999579913, "timestamp": 1558583798, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-56-38", "custom_metrics": {"cost2_min": -59.633945559076075, "cost1_mean": 189.34245173237392, "outflow_rate_min": 972.665587987548, "cost2_mean": -47.310452601016394, "outflow_rate_max": 1223.6132640116846, "cost1_max": 206.39977036534242, "system_level_velocity_min": 13.516038242723413, "cost2_max": -36.146529004111244, "cost1_min": 130.92759730734184, "system_level_velocity_mean": 16.186837894121386, "outflow_rate_mean": 1114.2792311893763, "system_level_velocity_max": 17.900256213577272}, "time_total_s": 787.2886981964111, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.2225152254104614, "vf_explained_var": 0.8858481049537659, "kl": 0.014255326241254807, "vf_loss": 12.020003318786621, "total_loss": 12.01557731628418, "policy_loss": -0.006563947070389986}, "sample_time_ms": 15226.589, "num_steps_sampled": 1073974, "num_steps_trained": 1073974, "grad_time_ms": 8858.897, "load_time_ms": 4.431, "update_time_ms": 8.889}, "episode_reward_min": -399.68184538578066}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6160>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1104522, "episodes_this_iter": 42, "pid": 45007, "timesteps_this_iter": 30548, "time_since_restore": 809.3172056674957, "node_ip": "10.138.0.2", "episode_len_mean": 323.62, "hostname": "flow-main", "training_iteration": 31, "iterations_since_restore": 31, "episode_reward_max": -187.59539030568556, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.028507471084595, "episodes_total": 1429, "timesteps_total": 1104522, "episode_reward_mean": -318.88648247405746, "timestamp": 1558583820, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-57-00", "custom_metrics": {"cost2_min": -59.633945559076075, "cost1_mean": 189.45593326587255, "outflow_rate_min": 911.623756097561, "cost2_mean": -46.1888522543818, "outflow_rate_max": 1212.9034354960625, "cost1_max": 208.91926805089233, "system_level_velocity_min": 13.516038242723413, "cost2_max": -37.3818820067434, "cost1_min": 128.29415586721677, "system_level_velocity_mean": 16.23289911598152, "outflow_rate_mean": 1105.2263152123417, "system_level_velocity_max": 18.01609524515017}, "time_total_s": 809.3172056674957, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.210206151008606, "vf_explained_var": 0.8862109780311584, "kl": 0.016072534024715424, "vf_loss": 11.676201820373535, "total_loss": 11.669029235839844, "policy_loss": -0.009584440849721432}, "sample_time_ms": 15153.859, "num_steps_sampled": 1104522, "num_steps_trained": 1104522, "grad_time_ms": 8668.977, "load_time_ms": 4.364, "update_time_ms": 9.302}, "episode_reward_min": -399.68184538578066}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd4e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbde10>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1134679, "episodes_this_iter": 44, "pid": 45007, "timesteps_this_iter": 30157, "time_since_restore": 832.7126924991608, "node_ip": "10.138.0.2", "episode_len_mean": 322.44, "hostname": "flow-main", "training_iteration": 32, "iterations_since_restore": 32, "episode_reward_max": -175.00017594399432, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.39548683166504, "episodes_total": 1473, "timesteps_total": 1134679, "episode_reward_mean": -308.9965678159213, "timestamp": 1558583843, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-57-23", "custom_metrics": {"cost2_min": -56.06426062053305, "cost1_mean": 189.811501704984, "outflow_rate_min": 879.7497184179456, "cost2_mean": -44.47098216359226, "outflow_rate_max": 1202.0597080521784, "cost1_max": 208.91926805089233, "system_level_velocity_min": 12.798009403716028, "cost2_max": -37.183936979889715, "cost1_min": 128.29415586721677, "system_level_velocity_mean": 16.373983160636975, "outflow_rate_mean": 1096.2911290539018, "system_level_velocity_max": 18.01609524515017}, "time_total_s": 832.7126924991608, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.15000000596046448, "entropy": 1.2009425163269043, "vf_explained_var": 0.8805358409881592, "kl": 0.01655985601246357, "vf_loss": 12.565178871154785, "total_loss": 12.558072090148926, "policy_loss": -0.009591039270162582}, "sample_time_ms": 15043.118, "num_steps_sampled": 1134679, "num_steps_trained": 1134679, "grad_time_ms": 8581.482, "load_time_ms": 4.39, "update_time_ms": 10.348}, "episode_reward_min": -406.5900616104527}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdeb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd2e8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1164717, "episodes_this_iter": 52, "pid": 45007, "timesteps_this_iter": 30038, "time_since_restore": 856.607173204422, "node_ip": "10.138.0.2", "episode_len_mean": 322.36, "hostname": "flow-main", "training_iteration": 33, "iterations_since_restore": 33, "episode_reward_max": -175.00017594399432, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.89448070526123, "episodes_total": 1525, "timesteps_total": 1164717, "episode_reward_mean": -300.38699366617243, "timestamp": 1558583867, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-57-47", "custom_metrics": {"cost2_min": -52.888652320643715, "cost1_mean": 191.17175674585812, "outflow_rate_min": 879.7497184179456, "cost2_mean": -43.361591898707346, "outflow_rate_max": 1190.1936067033744, "cost1_max": 208.33662587819578, "system_level_velocity_min": 12.798009403716028, "cost2_max": -36.92907206972535, "cost1_min": 128.29415586721677, "system_level_velocity_mean": 16.509505747781628, "outflow_rate_mean": 1089.6104722128127, "system_level_velocity_max": 18.042636353166813}, "time_total_s": 856.607173204422, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.1852664947509766, "vf_explained_var": 0.8708310723304749, "kl": 0.01621294394135475, "vf_loss": 12.028437614440918, "total_loss": 12.021828651428223, "policy_loss": -0.009041882120072842}, "sample_time_ms": 14947.05, "num_steps_sampled": 1164717, "num_steps_trained": 1164717, "grad_time_ms": 8662.841, "load_time_ms": 4.465, "update_time_ms": 10.043}, "episode_reward_min": -406.5900616104527}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6c50>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1194505, "episodes_this_iter": 43, "pid": 45007, "timesteps_this_iter": 29788, "time_since_restore": 879.8743963241577, "node_ip": "10.138.0.2", "episode_len_mean": 324.16, "hostname": "flow-main", "training_iteration": 34, "iterations_since_restore": 34, "episode_reward_max": -240.5419687934634, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.267223119735718, "episodes_total": 1568, "timesteps_total": 1194505, "episode_reward_mean": -291.49468152537855, "timestamp": 1558583890, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-58-10", "custom_metrics": {"cost2_min": -50.941773450009734, "cost1_mean": 195.4960451278044, "outflow_rate_min": 893.6172328767124, "cost2_mean": -42.7104049898631, "outflow_rate_max": 1207.7926012127891, "cost1_max": 210.40083171814499, "system_level_velocity_min": 13.45427502815511, "cost2_max": -33.76800390786069, "cost1_min": 145.30278671757017, "system_level_velocity_mean": 16.81729501951819, "outflow_rate_mean": 1102.895215159619, "system_level_velocity_max": 18.216115555002332}, "time_total_s": 879.8743963241577, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.1887617111206055, "vf_explained_var": 0.90170818567276, "kl": 0.015848174691200256, "vf_loss": 9.566652297973633, "total_loss": 9.561359405517578, "policy_loss": -0.007670844439417124}, "sample_time_ms": 14891.152, "num_steps_sampled": 1194505, "num_steps_trained": 1194505, "grad_time_ms": 8754.738, "load_time_ms": 4.602, "update_time_ms": 10.085}, "episode_reward_min": -355.6686351858061}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6be0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6d30>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1224165, "episodes_this_iter": 45, "pid": 45007, "timesteps_this_iter": 29660, "time_since_restore": 903.0668346881866, "node_ip": "10.138.0.2", "episode_len_mean": 324.44, "hostname": "flow-main", "training_iteration": 35, "iterations_since_restore": 35, "episode_reward_max": -257.17789296055724, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.19243836402893, "episodes_total": 1613, "timesteps_total": 1224165, "episode_reward_mean": -292.72375323829743, "timestamp": 1558583914, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-58-34", "custom_metrics": {"cost2_min": -50.49144106443201, "cost1_mean": 194.0467298370217, "outflow_rate_min": 893.6172328767124, "cost2_mean": -42.893949560482525, "outflow_rate_max": 1207.7926012127891, "cost1_max": 210.40083171814499, "system_level_velocity_min": 13.45427502815511, "cost2_max": -33.76800390786069, "cost1_min": 145.30278671757017, "system_level_velocity_mean": 16.634638422638826, "outflow_rate_mean": 1089.8883711485316, "system_level_velocity_max": 18.216115555002332}, "time_total_s": 903.0668346881866, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "entropy": 1.1800035238265991, "vf_explained_var": 0.9050226807594299, "kl": 0.014633952639997005, "vf_loss": 9.15290641784668, "total_loss": 9.147359848022461, "policy_loss": -0.007742042653262615}, "sample_time_ms": 14813.41, "num_steps_sampled": 1224165, "num_steps_trained": 1224165, "grad_time_ms": 8837.838, "load_time_ms": 4.582, "update_time_ms": 10.108}, "episode_reward_min": -355.6686351858061}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc62b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc68d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6668>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1253812, "episodes_this_iter": 51, "pid": 45007, "timesteps_this_iter": 29647, "time_since_restore": 926.7454617023468, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "training_iteration": 36, "iterations_since_restore": 36, "episode_reward_max": -170.99366627137994, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.678627014160156, "episodes_total": 1664, "timesteps_total": 1253812, "episode_reward_mean": -294.3729673607202, "timestamp": 1558583937, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-58-57", "custom_metrics": {"cost2_min": -51.0952484233927, "cost1_mean": 191.84823200240174, "outflow_rate_min": 916.1290665835021, "cost2_mean": -42.681762702061825, "outflow_rate_max": 1172.1585155350979, "cost1_max": 208.00847923034524, "system_level_velocity_min": 14.063639879985223, "cost2_max": -34.89033405057927, "cost1_min": 132.7922522227566, "system_level_velocity_mean": 16.4737338322703, "outflow_rate_mean": 1074.3073064238115, "system_level_velocity_max": 18.19669593888516}, "time_total_s": 926.7454617023468, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "entropy": 1.189697504043579, "vf_explained_var": 0.8955329060554504, "kl": 0.01463572308421135, "vf_loss": 10.33096694946289, "total_loss": 10.326517105102539, "policy_loss": -0.006644808687269688}, "sample_time_ms": 14753.175, "num_steps_sampled": 1253812, "num_steps_trained": 1253812, "grad_time_ms": 8729.95, "load_time_ms": 4.441, "update_time_ms": 9.982}, "episode_reward_min": -351.96333492860174}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd7f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd240>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1283564, "episodes_this_iter": 46, "pid": 45007, "timesteps_this_iter": 29752, "time_since_restore": 950.0710430145264, "node_ip": "10.138.0.2", "episode_len_mean": 320.77, "hostname": "flow-main", "training_iteration": 37, "iterations_since_restore": 37, "episode_reward_max": -34.04273620688763, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.325581312179565, "episodes_total": 1710, "timesteps_total": 1283564, "episode_reward_mean": -288.5689801607659, "timestamp": 1558583961, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-59-21", "custom_metrics": {"cost2_min": -51.0952484233927, "cost1_mean": 190.99976810917553, "outflow_rate_min": 476.23994017784116, "cost2_mean": -42.13224783164797, "outflow_rate_max": 1161.7949884513678, "cost1_max": 208.00847923034524, "system_level_velocity_min": 13.64150183333646, "cost2_max": -22.613544280950833, "cost1_min": 24.244636127470525, "system_level_velocity_mean": 16.60722035636897, "outflow_rate_mean": 1072.1830235958644, "system_level_velocity_max": 18.488699091481653}, "time_total_s": 950.0710430145264, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.1727830171585083, "vf_explained_var": 0.8985727429389954, "kl": 0.015193113125860691, "vf_loss": 10.240478515625, "total_loss": 10.235939025878906, "policy_loss": -0.006817680783569813}, "sample_time_ms": 14669.374, "num_steps_sampled": 1283564, "num_steps_trained": 1283564, "grad_time_ms": 8729.721, "load_time_ms": 4.397, "update_time_ms": 10.024}, "episode_reward_min": -372.034978609236}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad6d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badfd0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1313679, "episodes_this_iter": 45, "pid": 45007, "timesteps_this_iter": 30115, "time_since_restore": 973.9955582618713, "node_ip": "10.138.0.2", "episode_len_mean": 320.77, "hostname": "flow-main", "training_iteration": 38, "iterations_since_restore": 38, "episode_reward_max": -34.04273620688763, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.92451524734497, "episodes_total": 1755, "timesteps_total": 1313679, "episode_reward_mean": -294.91431386238327, "timestamp": 1558583985, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_03-59-45", "custom_metrics": {"cost2_min": -50.554226315240726, "cost1_mean": 189.84697924328503, "outflow_rate_min": 476.23994017784116, "cost2_mean": -42.907730893261885, "outflow_rate_max": 1159.416449414101, "cost1_max": 206.93481784657618, "system_level_velocity_min": 13.64150183333646, "cost2_max": -22.613544280950833, "cost1_min": 24.244636127470525, "system_level_velocity_mean": 16.473168110505995, "outflow_rate_mean": 1070.8403581247542, "system_level_velocity_max": 18.488699091481653}, "time_total_s": 973.9955582618713, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.15000000596046448, "entropy": 1.164393663406372, "vf_explained_var": 0.8896883130073547, "kl": 0.015127311460673809, "vf_loss": 10.99969482421875, "total_loss": 10.994504928588867, "policy_loss": -0.007458961568772793}, "sample_time_ms": 14635.617, "num_steps_sampled": 1313679, "num_steps_trained": 1313679, "grad_time_ms": 8866.007, "load_time_ms": 4.5, "update_time_ms": 10.073}, "episode_reward_min": -378.5320632145811}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6198>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1343934, "episodes_this_iter": 50, "pid": 45007, "timesteps_this_iter": 30255, "time_since_restore": 997.8525886535645, "node_ip": "10.138.0.2", "episode_len_mean": 319.76, "hostname": "flow-main", "training_iteration": 39, "iterations_since_restore": 39, "episode_reward_max": -34.04273620688763, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.857030391693115, "episodes_total": 1805, "timesteps_total": 1343934, "episode_reward_mean": -297.0283197271329, "timestamp": 1558584009, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-00-09", "custom_metrics": {"cost2_min": -54.57632533423637, "cost1_mean": 190.0106139910448, "outflow_rate_min": 476.23994017784116, "cost2_mean": -43.474144541699935, "outflow_rate_max": 1182.6155780316903, "cost1_max": 206.37335013278536, "system_level_velocity_min": 13.808623400278622, "cost2_max": -22.613544280950833, "cost1_min": 24.244636127470525, "system_level_velocity_mean": 16.53514085684367, "outflow_rate_mean": 1081.2178305814132, "system_level_velocity_max": 18.488699091481653}, "time_total_s": 997.8525886535645, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.139799952507019, "vf_explained_var": 0.8743910193443298, "kl": 0.015004856511950493, "vf_loss": 12.039009094238281, "total_loss": 12.03322696685791, "policy_loss": -0.00803092960268259}, "sample_time_ms": 14597.249, "num_steps_sampled": 1343934, "num_steps_trained": 1343934, "grad_time_ms": 9005.727, "load_time_ms": 4.504, "update_time_ms": 10.172}, "episode_reward_min": -378.5320632145811}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd1d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdc88>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1374484, "episodes_this_iter": 44, "pid": 45007, "timesteps_this_iter": 30550, "time_since_restore": 1021.3197219371796, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "training_iteration": 40, "iterations_since_restore": 40, "episode_reward_max": -173.12844945010946, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.467133283615112, "episodes_total": 1849, "timesteps_total": 1374484, "episode_reward_mean": -303.7333362727149, "timestamp": 1558584032, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-00-32", "custom_metrics": {"cost2_min": -54.57632533423637, "cost1_mean": 191.83967445486252, "outflow_rate_min": 959.0026222303608, "cost2_mean": -44.78901766444019, "outflow_rate_max": 1203.2408262427225, "cost1_max": 206.37335013278536, "system_level_velocity_min": 13.719842780721246, "cost2_max": -35.306212777790584, "cost1_min": 130.78144754393963, "system_level_velocity_mean": 16.45124307683328, "outflow_rate_mean": 1097.289283767031, "system_level_velocity_max": 17.99466372231381}, "time_total_s": 1021.3197219371796, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.1464314460754395, "vf_explained_var": 0.8952966332435608, "kl": 0.017439009621739388, "vf_loss": 10.88731575012207, "total_loss": 10.881120681762695, "policy_loss": -0.008811856620013714}, "sample_time_ms": 14556.752, "num_steps_sampled": 1374484, "num_steps_trained": 1374484, "grad_time_ms": 8761.331, "load_time_ms": 4.443, "update_time_ms": 10.179}, "episode_reward_min": -388.3496424443957}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdf60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb57b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbda58>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1404891, "episodes_this_iter": 46, "pid": 45007, "timesteps_this_iter": 30407, "time_since_restore": 1044.978837966919, "node_ip": "10.138.0.2", "episode_len_mean": 321.62, "hostname": "flow-main", "training_iteration": 41, "iterations_since_restore": 41, "episode_reward_max": -31.650151958413506, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.65911602973938, "episodes_total": 1895, "timesteps_total": 1404891, "episode_reward_mean": -301.76079291473525, "timestamp": 1558584056, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-00-56", "custom_metrics": {"cost2_min": -53.967325953500314, "cost1_mean": 190.7386016975656, "outflow_rate_min": 493.2509405449511, "cost2_mean": -44.56918041331843, "outflow_rate_max": 1203.2408262427225, "cost1_max": 206.55458199699694, "system_level_velocity_min": 13.719842780721246, "cost2_max": -18.377576598538766, "cost1_min": 22.936924386561195, "system_level_velocity_mean": 16.46415921393054, "outflow_rate_mean": 1093.908238000708, "system_level_velocity_max": 18.562734796248446}, "time_total_s": 1044.978837966919, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "entropy": 1.1170141696929932, "vf_explained_var": 0.8873517513275146, "kl": 0.015041233040392399, "vf_loss": 10.615392684936523, "total_loss": 10.609757423400879, "policy_loss": -0.007890296168625355}, "sample_time_ms": 14590.888, "num_steps_sampled": 1404891, "num_steps_trained": 1404891, "grad_time_ms": 8890.082, "load_time_ms": 4.536, "update_time_ms": 9.922}, "episode_reward_min": -388.3496424443957}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdd30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd470>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1435492, "episodes_this_iter": 46, "pid": 45007, "timesteps_this_iter": 30601, "time_since_restore": 1068.9968616962433, "node_ip": "10.138.0.2", "episode_len_mean": 320.44, "hostname": "flow-main", "training_iteration": 42, "iterations_since_restore": 42, "episode_reward_max": -31.650151958413506, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.01802372932434, "episodes_total": 1941, "timesteps_total": 1435492, "episode_reward_mean": -298.5865738021964, "timestamp": 1558584080, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-01-20", "custom_metrics": {"cost2_min": -53.323937381719574, "cost1_mean": 191.72423300680305, "outflow_rate_min": 493.2509405449511, "cost2_mean": -44.533787278172234, "outflow_rate_max": 1196.8764420316184, "cost1_max": 207.56525668687104, "system_level_velocity_min": 13.8324445384717, "cost2_max": -18.377576598538766, "cost1_min": 22.936924386561195, "system_level_velocity_mean": 16.593243585253035, "outflow_rate_mean": 1103.0328428976402, "system_level_velocity_max": 18.562734796248446}, "time_total_s": 1068.9968616962433, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.1042217016220093, "vf_explained_var": 0.893324077129364, "kl": 0.01543306652456522, "vf_loss": 9.893301010131836, "total_loss": 9.890281677246094, "policy_loss": -0.005335570778697729}, "sample_time_ms": 14608.339, "num_steps_sampled": 1435492, "num_steps_trained": 1435492, "grad_time_ms": 8936.219, "load_time_ms": 4.479, "update_time_ms": 8.979}, "episode_reward_min": -353.9008846770891}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badfd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5b70>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1466010, "episodes_this_iter": 49, "pid": 45007, "timesteps_this_iter": 30518, "time_since_restore": 1095.0688905715942, "node_ip": "10.138.0.2", "episode_len_mean": 323.62, "hostname": "flow-main", "training_iteration": 43, "iterations_since_restore": 43, "episode_reward_max": -166.27938214809924, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 26.072028875350952, "episodes_total": 1990, "timesteps_total": 1466010, "episode_reward_mean": -298.942633797825, "timestamp": 1558584106, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-01-46", "custom_metrics": {"cost2_min": -52.68265134287974, "cost1_mean": 194.81223120799868, "outflow_rate_min": 957.3520040739511, "cost2_mean": -44.163016989602, "outflow_rate_max": 1198.2667062664707, "cost1_max": 208.82498991336814, "system_level_velocity_min": 13.697449643607783, "cost2_max": -32.228949538871596, "cost1_min": 132.57573797371265, "system_level_velocity_mean": 16.70329306440689, "outflow_rate_mean": 1117.0492228588919, "system_level_velocity_max": 18.118093574755772}, "time_total_s": 1095.0688905715942, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.1078134775161743, "vf_explained_var": 0.8842250108718872, "kl": 0.01646517962217331, "vf_loss": 11.257123947143555, "total_loss": 11.252737998962402, "policy_loss": -0.006856540217995644}, "sample_time_ms": 14592.67, "num_steps_sampled": 1466010, "num_steps_trained": 1466010, "grad_time_ms": 9169.32, "load_time_ms": 4.581, "update_time_ms": 8.885}, "episode_reward_min": -392.29277875265814}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6eb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6dd8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1496835, "episodes_this_iter": 43, "pid": 45007, "timesteps_this_iter": 30825, "time_since_restore": 1118.6881051063538, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "training_iteration": 44, "iterations_since_restore": 44, "episode_reward_max": -258.79280306092136, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.61921453475952, "episodes_total": 2033, "timesteps_total": 1496835, "episode_reward_mean": -302.07120272106187, "timestamp": 1558584130, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-02-10", "custom_metrics": {"cost2_min": -55.73412345758599, "cost1_mean": 194.6048996810628, "outflow_rate_min": 966.2730390797922, "cost2_mean": -44.03684797824608, "outflow_rate_max": 1198.2667062664707, "cost1_max": 208.82498991336814, "system_level_velocity_min": 13.697449643607783, "cost2_max": -33.50069650900579, "cost1_min": 162.96120773794632, "system_level_velocity_mean": 16.59491665783985, "outflow_rate_mean": 1113.8479552512001, "system_level_velocity_max": 18.118093574755772}, "time_total_s": 1118.6881051063538, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.15000000596046448, "entropy": 1.112898588180542, "vf_explained_var": 0.8928288221359253, "kl": 0.01593952625989914, "vf_loss": 10.234044075012207, "total_loss": 10.227415084838867, "policy_loss": -0.009019299410283566}, "sample_time_ms": 14714.955, "num_steps_sampled": 1496835, "num_steps_trained": 1496835, "grad_time_ms": 9082.293, "load_time_ms": 4.548, "update_time_ms": 9.137}, "episode_reward_min": -392.29277875265814}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc69b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6128>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1526963, "episodes_this_iter": 45, "pid": 45007, "timesteps_this_iter": 30128, "time_since_restore": 1143.0035622119904, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "training_iteration": 45, "iterations_since_restore": 45, "episode_reward_max": -258.79280306092136, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.315457105636597, "episodes_total": 2078, "timesteps_total": 1526963, "episode_reward_mean": -302.7392982930905, "timestamp": 1558584154, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-02-34", "custom_metrics": {"cost2_min": -55.73412345758599, "cost1_mean": 193.82763435729265, "outflow_rate_min": 966.2730390797922, "cost2_mean": -44.069919490143086, "outflow_rate_max": 1198.2667062664707, "cost1_max": 208.6523576860214, "system_level_velocity_min": 12.35766416625825, "cost2_max": -34.01755878162777, "cost1_min": 151.62351099923416, "system_level_velocity_mean": 16.53216514739913, "outflow_rate_mean": 1109.8566687637422, "system_level_velocity_max": 18.118093574755772}, "time_total_s": 1143.0035622119904, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.15000000596046448, "entropy": 1.1141866445541382, "vf_explained_var": 0.8811701536178589, "kl": 0.016981152817606926, "vf_loss": 10.480965614318848, "total_loss": 10.47521686553955, "policy_loss": -0.008294150233268738}, "sample_time_ms": 14795.863, "num_steps_sampled": 1526963, "num_steps_trained": 1526963, "grad_time_ms": 9115.381, "load_time_ms": 4.512, "update_time_ms": 8.856}, "episode_reward_min": -393.08355964485474}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbde80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd7f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd588>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1557304, "episodes_this_iter": 48, "pid": 45007, "timesteps_this_iter": 30341, "time_since_restore": 1167.221426486969, "node_ip": "10.138.0.2", "episode_len_mean": 323.9, "hostname": "flow-main", "training_iteration": 46, "iterations_since_restore": 46, "episode_reward_max": -172.28731301619501, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.217864274978638, "episodes_total": 2126, "timesteps_total": 1557304, "episode_reward_mean": -298.3903100701678, "timestamp": 1558584178, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-02-58", "custom_metrics": {"cost2_min": -55.06454252736291, "cost1_mean": 193.9081205178801, "outflow_rate_min": 949.0305177445232, "cost2_mean": -43.713117226263236, "outflow_rate_max": 1187.0291880156315, "cost1_max": 208.14645822197798, "system_level_velocity_min": 12.35766416625825, "cost2_max": -34.26434122527693, "cost1_min": 138.2154820903076, "system_level_velocity_mean": 16.62122116539794, "outflow_rate_mean": 1106.8926540490095, "system_level_velocity_max": 18.20833606866793}, "time_total_s": 1167.221426486969, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "entropy": 1.136193871498108, "vf_explained_var": 0.8784141540527344, "kl": 0.01625773310661316, "vf_loss": 11.385843276977539, "total_loss": 11.378888130187988, "policy_loss": -0.009392301551997662}, "sample_time_ms": 14786.053, "num_steps_sampled": 1557304, "num_steps_trained": 1557304, "grad_time_ms": 9177.778, "load_time_ms": 4.623, "update_time_ms": 8.952}, "episode_reward_min": -393.08355964485474}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6dd8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1587739, "episodes_this_iter": 45, "pid": 45007, "timesteps_this_iter": 30435, "time_since_restore": 1189.9975793361664, "node_ip": "10.138.0.2", "episode_len_mean": 322.72, "hostname": "flow-main", "training_iteration": 47, "iterations_since_restore": 47, "episode_reward_max": -161.32638934767158, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.776152849197388, "episodes_total": 2171, "timesteps_total": 1587739, "episode_reward_mean": -295.8288026783495, "timestamp": 1558584201, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-03-21", "custom_metrics": {"cost2_min": -55.06454252736291, "cost1_mean": 193.90496787222506, "outflow_rate_min": 949.0305177445232, "cost2_mean": -43.865432550457335, "outflow_rate_max": 1184.2205581598603, "cost1_max": 209.16325270249928, "system_level_velocity_min": 14.152299559997365, "cost2_max": -35.22639360092572, "cost1_min": 136.0590228003752, "system_level_velocity_mean": 16.67908310071418, "outflow_rate_mean": 1108.1532054015013, "system_level_velocity_max": 18.549857266471715}, "time_total_s": 1189.9975793361664, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "entropy": 1.1164602041244507, "vf_explained_var": 0.8935337066650391, "kl": 0.016128569841384888, "vf_loss": 9.986328125, "total_loss": 9.982024192810059, "policy_loss": -0.006723673548549414}, "sample_time_ms": 14831.483, "num_steps_sampled": 1587739, "num_steps_trained": 1587739, "grad_time_ms": 9076.261, "load_time_ms": 4.483, "update_time_ms": 8.825}, "episode_reward_min": -372.20873336742306}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc62b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6128>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1618236, "episodes_this_iter": 49, "pid": 45007, "timesteps_this_iter": 30497, "time_since_restore": 1215.1735670566559, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "training_iteration": 48, "iterations_since_restore": 48, "episode_reward_max": -161.32638934767158, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 25.175987720489502, "episodes_total": 2220, "timesteps_total": 1618236, "episode_reward_mean": -293.0854591683162, "timestamp": 1558584226, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-03-46", "custom_metrics": {"cost2_min": -52.609365760278784, "cost1_mean": 196.41184197887623, "outflow_rate_min": 949.0305177445232, "cost2_mean": -43.881703215350115, "outflow_rate_max": 1216.587110165325, "cost1_max": 209.65202847399888, "system_level_velocity_min": 14.152299559997365, "cost2_max": -30.701324041225902, "cost1_min": 136.0590228003752, "system_level_velocity_mean": 16.838782745036436, "outflow_rate_mean": 1123.8468103016226, "system_level_velocity_max": 18.549857266471715}, "time_total_s": 1215.1735670566559, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.102763295173645, "vf_explained_var": 0.8804518580436707, "kl": 0.017846640199422836, "vf_loss": 10.61167049407959, "total_loss": 10.606371879577637, "policy_loss": -0.007975482381880283}, "sample_time_ms": 14847.255, "num_steps_sampled": 1618236, "num_steps_trained": 1618236, "grad_time_ms": 9184.462, "load_time_ms": 4.391, "update_time_ms": 8.838}, "episode_reward_min": -372.20873336742306}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5f60>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1648777, "episodes_this_iter": 46, "pid": 45007, "timesteps_this_iter": 30541, "time_since_restore": 1239.4357423782349, "node_ip": "10.138.0.2", "episode_len_mean": 324.72, "hostname": "flow-main", "training_iteration": 49, "iterations_since_restore": 49, "episode_reward_max": -252.39116785286677, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.26217532157898, "episodes_total": 2266, "timesteps_total": 1648777, "episode_reward_mean": -292.07213234783734, "timestamp": 1558584251, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-04-11", "custom_metrics": {"cost2_min": -53.373816106690796, "cost1_mean": 198.20162391048987, "outflow_rate_min": 941.7509268292686, "cost2_mean": -44.00613487999345, "outflow_rate_max": 1216.587110165325, "cost1_max": 210.21036250695713, "system_level_velocity_min": 13.658527714410173, "cost2_max": -30.701324041225902, "cost1_min": 164.35703077695882, "system_level_velocity_mean": 16.940241932080355, "outflow_rate_mean": 1136.2373141833893, "system_level_velocity_max": 18.283121511077375}, "time_total_s": 1239.4357423782349, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.1002939939498901, "vf_explained_var": 0.9023917317390442, "kl": 0.01751541532576084, "vf_loss": 8.773407936096191, "total_loss": 8.767723083496094, "policy_loss": -0.008311483077704906}, "sample_time_ms": 14871.526, "num_steps_sampled": 1648777, "num_steps_trained": 1648777, "grad_time_ms": 9200.035, "load_time_ms": 4.33, "update_time_ms": 8.784}, "episode_reward_min": -394.1408327135942}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6d30>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1679083, "episodes_this_iter": 45, "pid": 45007, "timesteps_this_iter": 30306, "time_since_restore": 1263.6797049045563, "node_ip": "10.138.0.2", "episode_len_mean": 324.24, "hostname": "flow-main", "training_iteration": 50, "iterations_since_restore": 50, "episode_reward_max": -246.44116304521927, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.24396252632141, "episodes_total": 2311, "timesteps_total": 1679083, "episode_reward_mean": -293.1320706274172, "timestamp": 1558584275, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-04-35", "custom_metrics": {"cost2_min": -55.286656273009115, "cost1_mean": 197.16896174259216, "outflow_rate_min": 905.8770194805194, "cost2_mean": -44.46470116696241, "outflow_rate_max": 1216.587110165325, "cost1_max": 210.21036250695713, "system_level_velocity_min": 12.431922273215683, "cost2_max": -34.85001327529243, "cost1_min": 147.468521921844, "system_level_velocity_mean": 16.858288328535338, "outflow_rate_mean": 1131.6439102452161, "system_level_velocity_max": 18.283121511077375}, "time_total_s": 1263.6797049045563, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.097327709197998, "vf_explained_var": 0.9027766585350037, "kl": 0.0156660508364439, "vf_loss": 9.010611534118652, "total_loss": 9.004670143127441, "policy_loss": -0.008292046375572681}, "sample_time_ms": 14919.973, "num_steps_sampled": 1679083, "num_steps_trained": 1679083, "grad_time_ms": 9228.57, "load_time_ms": 4.388, "update_time_ms": 8.755}, "episode_reward_min": -413.66273911646124}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb55c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5d30>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1709549, "episodes_this_iter": 49, "pid": 45007, "timesteps_this_iter": 30466, "time_since_restore": 1286.146769285202, "node_ip": "10.138.0.2", "episode_len_mean": 324.52, "hostname": "flow-main", "training_iteration": 51, "iterations_since_restore": 51, "episode_reward_max": -246.44116304521927, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.467064380645752, "episodes_total": 2360, "timesteps_total": 1709549, "episode_reward_mean": -292.00010025792966, "timestamp": 1558584297, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-04-57", "custom_metrics": {"cost2_min": -56.108811846863034, "cost1_mean": 197.14363305604843, "outflow_rate_min": 905.8770194805194, "cost2_mean": -44.134018046834164, "outflow_rate_max": 1205.1926679940266, "cost1_max": 210.82109111909682, "system_level_velocity_min": 12.431922273215683, "cost2_max": -34.29608738974724, "cost1_min": 147.468521921844, "system_level_velocity_mean": 16.854882908304436, "outflow_rate_mean": 1127.8832610739107, "system_level_velocity_max": 18.298515457519766}, "time_total_s": 1286.146769285202, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.0948238372802734, "vf_explained_var": 0.891631543636322, "kl": 0.016268037259578705, "vf_loss": 9.489836692810059, "total_loss": 9.4860200881958, "policy_loss": -0.00625534076243639}, "sample_time_ms": 14936.554, "num_steps_sampled": 1709549, "num_steps_trained": 1709549, "grad_time_ms": 9092.354, "load_time_ms": 4.439, "update_time_ms": 8.762}, "episode_reward_min": -413.66273911646124}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdb38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdcf8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1740138, "episodes_this_iter": 46, "pid": 45007, "timesteps_this_iter": 30589, "time_since_restore": 1308.570524930954, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "training_iteration": 52, "iterations_since_restore": 52, "episode_reward_max": -248.43551824756784, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.423755645751953, "episodes_total": 2406, "timesteps_total": 1740138, "episode_reward_mean": -291.40308517311473, "timestamp": 1558584320, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-05-20", "custom_metrics": {"cost2_min": -56.108811846863034, "cost1_mean": 198.09697898204723, "outflow_rate_min": 905.8770194805194, "cost2_mean": -43.812629109008824, "outflow_rate_max": 1206.8348629685258, "cost1_max": 211.60614058937313, "system_level_velocity_min": 12.431922273215683, "cost2_max": -34.29608738974724, "cost1_min": 147.468521921844, "system_level_velocity_mean": 16.91801605736865, "outflow_rate_mean": 1129.3000669579328, "system_level_velocity_max": 18.38828113707424}, "time_total_s": 1308.570524930954, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.1008704900741577, "vf_explained_var": 0.9139695167541504, "kl": 0.01753496192395687, "vf_loss": 7.478675842285156, "total_loss": 7.473200798034668, "policy_loss": -0.008104586973786354}, "sample_time_ms": 14951.432, "num_steps_sampled": 1740138, "num_steps_trained": 1740138, "grad_time_ms": 8918.034, "load_time_ms": 4.313, "update_time_ms": 8.79}, "episode_reward_min": -413.66273911646124}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdb00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4ba8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1770838, "episodes_this_iter": 44, "pid": 45007, "timesteps_this_iter": 30700, "time_since_restore": 1331.1100277900696, "node_ip": "10.138.0.2", "episode_len_mean": 323.54, "hostname": "flow-main", "training_iteration": 53, "iterations_since_restore": 53, "episode_reward_max": -207.99736531107905, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.5395028591156, "episodes_total": 2450, "timesteps_total": 1770838, "episode_reward_mean": -295.3607999278602, "timestamp": 1558584342, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-05-42", "custom_metrics": {"cost2_min": -56.732689616911735, "cost1_mean": 196.08560870244827, "outflow_rate_min": 887.4677885208282, "cost2_mean": -44.940474451110894, "outflow_rate_max": 1206.8348629685258, "cost1_max": 211.60614058937313, "system_level_velocity_min": 14.202242772024485, "cost2_max": -35.05931658010147, "cost1_min": 123.80133353673358, "system_level_velocity_mean": 16.762810856287114, "outflow_rate_mean": 1123.22713590625, "system_level_velocity_max": 18.38828113707424}, "time_total_s": 1331.1100277900696, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "entropy": 1.107228398323059, "vf_explained_var": 0.8900434374809265, "kl": 0.020136689767241478, "vf_loss": 9.883343696594238, "total_loss": 9.876996040344238, "policy_loss": -0.009367520920932293}, "sample_time_ms": 14930.397, "num_steps_sampled": 1770838, "num_steps_trained": 1770838, "grad_time_ms": 8585.791, "load_time_ms": 4.24, "update_time_ms": 8.655}, "episode_reward_min": -367.4085487757423}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5e80>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1801413, "episodes_this_iter": 47, "pid": 45007, "timesteps_this_iter": 30575, "time_since_restore": 1355.0820748806, "node_ip": "10.138.0.2", "episode_len_mean": 323.06, "hostname": "flow-main", "training_iteration": 54, "iterations_since_restore": 54, "episode_reward_max": -207.99736531107905, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.972047090530396, "episodes_total": 2497, "timesteps_total": 1801413, "episode_reward_mean": -296.8373959629573, "timestamp": 1558584367, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-06-07", "custom_metrics": {"cost2_min": -56.732689616911735, "cost1_mean": 195.23866317871835, "outflow_rate_min": 887.4677885208282, "cost2_mean": -45.600473391651036, "outflow_rate_max": 1202.859129999165, "cost1_max": 210.31272257622499, "system_level_velocity_min": 14.293725615682964, "cost2_max": -35.05931658010147, "cost1_min": 123.80133353673358, "system_level_velocity_mean": 16.703256451368752, "outflow_rate_mean": 1121.56894923446, "system_level_velocity_max": 18.226691005391224}, "time_total_s": 1355.0820748806, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 1.092637062072754, "vf_explained_var": 0.8914283514022827, "kl": 0.013902812264859676, "vf_loss": 9.650468826293945, "total_loss": 9.645142555236816, "policy_loss": -0.008453565649688244}, "sample_time_ms": 14858.037, "num_steps_sampled": 1801413, "num_steps_trained": 1801413, "grad_time_ms": 8693.495, "load_time_ms": 4.132, "update_time_ms": 8.469}, "episode_reward_min": -371.5639103714186}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdcf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdb38>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1832371, "episodes_this_iter": 48, "pid": 45007, "timesteps_this_iter": 30958, "time_since_restore": 1377.979707479477, "node_ip": "10.138.0.2", "episode_len_mean": 324.52, "hostname": "flow-main", "training_iteration": 55, "iterations_since_restore": 55, "episode_reward_max": -235.3537671370872, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.897632598876953, "episodes_total": 2545, "timesteps_total": 1832371, "episode_reward_mean": -297.81092776751683, "timestamp": 1558584389, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-06-29", "custom_metrics": {"cost2_min": -55.159056434226954, "cost1_mean": 196.3391062927976, "outflow_rate_min": 990.7154634146345, "cost2_mean": -45.96996318566377, "outflow_rate_max": 1213.062857142857, "cost1_max": 209.8232841398953, "system_level_velocity_min": 14.136973739100918, "cost2_max": -36.40330406633608, "cost1_min": 169.5596401365243, "system_level_velocity_mean": 16.723347544678923, "outflow_rate_mean": 1129.0771126192067, "system_level_velocity_max": 18.164831023721245}, "time_total_s": 1377.979707479477, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 1.1080615520477295, "vf_explained_var": 0.9003281593322754, "kl": 0.01663213223218918, "vf_loss": 9.248661994934082, "total_loss": 9.242403030395508, "policy_loss": -0.010000699199736118}, "sample_time_ms": 14854.186, "num_steps_sampled": 1832371, "num_steps_trained": 1832371, "grad_time_ms": 8554.86, "load_time_ms": 4.124, "update_time_ms": 8.659}, "episode_reward_min": -391.82713201256263}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb50b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5ef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5a90>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1863554, "episodes_this_iter": 45, "pid": 45007, "timesteps_this_iter": 31183, "time_since_restore": 1403.4074046611786, "node_ip": "10.138.0.2", "episode_len_mean": 323.37, "hostname": "flow-main", "training_iteration": 56, "iterations_since_restore": 56, "episode_reward_max": -185.37756912346825, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 25.42769718170166, "episodes_total": 2590, "timesteps_total": 1863554, "episode_reward_mean": -299.430509373142, "timestamp": 1558584415, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-06-55", "custom_metrics": {"cost2_min": -61.61988980119467, "cost1_mean": 195.45949540089444, "outflow_rate_min": 949.4965501566542, "cost2_mean": -46.69754772754195, "outflow_rate_max": 1220.0132197639612, "cost1_max": 210.58101192618588, "system_level_velocity_min": 13.522204789535206, "cost2_max": -34.38277799247364, "cost1_min": 129.8776789009485, "system_level_velocity_mean": 16.687789963578616, "outflow_rate_mean": 1131.5415026517676, "system_level_velocity_max": 18.33215821780553}, "time_total_s": 1403.4074046611786, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 1.0792969465255737, "vf_explained_var": 0.9074374437332153, "kl": 0.013872005976736546, "vf_loss": 8.101219177246094, "total_loss": 8.097471237182617, "policy_loss": -0.00686869490891695}, "sample_time_ms": 14831.063, "num_steps_sampled": 1863554, "num_steps_trained": 1863554, "grad_time_ms": 8696.944, "load_time_ms": 4.072, "update_time_ms": 8.659}, "episode_reward_min": -409.176655278387}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc66a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb57b8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1894489, "episodes_this_iter": 44, "pid": 45007, "timesteps_this_iter": 30935, "time_since_restore": 1427.0843183994293, "node_ip": "10.138.0.2", "episode_len_mean": 323.65, "hostname": "flow-main", "training_iteration": 57, "iterations_since_restore": 57, "episode_reward_max": -185.37756912346825, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.676913738250732, "episodes_total": 2634, "timesteps_total": 1894489, "episode_reward_mean": -297.58056158989575, "timestamp": 1558584439, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-07-19", "custom_metrics": {"cost2_min": -61.61988980119467, "cost1_mean": 196.85655814012264, "outflow_rate_min": 949.4965501566542, "cost2_mean": -46.60420881256695, "outflow_rate_max": 1226.1069947722283, "cost1_max": 211.47415156646332, "system_level_velocity_min": 13.522204789535206, "cost2_max": -33.813714708338146, "cost1_min": 129.8776789009485, "system_level_velocity_mean": 16.80474384551431, "outflow_rate_mean": 1139.282137047801, "system_level_velocity_max": 18.415057180797866}, "time_total_s": 1427.0843183994293, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 1.0801060199737549, "vf_explained_var": 0.8993450403213501, "kl": 0.014524244703352451, "vf_loss": 8.837803840637207, "total_loss": 8.83275032043457, "policy_loss": -0.008320679888129234}, "sample_time_ms": 14871.353, "num_steps_sampled": 1894489, "num_steps_trained": 1894489, "grad_time_ms": 8746.903, "load_time_ms": 4.122, "update_time_ms": 8.979}, "episode_reward_min": -409.176655278387}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdcf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd748>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1925631, "episodes_this_iter": 48, "pid": 45007, "timesteps_this_iter": 31142, "time_since_restore": 1451.5178451538086, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "training_iteration": 58, "iterations_since_restore": 58, "episode_reward_max": -250.3580610580162, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.433526754379272, "episodes_total": 2682, "timesteps_total": 1925631, "episode_reward_mean": -301.9005414620599, "timestamp": 1558584463, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-07-43", "custom_metrics": {"cost2_min": -61.25015499401533, "cost1_mean": 196.66521608762613, "outflow_rate_min": 911.9137711693547, "cost2_mean": -46.880458603626565, "outflow_rate_max": 1226.1069947722283, "cost1_max": 211.47415156646332, "system_level_velocity_min": 13.526682735544833, "cost2_max": -33.813714708338146, "cost1_min": 162.72500083122844, "system_level_velocity_mean": 16.696800640205925, "outflow_rate_mean": 1135.3198404112031, "system_level_velocity_max": 18.415057180797866}, "time_total_s": 1451.5178451538086, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 1.0822962522506714, "vf_explained_var": 0.900733232498169, "kl": 0.015136932954192162, "vf_loss": 9.511931419372559, "total_loss": 9.506107330322266, "policy_loss": -0.009229591116309166}, "sample_time_ms": 14882.029, "num_steps_sampled": 1925631, "num_steps_trained": 1925631, "grad_time_ms": 8663.21, "load_time_ms": 4.184, "update_time_ms": 8.888}, "episode_reward_min": -442.33742776290444}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb57f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5d68>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1956609, "episodes_this_iter": 46, "pid": 45007, "timesteps_this_iter": 30978, "time_since_restore": 1474.372576713562, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "training_iteration": 59, "iterations_since_restore": 59, "episode_reward_max": -251.0322542848041, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.854731559753418, "episodes_total": 2728, "timesteps_total": 1956609, "episode_reward_mean": -302.33023998783824, "timestamp": 1558584486, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-08-06", "custom_metrics": {"cost2_min": -62.4118371732913, "cost1_mean": 196.3845441588829, "outflow_rate_min": 911.9137711693547, "cost2_mean": -47.08240987808251, "outflow_rate_max": 1234.8843476646243, "cost1_max": 213.49864257834838, "system_level_velocity_min": 12.793562999445394, "cost2_max": -33.813714708338146, "cost1_min": 157.9605537024624, "system_level_velocity_mean": 16.681474170467553, "outflow_rate_mean": 1132.073905359248, "system_level_velocity_max": 18.35827441419471}, "time_total_s": 1474.372576713562, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 1.0473681688308716, "vf_explained_var": 0.9039471745491028, "kl": 0.0155314477160573, "vf_loss": 8.015307426452637, "total_loss": 8.011730194091797, "policy_loss": -0.007072542328387499}, "sample_time_ms": 14894.545, "num_steps_sampled": 1956609, "num_steps_trained": 1956609, "grad_time_ms": 8510.151, "load_time_ms": 4.111, "update_time_ms": 8.892}, "episode_reward_min": -442.33742776290444}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4860>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 1987592, "episodes_this_iter": 43, "pid": 45007, "timesteps_this_iter": 30983, "time_since_restore": 1496.923030614853, "node_ip": "10.138.0.2", "episode_len_mean": 324.72, "hostname": "flow-main", "training_iteration": 60, "iterations_since_restore": 60, "episode_reward_max": -252.3748366822931, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.550453901290894, "episodes_total": 2771, "timesteps_total": 1987592, "episode_reward_mean": -295.99915696515853, "timestamp": 1558584509, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-08-29", "custom_metrics": {"cost2_min": -62.4118371732913, "cost1_mean": 198.31235084717042, "outflow_rate_min": 928.0521296225697, "cost2_mean": -46.55683345712887, "outflow_rate_max": 1234.8843476646243, "cost1_max": 213.49864257834838, "system_level_velocity_min": 12.793562999445394, "cost2_max": -36.92736756264546, "cost1_min": 157.9605537024624, "system_level_velocity_mean": 16.88476209918608, "outflow_rate_mean": 1143.2154765259363, "system_level_velocity_max": 18.417797732069587}, "time_total_s": 1496.923030614853, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 1.0637238025665283, "vf_explained_var": 0.8965510725975037, "kl": 0.01591986045241356, "vf_loss": 9.25949478149414, "total_loss": 9.253530502319336, "policy_loss": -0.009545393288135529}, "sample_time_ms": 14885.82, "num_steps_sampled": 1987592, "num_steps_trained": 1987592, "grad_time_ms": 8349.618, "load_time_ms": 3.929, "update_time_ms": 8.992}, "episode_reward_min": -406.1583183058256}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd198>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2018401, "episodes_this_iter": 52, "pid": 45007, "timesteps_this_iter": 30809, "time_since_restore": 1523.3163480758667, "node_ip": "10.138.0.2", "episode_len_mean": 321.82, "hostname": "flow-main", "training_iteration": 61, "iterations_since_restore": 61, "episode_reward_max": -31.38332268228276, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 26.393317461013794, "episodes_total": 2823, "timesteps_total": 2018401, "episode_reward_mean": -291.6567727608084, "timestamp": 1558584535, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-08-55", "custom_metrics": {"cost2_min": -60.67445020240374, "cost1_mean": 197.03884974121127, "outflow_rate_min": 477.9372180334546, "cost2_mean": -46.36346377829423, "outflow_rate_max": 1231.2330739164381, "cost1_max": 212.87741680556843, "system_level_velocity_min": 14.097829621857846, "cost2_max": -22.648134236326847, "cost1_min": 23.371721955855616, "system_level_velocity_mean": 16.94338475884273, "outflow_rate_mean": 1135.1250026537045, "system_level_velocity_max": 18.76952464651357}, "time_total_s": 1523.3163480758667, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 1.0657122135162354, "vf_explained_var": 0.8966135382652283, "kl": 0.013819929212331772, "vf_loss": 9.08234977722168, "total_loss": 9.077856063842773, "policy_loss": -0.007602174300700426}, "sample_time_ms": 15034.225, "num_steps_sampled": 2018401, "num_steps_trained": 2018401, "grad_time_ms": 8594.666, "load_time_ms": 3.979, "update_time_ms": 8.989}, "episode_reward_min": -403.5222094444769}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd10f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1ef0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2049245, "episodes_this_iter": 46, "pid": 45007, "timesteps_this_iter": 30844, "time_since_restore": 1546.143774986267, "node_ip": "10.138.0.2", "episode_len_mean": 318.54, "hostname": "flow-main", "training_iteration": 62, "iterations_since_restore": 62, "episode_reward_max": -31.38332268228276, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.82742691040039, "episodes_total": 2869, "timesteps_total": 2049245, "episode_reward_mean": -284.0431856050842, "timestamp": 1558584558, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-09-18", "custom_metrics": {"cost2_min": -60.67445020240374, "cost1_mean": 196.56568587456135, "outflow_rate_min": 477.9372180334546, "cost2_mean": -46.15777760417076, "outflow_rate_max": 1236.0253147000992, "cost1_max": 214.52041000375488, "system_level_velocity_min": 14.248042930008546, "cost2_max": -21.083460912749228, "cost1_min": 23.371721955855616, "system_level_velocity_mean": 17.113651883348556, "outflow_rate_mean": 1134.068521562091, "system_level_velocity_max": 18.905845356857004}, "time_total_s": 1546.143774986267, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 1.0231131315231323, "vf_explained_var": 0.8886374235153198, "kl": 0.014566733501851559, "vf_loss": 8.85614013671875, "total_loss": 8.850749015808105, "policy_loss": -0.008669224567711353}, "sample_time_ms": 15049.548, "num_steps_sampled": 2049245, "num_steps_trained": 2049245, "grad_time_ms": 8618.822, "load_time_ms": 4.066, "update_time_ms": 8.79}, "episode_reward_min": -403.5222094444769}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdc88>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2079977, "episodes_this_iter": 44, "pid": 45007, "timesteps_this_iter": 30732, "time_since_restore": 1569.8519806861877, "node_ip": "10.138.0.2", "episode_len_mean": 321.16, "hostname": "flow-main", "training_iteration": 63, "iterations_since_restore": 63, "episode_reward_max": -32.162405456425994, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.708205699920654, "episodes_total": 2913, "timesteps_total": 2079977, "episode_reward_mean": -283.59142135559034, "timestamp": 1558584582, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-09-42", "custom_metrics": {"cost2_min": -57.95960616340956, "cost1_mean": 199.24515811358128, "outflow_rate_min": 508.5230901032742, "cost2_mean": -46.75549106503675, "outflow_rate_max": 1236.0253147000992, "cost1_max": 214.52041000375488, "system_level_velocity_min": 14.345283358249704, "cost2_max": -21.083460912749228, "cost1_min": 24.544413532699977, "system_level_velocity_mean": 17.200441083883916, "outflow_rate_mean": 1143.4873650031632, "system_level_velocity_max": 18.905845356857004}, "time_total_s": 1569.8519806861877, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 1.0451616048812866, "vf_explained_var": 0.899241030216217, "kl": 0.013899611309170723, "vf_loss": 8.625826835632324, "total_loss": 8.620661735534668, "policy_loss": -0.008292410522699356}, "sample_time_ms": 15048.878, "num_steps_sampled": 2079977, "num_steps_trained": 2079977, "grad_time_ms": 8736.478, "load_time_ms": 3.845, "update_time_ms": 9.102}, "episode_reward_min": -373.710034154284}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1a20>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2111319, "episodes_this_iter": 49, "pid": 45007, "timesteps_this_iter": 31342, "time_since_restore": 1592.887720823288, "node_ip": "10.138.0.2", "episode_len_mean": 323.26, "hostname": "flow-main", "training_iteration": 64, "iterations_since_restore": 64, "episode_reward_max": -212.65448139255724, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.03574013710022, "episodes_total": 2962, "timesteps_total": 2111319, "episode_reward_mean": -288.7111068592171, "timestamp": 1558584605, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-10-05", "custom_metrics": {"cost2_min": -57.95960616340956, "cost1_mean": 199.76395933496104, "outflow_rate_min": 891.6138832388469, "cost2_mean": -47.74059969097701, "outflow_rate_max": 1244.7059468049517, "cost1_max": 215.98513202878365, "system_level_velocity_min": 14.345283358249704, "cost2_max": -36.07344439045262, "cost1_min": 123.6806076497496, "system_level_velocity_mean": 17.07149310063411, "outflow_rate_mean": 1146.0556007404182, "system_level_velocity_max": 18.662092325220968}, "time_total_s": 1592.887720823288, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 1.0483285188674927, "vf_explained_var": 0.8945199251174927, "kl": 0.01472298800945282, "vf_loss": 9.238393783569336, "total_loss": 9.234243392944336, "policy_loss": -0.0074625504203140736}, "sample_time_ms": 15057.712, "num_steps_sampled": 2111319, "num_steps_trained": 2111319, "grad_time_ms": 8633.605, "load_time_ms": 3.934, "update_time_ms": 9.297}, "episode_reward_min": -373.710034154284}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd10b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1b00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd19b0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2142950, "episodes_this_iter": 48, "pid": 45007, "timesteps_this_iter": 31631, "time_since_restore": 1617.3506979942322, "node_ip": "10.138.0.2", "episode_len_mean": 319.66, "hostname": "flow-main", "training_iteration": 65, "iterations_since_restore": 65, "episode_reward_max": -24.541395606474072, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.462977170944214, "episodes_total": 3010, "timesteps_total": 2142950, "episode_reward_mean": -292.8282707365826, "timestamp": 1558584629, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-10-29", "custom_metrics": {"cost2_min": -60.5829241252652, "cost1_mean": 196.20106341121243, "outflow_rate_min": 454.9250223567449, "cost2_mean": -48.3026329557872, "outflow_rate_max": 1244.7059468049517, "cost1_max": 215.98513202878365, "system_level_velocity_min": 14.281563429059835, "cost2_max": -18.89739309005306, "cost1_min": 18.02339056465608, "system_level_velocity_mean": 16.915134128816263, "outflow_rate_mean": 1136.0262768963676, "system_level_velocity_max": 18.662092325220968}, "time_total_s": 1617.3506979942322, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499999403953552, "entropy": 1.047989010810852, "vf_explained_var": 0.8914641737937927, "kl": 0.016839174553751945, "vf_loss": 9.80524730682373, "total_loss": 9.800167083740234, "policy_loss": -0.008866802789270878}, "sample_time_ms": 15074.78, "num_steps_sampled": 2142950, "num_steps_trained": 2142950, "grad_time_ms": 8773.551, "load_time_ms": 3.954, "update_time_ms": 9.129}, "episode_reward_min": -411.37698866323547}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1080>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2174296, "episodes_this_iter": 44, "pid": 45007, "timesteps_this_iter": 31346, "time_since_restore": 1642.0543298721313, "node_ip": "10.138.0.2", "episode_len_mean": 320.66, "hostname": "flow-main", "training_iteration": 66, "iterations_since_restore": 66, "episode_reward_max": -24.541395606474072, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.70363187789917, "episodes_total": 3054, "timesteps_total": 2174296, "episode_reward_mean": -293.65493817597405, "timestamp": 1558584654, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-10-54", "custom_metrics": {"cost2_min": -60.5829241252652, "cost1_mean": 197.56272861005726, "outflow_rate_min": 454.9250223567449, "cost2_mean": -48.8327589356104, "outflow_rate_max": 1246.177291296822, "cost1_max": 215.11229020333764, "system_level_velocity_min": 14.281563429059835, "cost2_max": -18.89739309005306, "cost1_min": 18.02339056465608, "system_level_velocity_mean": 16.975840097909003, "outflow_rate_mean": 1144.8956584920118, "system_level_velocity_max": 18.55820839416446}, "time_total_s": 1642.0543298721313, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 1.0260586738586426, "vf_explained_var": 0.9003313183784485, "kl": 0.016227129846811295, "vf_loss": 8.362435340881348, "total_loss": 8.35770320892334, "policy_loss": -0.008383190259337425}, "sample_time_ms": 15111.776, "num_steps_sampled": 2174296, "num_steps_trained": 2174296, "grad_time_ms": 8667.444, "load_time_ms": 3.925, "update_time_ms": 9.097}, "episode_reward_min": -411.37698866323547}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd12b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1048>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2205344, "episodes_this_iter": 46, "pid": 45007, "timesteps_this_iter": 31048, "time_since_restore": 1664.9626502990723, "node_ip": "10.138.0.2", "episode_len_mean": 320.66, "hostname": "flow-main", "training_iteration": 67, "iterations_since_restore": 67, "episode_reward_max": -24.541395606474072, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.908320426940918, "episodes_total": 3100, "timesteps_total": 2205344, "episode_reward_mean": -288.1899335322082, "timestamp": 1558584677, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-11-17", "custom_metrics": {"cost2_min": -58.19217464502984, "cost1_mean": 199.0929898460199, "outflow_rate_min": 454.9250223567449, "cost2_mean": -49.43601958891868, "outflow_rate_max": 1248.2191892492367, "cost1_max": 215.93023977007402, "system_level_velocity_min": 14.499356252129347, "cost2_max": -18.89739309005306, "cost1_min": 18.02339056465608, "system_level_velocity_mean": 17.135216668876286, "outflow_rate_mean": 1155.896096433368, "system_level_velocity_max": 18.650736771041114}, "time_total_s": 1664.9626502990723, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 1.0118789672851562, "vf_explained_var": 0.888117253780365, "kl": 0.015704071149230003, "vf_loss": 8.429703712463379, "total_loss": 8.425259590148926, "policy_loss": -0.007977885194122791}, "sample_time_ms": 15053.95, "num_steps_sampled": 2205344, "num_steps_trained": 2205344, "grad_time_ms": 8649.058, "load_time_ms": 3.94, "update_time_ms": 8.738}, "episode_reward_min": -376.4015558386718}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb55c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5710>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2236407, "episodes_this_iter": 51, "pid": 45007, "timesteps_this_iter": 31063, "time_since_restore": 1688.9345009326935, "node_ip": "10.138.0.2", "episode_len_mean": 323.62, "hostname": "flow-main", "training_iteration": 68, "iterations_since_restore": 68, "episode_reward_max": -159.5021017913299, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.971850633621216, "episodes_total": 3151, "timesteps_total": 2236407, "episode_reward_mean": -283.52620453832935, "timestamp": 1558584701, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-11-41", "custom_metrics": {"cost2_min": -58.19217464502984, "cost1_mean": 202.871450614025, "outflow_rate_min": 983.8582481893275, "cost2_mean": -49.44180043265258, "outflow_rate_max": 1248.2191892492367, "cost1_max": 216.14872063928763, "system_level_velocity_min": 14.5837321280121, "cost2_max": -41.78623904244051, "cost1_min": 138.14605667959273, "system_level_velocity_mean": 17.347684012938636, "outflow_rate_mean": 1171.417059334954, "system_level_velocity_max": 18.741626836350807}, "time_total_s": 1688.9345009326935, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 1.0210554599761963, "vf_explained_var": 0.8891785740852356, "kl": 0.01641218177974224, "vf_loss": 8.87712287902832, "total_loss": 8.872849464416504, "policy_loss": -0.00796500314027071}, "sample_time_ms": 15023.543, "num_steps_sampled": 2236407, "num_steps_trained": 2236407, "grad_time_ms": 8632.779, "load_time_ms": 3.734, "update_time_ms": 9.048}, "episode_reward_min": -372.70553191684695}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd19e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1d68>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2267649, "episodes_this_iter": 43, "pid": 45007, "timesteps_this_iter": 31242, "time_since_restore": 1714.7520589828491, "node_ip": "10.138.0.2", "episode_len_mean": 324.8, "hostname": "flow-main", "training_iteration": 69, "iterations_since_restore": 69, "episode_reward_max": -245.9820734599417, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 25.81755805015564, "episodes_total": 3194, "timesteps_total": 2267649, "episode_reward_mean": -287.95439022288787, "timestamp": 1558584727, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-12-07", "custom_metrics": {"cost2_min": -57.74432821607295, "cost1_mean": 202.35549648085941, "outflow_rate_min": 948.3086054136486, "cost2_mean": -49.23800601750441, "outflow_rate_max": 1245.3257229350738, "cost1_max": 216.14872063928763, "system_level_velocity_min": 13.904350991755726, "cost2_max": -41.589822461880324, "cost1_min": 167.3448202362677, "system_level_velocity_mean": 17.234037205068557, "outflow_rate_mean": 1164.6412614267979, "system_level_velocity_max": 18.741626836350807}, "time_total_s": 1714.7520589828491, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 1.0346306562423706, "vf_explained_var": 0.9090840816497803, "kl": 0.017931995913386345, "vf_loss": 8.146204948425293, "total_loss": 8.140091896057129, "policy_loss": -0.010147986933588982}, "sample_time_ms": 14992.033, "num_steps_sampled": 2267649, "num_steps_trained": 2267649, "grad_time_ms": 8958.468, "load_time_ms": 3.878, "update_time_ms": 9.071}, "episode_reward_min": -402.16361858966224}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1b00>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2299037, "episodes_this_iter": 47, "pid": 45007, "timesteps_this_iter": 31388, "time_since_restore": 1738.47842335701, "node_ip": "10.138.0.2", "episode_len_mean": 322.02, "hostname": "flow-main", "training_iteration": 70, "iterations_since_restore": 70, "episode_reward_max": -22.856831852908424, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.726364374160767, "episodes_total": 3241, "timesteps_total": 2299037, "episode_reward_mean": -290.70242430649324, "timestamp": 1558584751, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-12-31", "custom_metrics": {"cost2_min": -62.144727553817745, "cost1_mean": 199.6879572354297, "outflow_rate_min": 492.0625426222078, "cost2_mean": -49.67073019997091, "outflow_rate_max": 1255.4804867348817, "cost1_max": 217.29475073443712, "system_level_velocity_min": 13.904350991755726, "cost2_max": -18.089150783963788, "cost1_min": 18.10525601185506, "system_level_velocity_mean": 17.126658694600778, "outflow_rate_mean": 1151.3320109589713, "system_level_velocity_max": 18.701282864728533}, "time_total_s": 1738.47842335701, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 1.0182026624679565, "vf_explained_var": 0.8907397985458374, "kl": 0.016739916056394577, "vf_loss": 9.149361610412598, "total_loss": 9.144878387451172, "policy_loss": -0.008250521495938301}, "sample_time_ms": 15077.988, "num_steps_sampled": 2299037, "num_steps_trained": 2299037, "grad_time_ms": 8990.404, "load_time_ms": 4.118, "update_time_ms": 9.462}, "episode_reward_min": -420.92079792185217}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd4e0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2330440, "episodes_this_iter": 46, "pid": 45007, "timesteps_this_iter": 31403, "time_since_restore": 1761.415462732315, "node_ip": "10.138.0.2", "episode_len_mean": 322.02, "hostname": "flow-main", "training_iteration": 71, "iterations_since_restore": 71, "episode_reward_max": -22.856831852908424, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.937039375305176, "episodes_total": 3287, "timesteps_total": 2330440, "episode_reward_mean": -292.88140299306787, "timestamp": 1558584774, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-12-54", "custom_metrics": {"cost2_min": -62.144727553817745, "cost1_mean": 199.1670840814391, "outflow_rate_min": 492.0625426222078, "cost2_mean": -50.644615670110994, "outflow_rate_max": 1264.3936837326253, "cost1_max": 217.71453036636478, "system_level_velocity_min": 13.904350991755726, "cost2_max": -18.089150783963788, "cost1_min": 18.10525601185506, "system_level_velocity_mean": 17.040870316470798, "outflow_rate_mean": 1152.239943661748, "system_level_velocity_max": 18.823832512675324}, "time_total_s": 1761.415462732315, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 1.0009700059890747, "vf_explained_var": 0.8859151005744934, "kl": 0.016123061999678612, "vf_loss": 8.827640533447266, "total_loss": 8.824663162231445, "policy_loss": -0.006605650298297405}, "sample_time_ms": 14943.497, "num_steps_sampled": 2330440, "num_steps_trained": 2330440, "grad_time_ms": 8779.207, "load_time_ms": 3.871, "update_time_ms": 9.376}, "episode_reward_min": -420.92079792185217}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1f28>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2361780, "episodes_this_iter": 47, "pid": 45007, "timesteps_this_iter": 31340, "time_since_restore": 1784.5904428958893, "node_ip": "10.138.0.2", "episode_len_mean": 323.82, "hostname": "flow-main", "training_iteration": 72, "iterations_since_restore": 72, "episode_reward_max": -156.1663389738824, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.17498016357422, "episodes_total": 3334, "timesteps_total": 2361780, "episode_reward_mean": -291.0094470709278, "timestamp": 1558584797, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-13-17", "custom_metrics": {"cost2_min": -59.69339871487038, "cost1_mean": 201.51914717512926, "outflow_rate_min": 1014.8147458815208, "cost2_mean": -51.10272239449425, "outflow_rate_max": 1264.3936837326253, "cost1_max": 217.71453036636478, "system_level_velocity_min": 14.83979748248285, "cost2_max": -42.85749033282405, "cost1_min": 140.29117596177565, "system_level_velocity_mean": 17.152258230210517, "outflow_rate_mean": 1166.0804016501731, "system_level_velocity_max": 18.949149407851245}, "time_total_s": 1784.5904428958893, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 1.012622594833374, "vf_explained_var": 0.896142303943634, "kl": 0.015621442347764969, "vf_loss": 8.243595123291016, "total_loss": 8.237714767456055, "policy_loss": -0.009394655004143715}, "sample_time_ms": 14969.812, "num_steps_sampled": 2361780, "num_steps_trained": 2361780, "grad_time_ms": 8788.625, "load_time_ms": 3.965, "update_time_ms": 9.46}, "episode_reward_min": -382.1797555699072}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd10b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1a90>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2393111, "episodes_this_iter": 45, "pid": 45007, "timesteps_this_iter": 31331, "time_since_restore": 1807.65269947052, "node_ip": "10.138.0.2", "episode_len_mean": 321.28, "hostname": "flow-main", "training_iteration": 73, "iterations_since_restore": 73, "episode_reward_max": -156.1663389738824, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.062256574630737, "episodes_total": 3379, "timesteps_total": 2393111, "episode_reward_mean": -288.2918907628343, "timestamp": 1558584820, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-13-40", "custom_metrics": {"cost2_min": -59.69339871487038, "cost1_mean": 199.93030091047166, "outflow_rate_min": 888.9627643246275, "cost2_mean": -50.95052204070312, "outflow_rate_max": 1262.7404098253758, "cost1_max": 218.63785493276018, "system_level_velocity_min": 14.83979748248285, "cost2_max": -41.52845833653048, "cost1_min": 123.39881738755419, "system_level_velocity_mean": 17.153246524187196, "outflow_rate_mean": 1159.400673844866, "system_level_velocity_max": 18.949149407851245}, "time_total_s": 1807.65269947052, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 0.9999260306358337, "vf_explained_var": 0.887286365032196, "kl": 0.015635408461093903, "vf_loss": 8.933134078979492, "total_loss": 8.929579734802246, "policy_loss": -0.007073420099914074}, "sample_time_ms": 15021.989, "num_steps_sampled": 2393111, "num_steps_trained": 2393111, "grad_time_ms": 8672.215, "load_time_ms": 4.118, "update_time_ms": 9.394}, "episode_reward_min": -382.1797555699072}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badc18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badcc0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2424790, "episodes_this_iter": 51, "pid": 45007, "timesteps_this_iter": 31679, "time_since_restore": 1832.6626200675964, "node_ip": "10.138.0.2", "episode_len_mean": 319.3, "hostname": "flow-main", "training_iteration": 74, "iterations_since_restore": 74, "episode_reward_max": -32.924089906473874, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 25.009920597076416, "episodes_total": 3430, "timesteps_total": 2424790, "episode_reward_mean": -287.9177514206047, "timestamp": 1558584845, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-14-05", "custom_metrics": {"cost2_min": -58.64779224228295, "cost1_mean": 197.8045810744242, "outflow_rate_min": 480.36537355228626, "cost2_mean": -51.077444572722015, "outflow_rate_max": 1262.7404098253758, "cost1_max": 218.63785493276018, "system_level_velocity_min": 14.062668666105768, "cost2_max": -21.026569810963274, "cost1_min": 24.54492555582881, "system_level_velocity_mean": 17.073517857491087, "outflow_rate_mean": 1152.5148431587982, "system_level_velocity_max": 18.943694379264347}, "time_total_s": 1832.6626200675964, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499999403953552, "entropy": 1.0253167152404785, "vf_explained_var": 0.9007354974746704, "kl": 0.016794301569461823, "vf_loss": 8.9524507522583, "total_loss": 8.947372436523438, "policy_loss": -0.008857570588588715}, "sample_time_ms": 15248.246, "num_steps_sampled": 2424790, "num_steps_trained": 2424790, "grad_time_ms": 8644.199, "load_time_ms": 4.122, "update_time_ms": 8.984}, "episode_reward_min": -412.2987455268737}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4d68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4a90>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2456362, "episodes_this_iter": 44, "pid": 45007, "timesteps_this_iter": 31572, "time_since_restore": 1855.7473902702332, "node_ip": "10.138.0.2", "episode_len_mean": 318.46, "hostname": "flow-main", "training_iteration": 75, "iterations_since_restore": 75, "episode_reward_max": -32.924089906473874, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.08477020263672, "episodes_total": 3474, "timesteps_total": 2456362, "episode_reward_mean": -288.0231306476234, "timestamp": 1558584868, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-14-28", "custom_metrics": {"cost2_min": -59.39549644303894, "cost1_mean": 197.74343739714618, "outflow_rate_min": 480.36537355228626, "cost2_mean": -51.26188096246787, "outflow_rate_max": 1258.836198600294, "cost1_max": 218.0266731959149, "system_level_velocity_min": 14.062668666105768, "cost2_max": -21.026569810963274, "cost1_min": 24.54492555582881, "system_level_velocity_mean": 17.133642924909864, "outflow_rate_mean": 1151.4001871419518, "system_level_velocity_max": 18.943694379264347}, "time_total_s": 1855.7473902702332, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 1.0138005018234253, "vf_explained_var": 0.8929530382156372, "kl": 0.015781812369823456, "vf_loss": 8.43274974822998, "total_loss": 8.427940368652344, "policy_loss": -0.008359772153198719}, "sample_time_ms": 15263.898, "num_steps_sampled": 2456362, "num_steps_trained": 2456362, "grad_time_ms": 8490.694, "load_time_ms": 4.077, "update_time_ms": 8.976}, "episode_reward_min": -412.2987455268737}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd12e8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2488036, "episodes_this_iter": 44, "pid": 45007, "timesteps_this_iter": 31674, "time_since_restore": 1878.8702974319458, "node_ip": "10.138.0.2", "episode_len_mean": 321.62, "hostname": "flow-main", "training_iteration": 76, "iterations_since_restore": 76, "episode_reward_max": -156.50822421613404, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.122907161712646, "episodes_total": 3518, "timesteps_total": 2488036, "episode_reward_mean": -296.3912441150373, "timestamp": 1558584891, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-14-51", "custom_metrics": {"cost2_min": -59.39549644303894, "cost1_mean": 198.0073542208715, "outflow_rate_min": 906.4840113797728, "cost2_mean": -51.97288062252741, "outflow_rate_max": 1259.89234141637, "cost1_max": 217.77654672096637, "system_level_velocity_min": 14.273699428497208, "cost2_max": -39.696341432107545, "cost1_min": 127.82072927033728, "system_level_velocity_mean": 16.939569446748948, "outflow_rate_mean": 1147.2522053292275, "system_level_velocity_max": 18.795787034750198}, "time_total_s": 1878.8702974319458, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499999403953552, "entropy": 1.032442331314087, "vf_explained_var": 0.8974065780639648, "kl": 0.017563913017511368, "vf_loss": 9.002949714660645, "total_loss": 8.99709415435791, "policy_loss": -0.009807338938117027}, "sample_time_ms": 15279.609, "num_steps_sampled": 2488036, "num_steps_trained": 2488036, "grad_time_ms": 8317.192, "load_time_ms": 4.111, "update_time_ms": 8.844}, "episode_reward_min": -388.33323704561684}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb55c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb5b38>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2519999, "episodes_this_iter": 52, "pid": 45007, "timesteps_this_iter": 31963, "time_since_restore": 1902.3231348991394, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "training_iteration": 77, "iterations_since_restore": 77, "episode_reward_max": -242.67561783042797, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.452837467193604, "episodes_total": 3570, "timesteps_total": 2519999, "episode_reward_mean": -305.90677160311236, "timestamp": 1558584915, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-15-15", "custom_metrics": {"cost2_min": -63.22763640313244, "cost1_mean": 198.61169782358692, "outflow_rate_min": 970.1877417745203, "cost2_mean": -53.22669655140726, "outflow_rate_max": 1267.4936241575406, "cost1_max": 217.6900246510532, "system_level_velocity_min": 13.749501909234715, "cost2_max": -46.89778783203943, "cost1_min": 165.70256689646857, "system_level_velocity_mean": 16.797820061707043, "outflow_rate_mean": 1150.5725878454557, "system_level_velocity_max": 18.774531374104527}, "time_total_s": 1902.3231348991394, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499999403953552, "entropy": 1.029365062713623, "vf_explained_var": 0.8922908902168274, "kl": 0.0166916623711586, "vf_loss": 10.263916969299316, "total_loss": 10.258349418640137, "policy_loss": -0.00932225864380598}, "sample_time_ms": 15326.145, "num_steps_sampled": 2519999, "num_steps_trained": 2519999, "grad_time_ms": 8324.96, "load_time_ms": 4.143, "update_time_ms": 8.832}, "episode_reward_min": -436.9954295264614}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbda20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd240>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2551347, "episodes_this_iter": 43, "pid": 45007, "timesteps_this_iter": 31348, "time_since_restore": 1925.386001586914, "node_ip": "10.138.0.2", "episode_len_mean": 323.9, "hostname": "flow-main", "training_iteration": 78, "iterations_since_restore": 78, "episode_reward_max": -172.06754063549093, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.062866687774658, "episodes_total": 3613, "timesteps_total": 2551347, "episode_reward_mean": -300.0356547525753, "timestamp": 1558584938, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-15-38", "custom_metrics": {"cost2_min": -63.22763640313244, "cost1_mean": 199.77678528735342, "outflow_rate_min": 970.1877417745203, "cost2_mean": -52.7269036982563, "outflow_rate_max": 1267.4936241575406, "cost1_max": 217.6900246510532, "system_level_velocity_min": 13.749501909234715, "cost2_max": -43.42069785238944, "cost1_min": 140.9207800495118, "system_level_velocity_mean": 16.967053160732547, "outflow_rate_mean": 1160.1174405804882, "system_level_velocity_max": 18.78821405031838}, "time_total_s": 1925.386001586914, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 0.9855151772499084, "vf_explained_var": 0.9035041928291321, "kl": 0.017111465334892273, "vf_loss": 7.372984886169434, "total_loss": 7.368849277496338, "policy_loss": -0.007985548116266727}, "sample_time_ms": 15349.274, "num_steps_sampled": 2551347, "num_steps_trained": 2551347, "grad_time_ms": 8210.109, "load_time_ms": 4.231, "update_time_ms": 8.646}, "episode_reward_min": -436.9954295264614}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd16a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1f28>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2583045, "episodes_this_iter": 46, "pid": 45007, "timesteps_this_iter": 31698, "time_since_restore": 1948.5012686252594, "node_ip": "10.138.0.2", "episode_len_mean": 322.8, "hostname": "flow-main", "training_iteration": 79, "iterations_since_restore": 79, "episode_reward_max": -163.84620425254295, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.115267038345337, "episodes_total": 3659, "timesteps_total": 2583045, "episode_reward_mean": -291.1498732685529, "timestamp": 1558584961, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-16-01", "custom_metrics": {"cost2_min": -62.26936521262515, "cost1_mean": 201.62411074790649, "outflow_rate_min": 988.2393221830987, "cost2_mean": -52.27473898339566, "outflow_rate_max": 1267.4936241575406, "cost1_max": 219.0136559277766, "system_level_velocity_min": 13.749501909234715, "cost2_max": -40.81948006948379, "cost1_min": 140.9207800495118, "system_level_velocity_mean": 17.207990616345345, "outflow_rate_mean": 1168.2197309170012, "system_level_velocity_max": 18.841790973977716}, "time_total_s": 1948.5012686252594, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499999403953552, "entropy": 1.019485354423523, "vf_explained_var": 0.8761300444602966, "kl": 0.015565113164484501, "vf_loss": 10.14193344116211, "total_loss": 10.136968612670898, "policy_loss": -0.008467676118016243}, "sample_time_ms": 15397.077, "num_steps_sampled": 2583045, "num_steps_trained": 2583045, "grad_time_ms": 7893.96, "load_time_ms": 4.203, "update_time_ms": 8.82}, "episode_reward_min": -423.618718569517}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad5f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad1d0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2614715, "episodes_this_iter": 50, "pid": 45007, "timesteps_this_iter": 31670, "time_since_restore": 1971.775814294815, "node_ip": "10.138.0.2", "episode_len_mean": 323.9, "hostname": "flow-main", "training_iteration": 80, "iterations_since_restore": 80, "episode_reward_max": -163.84620425254295, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.274545669555664, "episodes_total": 3709, "timesteps_total": 2614715, "episode_reward_mean": -294.2225831309172, "timestamp": 1558584984, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-16-24", "custom_metrics": {"cost2_min": -62.26936521262515, "cost1_mean": 201.6535270098544, "outflow_rate_min": 1015.9134060840173, "cost2_mean": -53.01927571271135, "outflow_rate_max": 1258.9696040974532, "cost1_max": 219.0136559277766, "system_level_velocity_min": 14.238316992442902, "cost2_max": -40.81948006948379, "cost1_min": 144.2124151825419, "system_level_velocity_mean": 17.142093603585433, "outflow_rate_mean": 1166.7820627763776, "system_level_velocity_max": 18.841790973977716}, "time_total_s": 1971.775814294815, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499999403953552, "entropy": 1.0108561515808105, "vf_explained_var": 0.8951870799064636, "kl": 0.01716659776866436, "vf_loss": 9.117122650146484, "total_loss": 9.112126350402832, "policy_loss": -0.008857984095811844}, "sample_time_ms": 15359.854, "num_steps_sampled": 2614715, "num_steps_trained": 2614715, "grad_time_ms": 7886.632, "load_time_ms": 4.056, "update_time_ms": 8.39}, "episode_reward_min": -403.5714057012647}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd19e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbda58>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2646272, "episodes_this_iter": 44, "pid": 45007, "timesteps_this_iter": 31557, "time_since_restore": 1995.0586204528809, "node_ip": "10.138.0.2", "episode_len_mean": 324.52, "hostname": "flow-main", "training_iteration": 81, "iterations_since_restore": 81, "episode_reward_max": -237.35091934470327, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.282806158065796, "episodes_total": 3753, "timesteps_total": 2646272, "episode_reward_mean": -299.79193413611307, "timestamp": 1558585008, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-16-48", "custom_metrics": {"cost2_min": -63.3463005161778, "cost1_mean": 200.35841757811247, "outflow_rate_min": 968.543241933658, "cost2_mean": -53.38954370184628, "outflow_rate_max": 1259.0075663656914, "cost1_max": 218.0526122704908, "system_level_velocity_min": 13.657866195044345, "cost2_max": -42.68839124088803, "cost1_min": 164.15033325256715, "system_level_velocity_mean": 16.98521258222736, "outflow_rate_mean": 1161.4793921907317, "system_level_velocity_max": 18.773973648555273}, "time_total_s": 1995.0586204528809, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 1.0019434690475464, "vf_explained_var": 0.9038764238357544, "kl": 0.017745770514011383, "vf_loss": 8.413105010986328, "total_loss": 8.40754508972168, "policy_loss": -0.009552476927638054}, "sample_time_ms": 15387.293, "num_steps_sampled": 2646272, "num_steps_trained": 2646272, "grad_time_ms": 7892.535, "load_time_ms": 4.202, "update_time_ms": 8.344}, "episode_reward_min": -433.3676240508226}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd16a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1320>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2678058, "episodes_this_iter": 45, "pid": 45007, "timesteps_this_iter": 31786, "time_since_restore": 2018.7104892730713, "node_ip": "10.138.0.2", "episode_len_mean": 323.14, "hostname": "flow-main", "training_iteration": 82, "iterations_since_restore": 82, "episode_reward_max": -222.4402526428056, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.65186882019043, "episodes_total": 3798, "timesteps_total": 2678058, "episode_reward_mean": -295.1111153215076, "timestamp": 1558585031, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-17-11", "custom_metrics": {"cost2_min": -63.3463005161778, "cost1_mean": 200.65835644765428, "outflow_rate_min": 864.2272785419465, "cost2_mean": -53.17056140244111, "outflow_rate_max": 1264.7235671486976, "cost1_max": 218.68070514140322, "system_level_velocity_min": 13.657866195044345, "cost2_max": -42.68839124088803, "cost1_min": 122.59022136882223, "system_level_velocity_mean": 17.10739006080099, "outflow_rate_mean": 1163.632892767833, "system_level_velocity_max": 18.910604473959253}, "time_total_s": 2018.7104892730713, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 0.9907438158988953, "vf_explained_var": 0.9023562669754028, "kl": 0.016253456473350525, "vf_loss": 8.423418998718262, "total_loss": 8.419695854187012, "policy_loss": -0.007380351889878511}, "sample_time_ms": 15411.929, "num_steps_sampled": 2678058, "num_steps_trained": 2678058, "grad_time_ms": 7915.375, "load_time_ms": 4.156, "update_time_ms": 8.285}, "episode_reward_min": -433.3676240508226}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1ba8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2709376, "episodes_this_iter": 50, "pid": 45007, "timesteps_this_iter": 31318, "time_since_restore": 2042.5407044887543, "node_ip": "10.138.0.2", "episode_len_mean": 322.55, "hostname": "flow-main", "training_iteration": 83, "iterations_since_restore": 83, "episode_reward_max": -221.73943661991714, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.830215215682983, "episodes_total": 3848, "timesteps_total": 2709376, "episode_reward_mean": -291.0647603876346, "timestamp": 1558585055, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-17-35", "custom_metrics": {"cost2_min": -61.90384757268552, "cost1_mean": 201.20693852594965, "outflow_rate_min": 864.2272785419465, "cost2_mean": -52.656583061636454, "outflow_rate_max": 1264.7235671486976, "cost1_max": 218.68070514140322, "system_level_velocity_min": 14.246910219026395, "cost2_max": -43.22936681365961, "cost1_min": 122.59022136882223, "system_level_velocity_mean": 17.196718922840574, "outflow_rate_mean": 1169.589519332773, "system_level_velocity_max": 18.910604473959253}, "time_total_s": 2042.5407044887543, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 0.9716650247573853, "vf_explained_var": 0.8996015191078186, "kl": 0.017774315550923347, "vf_loss": 7.895713806152344, "total_loss": 7.890458106994629, "policy_loss": -0.009256001561880112}, "sample_time_ms": 15474.304, "num_steps_sampled": 2709376, "num_steps_trained": 2709376, "grad_time_ms": 7930.189, "load_time_ms": 4.18, "update_time_ms": 8.452}, "episode_reward_min": -390.52789613320465}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1400>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd16d8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2740794, "episodes_this_iter": 45, "pid": 45007, "timesteps_this_iter": 31418, "time_since_restore": 2065.166405439377, "node_ip": "10.138.0.2", "episode_len_mean": 321.75, "hostname": "flow-main", "training_iteration": 84, "iterations_since_restore": 84, "episode_reward_max": -157.3721687447635, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.62570095062256, "episodes_total": 3893, "timesteps_total": 2740794, "episode_reward_mean": -294.7713004432178, "timestamp": 1558585078, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-17-58", "custom_metrics": {"cost2_min": -61.91627830095487, "cost1_mean": 198.84318194292598, "outflow_rate_min": 927.0723311700136, "cost2_mean": -52.06306097238277, "outflow_rate_max": 1261.735153551523, "cost1_max": 218.57968740019624, "system_level_velocity_min": 13.624540133872971, "cost2_max": -38.09768722547913, "cost1_min": 130.94485441371975, "system_level_velocity_mean": 17.05466482801437, "outflow_rate_mean": 1155.7829265707858, "system_level_velocity_max": 18.871563238251184}, "time_total_s": 2065.166405439377, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 1.0138028860092163, "vf_explained_var": 0.9274078607559204, "kl": 0.017478318884968758, "vf_loss": 6.936465740203857, "total_loss": 6.930515766143799, "policy_loss": -0.009883278980851173}, "sample_time_ms": 15242.625, "num_steps_sampled": 2740794, "num_steps_trained": 2740794, "grad_time_ms": 7921.759, "load_time_ms": 4.139, "update_time_ms": 8.54}, "episode_reward_min": -467.66861894497026}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd16a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1320>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2771957, "episodes_this_iter": 45, "pid": 45007, "timesteps_this_iter": 31163, "time_since_restore": 2088.2951118946075, "node_ip": "10.138.0.2", "episode_len_mean": 319.64, "hostname": "flow-main", "training_iteration": 85, "iterations_since_restore": 85, "episode_reward_max": -31.698077933286466, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.128706455230713, "episodes_total": 3938, "timesteps_total": 2771957, "episode_reward_mean": -292.6666615370581, "timestamp": 1558585101, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-18-21", "custom_metrics": {"cost2_min": -61.91627830095487, "cost1_mean": 197.99247432944827, "outflow_rate_min": 464.52408151712706, "cost2_mean": -51.27837740564277, "outflow_rate_max": 1252.62519611891, "cost1_max": 218.57968740019624, "system_level_velocity_min": 13.624540133872971, "cost2_max": -21.77800265902478, "cost1_min": 23.252248405436152, "system_level_velocity_mean": 17.127130740965928, "outflow_rate_mean": 1147.9756844644912, "system_level_velocity_max": 18.871563238251184}, "time_total_s": 2088.2951118946075, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 0.974416971206665, "vf_explained_var": 0.8910648226737976, "kl": 0.01684967800974846, "vf_loss": 8.103586196899414, "total_loss": 8.098945617675781, "policy_loss": -0.008432011120021343}, "sample_time_ms": 15237.816, "num_steps_sampled": 2771957, "num_steps_trained": 2771957, "grad_time_ms": 7930.216, "load_time_ms": 4.195, "update_time_ms": 8.577}, "episode_reward_min": -467.66861894497026}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd19b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1860>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2803288, "episodes_this_iter": 49, "pid": 45007, "timesteps_this_iter": 31331, "time_since_restore": 2111.4518744945526, "node_ip": "10.138.0.2", "episode_len_mean": 320.72, "hostname": "flow-main", "training_iteration": 86, "iterations_since_restore": 86, "episode_reward_max": -31.698077933286466, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.15676259994507, "episodes_total": 3987, "timesteps_total": 2803288, "episode_reward_mean": -287.203930325819, "timestamp": 1558585124, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-18-44", "custom_metrics": {"cost2_min": -63.08047169033537, "cost1_mean": 200.6592645132835, "outflow_rate_min": 464.52408151712706, "cost2_mean": -50.53367207320198, "outflow_rate_max": 1243.988327977779, "cost1_max": 218.71183331264922, "system_level_velocity_min": 13.820321859444638, "cost2_max": -21.77800265902478, "cost1_min": 23.252248405436152, "system_level_velocity_mean": 17.330739902658262, "outflow_rate_mean": 1156.8247274559683, "system_level_velocity_max": 18.901990127070288}, "time_total_s": 2111.4518744945526, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 0.9912422299385071, "vf_explained_var": 0.9059207439422607, "kl": 0.016488537192344666, "vf_loss": 7.716960906982422, "total_loss": 7.7111735343933105, "policy_loss": -0.009496956132352352}, "sample_time_ms": 15247.585, "num_steps_sampled": 2803288, "num_steps_trained": 2803288, "grad_time_ms": 7921.848, "load_time_ms": 4.151, "update_time_ms": 8.497}, "episode_reward_min": -426.212030516454}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd19e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1c88>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2834290, "episodes_this_iter": 46, "pid": 45007, "timesteps_this_iter": 31002, "time_since_restore": 2136.2361204624176, "node_ip": "10.138.0.2", "episode_len_mean": 323.62, "hostname": "flow-main", "training_iteration": 87, "iterations_since_restore": 87, "episode_reward_max": -214.56327492178997, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.78424596786499, "episodes_total": 4033, "timesteps_total": 2834290, "episode_reward_mean": -288.6492505195033, "timestamp": 1558585149, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-19-09", "custom_metrics": {"cost2_min": -63.08047169033537, "cost1_mean": 202.1202149410692, "outflow_rate_min": 911.7324343282257, "cost2_mean": -49.85614367483641, "outflow_rate_max": 1243.988327977779, "cost1_max": 218.71183331264922, "system_level_velocity_min": 13.820321859444638, "cost2_max": -35.222936440932344, "cost1_min": 129.57903613553157, "system_level_velocity_mean": 17.30320643906573, "outflow_rate_mean": 1159.7768306673368, "system_level_velocity_max": 18.901990127070288}, "time_total_s": 2136.2361204624176, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 0.9900583028793335, "vf_explained_var": 0.9161196351051331, "kl": 0.016342807561159134, "vf_loss": 7.082981586456299, "total_loss": 7.075945854187012, "policy_loss": -0.010712729766964912}, "sample_time_ms": 15228.43, "num_steps_sampled": 2834290, "num_steps_trained": 2834290, "grad_time_ms": 8074.358, "load_time_ms": 4.143, "update_time_ms": 8.462}, "episode_reward_min": -426.212030516454}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1c18>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2865410, "episodes_this_iter": 44, "pid": 45007, "timesteps_this_iter": 31120, "time_since_restore": 2159.6521418094635, "node_ip": "10.138.0.2", "episode_len_mean": 324.52, "hostname": "flow-main", "training_iteration": 88, "iterations_since_restore": 88, "episode_reward_max": -230.59905218362204, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.4160213470459, "episodes_total": 4077, "timesteps_total": 2865410, "episode_reward_mean": -292.1968303904661, "timestamp": 1558585173, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-19-33", "custom_metrics": {"cost2_min": -63.451251784902055, "cost1_mean": 201.73576753147464, "outflow_rate_min": 955.8202887864823, "cost2_mean": -49.241015792507696, "outflow_rate_max": 1237.083041887451, "cost1_max": 216.53495464377383, "system_level_velocity_min": 14.037358588723253, "cost2_max": -35.222936440932344, "cost1_min": 168.12122842463924, "system_level_velocity_mean": 17.202108727105283, "outflow_rate_mean": 1150.5540448361135, "system_level_velocity_max": 18.800609215945872}, "time_total_s": 2159.6521418094635, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 0.9897865056991577, "vf_explained_var": 0.9126335978507996, "kl": 0.01668720878660679, "vf_loss": 7.432008266448975, "total_loss": 7.426942825317383, "policy_loss": -0.00881997775286436}, "sample_time_ms": 15250.293, "num_steps_sampled": 2865410, "num_steps_trained": 2865410, "grad_time_ms": 8089.524, "load_time_ms": 4.274, "update_time_ms": 8.701}, "episode_reward_min": -414.74775633765074}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd11d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bb59b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd17b8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2896217, "episodes_this_iter": 48, "pid": 45007, "timesteps_this_iter": 30807, "time_since_restore": 2183.92347073555, "node_ip": "10.138.0.2", "episode_len_mean": 324.52, "hostname": "flow-main", "training_iteration": 89, "iterations_since_restore": 89, "episode_reward_max": -230.6708434154084, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.271328926086426, "episodes_total": 4125, "timesteps_total": 2896217, "episode_reward_mean": -288.44720479203437, "timestamp": 1558585197, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-19-57", "custom_metrics": {"cost2_min": -63.451251784902055, "cost1_mean": 202.34437572232488, "outflow_rate_min": 955.8202887864823, "cost2_mean": -48.118089079368254, "outflow_rate_max": 1222.4081601580895, "cost1_max": 216.47935751488316, "system_level_velocity_min": 14.037358588723253, "cost2_max": -35.4177402144534, "cost1_min": 168.54634648732682, "system_level_velocity_mean": 17.27434672793168, "outflow_rate_mean": 1150.5370082163436, "system_level_velocity_max": 18.89654328039528}, "time_total_s": 2183.92347073555, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 0.9908981919288635, "vf_explained_var": 0.9090431332588196, "kl": 0.015328431501984596, "vf_loss": 7.8836894035339355, "total_loss": 7.8781514167785645, "policy_loss": -0.008986998349428177}, "sample_time_ms": 15246.867, "num_steps_sampled": 2896217, "num_steps_trained": 2896217, "grad_time_ms": 8208.944, "load_time_ms": 4.385, "update_time_ms": 8.414}, "episode_reward_min": -414.579656171205}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd12e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd16d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1b70>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2927527, "episodes_this_iter": 49, "pid": 45007, "timesteps_this_iter": 31310, "time_since_restore": 2208.6449904441833, "node_ip": "10.138.0.2", "episode_len_mean": 321.82, "hostname": "flow-main", "training_iteration": 90, "iterations_since_restore": 90, "episode_reward_max": -23.091381809920417, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.721519708633423, "episodes_total": 4174, "timesteps_total": 2927527, "episode_reward_mean": -290.22698701880165, "timestamp": 1558585222, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-20-22", "custom_metrics": {"cost2_min": -63.14851672378812, "cost1_mean": 199.33173416692756, "outflow_rate_min": 493.8123238995481, "cost2_mean": -48.536531708783734, "outflow_rate_max": 1222.7725129160158, "cost1_max": 216.95313835505246, "system_level_velocity_min": 13.851392110007081, "cost2_max": -17.732961589013442, "cost1_min": 17.968165254660136, "system_level_velocity_mean": 17.147750796390923, "outflow_rate_mean": 1136.585284265395, "system_level_velocity_max": 18.89654328039528}, "time_total_s": 2208.6449904441833, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 0.9968522787094116, "vf_explained_var": 0.907259464263916, "kl": 0.01572151482105255, "vf_loss": 8.91594123840332, "total_loss": 8.90949821472168, "policy_loss": -0.009980635717511177}, "sample_time_ms": 15250.918, "num_steps_sampled": 2927527, "num_steps_trained": 2927527, "grad_time_ms": 8348.885, "load_time_ms": 4.5, "update_time_ms": 8.5}, "episode_reward_min": -419.0384160961595}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbda90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd0b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbdba8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2958569, "episodes_this_iter": 43, "pid": 45007, "timesteps_this_iter": 31042, "time_since_restore": 2231.828763484955, "node_ip": "10.138.0.2", "episode_len_mean": 320.84, "hostname": "flow-main", "training_iteration": 91, "iterations_since_restore": 91, "episode_reward_max": -23.091381809920417, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.183773040771484, "episodes_total": 4217, "timesteps_total": 2958569, "episode_reward_mean": -288.5222295628061, "timestamp": 1558585245, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-20-45", "custom_metrics": {"cost2_min": -60.42298943326852, "cost1_mean": 199.02937437046438, "outflow_rate_min": 493.8123238995481, "cost2_mean": -48.64757576214786, "outflow_rate_max": 1229.458045072096, "cost1_max": 217.16524783213458, "system_level_velocity_min": 13.851392110007081, "cost2_max": -17.732961589013442, "cost1_min": 17.968165254660136, "system_level_velocity_mean": 17.174530777437557, "outflow_rate_mean": 1137.8621167050098, "system_level_velocity_max": 18.88045951357852}, "time_total_s": 2231.828763484955, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 0.959476113319397, "vf_explained_var": 0.9145985841751099, "kl": 0.016366083174943924, "vf_loss": 7.6377387046813965, "total_loss": 7.6332550048828125, "policy_loss": -0.008165787905454636}, "sample_time_ms": 15236.669, "num_steps_sampled": 2958569, "num_steps_trained": 2958569, "grad_time_ms": 8353.619, "load_time_ms": 4.541, "update_time_ms": 8.649}, "episode_reward_min": -419.0384160961595}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bade10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd17b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1208>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 2989475, "episodes_this_iter": 48, "pid": 45007, "timesteps_this_iter": 30906, "time_since_restore": 2255.9871895313263, "node_ip": "10.138.0.2", "episode_len_mean": 320.84, "hostname": "flow-main", "training_iteration": 92, "iterations_since_restore": 92, "episode_reward_max": -23.809489484868568, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.15842604637146, "episodes_total": 4265, "timesteps_total": 2989475, "episode_reward_mean": -286.6574359749362, "timestamp": 1558585269, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-21-09", "custom_metrics": {"cost2_min": -66.09542661383651, "cost1_mean": 199.96032149990012, "outflow_rate_min": 468.51797875626045, "cost2_mean": -49.31860213372023, "outflow_rate_max": 1234.630090951013, "cost1_max": 217.16524783213458, "system_level_velocity_min": 14.53013200187281, "cost2_max": -16.66717969421679, "cost1_min": 17.860373010429058, "system_level_velocity_mean": 17.260449711725702, "outflow_rate_mean": 1149.2082329677648, "system_level_velocity_max": 18.93640010906199}, "time_total_s": 2255.9871895313263, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 0.9384750723838806, "vf_explained_var": 0.9035747647285461, "kl": 0.016332149505615234, "vf_loss": 8.038604736328125, "total_loss": 8.035566329956055, "policy_loss": -0.006712575443089008}, "sample_time_ms": 15347.265, "num_steps_sampled": 2989475, "num_steps_trained": 2989475, "grad_time_ms": 8294.269, "load_time_ms": 4.524, "update_time_ms": 8.567}, "episode_reward_min": -390.7571181680387}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd3c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd1d0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3021043, "episodes_this_iter": 50, "pid": 45007, "timesteps_this_iter": 31568, "time_since_restore": 2280.9515001773834, "node_ip": "10.138.0.2", "episode_len_mean": 320.94, "hostname": "flow-main", "training_iteration": 93, "iterations_since_restore": 93, "episode_reward_max": -23.809489484868568, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.96431064605713, "episodes_total": 4315, "timesteps_total": 3021043, "episode_reward_mean": -289.9255148394726, "timestamp": 1558585294, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-21-34", "custom_metrics": {"cost2_min": -67.45114656186132, "cost1_mean": 199.7284254545943, "outflow_rate_min": 468.51797875626045, "cost2_mean": -50.21869193602748, "outflow_rate_max": 1235.4182810322723, "cost1_max": 217.3490628281536, "system_level_velocity_min": 14.06884178118871, "cost2_max": -16.66717969421679, "cost1_min": 17.860373010429058, "system_level_velocity_mean": 17.235446667578376, "outflow_rate_mean": 1148.7276919908866, "system_level_velocity_max": 18.948662667246666}, "time_total_s": 2280.9515001773834, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 0.9466161727905273, "vf_explained_var": 0.912115752696991, "kl": 0.016959698870778084, "vf_loss": 7.909520626068115, "total_loss": 7.904537200927734, "policy_loss": -0.008799583651125431}, "sample_time_ms": 15313.188, "num_steps_sampled": 3021043, "num_steps_trained": 3021043, "grad_time_ms": 8441.968, "load_time_ms": 4.472, "update_time_ms": 8.144}, "episode_reward_min": -417.7094032977935}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1da0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3052040, "episodes_this_iter": 44, "pid": 45007, "timesteps_this_iter": 30997, "time_since_restore": 2304.1692831516266, "node_ip": "10.138.0.2", "episode_len_mean": 319.92, "hostname": "flow-main", "training_iteration": 94, "iterations_since_restore": 94, "episode_reward_max": -32.377781397185196, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.217782974243164, "episodes_total": 4359, "timesteps_total": 3052040, "episode_reward_mean": -285.28184046999746, "timestamp": 1558585318, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-21-58", "custom_metrics": {"cost2_min": -67.45114656186132, "cost1_mean": 199.90440671785808, "outflow_rate_min": 462.43348918263234, "cost2_mean": -50.00620263319909, "outflow_rate_max": 1235.4182810322723, "cost1_max": 217.40349181610046, "system_level_velocity_min": 14.06884178118871, "cost2_max": -21.710775385371807, "cost1_min": 22.96450920120891, "system_level_velocity_mean": 17.329152032271544, "outflow_rate_mean": 1151.044092109769, "system_level_velocity_max": 18.948662667246666}, "time_total_s": 2304.1692831516266, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 0.9391880631446838, "vf_explained_var": 0.9111917018890381, "kl": 0.018790584057569504, "vf_loss": 7.447551727294922, "total_loss": 7.445777893066406, "policy_loss": -0.006001046393066645}, "sample_time_ms": 15332.938, "num_steps_sampled": 3052040, "num_steps_trained": 3052040, "grad_time_ms": 8483.139, "load_time_ms": 4.447, "update_time_ms": 8.112}, "episode_reward_min": -417.7094032977935}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badc18>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3083067, "episodes_this_iter": 47, "pid": 45007, "timesteps_this_iter": 31027, "time_since_restore": 2328.6010916233063, "node_ip": "10.138.0.2", "episode_len_mean": 315.89, "hostname": "flow-main", "training_iteration": 95, "iterations_since_restore": 95, "episode_reward_max": -25.06051681489781, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.431808471679688, "episodes_total": 4406, "timesteps_total": 3083067, "episode_reward_mean": -277.1256154281337, "timestamp": 1558585342, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-22-22", "custom_metrics": {"cost2_min": -63.9089130601511, "cost1_mean": 198.23033758296745, "outflow_rate_min": 437.2949997643919, "cost2_mean": -49.08880071809034, "outflow_rate_max": 1239.1403802038228, "cost1_max": 219.40108363939032, "system_level_velocity_min": 13.902555150934013, "cost2_max": -19.8101495997879, "cost1_min": 17.68797787567923, "system_level_velocity_mean": 17.412337051384586, "outflow_rate_mean": 1146.2358684488247, "system_level_velocity_max": 18.94920261609349}, "time_total_s": 2328.6010916233063, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 0.9495512843132019, "vf_explained_var": 0.8977064490318298, "kl": 0.01646110787987709, "vf_loss": 8.56545352935791, "total_loss": 8.561080932617188, "policy_loss": -0.008077013306319714}, "sample_time_ms": 15467.169, "num_steps_sampled": 3083067, "num_steps_trained": 3083067, "grad_time_ms": 8480.44, "load_time_ms": 4.261, "update_time_ms": 8.131}, "episode_reward_min": -402.4480199325024}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1f60>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3114010, "episodes_this_iter": 49, "pid": 45007, "timesteps_this_iter": 30943, "time_since_restore": 2354.489719390869, "node_ip": "10.138.0.2", "episode_len_mean": 319.9, "hostname": "flow-main", "training_iteration": 96, "iterations_since_restore": 96, "episode_reward_max": -25.06051681489781, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 25.888627767562866, "episodes_total": 4455, "timesteps_total": 3114010, "episode_reward_mean": -282.7474020825606, "timestamp": 1558585368, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-22-48", "custom_metrics": {"cost2_min": -63.9089130601511, "cost1_mean": 200.11752951763512, "outflow_rate_min": 437.2949997643919, "cost2_mean": -49.75604110962267, "outflow_rate_max": 1239.8327009984232, "cost1_max": 219.40108363939032, "system_level_velocity_min": 13.902555150934013, "cost2_max": -19.8101495997879, "cost1_min": 17.68797787567923, "system_level_velocity_mean": 17.321142077612123, "outflow_rate_mean": 1151.8677547993655, "system_level_velocity_max": 18.94920261609349}, "time_total_s": 2354.489719390869, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 0.9307870268821716, "vf_explained_var": 0.9180052280426025, "kl": 0.01664567179977894, "vf_loss": 6.3257856369018555, "total_loss": 6.321352005004883, "policy_loss": -0.008178741671144962}, "sample_time_ms": 15582.782, "num_steps_sampled": 3114010, "num_steps_trained": 3114010, "grad_time_ms": 8638.559, "load_time_ms": 4.475, "update_time_ms": 8.52}, "episode_reward_min": -402.4480199325024}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd19b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd17b8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3145110, "episodes_this_iter": 45, "pid": 45007, "timesteps_this_iter": 31100, "time_since_restore": 2377.86355304718, "node_ip": "10.138.0.2", "episode_len_mean": 320.95, "hostname": "flow-main", "training_iteration": 97, "iterations_since_restore": 97, "episode_reward_max": -25.030117719189867, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.373833656311035, "episodes_total": 4500, "timesteps_total": 3145110, "episode_reward_mean": -282.54986451220697, "timestamp": 1558585391, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-23-11", "custom_metrics": {"cost2_min": -61.41765375375118, "cost1_mean": 200.8168191758728, "outflow_rate_min": 444.6769763958757, "cost2_mean": -49.78971211315038, "outflow_rate_max": 1244.9694860643822, "cost1_max": 218.77983223978714, "system_level_velocity_min": 13.93967243557976, "cost2_max": -19.641035798038395, "cost1_min": 18.026351125695264, "system_level_velocity_mean": 17.314807441467345, "outflow_rate_mean": 1154.866598403666, "system_level_velocity_max": 18.94908981528319}, "time_total_s": 2377.86355304718, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 0.948099672794342, "vf_explained_var": 0.9111034274101257, "kl": 0.017074178904294968, "vf_loss": 7.21044921875, "total_loss": 7.2047271728515625, "policy_loss": -0.009564335457980633}, "sample_time_ms": 15601.564, "num_steps_sampled": 3145110, "num_steps_trained": 3145110, "grad_time_ms": 8479.214, "load_time_ms": 4.482, "update_time_ms": 8.707}, "episode_reward_min": -400.34155674703123}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd59b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5c88>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3176529, "episodes_this_iter": 44, "pid": 45007, "timesteps_this_iter": 31419, "time_since_restore": 2400.6512553691864, "node_ip": "10.138.0.2", "episode_len_mean": 320.84, "hostname": "flow-main", "training_iteration": 98, "iterations_since_restore": 98, "episode_reward_max": -25.030117719189867, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.787702322006226, "episodes_total": 4544, "timesteps_total": 3176529, "episode_reward_mean": -286.18928529417923, "timestamp": 1558585414, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-23-34", "custom_metrics": {"cost2_min": -65.01540876295199, "cost1_mean": 200.29145445129944, "outflow_rate_min": 444.6769763958757, "cost2_mean": -50.56230371227094, "outflow_rate_max": 1244.9694860643822, "cost1_max": 218.77983223978714, "system_level_velocity_min": 14.080451131254119, "cost2_max": -19.641035798038395, "cost1_min": 18.026351125695264, "system_level_velocity_mean": 17.262142934763382, "outflow_rate_mean": 1154.121884367654, "system_level_velocity_max": 18.90654381755198}, "time_total_s": 2400.6512553691864, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 0.9518954753875732, "vf_explained_var": 0.9172509908676147, "kl": 0.018709080293774605, "vf_loss": 7.054362773895264, "total_loss": 7.050237655639648, "policy_loss": -0.008334457874298096}, "sample_time_ms": 15572.825, "num_steps_sampled": 3176529, "num_steps_trained": 3176529, "grad_time_ms": 8444.708, "load_time_ms": 4.346, "update_time_ms": 8.537}, "episode_reward_min": -400.34155674703123}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1cf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5a90>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3207751, "episodes_this_iter": 52, "pid": 45007, "timesteps_this_iter": 31222, "time_since_restore": 2423.5121536254883, "node_ip": "10.138.0.2", "episode_len_mean": 322.8, "hostname": "flow-main", "training_iteration": 99, "iterations_since_restore": 99, "episode_reward_max": -180.4096787226309, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.86089825630188, "episodes_total": 4596, "timesteps_total": 3207751, "episode_reward_mean": -286.2350419356645, "timestamp": 1558585437, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-23-57", "custom_metrics": {"cost2_min": -65.01540876295199, "cost1_mean": 202.56323702788202, "outflow_rate_min": 926.9292545939867, "cost2_mean": -50.96405812671442, "outflow_rate_max": 1242.135777981911, "cost1_max": 218.1203558781404, "system_level_velocity_min": 14.10316660829203, "cost2_max": -39.74921535723212, "cost1_min": 130.66703365690802, "system_level_velocity_mean": 17.356150171588244, "outflow_rate_mean": 1165.044460347085, "system_level_velocity_max": 18.95315709978272}, "time_total_s": 2423.5121536254883, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 0.9304317235946655, "vf_explained_var": 0.9002330899238586, "kl": 0.015270015224814415, "vf_loss": 7.804093837738037, "total_loss": 7.799956321716309, "policy_loss": -0.007572841830551624}, "sample_time_ms": 15562.787, "num_steps_sampled": 3207751, "num_steps_trained": 3207751, "grad_time_ms": 8311.969, "load_time_ms": 4.263, "update_time_ms": 8.648}, "episode_reward_min": -412.48398073519496}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd10f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1b00>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3239149, "episodes_this_iter": 43, "pid": 45007, "timesteps_this_iter": 31398, "time_since_restore": 2446.802933692932, "node_ip": "10.138.0.2", "episode_len_mean": 322.8, "hostname": "flow-main", "training_iteration": 100, "iterations_since_restore": 100, "episode_reward_max": -149.36570996244154, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.290780067443848, "episodes_total": 4639, "timesteps_total": 3239149, "episode_reward_mean": -288.5241241020451, "timestamp": 1558585460, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-24-20", "custom_metrics": {"cost2_min": -60.97453883596284, "cost1_mean": 201.75410754719823, "outflow_rate_min": 926.9292545939867, "cost2_mean": -51.25613294787991, "outflow_rate_max": 1239.563449477352, "cost1_max": 218.1203558781404, "system_level_velocity_min": 14.10316660829203, "cost2_max": -39.377025386709036, "cost1_min": 132.87809369222603, "system_level_velocity_mean": 17.26732065680686, "outflow_rate_mean": 1161.5771544030206, "system_level_velocity_max": 18.95315709978272}, "time_total_s": 2446.802933692932, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 0.9434620141983032, "vf_explained_var": 0.918062686920166, "kl": 0.018655315041542053, "vf_loss": 6.249989032745361, "total_loss": 6.243149757385254, "policy_loss": -0.011036621406674385}, "sample_time_ms": 15561.697, "num_steps_sampled": 3239149, "num_steps_trained": 3239149, "grad_time_ms": 8170.813, "load_time_ms": 4.156, "update_time_ms": 8.672}, "episode_reward_min": -412.48398073519496}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd16d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1ef0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3270068, "episodes_this_iter": 47, "pid": 45007, "timesteps_this_iter": 30919, "time_since_restore": 2469.911920785904, "node_ip": "10.138.0.2", "episode_len_mean": 321.18, "hostname": "flow-main", "training_iteration": 101, "iterations_since_restore": 101, "episode_reward_max": -147.8935800298259, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.1089870929718, "episodes_total": 4686, "timesteps_total": 3270068, "episode_reward_mean": -282.3068331373637, "timestamp": 1558585484, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-24-44", "custom_metrics": {"cost2_min": -60.97453883596284, "cost1_mean": 202.03273363986912, "outflow_rate_min": 988.6252023323439, "cost2_mean": -50.37078105971905, "outflow_rate_max": 1238.2070810048144, "cost1_max": 218.14633365250404, "system_level_velocity_min": 14.786263808661175, "cost2_max": -35.478538987163454, "cost1_min": 138.824016429239, "system_level_velocity_mean": 17.408698038013604, "outflow_rate_mean": 1161.6761246540868, "system_level_velocity_max": 18.917689378470367}, "time_total_s": 2469.911920785904, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 0.9364752173423767, "vf_explained_var": 0.9141561388969421, "kl": 0.017502395436167717, "vf_loss": 6.77554988861084, "total_loss": 6.771209239959717, "policy_loss": -0.00827799178659916}, "sample_time_ms": 15559.659, "num_steps_sampled": 3270068, "num_steps_trained": 3270068, "grad_time_ms": 8166.076, "load_time_ms": 4.035, "update_time_ms": 8.555}, "episode_reward_min": -384.4380169769026}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc61d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6b70>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3300999, "episodes_this_iter": 49, "pid": 45007, "timesteps_this_iter": 30931, "time_since_restore": 2493.0449221134186, "node_ip": "10.138.0.2", "episode_len_mean": 321.26, "hostname": "flow-main", "training_iteration": 102, "iterations_since_restore": 102, "episode_reward_max": -147.8935800298259, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.13300132751465, "episodes_total": 4735, "timesteps_total": 3300999, "episode_reward_mean": -281.97837230907663, "timestamp": 1558585507, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-25-07", "custom_metrics": {"cost2_min": -60.42755289647924, "cost1_mean": 201.97581017781434, "outflow_rate_min": 923.1100752948831, "cost2_mean": -50.06532978686986, "outflow_rate_max": 1245.817262526956, "cost1_max": 218.63265793740595, "system_level_velocity_min": 14.324672696156135, "cost2_max": -35.478538987163454, "cost1_min": 129.6624735296117, "system_level_velocity_mean": 17.41848719721752, "outflow_rate_mean": 1156.5414740049744, "system_level_velocity_max": 18.996698932672928}, "time_total_s": 2493.0449221134186, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 0.9460840225219727, "vf_explained_var": 0.9060798287391663, "kl": 0.017902689054608345, "vf_loss": 7.446124076843262, "total_loss": 7.438783645629883, "policy_loss": -0.011368834413588047}, "sample_time_ms": 15446.623, "num_steps_sampled": 3300999, "num_steps_trained": 3300999, "grad_time_ms": 8176.406, "load_time_ms": 3.972, "update_time_ms": 8.603}, "episode_reward_min": -371.42067094118914}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd57f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5cf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5a90>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3332072, "episodes_this_iter": 45, "pid": 45007, "timesteps_this_iter": 31073, "time_since_restore": 2515.7177901268005, "node_ip": "10.138.0.2", "episode_len_mean": 318.75, "hostname": "flow-main", "training_iteration": 103, "iterations_since_restore": 103, "episode_reward_max": -25.145863976819363, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.672868013381958, "episodes_total": 4780, "timesteps_total": 3332072, "episode_reward_mean": -281.90529959136353, "timestamp": 1558585530, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-25-30", "custom_metrics": {"cost2_min": -60.17352261415411, "cost1_mean": 199.21272674120053, "outflow_rate_min": 431.75782487237836, "cost2_mean": -49.58761339971531, "outflow_rate_max": 1247.2794501504623, "cost1_max": 218.63265793740595, "system_level_velocity_min": 12.779680042809616, "cost2_max": -20.05344334004355, "cost1_min": 17.674861322170997, "system_level_velocity_mean": 17.298041485566326, "outflow_rate_mean": 1142.0880490194402, "system_level_velocity_max": 19.064070798798287}, "time_total_s": 2515.7177901268005, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 0.9654378890991211, "vf_explained_var": 0.9151240587234497, "kl": 0.019779760390520096, "vf_loss": 7.406274318695068, "total_loss": 7.399773597717285, "policy_loss": -0.010950802825391293}, "sample_time_ms": 15399.04, "num_steps_sampled": 3332072, "num_steps_trained": 3332072, "grad_time_ms": 7994.265, "load_time_ms": 4.162, "update_time_ms": 8.624}, "episode_reward_min": -381.2260314752372}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5828>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3362999, "episodes_this_iter": 50, "pid": 45007, "timesteps_this_iter": 30927, "time_since_restore": 2538.72918343544, "node_ip": "10.138.0.2", "episode_len_mean": 318.67, "hostname": "flow-main", "training_iteration": 104, "iterations_since_restore": 104, "episode_reward_max": -25.145863976819363, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.011393308639526, "episodes_total": 4830, "timesteps_total": 3362999, "episode_reward_mean": -281.12228266191005, "timestamp": 1558585553, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-25-53", "custom_metrics": {"cost2_min": -60.17352261415411, "cost1_mean": 199.09483088018547, "outflow_rate_min": 431.75782487237836, "cost2_mean": -49.75217032942104, "outflow_rate_max": 1247.2794501504623, "cost1_max": 218.6042178112092, "system_level_velocity_min": 12.779680042809616, "cost2_max": -20.05344334004355, "cost1_min": 17.674861322170997, "system_level_velocity_mean": 17.284629257868456, "outflow_rate_mean": 1141.1677975328055, "system_level_velocity_max": 19.064070798798287}, "time_total_s": 2538.72918343544, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 0.9551435708999634, "vf_explained_var": 0.9042280912399292, "kl": 0.01860160008072853, "vf_loss": 8.041881561279297, "total_loss": 8.034708023071289, "policy_loss": -0.011358330026268959}, "sample_time_ms": 15414.729, "num_steps_sampled": 3362999, "num_steps_trained": 3362999, "grad_time_ms": 7957.813, "load_time_ms": 4.343, "update_time_ms": 8.694}, "episode_reward_min": -398.1496246596684}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbda58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bc6128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd470>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3394475, "episodes_this_iter": 42, "pid": 45007, "timesteps_this_iter": 31476, "time_since_restore": 2561.4625372886658, "node_ip": "10.138.0.2", "episode_len_mean": 323.54, "hostname": "flow-main", "training_iteration": 105, "iterations_since_restore": 105, "episode_reward_max": -199.1943315048324, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.733353853225708, "episodes_total": 4872, "timesteps_total": 3394475, "episode_reward_mean": -285.71387565046166, "timestamp": 1558585575, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-26-15", "custom_metrics": {"cost2_min": -60.09398734583885, "cost1_mean": 202.6434598099456, "outflow_rate_min": 889.7851035303361, "cost2_mean": -51.2626786713211, "outflow_rate_max": 1248.6820564904735, "cost1_max": 218.89099239427213, "system_level_velocity_min": 14.303553135591722, "cost2_max": -39.801798671423704, "cost1_min": 124.98482874858726, "system_level_velocity_mean": 17.311894521957147, "outflow_rate_mean": 1159.0725578981087, "system_level_velocity_max": 19.064070798798287}, "time_total_s": 2561.4625372886658, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 0.9605849981307983, "vf_explained_var": 0.907312273979187, "kl": 0.01742512919008732, "vf_loss": 7.716304302215576, "total_loss": 7.709171772003174, "policy_loss": -0.011053327471017838}, "sample_time_ms": 15225.845, "num_steps_sampled": 3394475, "num_steps_trained": 3394475, "grad_time_ms": 7976.751, "load_time_ms": 4.447, "update_time_ms": 8.665}, "episode_reward_min": -398.1496246596684}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd55c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd57f0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3425811, "episodes_this_iter": 47, "pid": 45007, "timesteps_this_iter": 31336, "time_since_restore": 2583.924719810486, "node_ip": "10.138.0.2", "episode_len_mean": 324.72, "hostname": "flow-main", "training_iteration": 106, "iterations_since_restore": 106, "episode_reward_max": -219.06835610617085, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.46218252182007, "episodes_total": 4919, "timesteps_total": 3425811, "episode_reward_mean": -295.17085343652104, "timestamp": 1558585598, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-26-38", "custom_metrics": {"cost2_min": -60.09398734583885, "cost1_mean": 201.25008511834207, "outflow_rate_min": 953.9736409883722, "cost2_mean": -52.50167954757194, "outflow_rate_max": 1248.6820564904735, "cost1_max": 218.89099239427213, "system_level_velocity_min": 14.035814803297924, "cost2_max": -42.638809388972376, "cost1_min": 166.86347346412276, "system_level_velocity_mean": 17.08890656944939, "outflow_rate_mean": 1155.1725009474974, "system_level_velocity_max": 19.03363672305899}, "time_total_s": 2583.924719810486, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499997913837433, "entropy": 0.9719792604446411, "vf_explained_var": 0.9014042019844055, "kl": 0.017889918759465218, "vf_loss": 8.503583908081055, "total_loss": 8.497415542602539, "policy_loss": -0.010194908827543259}, "sample_time_ms": 15060.975, "num_steps_sampled": 3425811, "num_steps_trained": 3425811, "grad_time_ms": 7799.531, "load_time_ms": 4.317, "update_time_ms": 8.366}, "episode_reward_min": -382.4768294301755}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd16d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd18d0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3457198, "episodes_this_iter": 50, "pid": 45007, "timesteps_this_iter": 31387, "time_since_restore": 2607.255386352539, "node_ip": "10.138.0.2", "episode_len_mean": 325.0, "hostname": "flow-main", "training_iteration": 107, "iterations_since_restore": 107, "episode_reward_max": -229.40436208418643, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.330666542053223, "episodes_total": 4969, "timesteps_total": 3457198, "episode_reward_mean": -296.2091982777081, "timestamp": 1558585621, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-27-01", "custom_metrics": {"cost2_min": -60.94128597868906, "cost1_mean": 201.0585048053191, "outflow_rate_min": 953.9736409883722, "cost2_mean": -52.12820929307602, "outflow_rate_max": 1240.3415015116598, "cost1_max": 218.18983445609024, "system_level_velocity_min": 14.035814803297924, "cost2_max": -41.42224654469288, "cost1_min": 166.86347346412276, "system_level_velocity_mean": 17.05518741825351, "outflow_rate_mean": 1153.5303120393858, "system_level_velocity_max": 18.937879534564697}, "time_total_s": 2607.255386352539, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499996423721313, "entropy": 0.9601514935493469, "vf_explained_var": 0.9113754034042358, "kl": 0.025830522179603577, "vf_loss": 7.502366542816162, "total_loss": 7.503365516662598, "policy_loss": -0.004812916740775108}, "sample_time_ms": 15053.204, "num_steps_sampled": 3457198, "num_steps_trained": 3457198, "grad_time_ms": 7802.97, "load_time_ms": 4.241, "update_time_ms": 8.246}, "episode_reward_min": -382.4768294301755}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd52b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5470>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3488371, "episodes_this_iter": 44, "pid": 45007, "timesteps_this_iter": 31173, "time_since_restore": 2629.988390684128, "node_ip": "10.138.0.2", "episode_len_mean": 320.92, "hostname": "flow-main", "training_iteration": 108, "iterations_since_restore": 108, "episode_reward_max": -31.028692603399346, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.733004331588745, "episodes_total": 5013, "timesteps_total": 3488371, "episode_reward_mean": -288.363989686979, "timestamp": 1558585644, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-27-24", "custom_metrics": {"cost2_min": -60.94128597868906, "cost1_mean": 199.504535462186, "outflow_rate_min": 494.54964184365247, "cost2_mean": -51.35764882392254, "outflow_rate_max": 1240.5653689596902, "cost1_max": 218.9150452516527, "system_level_velocity_min": 14.076137455409587, "cost2_max": -18.19426282021726, "cost1_min": 23.14128558451894, "system_level_velocity_mean": 17.18483521710508, "outflow_rate_mean": 1150.4907614516594, "system_level_velocity_max": 18.946546904411324}, "time_total_s": 2629.988390684128, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750009536743164, "entropy": 0.9511559009552002, "vf_explained_var": 0.9186881184577942, "kl": 0.013853661715984344, "vf_loss": 6.726393699645996, "total_loss": 6.7222514152526855, "policy_loss": -0.008817560970783234}, "sample_time_ms": 15058.789, "num_steps_sampled": 3488371, "num_steps_trained": 3488371, "grad_time_ms": 7791.814, "load_time_ms": 4.251, "update_time_ms": 8.029}, "episode_reward_min": -403.1583685623147}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5b70>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3519788, "episodes_this_iter": 48, "pid": 45007, "timesteps_this_iter": 31417, "time_since_restore": 2654.222038269043, "node_ip": "10.138.0.2", "episode_len_mean": 317.94, "hostname": "flow-main", "training_iteration": 109, "iterations_since_restore": 109, "episode_reward_max": -24.842889256406654, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.23364758491516, "episodes_total": 5061, "timesteps_total": 3519788, "episode_reward_mean": -281.2112501040458, "timestamp": 1558585668, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-27-48", "custom_metrics": {"cost2_min": -61.141688844568364, "cost1_mean": 199.67710852589, "outflow_rate_min": 434.44599691538906, "cost2_mean": -51.18793853213138, "outflow_rate_max": 1255.0023000060917, "cost1_max": 219.31284990398223, "system_level_velocity_min": 14.076137455409587, "cost2_max": -18.19426282021726, "cost1_min": 17.76257031416872, "system_level_velocity_mean": 17.387645313600522, "outflow_rate_mean": 1156.1277801514643, "system_level_velocity_max": 18.98648570968854}, "time_total_s": 2654.222038269043, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750009536743164, "entropy": 0.9423548579216003, "vf_explained_var": 0.9080972075462341, "kl": 0.015614713542163372, "vf_loss": 7.512520790100098, "total_loss": 7.507871150970459, "policy_loss": -0.009919063188135624}, "sample_time_ms": 15137.295, "num_steps_sampled": 3519788, "num_steps_trained": 3519788, "grad_time_ms": 7851.358, "load_time_ms": 4.266, "update_time_ms": 8.162}, "episode_reward_min": -403.1583685623147}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badf28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1358>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3551049, "episodes_this_iter": 45, "pid": 45007, "timesteps_this_iter": 31261, "time_since_restore": 2676.954938650131, "node_ip": "10.138.0.2", "episode_len_mean": 322.02, "hostname": "flow-main", "training_iteration": 110, "iterations_since_restore": 110, "episode_reward_max": -24.842889256406654, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.732900381088257, "episodes_total": 5106, "timesteps_total": 3551049, "episode_reward_mean": -286.8734521338109, "timestamp": 1558585691, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-28-11", "custom_metrics": {"cost2_min": -62.78892296936441, "cost1_mean": 201.71393521531752, "outflow_rate_min": 434.44599691538906, "cost2_mean": -52.39374597007982, "outflow_rate_max": 1255.5620700960235, "cost1_max": 219.7667207041966, "system_level_velocity_min": 13.86684552839973, "cost2_max": -19.725428496035235, "cost1_min": 17.76257031416872, "system_level_velocity_mean": 17.313675587501862, "outflow_rate_mean": 1166.9595852776379, "system_level_velocity_max": 19.036736202089802}, "time_total_s": 2676.954938650131, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750009536743164, "entropy": 0.9510654211044312, "vf_explained_var": 0.9214249849319458, "kl": 0.01576942950487137, "vf_loss": 7.255621433258057, "total_loss": 7.249977111816406, "policy_loss": -0.01096642017364502}, "sample_time_ms": 15073.506, "num_steps_sampled": 3551049, "num_steps_trained": 3551049, "grad_time_ms": 7859.475, "load_time_ms": 4.243, "update_time_ms": 8.058}, "episode_reward_min": -417.34103155091543}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369ba4b00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5710>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3582040, "episodes_this_iter": 49, "pid": 45007, "timesteps_this_iter": 30991, "time_since_restore": 2700.9365360736847, "node_ip": "10.138.0.2", "episode_len_mean": 318.89, "hostname": "flow-main", "training_iteration": 111, "iterations_since_restore": 111, "episode_reward_max": -24.64618492478284, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.981597423553467, "episodes_total": 5155, "timesteps_total": 3582040, "episode_reward_mean": -282.65008590159897, "timestamp": 1558585715, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-28-35", "custom_metrics": {"cost2_min": -64.0754783129284, "cost1_mean": 200.11753383644972, "outflow_rate_min": 458.7643428802759, "cost2_mean": -51.76783040353354, "outflow_rate_max": 1255.5620700960235, "cost1_max": 219.7667207041966, "system_level_velocity_min": 13.86684552839973, "cost2_max": -18.037639018589704, "cost1_min": 18.01315405152409, "system_level_velocity_mean": 17.379447521102573, "outflow_rate_mean": 1158.5116102990337, "system_level_velocity_max": 19.036736202089802}, "time_total_s": 2700.9365360736847, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "entropy": 0.9095228910446167, "vf_explained_var": 0.8967011570930481, "kl": 0.014060311950743198, "vf_loss": 7.618403434753418, "total_loss": 7.614567756652832, "policy_loss": -0.008581486530601978}, "sample_time_ms": 15185.621, "num_steps_sampled": 3582040, "num_steps_trained": 3582040, "grad_time_ms": 7834.695, "load_time_ms": 4.298, "update_time_ms": 8.261}, "episode_reward_min": -417.34103155091543}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1b38>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3613568, "episodes_this_iter": 48, "pid": 45007, "timesteps_this_iter": 31528, "time_since_restore": 2724.5586857795715, "node_ip": "10.138.0.2", "episode_len_mean": 318.69, "hostname": "flow-main", "training_iteration": 112, "iterations_since_restore": 112, "episode_reward_max": -24.64618492478284, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.62214970588684, "episodes_total": 5203, "timesteps_total": 3613568, "episode_reward_mean": -282.2833984784938, "timestamp": 1558585739, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-28-59", "custom_metrics": {"cost2_min": -64.0754783129284, "cost1_mean": 200.26942971631664, "outflow_rate_min": 458.7643428802759, "cost2_mean": -51.75017724174829, "outflow_rate_max": 1248.4174237635507, "cost1_max": 219.5365642265876, "system_level_velocity_min": 14.018608505695427, "cost2_max": -18.037639018589704, "cost1_min": 18.01315405152409, "system_level_velocity_mean": 17.396607599022527, "outflow_rate_mean": 1158.4509733742634, "system_level_velocity_max": 19.11944622166476}, "time_total_s": 2724.5586857795715, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750009536743164, "entropy": 0.9457334280014038, "vf_explained_var": 0.9085362553596497, "kl": 0.01391693763434887, "vf_loss": 7.515685558319092, "total_loss": 7.511699199676514, "policy_loss": -0.00868338905274868}, "sample_time_ms": 15215.21, "num_steps_sampled": 3613568, "num_steps_trained": 3613568, "grad_time_ms": 7853.689, "load_time_ms": 4.517, "update_time_ms": 8.187}, "episode_reward_min": -382.290914909311}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd17b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd18d0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3644297, "episodes_this_iter": 43, "pid": 45007, "timesteps_this_iter": 30729, "time_since_restore": 2747.8920192718506, "node_ip": "10.138.0.2", "episode_len_mean": 324.8, "hostname": "flow-main", "training_iteration": 113, "iterations_since_restore": 113, "episode_reward_max": -226.37854079856896, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.333333492279053, "episodes_total": 5246, "timesteps_total": 3644297, "episode_reward_mean": -284.8244295414911, "timestamp": 1558585762, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-29-22", "custom_metrics": {"cost2_min": -64.0754783129284, "cost1_mean": 204.74372620759797, "outflow_rate_min": 981.6367630331753, "cost2_mean": -52.335855918757154, "outflow_rate_max": 1249.5614627842608, "cost1_max": 220.08025492207668, "system_level_velocity_min": 14.451511678360081, "cost2_max": -39.40679663500826, "cost1_min": 172.2942130529239, "system_level_velocity_mean": 17.43657354679906, "outflow_rate_mean": 1178.1754566510017, "system_level_velocity_max": 19.11944622166476}, "time_total_s": 2747.8920192718506, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "entropy": 0.9069706201553345, "vf_explained_var": 0.9088082909584045, "kl": 0.013657531701028347, "vf_loss": 6.520651340484619, "total_loss": 6.51702880859375, "policy_loss": -0.008232162334024906}, "sample_time_ms": 15274.046, "num_steps_sampled": 3644297, "num_steps_trained": 3644297, "grad_time_ms": 7861.334, "load_time_ms": 4.351, "update_time_ms": 8.286}, "episode_reward_min": -382.14902481329204}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd54e0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3675332, "episodes_this_iter": 50, "pid": 45007, "timesteps_this_iter": 31035, "time_since_restore": 2771.084459066391, "node_ip": "10.138.0.2", "episode_len_mean": 319.75, "hostname": "flow-main", "training_iteration": 114, "iterations_since_restore": 114, "episode_reward_max": -29.574812807347993, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.192439794540405, "episodes_total": 5296, "timesteps_total": 3675332, "episode_reward_mean": -273.2029905135346, "timestamp": 1558585785, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-29-45", "custom_metrics": {"cost2_min": -61.65019882366536, "cost1_mean": 203.37159991725747, "outflow_rate_min": 513.1510694623687, "cost2_mean": -50.742836696352086, "outflow_rate_max": 1249.5614627842608, "cost1_max": 220.08025492207668, "system_level_velocity_min": 15.24060388895509, "cost2_max": -20.0955346623718, "cost1_min": 23.29574009792362, "system_level_velocity_mean": 17.644080943868147, "outflow_rate_mean": 1171.9366856530141, "system_level_velocity_max": 19.17910300812854}, "time_total_s": 2771.084459066391, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "entropy": 0.9274120330810547, "vf_explained_var": 0.9033758044242859, "kl": 0.015903929248452187, "vf_loss": 7.253142356872559, "total_loss": 7.248959064483643, "policy_loss": -0.009551684372127056}, "sample_time_ms": 15277.702, "num_steps_sampled": 3675332, "num_steps_trained": 3675332, "grad_time_ms": 7874.116, "load_time_ms": 4.138, "update_time_ms": 8.38}, "episode_reward_min": -372.1700510977859}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd14e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1b38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1438>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3707097, "episodes_this_iter": 43, "pid": 45007, "timesteps_this_iter": 31765, "time_since_restore": 2795.4078850746155, "node_ip": "10.138.0.2", "episode_len_mean": 319.75, "hostname": "flow-main", "training_iteration": 115, "iterations_since_restore": 115, "episode_reward_max": -29.574812807347993, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.323426008224487, "episodes_total": 5339, "timesteps_total": 3707097, "episode_reward_mean": -279.16958634279456, "timestamp": 1558585810, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-30-10", "custom_metrics": {"cost2_min": -63.47527882262807, "cost1_mean": 202.44584255406113, "outflow_rate_min": 513.1510694623687, "cost2_mean": -51.7477382046531, "outflow_rate_max": 1245.828163505214, "cost1_max": 219.90545919249502, "system_level_velocity_min": 14.851161225514572, "cost2_max": -20.0955346623718, "cost1_min": 23.29574009792362, "system_level_velocity_mean": 17.543448348536746, "outflow_rate_mean": 1167.4087616286627, "system_level_velocity_max": 19.17910300812854}, "time_total_s": 2795.4078850746155, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "entropy": 0.9540062546730042, "vf_explained_var": 0.8962713479995728, "kl": 0.0156770721077919, "vf_loss": 8.47690200805664, "total_loss": 8.472006797790527, "policy_loss": -0.010186615400016308}, "sample_time_ms": 15306.107, "num_steps_sampled": 3707097, "num_steps_trained": 3707097, "grad_time_ms": 8004.367, "load_time_ms": 4.248, "update_time_ms": 8.739}, "episode_reward_min": -382.32623929546793}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd17f0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3738083, "episodes_this_iter": 47, "pid": 45007, "timesteps_this_iter": 30986, "time_since_restore": 2819.66783118248, "node_ip": "10.138.0.2", "episode_len_mean": 320.93, "hostname": "flow-main", "training_iteration": 116, "iterations_since_restore": 116, "episode_reward_max": -29.574812807347993, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.25994610786438, "episodes_total": 5386, "timesteps_total": 3738083, "episode_reward_mean": -283.3602375614959, "timestamp": 1558585834, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-30-34", "custom_metrics": {"cost2_min": -63.72745655483082, "cost1_mean": 202.84968803787442, "outflow_rate_min": 513.1510694623687, "cost2_mean": -52.32805321517941, "outflow_rate_max": 1255.1212934845282, "cost1_max": 220.20346751576827, "system_level_velocity_min": 12.739174846846298, "cost2_max": -20.0955346623718, "cost1_min": 23.29574009792362, "system_level_velocity_mean": 17.49744958365973, "outflow_rate_mean": 1168.9574803159426, "system_level_velocity_max": 19.17910300812854}, "time_total_s": 2819.66783118248, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "entropy": 0.9056029319763184, "vf_explained_var": 0.9012928009033203, "kl": 0.01458329800516367, "vf_loss": 7.495311737060547, "total_loss": 7.489969730377197, "policy_loss": -0.010264294221997261}, "sample_time_ms": 15339.812, "num_steps_sampled": 3738083, "num_steps_trained": 3738083, "grad_time_ms": 8149.534, "load_time_ms": 4.146, "update_time_ms": 8.711}, "episode_reward_min": -436.62967912115784}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5e80>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3769257, "episodes_this_iter": 49, "pid": 45007, "timesteps_this_iter": 31174, "time_since_restore": 2844.1447172164917, "node_ip": "10.138.0.2", "episode_len_mean": 323.91, "hostname": "flow-main", "training_iteration": 117, "iterations_since_restore": 117, "episode_reward_max": -167.44049252585768, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.47688603401184, "episodes_total": 5435, "timesteps_total": 3769257, "episode_reward_mean": -285.45995902967996, "timestamp": 1558585859, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-30-59", "custom_metrics": {"cost2_min": -63.72745655483082, "cost1_mean": 203.78355263651804, "outflow_rate_min": 992.2918755662939, "cost2_mean": -52.0091834791752, "outflow_rate_max": 1255.1212934845282, "cost1_max": 220.54468696739116, "system_level_velocity_min": 12.739174846846298, "cost2_max": -40.83715838555439, "cost1_min": 141.9828219013669, "system_level_velocity_mean": 17.382328645151112, "outflow_rate_mean": 1175.6108204395998, "system_level_velocity_max": 19.109448050269073}, "time_total_s": 2844.1447172164917, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750009536743164, "entropy": 0.9017242193222046, "vf_explained_var": 0.9074998497962952, "kl": 0.01583019644021988, "vf_loss": 7.298770904541016, "total_loss": 7.2943572998046875, "policy_loss": -0.009755748324096203}, "sample_time_ms": 15308.554, "num_steps_sampled": 3769257, "num_steps_trained": 3769257, "grad_time_ms": 8294.307, "load_time_ms": 4.129, "update_time_ms": 8.976}, "episode_reward_min": -436.62967912115784}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bad518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bbd2e8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3800552, "episodes_this_iter": 44, "pid": 45007, "timesteps_this_iter": 31295, "time_since_restore": 2867.1214683055878, "node_ip": "10.138.0.2", "episode_len_mean": 322.55, "hostname": "flow-main", "training_iteration": 118, "iterations_since_restore": 118, "episode_reward_max": -167.44049252585768, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.97675108909607, "episodes_total": 5479, "timesteps_total": 3800552, "episode_reward_mean": -284.20758651527234, "timestamp": 1558585882, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-31-22", "custom_metrics": {"cost2_min": -60.354602995951566, "cost1_mean": 202.03169715723888, "outflow_rate_min": 927.504625, "cost2_mean": -51.45732991831704, "outflow_rate_max": 1255.1212934845282, "cost1_max": 220.54468696739116, "system_level_velocity_min": 13.678137254211464, "cost2_max": -40.83715838555439, "cost1_min": 141.6097757777178, "system_level_velocity_mean": 17.301286108453017, "outflow_rate_mean": 1168.3589282474175, "system_level_velocity_max": 19.109448050269073}, "time_total_s": 2867.1214683055878, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750009536743164, "entropy": 0.9261354804039001, "vf_explained_var": 0.9132535457611084, "kl": 0.01635054685175419, "vf_loss": 7.126225471496582, "total_loss": 7.124475479125977, "policy_loss": -0.0072680190205574036}, "sample_time_ms": 15312.943, "num_steps_sampled": 3800552, "num_steps_trained": 3800552, "grad_time_ms": 8313.764, "load_time_ms": 4.082, "update_time_ms": 9.182}, "episode_reward_min": -366.916103642695}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd54a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5b38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd57f0>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3831629, "episodes_this_iter": 48, "pid": 45007, "timesteps_this_iter": 31077, "time_since_restore": 2891.808391571045, "node_ip": "10.138.0.2", "episode_len_mean": 321.1, "hostname": "flow-main", "training_iteration": 119, "iterations_since_restore": 119, "episode_reward_max": -148.08806041908142, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.686923265457153, "episodes_total": 5527, "timesteps_total": 3831629, "episode_reward_mean": -286.9245728349711, "timestamp": 1558585906, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-31-46", "custom_metrics": {"cost2_min": -61.79531066217687, "cost1_mean": 199.61618021116774, "outflow_rate_min": 913.0605993663594, "cost2_mean": -51.674784556681935, "outflow_rate_max": 1246.274331206066, "cost1_max": 220.56131044315995, "system_level_velocity_min": 13.678137254211464, "cost2_max": -38.67276666100279, "cost1_min": 139.5566593880841, "system_level_velocity_mean": 17.152141535214348, "outflow_rate_mean": 1157.7709551553571, "system_level_velocity_max": 19.043437027403467}, "time_total_s": 2891.808391571045, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "entropy": 0.9115098118782043, "vf_explained_var": 0.9089488983154297, "kl": 0.01370406523346901, "vf_loss": 7.428350925445557, "total_loss": 7.424459457397461, "policy_loss": -0.00851655937731266}, "sample_time_ms": 15265.128, "num_steps_sampled": 3831629, "num_steps_trained": 3831629, "grad_time_ms": 8407.173, "load_time_ms": 3.979, "update_time_ms": 9.114}, "episode_reward_min": -375.49149703480316}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5978>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3862796, "episodes_this_iter": 49, "pid": 45007, "timesteps_this_iter": 31167, "time_since_restore": 2914.886801958084, "node_ip": "10.138.0.2", "episode_len_mean": 320.65, "hostname": "flow-main", "training_iteration": 120, "iterations_since_restore": 120, "episode_reward_max": -31.81696696821449, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.078410387039185, "episodes_total": 5576, "timesteps_total": 3862796, "episode_reward_mean": -282.84779320312475, "timestamp": 1558585930, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-32-10", "custom_metrics": {"cost2_min": -62.658222167140174, "cost1_mean": 201.01954511638633, "outflow_rate_min": 468.8485586228365, "cost2_mean": -51.185660839116274, "outflow_rate_max": 1246.274331206066, "cost1_max": 220.56131044315995, "system_level_velocity_min": 13.892261369551383, "cost2_max": -21.1477836084225, "cost1_min": 23.13663820153754, "system_level_velocity_mean": 17.34053984168171, "outflow_rate_mean": 1157.1636354437844, "system_level_velocity_max": 19.04624515682137}, "time_total_s": 2914.886801958084, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750009536743164, "entropy": 0.9172185063362122, "vf_explained_var": 0.9103888869285583, "kl": 0.015563417226076126, "vf_loss": 7.481770038604736, "total_loss": 7.477242469787598, "policy_loss": -0.009780134074389935}, "sample_time_ms": 15311.087, "num_steps_sampled": 3862796, "num_steps_trained": 3862796, "grad_time_ms": 8395.01, "load_time_ms": 4.12, "update_time_ms": 9.176}, "episode_reward_min": -383.9776125528535}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1cc0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1518>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3893792, "episodes_this_iter": 45, "pid": 45007, "timesteps_this_iter": 30996, "time_since_restore": 2938.119324207306, "node_ip": "10.138.0.2", "episode_len_mean": 320.93, "hostname": "flow-main", "training_iteration": 121, "iterations_since_restore": 121, "episode_reward_max": -31.81696696821449, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 23.2325222492218, "episodes_total": 5621, "timesteps_total": 3893792, "episode_reward_mean": -283.98275729184525, "timestamp": 1558585953, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-32-33", "custom_metrics": {"cost2_min": -62.658222167140174, "cost1_mean": 200.24410630582784, "outflow_rate_min": 468.8485586228365, "cost2_mean": -50.98591127532731, "outflow_rate_max": 1248.4969425984323, "cost1_max": 221.23453361863454, "system_level_velocity_min": 13.430646694915248, "cost2_max": -21.1477836084225, "cost1_min": 23.13663820153754, "system_level_velocity_mean": 17.241045143991094, "outflow_rate_mean": 1154.0215589507775, "system_level_velocity_max": 19.109712172940455}, "time_total_s": 2938.119324207306, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "entropy": 0.9164688587188721, "vf_explained_var": 0.9108163118362427, "kl": 0.015182710252702236, "vf_loss": 7.665425777435303, "total_loss": 7.661370754241943, "policy_loss": -0.009178770706057549}, "sample_time_ms": 15243.79, "num_steps_sampled": 3893792, "num_steps_trained": 3893792, "grad_time_ms": 8387.55, "load_time_ms": 4.06, "update_time_ms": 9.052}, "episode_reward_min": -419.00692071963334}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1128>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3924815, "episodes_this_iter": 46, "pid": 45007, "timesteps_this_iter": 31023, "time_since_restore": 2962.954430580139, "node_ip": "10.138.0.2", "episode_len_mean": 319.83, "hostname": "flow-main", "training_iteration": 122, "iterations_since_restore": 122, "episode_reward_max": -31.81696696821449, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.835106372833252, "episodes_total": 5667, "timesteps_total": 3924815, "episode_reward_mean": -278.43786919685317, "timestamp": 1558585978, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-32-58", "custom_metrics": {"cost2_min": -61.07642734667455, "cost1_mean": 200.35464312567692, "outflow_rate_min": 468.8485586228365, "cost2_mean": -50.21239724892648, "outflow_rate_max": 1248.4969425984323, "cost1_max": 221.23453361863454, "system_level_velocity_min": 13.430646694915248, "cost2_max": -21.1477836084225, "cost1_min": 23.13663820153754, "system_level_velocity_mean": 17.314194353221318, "outflow_rate_mean": 1156.5128302572284, "system_level_velocity_max": 19.163268424936952}, "time_total_s": 2962.954430580139, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "entropy": 0.8981680870056152, "vf_explained_var": 0.917576789855957, "kl": 0.015281204134225845, "vf_loss": 6.40738582611084, "total_loss": 6.40390682220459, "policy_loss": -0.00863601639866829}, "sample_time_ms": 15264.271, "num_steps_sampled": 3924815, "num_steps_trained": 3924815, "grad_time_ms": 8489.051, "load_time_ms": 3.927, "update_time_ms": 9.079}, "episode_reward_min": -419.00692071963334}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5cf8>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3955825, "episodes_this_iter": 44, "pid": 45007, "timesteps_this_iter": 31010, "time_since_restore": 2987.3787908554077, "node_ip": "10.138.0.2", "episode_len_mean": 320.92, "hostname": "flow-main", "training_iteration": 123, "iterations_since_restore": 123, "episode_reward_max": -23.813369556372933, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 24.424360275268555, "episodes_total": 5711, "timesteps_total": 3955825, "episode_reward_mean": -274.76179142423666, "timestamp": 1558586002, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-33-22", "custom_metrics": {"cost2_min": -58.9663735380643, "cost1_mean": 202.99600925742888, "outflow_rate_min": 477.24354782665716, "cost2_mean": -49.823623514136244, "outflow_rate_max": 1246.261017829427, "cost1_max": 220.3786669503667, "system_level_velocity_min": 15.028726943517526, "cost2_max": -15.41968875477215, "cost1_min": 17.73574062615654, "system_level_velocity_mean": 17.488065785092896, "outflow_rate_mean": 1168.2204101234415, "system_level_velocity_max": 19.163268424936952}, "time_total_s": 2987.3787908554077, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "entropy": 0.9047290682792664, "vf_explained_var": 0.9227672219276428, "kl": 0.01622425764799118, "vf_loss": 6.068694114685059, "total_loss": 6.065246105194092, "policy_loss": -0.008923780173063278}, "sample_time_ms": 15206.868, "num_steps_sampled": 3955825, "num_steps_trained": 3955825, "grad_time_ms": 8655.503, "load_time_ms": 3.831, "update_time_ms": 8.963}, "episode_reward_min": -345.97819504724447}
{"config": {"num_gpus_per_worker": 0, "lr": 0.0005, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "train_batch_size": 15000, "horizon": 750, "clip_actions": false, "straggler_mitigation": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "lr_schedule": null, "output": null, "vf_share_layers": false, "monitor": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "collect_metrics_timeout": 180, "output_max_file_size": 67108864, "model": {"channel_major": false, "use_lstm": false, "custom_model": null, "free_log_std": false, "conv_filters": null, "conv_activation": "relu", "grayscale": false, "max_seq_len": 20, "custom_options": {}, "framestack": true, "fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "custom_preprocessor": null, "lstm_cell_size": 256, "fcnet_activation": "tanh", "zero_mean": true, "dim": 84, "lstm_use_prev_action_reward": false}, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd5160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5369bd1c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5369badf28>"}, "output_compress_columns": ["obs", "new_obs"], "num_sgd_iter": 10, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "input_evaluation": null, "use_gae": true, "clip_param": 0.3, "vf_loss_coeff": 1.0, "num_workers": 20, "log_level": "INFO", "compress_observations": false, "optimizer": {}, "synchronize_filters": true, "batch_mode": "truncate_episodes", "entropy_coeff": 0.0, "kl_target": 0.01, "clip_rewards": null, "gamma": 0.99, "num_gpus": 0, "observation_filter": "MeanStdFilter", "sample_batch_size": 750, "tf_session_args": {"gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "log_device_placement": false, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "custom_resources_per_worker": {}, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "simple_optimizer": false, "preprocessor_pref": "deepmind", "input": "sampler", "lambda": 0.97}, "timesteps_since_restore": 3986606, "episodes_this_iter": 51, "pid": 45007, "timesteps_this_iter": 30781, "time_since_restore": 3010.092101097107, "node_ip": "10.138.0.2", "episode_len_mean": 322.02, "hostname": "flow-main", "training_iteration": 124, "iterations_since_restore": 124, "episode_reward_max": -23.813369556372933, "policy_reward_mean": {}, "done": false, "time_this_iter_s": 22.71331024169922, "episodes_total": 5762, "timesteps_total": 3986606, "episode_reward_mean": -278.9956481755708, "timestamp": 1558586025, "num_metric_batches_dropped": 0, "experiment_id": "b314c6363a3f437798bd5ad9a73b3c00", "date": "2019-05-23_04-33-45", "custom_metrics": {"cost2_min": -58.9663735380643, "cost1_mean": 202.30702494480818, "outflow_rate_min": 477.24354782665716, "cost2_mean": -49.179053606818655, "outflow_rate_max": 1239.6355581412809, "cost1_max": 220.02404377258165, "system_level_velocity_min": 15.028726943517526, "cost2_max": -15.41968875477215, "cost1_min": 17.73574062615654, "system_level_velocity_mean": 17.370809791292597, "outflow_rate_mean": 1159.3254627280107, "system_level_velocity_max": 19.14682752848303}, "time_total_s": 3010.092101097107, "info": {"default": {"cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "entropy": 0.8915899991989136, "vf_explained_var": 0.9068368077278137, "kl": 0.015662550926208496, "vf_loss": 7.072934627532959, "total_loss": 7.067967891693115, "policy_loss": -0.01025240309536457}, "sample_time_ms": 15178.039, "num_steps_sampled": 3986606, "num_steps_trained": 3986606, "grad_time_ms": 8636.156, "load_time_ms": 3.903, "update_time_ms": 8.883}, "episode_reward_min": -345.97819504724447}

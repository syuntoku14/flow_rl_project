{"custom_metrics": {"system_level_velocity_mean": 10.175821000788462, "cost2_max": -14.946331047648039, "outflow_rate_min": 440.3733333333333, "system_level_velocity_max": 11.923426154441536, "outflow_rate_mean": 734.6665324992136, "cost1_max": 145.57878292611701, "cost1_mean": 122.3258501300568, "cost2_min": -37.30046573663083, "system_level_velocity_min": 7.62446571552662, "outflow_rate_max": 924.6040643365299, "cost1_min": 92.77233452831334, "cost2_mean": -24.62210530948007}, "timesteps_this_iter": 40962, "iterations_since_restore": 1, "episode_reward_min": 136.64851943289906, "episode_len_mean": 325.0, "time_this_iter_s": 30.629157304763794, "episodes_total": 40, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89a27f0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89a27b8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89a2780>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 30.629157304763794, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 30.629157304763794, "episode_reward_max": 317.2715851090952, "info": {"num_steps_trained": 40962, "grad_time_ms": 10181.939, "update_time_ms": 834.141, "num_steps_sampled": 40962, "default": {"vf_explained_var": 0.8967428207397461, "policy_loss": -0.0019872449338436127, "entropy": 1.4110963344573975, "vf_loss": 1.7070354223251343, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.20000001788139343, "kl": 0.004332767333835363, "total_loss": 1.7059147357940674}, "load_time_ms": 52.835, "sample_time_ms": 19427.441}, "node_ip": "10.138.0.2", "timesteps_since_restore": 40962, "training_iteration": 1, "date": "2019-05-21_00-15-25", "timesteps_total": 40962, "num_metric_batches_dropped": 0, "episode_reward_mean": 215.90554657801448, "timestamp": 1558397725, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 10.34970049427944, "cost2_max": -14.946331047648039, "outflow_rate_min": 383.2771653543308, "system_level_velocity_max": 12.329270680980834, "outflow_rate_mean": 762.6584862182365, "cost1_max": 150.56231727939456, "cost1_mean": 124.90169609901973, "cost2_min": -38.17034837135575, "system_level_velocity_min": 7.62446571552662, "outflow_rate_max": 969.8489401071255, "cost1_min": 92.77233452831334, "cost2_mean": -25.8833129489661}, "timesteps_this_iter": 43494, "iterations_since_restore": 2, "episode_reward_min": 136.64851943289906, "episode_len_mean": 325.0, "time_this_iter_s": 26.210071325302124, "episodes_total": 80, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939908>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89398d0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939898>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 56.83922863006592, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 56.83922863006592, "episode_reward_max": 341.94281440835937, "info": {"num_steps_trained": 84456, "grad_time_ms": 9439.453, "update_time_ms": 420.295, "num_steps_sampled": 84456, "default": {"vf_explained_var": 0.9649256467819214, "policy_loss": -0.0069112638011574745, "entropy": 1.4107398986816406, "vf_loss": 1.1693214178085327, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.10000001639127731, "kl": 0.020605191588401794, "total_loss": 1.1644706726074219}, "load_time_ms": 28.338, "sample_time_ms": 18427.07}, "node_ip": "10.138.0.2", "timesteps_since_restore": 84456, "training_iteration": 2, "date": "2019-05-21_00-15-51", "timesteps_total": 84456, "num_metric_batches_dropped": 0, "episode_reward_mean": 232.13911527786405, "timestamp": 1558397751, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 10.849280521876947, "cost2_max": -16.83930972062924, "outflow_rate_min": 383.2771653543308, "system_level_velocity_max": 13.055625761343489, "outflow_rate_mean": 813.4460965912584, "cost1_max": 161.6880864440443, "cost1_mean": 131.73266687562253, "cost2_min": -52.207313569314415, "system_level_velocity_min": 7.62446571552662, "outflow_rate_max": 1061.8047714764296, "cost1_min": 92.77233452831334, "cost2_mean": -28.93435440011907}, "timesteps_this_iter": 46186, "iterations_since_restore": 3, "episode_reward_min": 145.067971765168, "episode_len_mean": 325.0, "time_this_iter_s": 28.655534029006958, "episodes_total": 120, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942ef0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942eb8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942e80>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 85.49476265907288, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 85.49476265907288, "episode_reward_max": 412.2008847898152, "info": {"num_steps_trained": 130642, "grad_time_ms": 9525.304, "update_time_ms": 282.386, "num_steps_sampled": 130642, "default": {"vf_explained_var": 0.9293331503868103, "policy_loss": -0.005418702028691769, "entropy": 1.395346999168396, "vf_loss": 3.51273250579834, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.011418240144848824, "total_loss": 3.509026527404785}, "load_time_ms": 20.03, "sample_time_ms": 18573.374}, "node_ip": "10.138.0.2", "timesteps_since_restore": 130642, "training_iteration": 3, "date": "2019-05-21_00-16-20", "timesteps_total": 130642, "num_metric_batches_dropped": 0, "episode_reward_mean": 270.00969283969994, "timestamp": 1558397780, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 12.36922627047212, "cost2_max": -17.145292207035634, "outflow_rate_min": 582.4726443768997, "system_level_velocity_max": 14.38917449947769, "outflow_rate_mean": 960.1231214703017, "cost1_max": 178.92535763378805, "cost1_mean": 152.02260888034553, "cost2_min": -60.19498194776966, "system_level_velocity_min": 8.18754101785948, "outflow_rate_max": 1117.8267032967035, "cost1_min": 100.10850133222316, "cost2_mean": -39.361452394708365}, "timesteps_this_iter": 46832, "iterations_since_restore": 4, "episode_reward_min": 145.067971765168, "episode_len_mean": 325.0, "time_this_iter_s": 30.361011743545532, "episodes_total": 180, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89420f0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942240>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942470>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 115.85577440261841, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 115.85577440261841, "episode_reward_max": 462.5370952707058, "info": {"num_steps_trained": 177474, "grad_time_ms": 9596.401, "update_time_ms": 213.677, "num_steps_sampled": 177474, "default": {"vf_explained_var": 0.9306632280349731, "policy_loss": -0.0043251607567071915, "entropy": 1.3694286346435547, "vf_loss": 5.711747646331787, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.009387869387865067, "total_loss": 5.7088303565979}, "load_time_ms": 16.063, "sample_time_ms": 19044.428}, "node_ip": "10.138.0.2", "timesteps_since_restore": 177474, "training_iteration": 4, "date": "2019-05-21_00-16-50", "timesteps_total": 177474, "num_metric_batches_dropped": 0, "episode_reward_mean": 370.57524283392917, "timestamp": 1558397810, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 13.067041905551896, "cost2_max": -26.95358441585243, "outflow_rate_min": 733.0459666895607, "system_level_velocity_max": 14.769541243549426, "outflow_rate_mean": 1030.5910262031402, "cost1_max": 182.96628039504176, "cost1_mean": 161.22902753312502, "cost2_min": -63.34844797833231, "system_level_velocity_min": 11.147564113543895, "outflow_rate_max": 1186.3443274879248, "cost1_min": 134.51173568754822, "cost2_mean": -46.091810829015415}, "timesteps_this_iter": 46912, "iterations_since_restore": 5, "episode_reward_min": 307.7235406394229, "episode_len_mean": 325.0, "time_this_iter_s": 28.97408366203308, "episodes_total": 220, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939da0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942b00>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942f98>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 144.8298580646515, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 144.8298580646515, "episode_reward_max": 479.8962145352299, "info": {"num_steps_trained": 224386, "grad_time_ms": 9783.175, "update_time_ms": 172.365, "num_steps_sampled": 224386, "default": {"vf_explained_var": 0.9341140389442444, "policy_loss": -0.0034166311379522085, "entropy": 1.353090763092041, "vf_loss": 6.363970756530762, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.008640732616186142, "total_loss": 6.361851215362549}, "load_time_ms": 14.258, "sample_time_ms": 18904.527}, "node_ip": "10.138.0.2", "timesteps_since_restore": 224386, "training_iteration": 5, "date": "2019-05-21_00-17-19", "timesteps_total": 224386, "num_metric_batches_dropped": 0, "episode_reward_mean": 413.99510371499457, "timestamp": 1558397839, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 13.635561628747114, "cost2_max": -13.233732375154048, "outflow_rate_min": 491.478024465899, "system_level_velocity_max": 18.15828695994851, "outflow_rate_mean": 1072.5816617168966, "cost1_max": 193.37148208449588, "cost1_mean": 166.5151023808402, "cost2_min": -63.34844797833231, "system_level_velocity_min": 10.946632534957553, "outflow_rate_max": 1210.8809863945578, "cost1_min": 24.67806859130035, "cost2_mean": -46.84181847532218}, "timesteps_this_iter": 45263, "iterations_since_restore": 6, "episode_reward_min": 57.886602166419635, "episode_len_mean": 322.13, "time_this_iter_s": 27.61925983428955, "episodes_total": 261, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939b00>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939898>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939860>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 172.44911789894104, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 172.44911789894104, "episode_reward_max": 479.8962145352299, "info": {"num_steps_trained": 269649, "grad_time_ms": 9688.228, "update_time_ms": 145.257, "num_steps_sampled": 269649, "default": {"vf_explained_var": 0.913783609867096, "policy_loss": -0.003779977560043335, "entropy": 1.3460619449615479, "vf_loss": 8.901830673217773, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.00807457510381937, "total_loss": 8.899261474609375}, "load_time_ms": 13.035, "sample_time_ms": 18806.631}, "node_ip": "10.138.0.2", "timesteps_since_restore": 269649, "training_iteration": 6, "date": "2019-05-21_00-17-47", "timesteps_total": 269649, "num_metric_batches_dropped": 0, "episode_reward_mean": 428.35396437401073, "timestamp": 1558397867, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 14.236037591600827, "cost2_max": -13.233732375154048, "outflow_rate_min": 491.478024465899, "system_level_velocity_max": 18.15828695994851, "outflow_rate_mean": 1123.221071210496, "cost1_max": 198.30742345346454, "cost1_mean": 173.97929113078226, "cost2_min": -62.15017661842865, "system_level_velocity_min": 10.490249902184273, "outflow_rate_max": 1274.5590841928172, "cost1_min": 24.67806859130035, "cost2_mean": -45.34832256699999}, "timesteps_this_iter": 43865, "iterations_since_restore": 7, "episode_reward_min": 57.886602166419635, "episode_len_mean": 322.13, "time_this_iter_s": 29.52519416809082, "episodes_total": 321, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942080>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89429b0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89421d0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 201.97431206703186, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 201.97431206703186, "episode_reward_max": 488.04105854629495, "info": {"num_steps_trained": 313514, "grad_time_ms": 9743.988, "update_time_ms": 125.514, "num_steps_sampled": 313514, "default": {"vf_explained_var": 0.9069346189498901, "policy_loss": -0.005086155608296394, "entropy": 1.3322302103042603, "vf_loss": 12.74166488647461, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.009522967971861362, "total_loss": 12.738005638122559}, "load_time_ms": 12.299, "sample_time_ms": 18883.905}, "node_ip": "10.138.0.2", "timesteps_since_restore": 313514, "training_iteration": 7, "date": "2019-05-21_00-18-17", "timesteps_total": 313514, "num_metric_batches_dropped": 0, "episode_reward_mean": 441.16598242739366, "timestamp": 1558397897, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 14.631525832209107, "cost2_max": -32.314157243980375, "outflow_rate_min": 870.0776337739447, "system_level_velocity_max": 16.48273571989766, "outflow_rate_mean": 1159.7667327366921, "cost1_max": 202.70672378100215, "cost1_mean": 180.7823890662839, "cost2_min": -60.411212752923255, "system_level_velocity_min": 10.490249902184273, "outflow_rate_max": 1306.7110862196475, "cost1_min": 127.26645319933147, "cost2_mean": -45.61179067293177}, "timesteps_this_iter": 41641, "iterations_since_restore": 8, "episode_reward_min": 349.92441080139537, "episode_len_mean": 325.0, "time_this_iter_s": 24.965131044387817, "episodes_total": 361, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939898>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939f28>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939860>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 226.93944311141968, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 226.93944311141968, "episode_reward_max": 494.457579103474, "info": {"num_steps_trained": 355155, "grad_time_ms": 9483.412, "update_time_ms": 110.767, "num_steps_sampled": 355155, "default": {"vf_explained_var": 0.9023398756980896, "policy_loss": -0.004473196342587471, "entropy": 1.3148131370544434, "vf_loss": 11.40030574798584, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.012300261296331882, "total_loss": 11.397677421569824}, "load_time_ms": 11.687, "sample_time_ms": 18675.988}, "node_ip": "10.138.0.2", "timesteps_since_restore": 355155, "training_iteration": 8, "date": "2019-05-21_00-18-42", "timesteps_total": 355155, "num_metric_batches_dropped": 0, "episode_reward_mean": 452.9909030180233, "timestamp": 1558397922, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 14.765916941256396, "cost2_max": -32.00119432634779, "outflow_rate_min": 881.2788535794062, "system_level_velocity_max": 16.548611953400446, "outflow_rate_mean": 1171.6009185289156, "cost1_max": 205.36155192791313, "cost1_mean": 182.1593344962392, "cost2_min": -62.44654102099271, "system_level_velocity_min": 10.490249902184273, "outflow_rate_max": 1309.9514127420439, "cost1_min": 127.26645319933147, "cost2_mean": -45.44878152924889}, "timesteps_this_iter": 42959, "iterations_since_restore": 9, "episode_reward_min": 358.64278057205206, "episode_len_mean": 325.0, "time_this_iter_s": 28.184666633605957, "episodes_total": 401, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89426d8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942278>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942048>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 255.12410974502563, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 255.12410974502563, "episode_reward_max": 496.30021600828314, "info": {"num_steps_trained": 398114, "grad_time_ms": 9513.2, "update_time_ms": 99.232, "num_steps_sampled": 398114, "default": {"vf_explained_var": 0.8892454504966736, "policy_loss": -0.0046462006866931915, "entropy": 1.3467156887054443, "vf_loss": 13.936246871948242, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.008593415841460228, "total_loss": 13.932889938354492}, "load_time_ms": 10.778, "sample_time_ms": 18639.119}, "node_ip": "10.138.0.2", "timesteps_since_restore": 398114, "training_iteration": 9, "date": "2019-05-21_00-19-10", "timesteps_total": 398114, "num_metric_batches_dropped": 0, "episode_reward_mean": 453.8978529964795, "timestamp": 1558397950, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 14.75216184446679, "cost2_max": -29.523740295808835, "outflow_rate_min": 830.3082222450449, "system_level_velocity_max": 16.703230482772327, "outflow_rate_mean": 1170.4506006613565, "cost1_max": 206.22035644818544, "cost1_mean": 181.6866349258161, "cost2_min": -62.44654102099271, "system_level_velocity_min": 11.36709981453032, "outflow_rate_max": 1320.345642855023, "cost1_min": 136.9096779030836, "cost2_mean": -44.282352637465216}, "timesteps_this_iter": 42559, "iterations_since_restore": 10, "episode_reward_min": 352.4664906822488, "episode_len_mean": 325.0, "time_this_iter_s": 28.836663722991943, "episodes_total": 460, "hostname": "flow-main", "episodes_this_iter": 59, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947320>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89479b0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947b38>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 283.9607734680176, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 283.9607734680176, "episode_reward_max": 498.1561777778218, "info": {"num_steps_trained": 440673, "grad_time_ms": 9514.686, "update_time_ms": 90.023, "num_steps_sampled": 440673, "default": {"vf_explained_var": 0.8708047270774841, "policy_loss": -0.005681281443685293, "entropy": 1.3335320949554443, "vf_loss": 18.80869483947754, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.01060762070119381, "total_loss": 18.80460548400879}, "load_time_ms": 10.235, "sample_time_ms": 18697.137}, "node_ip": "10.138.0.2", "timesteps_since_restore": 440673, "training_iteration": 10, "date": "2019-05-21_00-19-39", "timesteps_total": 440673, "num_metric_batches_dropped": 0, "episode_reward_mean": 450.98730028192614, "timestamp": 1558397979, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 14.879346220469303, "cost2_max": -29.523740295808835, "outflow_rate_min": 830.3082222450449, "system_level_velocity_max": 16.703230482772327, "outflow_rate_mean": 1176.710566862052, "cost1_max": 206.22035644818544, "cost1_mean": 183.31278487114506, "cost2_min": -59.605862171304345, "system_level_velocity_min": 11.36709981453032, "outflow_rate_max": 1320.345642855023, "cost1_min": 136.9096779030836, "cost2_mean": -44.1180188372855}, "timesteps_this_iter": 41452, "iterations_since_restore": 11, "episode_reward_min": 352.4664906822488, "episode_len_mean": 325.0, "time_this_iter_s": 27.257819652557373, "episodes_total": 501, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939630>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939e10>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89394e0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 311.21859312057495, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 311.21859312057495, "episode_reward_max": 498.1561777778218, "info": {"num_steps_trained": 482125, "grad_time_ms": 9377.011, "update_time_ms": 7.404, "num_steps_sampled": 482125, "default": {"vf_explained_var": 0.8892636895179749, "policy_loss": -0.0057727568782866, "entropy": 1.314439296722412, "vf_loss": 15.574962615966797, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.00920778512954712, "total_loss": 15.570570945739746}, "load_time_ms": 5.536, "sample_time_ms": 18588.714}, "node_ip": "10.138.0.2", "timesteps_since_restore": 482125, "training_iteration": 11, "date": "2019-05-21_00-20-06", "timesteps_total": 482125, "num_metric_batches_dropped": 0, "episode_reward_mean": 453.55057485167504, "timestamp": 1558398006, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 14.905556668966774, "cost2_max": -29.56948300159299, "outflow_rate_min": 989.2759011000308, "system_level_velocity_max": 16.65107915511287, "outflow_rate_mean": 1181.89648533855, "cost1_max": 205.2361252878762, "cost1_mean": 183.71540465863472, "cost2_min": -65.54138491805537, "system_level_velocity_min": 11.56151698673829, "outflow_rate_max": 1294.9279066251236, "cost1_min": 142.3777155777869, "cost2_mean": -45.53319434773159}, "timesteps_this_iter": 42457, "iterations_since_restore": 12, "episode_reward_min": 378.64855639686533, "episode_len_mean": 325.0, "time_this_iter_s": 28.17044496536255, "episodes_total": 541, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89420f0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89422b0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942400>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 339.3890380859375, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 339.3890380859375, "episode_reward_max": 496.9824325711195, "info": {"num_steps_trained": 524582, "grad_time_ms": 9538.735, "update_time_ms": 7.781, "num_steps_sampled": 524582, "default": {"vf_explained_var": 0.8806369304656982, "policy_loss": -0.0042060003615915775, "entropy": 1.3197340965270996, "vf_loss": 16.478782653808594, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.00841095857322216, "total_loss": 16.475839614868164}, "load_time_ms": 5.725, "sample_time_ms": 18622.562}, "node_ip": "10.138.0.2", "timesteps_since_restore": 524582, "training_iteration": 12, "date": "2019-05-21_00-20-34", "timesteps_total": 524582, "num_metric_batches_dropped": 0, "episode_reward_mean": 456.1351896700103, "timestamp": 1558398034, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 14.929724467180401, "cost2_max": -29.56948300159299, "outflow_rate_min": 934.8009291187738, "system_level_velocity_max": 16.714572114605907, "outflow_rate_mean": 1191.0112603772786, "cost1_max": 207.1703517321456, "cost1_mean": 184.10429769740858, "cost2_min": -70.80343474346913, "system_level_velocity_min": 11.105252877619336, "outflow_rate_max": 1334.539147495676, "cost1_min": 132.89335452425658, "cost2_mean": -47.871158503588376}, "timesteps_this_iter": 42933, "iterations_since_restore": 13, "episode_reward_min": 354.2304413290243, "episode_len_mean": 325.0, "time_this_iter_s": 29.891858339309692, "episodes_total": 600, "hostname": "flow-main", "episodes_this_iter": 59, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947748>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89473c8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947da0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 369.2808964252472, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 369.2808964252472, "episode_reward_max": 505.1207462060093, "info": {"num_steps_trained": 567515, "grad_time_ms": 9572.679, "update_time_ms": 7.88, "num_steps_sampled": 567515, "default": {"vf_explained_var": 0.8491981625556946, "policy_loss": -0.004875476472079754, "entropy": 1.3236870765686035, "vf_loss": 23.505168914794922, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.00857711024582386, "total_loss": 23.50157928466797}, "load_time_ms": 6.044, "sample_time_ms": 18712.357}, "node_ip": "10.138.0.2", "timesteps_since_restore": 567515, "training_iteration": 13, "date": "2019-05-21_00-21-04", "timesteps_total": 567515, "num_metric_batches_dropped": 0, "episode_reward_mean": 458.5528746995475, "timestamp": 1558398064, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 14.982671255687587, "cost2_max": -29.927116748030024, "outflow_rate_min": 934.8009291187738, "system_level_velocity_max": 16.797675357342804, "outflow_rate_mean": 1196.9769250510124, "cost1_max": 207.22066778359496, "cost1_mean": 184.80993147370722, "cost2_min": -70.80343474346913, "system_level_velocity_min": 11.105252877619336, "outflow_rate_max": 1336.5163469832382, "cost1_min": 132.89335452425658, "cost2_mean": -47.6229236752536}, "timesteps_this_iter": 40963, "iterations_since_restore": 14, "episode_reward_min": 354.2304413290243, "episode_len_mean": 325.0, "time_this_iter_s": 27.463350772857666, "episodes_total": 641, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942160>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942978>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942ef0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 396.74424719810486, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 396.74424719810486, "episode_reward_max": 505.1207462060093, "info": {"num_steps_trained": 608478, "grad_time_ms": 9612.102, "update_time_ms": 8.092, "num_steps_sampled": 608478, "default": {"vf_explained_var": 0.8761992454528809, "policy_loss": -0.005548682529479265, "entropy": 1.296961784362793, "vf_loss": 18.871334075927734, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.00914880633354187, "total_loss": 18.867156982421875}, "load_time_ms": 6.3, "sample_time_ms": 18380.664}, "node_ip": "10.138.0.2", "timesteps_since_restore": 608478, "training_iteration": 14, "date": "2019-05-21_00-21-32", "timesteps_total": 608478, "num_metric_batches_dropped": 0, "episode_reward_mean": 458.8423041630113, "timestamp": 1558398092, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 14.98676764578833, "cost2_max": -31.577525053227195, "outflow_rate_min": 969.261518158784, "system_level_velocity_max": 16.797675357342804, "outflow_rate_mean": 1198.7189001299355, "cost1_max": 207.22066778359496, "cost1_mean": 184.92044013990665, "cost2_min": -65.80563519134245, "system_level_velocity_min": 11.571851464525194, "outflow_rate_max": 1336.5163469832382, "cost1_min": 138.4766320491809, "cost2_mean": -46.7186677913029}, "timesteps_this_iter": 41976, "iterations_since_restore": 15, "episode_reward_min": 362.55755597450906, "episode_len_mean": 325.0, "time_this_iter_s": 27.15648651123047, "episodes_total": 681, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942d30>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942780>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942c18>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 423.9007337093353, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 423.9007337093353, "episode_reward_max": 505.1207462060093, "info": {"num_steps_trained": 650454, "grad_time_ms": 9629.134, "update_time_ms": 8.155, "num_steps_sampled": 650454, "default": {"vf_explained_var": 0.8665024638175964, "policy_loss": -0.005031912587583065, "entropy": 1.3068526983261108, "vf_loss": 20.262235641479492, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.009166927076876163, "total_loss": 20.258577346801758}, "load_time_ms": 6.138, "sample_time_ms": 18182.917}, "node_ip": "10.138.0.2", "timesteps_since_restore": 650454, "training_iteration": 15, "date": "2019-05-21_00-21-59", "timesteps_total": 650454, "num_metric_batches_dropped": 0, "episode_reward_mean": 459.15485695326714, "timestamp": 1558398119, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 14.99623414831458, "cost2_max": -31.577525053227195, "outflow_rate_min": 969.261518158784, "system_level_velocity_max": 16.806731073103204, "outflow_rate_mean": 1195.1617775661502, "cost1_max": 207.4651365734602, "cost1_mean": 184.9719963345586, "cost2_min": -64.40177009307527, "system_level_velocity_min": 11.571851464525194, "outflow_rate_max": 1332.4496042485362, "cost1_min": 138.4766320491809, "cost2_mean": -46.51565236029257}, "timesteps_this_iter": 42876, "iterations_since_restore": 16, "episode_reward_min": 362.55755597450906, "episode_len_mean": 325.0, "time_this_iter_s": 27.95053505897522, "episodes_total": 721, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947c18>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947b38>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947240>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 451.85126876831055, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 451.85126876831055, "episode_reward_max": 501.45291578946166, "info": {"num_steps_trained": 693330, "grad_time_ms": 9845.739, "update_time_ms": 8.01, "num_steps_sampled": 693330, "default": {"vf_explained_var": 0.8702579140663147, "policy_loss": -0.006418402306735516, "entropy": 1.3149460554122925, "vf_loss": 20.227148056030273, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.009090065024793148, "total_loss": 20.222091674804688}, "load_time_ms": 5.824, "sample_time_ms": 17999.296}, "node_ip": "10.138.0.2", "timesteps_since_restore": 693330, "training_iteration": 16, "date": "2019-05-21_00-22-27", "timesteps_total": 693330, "num_metric_batches_dropped": 0, "episode_reward_mean": 458.61314669106355, "timestamp": 1558398147, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 14.977716295783079, "cost2_max": -28.928422527349873, "outflow_rate_min": 954.7867343809324, "system_level_velocity_max": 16.806731073103204, "outflow_rate_mean": 1187.650724218821, "cost1_max": 207.4651365734602, "cost1_mean": 184.7674669470436, "cost2_min": -64.40177009307527, "system_level_velocity_min": 11.671286301483843, "outflow_rate_max": 1307.2714218618205, "cost1_min": 142.33616318578635, "cost2_mean": -46.01189436893914}, "timesteps_this_iter": 40468, "iterations_since_restore": 17, "episode_reward_min": 372.4316368395944, "episode_len_mean": 325.0, "time_this_iter_s": 27.155190229415894, "episodes_total": 781, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942cc0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942470>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89422e8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 479.00645899772644, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 479.00645899772644, "episode_reward_max": 501.45291578946166, "info": {"num_steps_trained": 733798, "grad_time_ms": 9757.709, "update_time_ms": 8.035, "num_steps_sampled": 733798, "default": {"vf_explained_var": 0.8525046706199646, "policy_loss": -0.006586199160665274, "entropy": 1.301037073135376, "vf_loss": 25.742156982421875, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.010655955411493778, "total_loss": 25.73716926574707}, "load_time_ms": 5.408, "sample_time_ms": 17849.691}, "node_ip": "10.138.0.2", "timesteps_since_restore": 733798, "training_iteration": 17, "date": "2019-05-21_00-22-54", "timesteps_total": 733798, "num_metric_batches_dropped": 0, "episode_reward_mean": 456.3959412348476, "timestamp": 1558398174, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.083189968482806, "cost2_max": -28.928422527349873, "outflow_rate_min": 954.7867343809324, "system_level_velocity_max": 16.689080275071657, "outflow_rate_mean": 1190.3534993012793, "cost1_max": 206.77716713543765, "cost1_mean": 186.13112539971243, "cost2_min": -64.39578807982738, "system_level_velocity_min": 11.671286301483843, "outflow_rate_max": 1313.7860731943545, "cost1_min": 142.83105209803608, "cost2_mean": -44.69882771341152}, "timesteps_this_iter": 40954, "iterations_since_restore": 18, "episode_reward_min": 372.4316368395944, "episode_len_mean": 325.0, "time_this_iter_s": 26.227908849716187, "episodes_total": 821, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89427b8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942358>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942f98>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 505.2343678474426, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 505.2343678474426, "episode_reward_max": 500.0145168299152, "info": {"num_steps_trained": 774752, "grad_time_ms": 9970.217, "update_time_ms": 8.21, "num_steps_sampled": 774752, "default": {"vf_explained_var": 0.8664357662200928, "policy_loss": -0.007844861596822739, "entropy": 1.3027942180633545, "vf_loss": 21.78413963317871, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.012862586416304111, "total_loss": 21.77822494506836}, "load_time_ms": 5.124, "sample_time_ms": 17763.944}, "node_ip": "10.138.0.2", "timesteps_since_restore": 774752, "training_iteration": 18, "date": "2019-05-21_00-23-20", "timesteps_total": 774752, "num_metric_batches_dropped": 0, "episode_reward_mean": 457.5023396620594, "timestamp": 1558398200, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.118510748816727, "cost2_max": -27.599151200463403, "outflow_rate_min": 911.9689233954455, "system_level_velocity_max": 16.891229495996075, "outflow_rate_mean": 1184.7166170793896, "cost1_max": 208.04845854282888, "cost1_mean": 186.37937335458253, "cost2_min": -64.39578807982738, "system_level_velocity_min": 11.147515981118207, "outflow_rate_max": 1313.7860731943545, "cost1_min": 134.36013229066089, "cost2_mean": -43.63698263153814}, "timesteps_this_iter": 40238, "iterations_since_restore": 19, "episode_reward_min": 355.4504966514173, "episode_len_mean": 325.0, "time_this_iter_s": 25.44999051094055, "episodes_total": 861, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947c18>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947a90>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947a20>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 530.6843583583832, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 530.6843583583832, "episode_reward_max": 500.0145168299152, "info": {"num_steps_trained": 814990, "grad_time_ms": 9963.119, "update_time_ms": 8.196, "num_steps_sampled": 814990, "default": {"vf_explained_var": 0.8846155405044556, "policy_loss": -0.008508330211043358, "entropy": 1.303568720817566, "vf_loss": 20.128141403198242, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.012006721459329128, "total_loss": 20.121435165405273}, "load_time_ms": 5.271, "sample_time_ms": 17496.623}, "node_ip": "10.138.0.2", "timesteps_since_restore": 814990, "training_iteration": 19, "date": "2019-05-21_00-23-46", "timesteps_total": 814990, "num_metric_batches_dropped": 0, "episode_reward_mean": 456.0941482382674, "timestamp": 1558398226, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.569827612646076, "cost2_max": -24.20925768255016, "outflow_rate_min": 911.9689233954455, "system_level_velocity_max": 17.146246719947566, "outflow_rate_mean": 1196.6386754754806, "cost1_max": 211.283712882209, "cost1_mean": 191.9338573841505, "cost2_min": -63.375990239834046, "system_level_velocity_min": 11.147515981118207, "outflow_rate_max": 1295.0265900389757, "cost1_min": 134.36013229066089, "cost2_mean": -38.40642031659381}, "timesteps_this_iter": 39255, "iterations_since_restore": 20, "episode_reward_min": 355.4504966514173, "episode_len_mean": 325.0, "time_this_iter_s": 27.204105138778687, "episodes_total": 921, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942550>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942160>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942cc0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 557.8884634971619, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 557.8884634971619, "episode_reward_max": 497.9911688593502, "info": {"num_steps_trained": 854245, "grad_time_ms": 9942.481, "update_time_ms": 8.245, "num_steps_sampled": 854245, "default": {"vf_explained_var": 0.8258838057518005, "policy_loss": -0.006308149080723524, "entropy": 1.2853002548217773, "vf_loss": 32.86261749267578, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.012047956697642803, "total_loss": 32.858116149902344}, "load_time_ms": 5.055, "sample_time_ms": 17354.421}, "node_ip": "10.138.0.2", "timesteps_since_restore": 854245, "training_iteration": 20, "date": "2019-05-21_00-24-13", "timesteps_total": 854245, "num_metric_batches_dropped": 0, "episode_reward_mean": 460.67478630192886, "timestamp": 1558398253, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.527773411564674, "cost2_max": -23.597504200637875, "outflow_rate_min": 934.5712624584717, "system_level_velocity_max": 17.146246719947566, "outflow_rate_mean": 1193.6377821953326, "cost1_max": 211.283712882209, "cost1_mean": 191.49326916480032, "cost2_min": -77.28578275654809, "system_level_velocity_min": 11.313394572211823, "outflow_rate_max": 1295.0265900389757, "cost1_min": 137.82364231931695, "cost2_mean": -37.387593727463276}, "timesteps_this_iter": 40166, "iterations_since_restore": 21, "episode_reward_min": 373.5018869379037, "episode_len_mean": 325.0, "time_this_iter_s": 24.523547649383545, "episodes_total": 961, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942cf8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942eb8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942e10>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 582.4120111465454, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 582.4120111465454, "episode_reward_max": 497.9911688593502, "info": {"num_steps_trained": 894411, "grad_time_ms": 9982.402, "update_time_ms": 8.226, "num_steps_sampled": 894411, "default": {"vf_explained_var": 0.8840212225914001, "policy_loss": -0.008984873071312904, "entropy": 1.3052091598510742, "vf_loss": 21.999784469604492, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.01305835135281086, "total_loss": 21.99275779724121}, "load_time_ms": 4.97, "sample_time_ms": 17042.933}, "node_ip": "10.138.0.2", "timesteps_since_restore": 894411, "training_iteration": 21, "date": "2019-05-21_00-24-38", "timesteps_total": 894411, "num_metric_batches_dropped": 0, "episode_reward_mean": 459.27734798525677, "timestamp": 1558398278, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.245421530601734, "cost2_max": -20.202432309542413, "outflow_rate_min": 934.5712624584717, "system_level_velocity_max": 17.01169114636667, "outflow_rate_mean": 1181.3724391795377, "cost1_max": 210.2790089448342, "cost1_mean": 187.96948005075816, "cost2_min": -77.28578275654809, "system_level_velocity_min": 9.513583417980577, "outflow_rate_max": 1306.6758635260878, "cost1_min": 115.28400331089067, "cost2_mean": -37.45115282616016}, "timesteps_this_iter": 39826, "iterations_since_restore": 22, "episode_reward_min": 373.5018869379037, "episode_len_mean": 325.0, "time_this_iter_s": 25.153292417526245, "episodes_total": 1001, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89473c8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947a20>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947c18>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 607.5653035640717, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 607.5653035640717, "episode_reward_max": 497.9911688593502, "info": {"num_steps_trained": 934237, "grad_time_ms": 9899.517, "update_time_ms": 7.984, "num_steps_sampled": 934237, "default": {"vf_explained_var": 0.8388059735298157, "policy_loss": -0.007634307723492384, "entropy": 1.2961885929107666, "vf_loss": 29.53962516784668, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.013762983493506908, "total_loss": 29.5340576171875}, "load_time_ms": 4.763, "sample_time_ms": 16824.602}, "node_ip": "10.138.0.2", "timesteps_since_restore": 934237, "training_iteration": 22, "date": "2019-05-21_00-25-03", "timesteps_total": 934237, "num_metric_batches_dropped": 0, "episode_reward_mean": 455.1684295805096, "timestamp": 1558398303, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.483486187179452, "cost2_max": -17.989253927911758, "outflow_rate_min": 973.7803587886764, "system_level_velocity_max": 17.081349074101094, "outflow_rate_mean": 1190.2220541615054, "cost1_max": 210.2790089448342, "cost1_mean": 191.03636588491213, "cost2_min": -67.10801785683302, "system_level_velocity_min": 9.513583417980577, "outflow_rate_max": 1306.6758635260878, "cost1_min": 115.28400331089067, "cost2_mean": -34.417383041794416}, "timesteps_this_iter": 39459, "iterations_since_restore": 23, "episode_reward_min": 382.8015510717001, "episode_len_mean": 325.0, "time_this_iter_s": 28.02934217453003, "episodes_total": 1060, "hostname": "flow-main", "episodes_this_iter": 59, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939a20>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939748>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939898>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 635.5946457386017, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 635.5946457386017, "episode_reward_max": 493.31385466194433, "info": {"num_steps_trained": 973696, "grad_time_ms": 9964.548, "update_time_ms": 8.003, "num_steps_sampled": 973696, "default": {"vf_explained_var": 0.8248721361160278, "policy_loss": -0.007728117052465677, "entropy": 1.2920397520065308, "vf_loss": 34.99641036987305, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.013341318815946579, "total_loss": 34.990684509277344}, "load_time_ms": 4.735, "sample_time_ms": 16573.004}, "node_ip": "10.138.0.2", "timesteps_since_restore": 973696, "training_iteration": 23, "date": "2019-05-21_00-25-31", "timesteps_total": 973696, "num_metric_batches_dropped": 0, "episode_reward_mean": 460.26757275931163, "timestamp": 1558398331, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.760626502051336, "cost2_max": -17.989253927911758, "outflow_rate_min": 973.7803587886764, "system_level_velocity_max": 17.081349074101094, "outflow_rate_mean": 1201.4780628783685, "cost1_max": 209.9101440063055, "cost1_mean": 194.54439653242898, "cost2_min": -67.10801785683302, "system_level_velocity_min": 12.195727242363425, "outflow_rate_max": 1298.1749131665208, "cost1_min": 147.89588744109955, "cost2_mean": -32.67451237189545}, "timesteps_this_iter": 38138, "iterations_since_restore": 24, "episode_reward_min": 386.8475816070911, "episode_len_mean": 325.0, "time_this_iter_s": 26.175122499465942, "episodes_total": 1101, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89426d8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942b70>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942358>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 661.7697682380676, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 661.7697682380676, "episode_reward_max": 494.63845744535087, "info": {"num_steps_trained": 1011834, "grad_time_ms": 9963.505, "update_time_ms": 7.989, "num_steps_sampled": 1011834, "default": {"vf_explained_var": 0.835103452205658, "policy_loss": -0.007967427372932434, "entropy": 1.2854028940200806, "vf_loss": 26.89383316040039, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.012006750330328941, "total_loss": 26.887664794921875}, "load_time_ms": 4.58, "sample_time_ms": 16448.749}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1011834, "training_iteration": 24, "date": "2019-05-21_00-25-57", "timesteps_total": 1011834, "num_metric_batches_dropped": 0, "episode_reward_mean": 464.9454111763247, "timestamp": 1558398357, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.856930160670638, "cost2_max": -18.51079709033743, "outflow_rate_min": 950.3073089700998, "system_level_velocity_max": 17.086333285070314, "outflow_rate_mean": 1208.5828563515108, "cost1_max": 210.57438802524092, "cost1_mean": 195.6915195792359, "cost2_min": -66.48696251849711, "system_level_velocity_min": 12.297983713987417, "outflow_rate_max": 1308.5212161724196, "cost1_min": 147.5808610912133, "cost2_mean": -32.26190405254741}, "timesteps_this_iter": 38877, "iterations_since_restore": 25, "episode_reward_min": 384.10831666895166, "episode_len_mean": 325.0, "time_this_iter_s": 25.008305549621582, "episodes_total": 1141, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947668>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89476d8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89470b8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 686.7780737876892, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 686.7780737876892, "episode_reward_max": 494.63845744535087, "info": {"num_steps_trained": 1050711, "grad_time_ms": 9830.447, "update_time_ms": 8.209, "num_steps_sampled": 1050711, "default": {"vf_explained_var": 0.8542787432670593, "policy_loss": -0.009085452184081078, "entropy": 1.2868751287460327, "vf_loss": 28.447877883911133, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.015347776934504509, "total_loss": 28.441097259521484}, "load_time_ms": 4.588, "sample_time_ms": 16367.15}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1050711, "training_iteration": 25, "date": "2019-05-21_00-26-22", "timesteps_total": 1050711, "num_metric_batches_dropped": 0, "episode_reward_mean": 466.93921026810915, "timestamp": 1558398382, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.76333538533695, "cost2_max": -18.51079709033743, "outflow_rate_min": 950.3073089700998, "system_level_velocity_max": 17.086333285070314, "outflow_rate_mean": 1205.7007955394677, "cost1_max": 210.57438802524092, "cost1_mean": 194.31544744328377, "cost2_min": -66.48696251849711, "system_level_velocity_min": 11.801100074112526, "outflow_rate_max": 1309.2137810803997, "cost1_min": 140.21720900721164, "cost2_mean": -35.10812543067461}, "timesteps_this_iter": 40612, "iterations_since_restore": 26, "episode_reward_min": 364.71056518120633, "episode_len_mean": 325.0, "time_this_iter_s": 28.33763289451599, "episodes_total": 1200, "hostname": "flow-main", "episodes_this_iter": 59, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956438>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956400>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89563c8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 715.1157066822052, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 715.1157066822052, "episode_reward_max": 495.6306511323738, "info": {"num_steps_trained": 1091323, "grad_time_ms": 9775.241, "update_time_ms": 8.293, "num_steps_sampled": 1091323, "default": {"vf_explained_var": 0.8566713333129883, "policy_loss": -0.007476119324564934, "entropy": 1.2986621856689453, "vf_loss": 32.03340148925781, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.014098825864493847, "total_loss": 32.028045654296875}, "load_time_ms": 4.705, "sample_time_ms": 16460.997}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1091323, "training_iteration": 26, "date": "2019-05-21_00-26-51", "timesteps_total": 1091323, "num_metric_batches_dropped": 0, "episode_reward_mean": 465.4491797159242, "timestamp": 1558398411, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.559228719720679, "cost2_max": -20.804794087078278, "outflow_rate_min": 921.8371553141665, "system_level_velocity_max": 17.30604607738621, "outflow_rate_mean": 1199.6308206088434, "cost1_max": 212.38881423092806, "cost1_mean": 191.57053039261444, "cost2_min": -64.7845860630464, "system_level_velocity_min": 9.840003291621574, "outflow_rate_max": 1324.0316351426932, "cost1_min": 119.61760409822308, "cost2_mean": -38.389130734408}, "timesteps_this_iter": 40151, "iterations_since_restore": 27, "episode_reward_min": 364.71056518120633, "episode_len_mean": 325.0, "time_this_iter_s": 25.733569383621216, "episodes_total": 1241, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947ba8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947978>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947f28>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 740.8492760658264, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 740.8492760658264, "episode_reward_max": 505.5216935782814, "info": {"num_steps_trained": 1131474, "grad_time_ms": 9806.364, "update_time_ms": 8.248, "num_steps_sampled": 1131474, "default": {"vf_explained_var": 0.8909093141555786, "policy_loss": -0.010027925483882427, "entropy": 1.2752970457077026, "vf_loss": 25.722688674926758, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.014490676112473011, "total_loss": 25.714834213256836}, "load_time_ms": 4.72, "sample_time_ms": 16289.806}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1131474, "training_iteration": 27, "date": "2019-05-21_00-27-16", "timesteps_total": 1131474, "num_metric_batches_dropped": 0, "episode_reward_mean": 462.3435296975061, "timestamp": 1558398436, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.470931543639688, "cost2_max": -20.986386631564816, "outflow_rate_min": 921.8371553141665, "system_level_velocity_max": 17.30604607738621, "outflow_rate_mean": 1200.9028500306513, "cost1_max": 212.38881423092806, "cost1_mean": 190.34096959000397, "cost2_min": -67.24211202793819, "system_level_velocity_min": 9.840003291621574, "outflow_rate_max": 1324.0316351426932, "cost1_min": 119.61760409822308, "cost2_mean": -40.3216073858132}, "timesteps_this_iter": 40482, "iterations_since_restore": 28, "episode_reward_min": 369.0218370384692, "episode_len_mean": 325.0, "time_this_iter_s": 25.690906286239624, "episodes_total": 1281, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956518>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956048>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89568d0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 766.540182352066, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 766.540182352066, "episode_reward_max": 505.5216935782814, "info": {"num_steps_trained": 1171956, "grad_time_ms": 9799.578, "update_time_ms": 8.133, "num_steps_sampled": 1171956, "default": {"vf_explained_var": 0.9012058973312378, "policy_loss": -0.007803123909980059, "entropy": 1.2819733619689941, "vf_loss": 22.23905372619629, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.014390687458217144, "total_loss": 22.233407974243164}, "load_time_ms": 4.735, "sample_time_ms": 16241.966}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1171956, "training_iteration": 28, "date": "2019-05-21_00-27-42", "timesteps_total": 1171956, "num_metric_batches_dropped": 0, "episode_reward_mean": 461.57269689344133, "timestamp": 1558398462, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.348624141147711, "cost2_max": -20.986386631564816, "outflow_rate_min": 921.8371553141665, "system_level_velocity_max": 17.30604607738621, "outflow_rate_mean": 1197.5872690540411, "cost1_max": 212.38881423092806, "cost1_mean": 188.8486744236379, "cost2_min": -67.24211202793819, "system_level_velocity_min": 9.840003291621574, "outflow_rate_max": 1317.088265463858, "cost1_min": 119.61760409822308, "cost2_mean": -40.83751794584151}, "timesteps_this_iter": 40523, "iterations_since_restore": 29, "episode_reward_min": 369.0218370384692, "episode_len_mean": 325.0, "time_this_iter_s": 26.976622581481934, "episodes_total": 1321, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947e48>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947b70>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89564e0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 793.516804933548, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 793.516804933548, "episode_reward_max": 499.43666100144645, "info": {"num_steps_trained": 1212479, "grad_time_ms": 9904.715, "update_time_ms": 8.402, "num_steps_sampled": 1212479, "default": {"vf_explained_var": 0.8796137571334839, "policy_loss": -0.006934348493814468, "entropy": 1.2933448553085327, "vf_loss": 27.56507110595703, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.012019294314086437, "total_loss": 27.559940338134766}, "load_time_ms": 4.627, "sample_time_ms": 16290.873}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1212479, "training_iteration": 29, "date": "2019-05-21_00-28-09", "timesteps_total": 1212479, "num_metric_batches_dropped": 0, "episode_reward_mean": 459.9052882574236, "timestamp": 1558398489, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.4716572551947, "cost2_max": -20.825417429813943, "outflow_rate_min": 1023.3171468667475, "system_level_velocity_max": 17.31648355513034, "outflow_rate_mean": 1204.0422342936408, "cost1_max": 212.5874040756986, "cost1_mean": 190.64400969071394, "cost2_min": -78.2357406205019, "system_level_velocity_min": 11.717687276825833, "outflow_rate_max": 1317.088265463858, "cost1_min": 142.3218334557542, "cost2_mean": -39.091939401704174}, "timesteps_this_iter": 39759, "iterations_since_restore": 30, "episode_reward_min": 388.3055560942253, "episode_len_mean": 325.0, "time_this_iter_s": 28.062647342681885, "episodes_total": 1381, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947f28>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947ba8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947978>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 821.5794522762299, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 821.5794522762299, "episode_reward_max": 506.4024563236586, "info": {"num_steps_trained": 1252238, "grad_time_ms": 10051.721, "update_time_ms": 8.538, "num_steps_sampled": 1252238, "default": {"vf_explained_var": 0.886445939540863, "policy_loss": -0.009252488613128662, "entropy": 1.2850875854492188, "vf_loss": 28.13241195678711, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.014837369322776794, "total_loss": 28.125383377075195}, "load_time_ms": 4.7, "sample_time_ms": 16228.836}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1252238, "training_iteration": 30, "date": "2019-05-21_00-28-37", "timesteps_total": 1252238, "num_metric_batches_dropped": 0, "episode_reward_mean": 463.1836303711718, "timestamp": 1558398517, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.510259333518679, "cost2_max": -20.825417429813943, "outflow_rate_min": 978.6520035193566, "system_level_velocity_max": 17.31648355513034, "outflow_rate_mean": 1197.3749123214593, "cost1_max": 212.5874040756986, "cost1_mean": 191.06183817482832, "cost2_min": -78.2357406205019, "system_level_velocity_min": 11.717687276825833, "outflow_rate_max": 1313.727209262579, "cost1_min": 142.3218334557542, "cost2_mean": -37.12256506044677}, "timesteps_this_iter": 39177, "iterations_since_restore": 31, "episode_reward_min": 375.6834840978778, "episode_len_mean": 325.0, "time_this_iter_s": 25.988747596740723, "episodes_total": 1421, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956ac8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956ba8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956048>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 847.5681998729706, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 847.5681998729706, "episode_reward_max": 506.4024563236586, "info": {"num_steps_trained": 1291415, "grad_time_ms": 10161.957, "update_time_ms": 8.513, "num_steps_sampled": 1291415, "default": {"vf_explained_var": 0.876569390296936, "policy_loss": -0.00785050168633461, "entropy": 1.2850432395935059, "vf_loss": 27.519838333129883, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.013851284049451351, "total_loss": 27.51406478881836}, "load_time_ms": 4.767, "sample_time_ms": 16264.83}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1291415, "training_iteration": 31, "date": "2019-05-21_00-29-03", "timesteps_total": 1291415, "num_metric_batches_dropped": 0, "episode_reward_mean": 461.59333776910853, "timestamp": 1558398543, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.713620125166756, "cost2_max": -20.66386475416098, "outflow_rate_min": 978.6520035193566, "system_level_velocity_max": 17.331801245389777, "outflow_rate_mean": 1201.1118213030902, "cost1_max": 212.5874040756986, "cost1_mean": 193.48920430583584, "cost2_min": -67.62189474783456, "system_level_velocity_min": 12.104246349840226, "outflow_rate_max": 1305.058864140099, "cost1_min": 146.54934192699022, "cost2_mean": -34.47927708414416}, "timesteps_this_iter": 40013, "iterations_since_restore": 32, "episode_reward_min": 375.6834840978778, "episode_len_mean": 325.0, "time_this_iter_s": 26.361804008483887, "episodes_total": 1461, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947ef0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947898>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947e10>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 873.9300038814545, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 873.9300038814545, "episode_reward_max": 491.7184070652841, "info": {"num_steps_trained": 1331428, "grad_time_ms": 10274.856, "update_time_ms": 8.631, "num_steps_sampled": 1331428, "default": {"vf_explained_var": 0.8717584013938904, "policy_loss": -0.008854485116899014, "entropy": 1.286661148071289, "vf_loss": 28.271757125854492, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.015052187256515026, "total_loss": 28.265161514282227}, "load_time_ms": 5.066, "sample_time_ms": 16271.593}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1331428, "training_iteration": 32, "date": "2019-05-21_00-29-30", "timesteps_total": 1331428, "num_metric_batches_dropped": 0, "episode_reward_mean": 463.56721295403474, "timestamp": 1558398570, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.756007759913432, "cost2_max": -18.475833672997965, "outflow_rate_min": 990.7826179702653, "system_level_velocity_max": 17.478516048904353, "outflow_rate_mean": 1202.039092737622, "cost1_max": 214.11104034238252, "cost1_mean": 193.798814439445, "cost2_min": -72.30887069690974, "system_level_velocity_min": 10.86947794540878, "outflow_rate_max": 1307.6453328924474, "cost1_min": 134.03799857403882, "cost2_mean": -34.54533122612545}, "timesteps_this_iter": 38873, "iterations_since_restore": 33, "episode_reward_min": 376.0176374646779, "episode_len_mean": 325.0, "time_this_iter_s": 27.659329175949097, "episodes_total": 1521, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947f28>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947cf8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947d30>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 901.5893330574036, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 901.5893330574036, "episode_reward_max": 494.32306939883273, "info": {"num_steps_trained": 1370301, "grad_time_ms": 10230.28, "update_time_ms": 8.689, "num_steps_sampled": 1370301, "default": {"vf_explained_var": 0.8559942841529846, "policy_loss": -0.00963544100522995, "entropy": 1.279390811920166, "vf_loss": 38.82699203491211, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.014810500666499138, "total_loss": 38.81957244873047}, "load_time_ms": 5.015, "sample_time_ms": 16280.158}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1370301, "training_iteration": 33, "date": "2019-05-21_00-29-57", "timesteps_total": 1370301, "num_metric_batches_dropped": 0, "episode_reward_mean": 462.78243543455466, "timestamp": 1558398597, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.640399433358407, "cost2_max": -18.475833672997965, "outflow_rate_min": 990.7826179702653, "system_level_velocity_max": 17.50631393163101, "outflow_rate_mean": 1194.7588918702038, "cost1_max": 214.86742286244134, "cost1_mean": 192.20841664301315, "cost2_min": -72.30887069690974, "system_level_velocity_min": 10.86947794540878, "outflow_rate_max": 1312.7359948325393, "cost1_min": 134.03799857403882, "cost2_mean": -34.936958131166534}, "timesteps_this_iter": 38792, "iterations_since_restore": 34, "episode_reward_min": 376.0176374646779, "episode_len_mean": 325.0, "time_this_iter_s": 25.571768045425415, "episodes_total": 1561, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956d30>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89568d0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956128>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 927.161101102829, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 927.161101102829, "episode_reward_max": 494.32306939883273, "info": {"num_steps_trained": 1409093, "grad_time_ms": 10252.922, "update_time_ms": 8.489, "num_steps_sampled": 1409093, "default": {"vf_explained_var": 0.8464295268058777, "policy_loss": -0.009907853789627552, "entropy": 1.2752141952514648, "vf_loss": 33.92518997192383, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.016108283773064613, "total_loss": 33.91769790649414}, "load_time_ms": 4.961, "sample_time_ms": 16197.116}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1409093, "training_iteration": 34, "date": "2019-05-21_00-30-23", "timesteps_total": 1409093, "num_metric_batches_dropped": 0, "episode_reward_mean": 459.5399249956506, "timestamp": 1558398623, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.642576656419585, "cost2_max": -16.02412315421417, "outflow_rate_min": 990.7826179702653, "system_level_velocity_max": 17.50631393163101, "outflow_rate_mean": 1184.0174902319968, "cost1_max": 214.86742286244134, "cost1_mean": 192.31336701620594, "cost2_min": -72.30887069690974, "system_level_velocity_min": 10.86947794540878, "outflow_rate_max": 1312.7359948325393, "cost1_min": 134.03799857403882, "cost2_mean": -33.056017431283266}, "timesteps_this_iter": 38635, "iterations_since_restore": 35, "episode_reward_min": 376.0176374646779, "episode_len_mean": 325.0, "time_this_iter_s": 26.96466374397278, "episodes_total": 1601, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89396d8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947eb8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947e10>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 954.1257648468018, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 954.1257648468018, "episode_reward_max": 491.0865774772417, "info": {"num_steps_trained": 1447728, "grad_time_ms": 10498.418, "update_time_ms": 8.174, "num_steps_sampled": 1447728, "default": {"vf_explained_var": 0.8380671143531799, "policy_loss": -0.00976656936109066, "entropy": 1.2731294631958008, "vf_loss": 36.04313659667969, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.017632322385907173, "total_loss": 36.036014556884766}, "load_time_ms": 4.89, "sample_time_ms": 16147.342}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1447728, "training_iteration": 35, "date": "2019-05-21_00-30-50", "timesteps_total": 1447728, "num_metric_batches_dropped": 0, "episode_reward_mean": 457.35114296609055, "timestamp": 1558398650, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.74668596547088, "cost2_max": -15.652309468987376, "outflow_rate_min": 1004.0818810452221, "system_level_velocity_max": 17.508220329220315, "outflow_rate_mean": 1177.5899113758628, "cost1_max": 214.59412177138756, "cost1_mean": 193.6124127254174, "cost2_min": -54.85199119329765, "system_level_velocity_min": 12.486295368461455, "outflow_rate_max": 1277.0320595102937, "cost1_min": 150.42026277866725, "cost2_mean": -30.603349096770298}, "timesteps_this_iter": 38608, "iterations_since_restore": 36, "episode_reward_min": 380.0835268289269, "episode_len_mean": 325.0, "time_this_iter_s": 26.89999508857727, "episodes_total": 1660, "hostname": "flow-main", "episodes_this_iter": 59, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89479e8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947f28>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947978>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 981.025759935379, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 981.025759935379, "episode_reward_max": 489.8835519372666, "info": {"num_steps_trained": 1486336, "grad_time_ms": 10378.953, "update_time_ms": 8.122, "num_steps_sampled": 1486336, "default": {"vf_explained_var": 0.8239261507987976, "policy_loss": -0.009282898157835007, "entropy": 1.279590129852295, "vf_loss": 44.315513610839844, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.016020063310861588, "total_loss": 44.308631896972656}, "load_time_ms": 4.599, "sample_time_ms": 16124.146}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1486336, "training_iteration": 36, "date": "2019-05-21_00-31-17", "timesteps_total": 1486336, "num_metric_batches_dropped": 0, "episode_reward_mean": 455.8407360038341, "timestamp": 1558398677, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.852965113108842, "cost2_max": -15.652309468987376, "outflow_rate_min": 1018.8640476190476, "system_level_velocity_max": 17.5472791237801, "outflow_rate_mean": 1173.0317488928383, "cost1_max": 214.81383565151899, "cost1_mean": 194.6872430345794, "cost2_min": -55.09849491045876, "system_level_velocity_min": 12.773176818795271, "outflow_rate_max": 1270.8302463192297, "cost1_min": 153.58902360397744, "cost2_mean": -28.87309465729787}, "timesteps_this_iter": 36632, "iterations_since_restore": 37, "episode_reward_min": 386.368068147775, "episode_len_mean": 325.0, "time_this_iter_s": 24.6391122341156, "episodes_total": 1701, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953a58>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89530f0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947780>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1005.6648721694946, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1005.6648721694946, "episode_reward_max": 489.8835519372666, "info": {"num_steps_trained": 1522968, "grad_time_ms": 10321.858, "update_time_ms": 8.169, "num_steps_sampled": 1522968, "default": {"vf_explained_var": 0.7974892854690552, "policy_loss": -0.009927681647241116, "entropy": 1.2682911157608032, "vf_loss": 42.8890495300293, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.01644473895430565, "total_loss": 42.881591796875}, "load_time_ms": 4.584, "sample_time_ms": 16072.593}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1522968, "training_iteration": 37, "date": "2019-05-21_00-31-42", "timesteps_total": 1522968, "num_metric_batches_dropped": 0, "episode_reward_mean": 452.9831744471451, "timestamp": 1558398702, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 15.976563279782276, "cost2_max": -16.015956307126054, "outflow_rate_min": 969.2685535924796, "system_level_velocity_max": 17.5472791237801, "outflow_rate_mean": 1172.0019773454492, "cost1_max": 215.32208188415453, "cost1_mean": 196.17018504604312, "cost2_min": -55.09849491045876, "system_level_velocity_min": 12.544249744990765, "outflow_rate_max": 1247.1568316634225, "cost1_min": 150.25697215776464, "cost2_mean": -27.77643690684799}, "timesteps_this_iter": 37070, "iterations_since_restore": 38, "episode_reward_min": 370.58112598744435, "episode_len_mean": 325.0, "time_this_iter_s": 23.833587169647217, "episodes_total": 1741, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942b70>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942080>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942780>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1029.4984593391418, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1029.4984593391418, "episode_reward_max": 482.56544070644344, "info": {"num_steps_trained": 1560038, "grad_time_ms": 10126.935, "update_time_ms": 8.189, "num_steps_sampled": 1560038, "default": {"vf_explained_var": 0.7697616219520569, "policy_loss": -0.00803892221301794, "entropy": 1.2848072052001953, "vf_loss": 47.26424789428711, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.01621660403907299, "total_loss": 47.25864028930664}, "load_time_ms": 4.746, "sample_time_ms": 16082.701}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1560038, "training_iteration": 38, "date": "2019-05-21_00-32-06", "timesteps_total": 1560038, "num_metric_batches_dropped": 0, "episode_reward_mean": 451.5141714387316, "timestamp": 1558398726, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.095907147850593, "cost2_max": -10.921123754832, "outflow_rate_min": 496.3206105869156, "system_level_velocity_max": 18.313775240312122, "outflow_rate_mean": 1169.1201022394844, "cost1_max": 216.34974157649788, "cost1_mean": 195.38994024656037, "cost2_min": -70.06221049629059, "system_level_velocity_min": 11.472242477882261, "outflow_rate_max": 1268.1323536358102, "cost1_min": 24.7750395986283, "cost2_mean": -27.618526283259328}, "timesteps_this_iter": 37732, "iterations_since_restore": 39, "episode_reward_min": 57.75764838073019, "episode_len_mean": 322.13, "time_this_iter_s": 27.12148380279541, "episodes_total": 1800, "hostname": "flow-main", "episodes_this_iter": 59, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953a90>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953c50>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953f28>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1056.6199431419373, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1056.6199431419373, "episode_reward_max": 484.21922991400703, "info": {"num_steps_trained": 1597770, "grad_time_ms": 9921.111, "update_time_ms": 7.957, "num_steps_sampled": 1597770, "default": {"vf_explained_var": 0.78974449634552, "policy_loss": -0.009581997990608215, "entropy": 1.282031774520874, "vf_loss": 53.54523849487305, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.01818937249481678, "total_loss": 53.53838348388672}, "load_time_ms": 4.782, "sample_time_ms": 16303.548}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1597770, "training_iteration": 39, "date": "2019-05-21_00-32-33", "timesteps_total": 1597770, "num_metric_batches_dropped": 0, "episode_reward_mean": 448.49329834973184, "timestamp": 1558398753, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.281686098942885, "cost2_max": -10.921123754832, "outflow_rate_min": 496.3206105869156, "system_level_velocity_max": 18.313775240312122, "outflow_rate_mean": 1181.355497878299, "cost1_max": 217.23325351818426, "cost1_mean": 197.5466681105598, "cost2_min": -70.06221049629059, "system_level_velocity_min": 11.472242477882261, "outflow_rate_max": 1269.1298385258358, "cost1_min": 24.7750395986283, "cost2_mean": -27.911948300257862}, "timesteps_this_iter": 36171, "iterations_since_restore": 40, "episode_reward_min": 57.75764838073019, "episode_len_mean": 322.13, "time_this_iter_s": 23.98781180381775, "episodes_total": 1842, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956588>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956438>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956668>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1080.607754945755, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1080.607754945755, "episode_reward_max": 484.21922991400703, "info": {"num_steps_trained": 1633941, "grad_time_ms": 9636.259, "update_time_ms": 7.787, "num_steps_sampled": 1633941, "default": {"vf_explained_var": 0.7996714115142822, "policy_loss": -0.010058087296783924, "entropy": 1.2646090984344482, "vf_loss": 40.64906692504883, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.016330167651176453, "total_loss": 40.64146041870117}, "load_time_ms": 4.992, "sample_time_ms": 16182.431}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1633941, "training_iteration": 40, "date": "2019-05-21_00-32-57", "timesteps_total": 1633941, "num_metric_batches_dropped": 0, "episode_reward_mean": 453.3756226186041, "timestamp": 1558398777, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.311969500182542, "cost2_max": -10.921123754832, "outflow_rate_min": 496.3206105869156, "system_level_velocity_max": 18.313775240312122, "outflow_rate_mean": 1179.7656869980874, "cost1_max": 217.23325351818426, "cost1_mean": 197.699303239084, "cost2_min": -54.51158532566521, "system_level_velocity_min": 11.472242477882261, "outflow_rate_max": 1269.7488257564924, "cost1_min": 24.7750395986283, "cost2_mean": -28.257289483426785}, "timesteps_this_iter": 37344, "iterations_since_restore": 41, "episode_reward_min": 57.75764838073019, "episode_len_mean": 322.13, "time_this_iter_s": 24.789980173110962, "episodes_total": 1882, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953a58>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89534a8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953400>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1105.397735118866, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1105.397735118866, "episode_reward_max": 484.21922991400703, "info": {"num_steps_trained": 1671285, "grad_time_ms": 9422.25, "update_time_ms": 7.77, "num_steps_sampled": 1671285, "default": {"vf_explained_var": 0.7957993149757385, "policy_loss": -0.009069940075278282, "entropy": 1.2784078121185303, "vf_loss": 43.723907470703125, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.016873985528945923, "total_loss": 43.717369079589844}, "load_time_ms": 4.844, "sample_time_ms": 16278.402}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1671285, "training_iteration": 41, "date": "2019-05-21_00-33-22", "timesteps_total": 1671285, "num_metric_batches_dropped": 0, "episode_reward_mean": 451.78351969962443, "timestamp": 1558398802, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.140749602552905, "cost2_max": -15.218469830474898, "outflow_rate_min": 1016.7828402975994, "system_level_velocity_max": 17.800118239270986, "outflow_rate_mean": 1179.0221355422282, "cost1_max": 217.72970147341385, "cost1_mean": 197.28589113554747, "cost2_min": -55.303893984404766, "system_level_velocity_min": 12.75007533395931, "outflow_rate_max": 1273.6476805605462, "cost1_min": 154.38030537058825, "cost2_mean": -30.121717319628825}, "timesteps_this_iter": 37836, "iterations_since_restore": 42, "episode_reward_min": 389.12249608834117, "episode_len_mean": 325.0, "time_this_iter_s": 25.03744125366211, "episodes_total": 1922, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953588>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89535c0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89537b8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1130.435176372528, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1130.435176372528, "episode_reward_max": 481.97969553933336, "info": {"num_steps_trained": 1709121, "grad_time_ms": 9241.879, "update_time_ms": 7.508, "num_steps_sampled": 1709121, "default": {"vf_explained_var": 0.8177178502082825, "policy_loss": -0.009135319851338863, "entropy": 1.277308464050293, "vf_loss": 42.11573791503906, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.015878409147262573, "total_loss": 42.108985900878906}, "load_time_ms": 4.558, "sample_time_ms": 16328.223}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1709121, "training_iteration": 42, "date": "2019-05-21_00-33-47", "timesteps_total": 1709121, "num_metric_batches_dropped": 0, "episode_reward_mean": 451.70853472983725, "timestamp": 1558398827, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.08002243847451, "cost2_max": -15.218469830474898, "outflow_rate_min": 1016.7828402975994, "system_level_velocity_max": 17.981522392389078, "outflow_rate_mean": 1180.3959487203458, "cost1_max": 219.00022977985418, "cost1_mean": 196.4612148220008, "cost2_min": -59.72468582917813, "system_level_velocity_min": 12.739069736937438, "outflow_rate_max": 1283.1631771792602, "cost1_min": 153.8017734233339, "cost2_mean": -31.363054244264095}, "timesteps_this_iter": 37248, "iterations_since_restore": 43, "episode_reward_min": 389.12249608834117, "episode_len_mean": 325.0, "time_this_iter_s": 26.075015544891357, "episodes_total": 1982, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956358>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89564a8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956550>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1156.5101919174194, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1156.5101919174194, "episode_reward_max": 484.3740593357931, "info": {"num_steps_trained": 1746369, "grad_time_ms": 9090.905, "update_time_ms": 7.336, "num_steps_sampled": 1746369, "default": {"vf_explained_var": 0.8183107972145081, "policy_loss": -0.0108084287494421, "entropy": 1.267142653465271, "vf_loss": 46.687740325927734, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.01917080394923687, "total_loss": 46.6798095703125}, "load_time_ms": 4.342, "sample_time_ms": 16321.766}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1746369, "training_iteration": 43, "date": "2019-05-21_00-34-13", "timesteps_total": 1746369, "num_metric_batches_dropped": 0, "episode_reward_mean": 451.6354853213463, "timestamp": 1558398853, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.121386334434856, "cost2_max": -16.309627762647278, "outflow_rate_min": 1026.759324551963, "system_level_velocity_max": 18.051571865229718, "outflow_rate_mean": 1184.7127606478898, "cost1_max": 220.25534901381002, "cost1_mean": 196.9177386190097, "cost2_min": -65.29625186653324, "system_level_velocity_min": 12.739069736937438, "outflow_rate_max": 1284.7885569096031, "cost1_min": 153.8017734233339, "cost2_mean": -31.713298540411202}, "timesteps_this_iter": 37599, "iterations_since_restore": 44, "episode_reward_min": 396.77222196686154, "episode_len_mean": 325.0, "time_this_iter_s": 23.89126753807068, "episodes_total": 2022, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953c18>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89539e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89530f0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1180.40145945549, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1180.40145945549, "episode_reward_max": 484.3740593357931, "info": {"num_steps_trained": 1783968, "grad_time_ms": 8906.711, "update_time_ms": 7.236, "num_steps_sampled": 1783968, "default": {"vf_explained_var": 0.8513849377632141, "policy_loss": -0.009370040148496628, "entropy": 1.2659199237823486, "vf_loss": 35.369659423828125, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.01935114525258541, "total_loss": 35.36319351196289}, "load_time_ms": 4.195, "sample_time_ms": 16335.289}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1783968, "training_iteration": 44, "date": "2019-05-21_00-34-37", "timesteps_total": 1783968, "num_metric_batches_dropped": 0, "episode_reward_mean": 453.13377101557904, "timestamp": 1558398877, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.217665192107788, "cost2_max": -16.87691380649296, "outflow_rate_min": 1028.6216095879777, "system_level_velocity_max": 18.051571865229718, "outflow_rate_mean": 1188.9249903503055, "cost1_max": 220.25534901381002, "cost1_mean": 198.1060909076837, "cost2_min": -65.29625186653324, "system_level_velocity_min": 12.739069736937438, "outflow_rate_max": 1284.7885569096031, "cost1_min": 153.8017734233339, "cost2_mean": -31.515966210362464}, "timesteps_this_iter": 37276, "iterations_since_restore": 45, "episode_reward_min": 396.77222196686154, "episode_len_mean": 325.0, "time_this_iter_s": 25.046699047088623, "episodes_total": 2062, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89533c8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953c50>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953f98>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1205.4481585025787, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1205.4481585025787, "episode_reward_max": 484.1073670673341, "info": {"num_steps_trained": 1821244, "grad_time_ms": 8692.15, "update_time_ms": 7.377, "num_steps_sampled": 1821244, "default": {"vf_explained_var": 0.8433730006217957, "policy_loss": -0.009592805989086628, "entropy": 1.2721219062805176, "vf_loss": 35.96485137939453, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.1499999761581421, "kl": 0.017943639308214188, "total_loss": 35.95794677734375}, "load_time_ms": 4.274, "sample_time_ms": 16357.603}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1821244, "training_iteration": 45, "date": "2019-05-21_00-35-02", "timesteps_total": 1821244, "num_metric_batches_dropped": 0, "episode_reward_mean": 454.3750856995094, "timestamp": 1558398902, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.415078833359868, "cost2_max": -16.87691380649296, "outflow_rate_min": 961.2980451330569, "system_level_velocity_max": 18.018146837153264, "outflow_rate_mean": 1194.5739678457437, "cost1_max": 219.65731359060726, "cost1_mean": 200.47492890739184, "cost2_min": -58.06281722425347, "system_level_velocity_min": 12.421075860630408, "outflow_rate_max": 1297.9647940775874, "cost1_min": 147.237712349899, "cost2_mean": -30.463627532813288}, "timesteps_this_iter": 37133, "iterations_since_restore": 46, "episode_reward_min": 374.67495521092115, "episode_len_mean": 325.0, "time_this_iter_s": 26.340550899505615, "episodes_total": 2122, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942cf8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947780>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947e10>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1231.7887094020844, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1231.7887094020844, "episode_reward_max": 489.59029542753046, "info": {"num_steps_trained": 1858377, "grad_time_ms": 8713.89, "update_time_ms": 7.248, "num_steps_sampled": 1858377, "default": {"vf_explained_var": 0.8299388289451599, "policy_loss": -0.011365318670868874, "entropy": 1.2716563940048218, "vf_loss": 47.983314514160156, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.14999999105930328, "kl": 0.020925868302583694, "total_loss": 47.9750862121582}, "load_time_ms": 4.57, "sample_time_ms": 16279.957}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1858377, "training_iteration": 46, "date": "2019-05-21_00-35-28", "timesteps_total": 1858377, "num_metric_batches_dropped": 0, "episode_reward_mean": 457.2402092014927, "timestamp": 1558398928, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.27264098437454, "cost2_max": -17.534175695716634, "outflow_rate_min": 961.2980451330569, "system_level_velocity_max": 18.00500759207044, "outflow_rate_mean": 1188.329587791134, "cost1_max": 220.38352552584047, "cost1_mean": 198.69385356053303, "cost2_min": -72.37262825541035, "system_level_velocity_min": 10.999920974121563, "outflow_rate_max": 1297.9647940775874, "cost1_min": 135.41941516474742, "cost2_mean": -31.627564508054558}, "timesteps_this_iter": 37672, "iterations_since_restore": 47, "episode_reward_min": 374.67495521092115, "episode_len_mean": 325.0, "time_this_iter_s": 26.69125008583069, "episodes_total": 2162, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89569e8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956dd8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942048>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1258.479959487915, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1258.479959487915, "episode_reward_max": 489.59029542753046, "info": {"num_steps_trained": 1896049, "grad_time_ms": 8886.99, "update_time_ms": 7.326, "num_steps_sampled": 1896049, "default": {"vf_explained_var": 0.8779420256614685, "policy_loss": -0.009063368663191795, "entropy": 1.2777870893478394, "vf_loss": 33.04573440551758, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.2250000238418579, "kl": 0.014223938807845116, "total_loss": 33.03987121582031}, "load_time_ms": 4.55, "sample_time_ms": 16311.122}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1896049, "training_iteration": 47, "date": "2019-05-21_00-35-55", "timesteps_total": 1896049, "num_metric_batches_dropped": 0, "episode_reward_mean": 456.3174128899729, "timestamp": 1558398955, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.336023609379072, "cost2_max": -12.993826152566102, "outflow_rate_min": 484.8852259572368, "system_level_velocity_max": 18.391407027902034, "outflow_rate_mean": 1183.941451460246, "cost1_max": 220.38352552584047, "cost1_mean": 197.47084382247695, "cost2_min": -72.37262825541035, "system_level_velocity_min": 10.999920974121563, "outflow_rate_max": 1314.83834826027, "cost1_min": 22.952490841241328, "cost2_mean": -31.4109840388875}, "timesteps_this_iter": 37552, "iterations_since_restore": 48, "episode_reward_min": 53.32949395961796, "episode_len_mean": 322.1, "time_this_iter_s": 25.7686128616333, "episodes_total": 2203, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947d30>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89472e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89477b8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1284.2485723495483, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1284.2485723495483, "episode_reward_max": 488.37922890186593, "info": {"num_steps_trained": 1933601, "grad_time_ms": 9103.947, "update_time_ms": 7.374, "num_steps_sampled": 1933601, "default": {"vf_explained_var": 0.8384385108947754, "policy_loss": -0.01126081496477127, "entropy": 1.2917168140411377, "vf_loss": 39.412933349609375, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22500000894069672, "kl": 0.015275225974619389, "total_loss": 39.40510940551758}, "load_time_ms": 4.315, "sample_time_ms": 16287.42}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1933601, "training_iteration": 48, "date": "2019-05-21_00-36-21", "timesteps_total": 1933601, "num_metric_batches_dropped": 0, "episode_reward_mean": 452.8302195305944, "timestamp": 1558398981, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.46188838566963, "cost2_max": -12.993826152566102, "outflow_rate_min": 484.8852259572368, "system_level_velocity_max": 18.391407027902034, "outflow_rate_mean": 1199.7256931001605, "cost1_max": 219.7793707796284, "cost1_mean": 199.18172865367333, "cost2_min": -62.1808320026832, "system_level_velocity_min": 10.490341382596299, "outflow_rate_max": 1314.83834826027, "cost1_min": 22.952490841241328, "cost2_mean": -30.886143270999472}, "timesteps_this_iter": 38367, "iterations_since_restore": 49, "episode_reward_min": 53.32949395961796, "episode_len_mean": 322.1, "time_this_iter_s": 27.054232597351074, "episodes_total": 2260, "hostname": "flow-main", "episodes_this_iter": 57, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942358>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942cf8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942f60>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1311.3028049468994, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1311.3028049468994, "episode_reward_max": 488.37922890186593, "info": {"num_steps_trained": 1971968, "grad_time_ms": 9254.161, "update_time_ms": 7.409, "num_steps_sampled": 1971968, "default": {"vf_explained_var": 0.8663497567176819, "policy_loss": -0.010216574184596539, "entropy": 1.2989223003387451, "vf_loss": 41.886844635009766, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22500000894069672, "kl": 0.01565350964665413, "total_loss": 41.88014602661133}, "load_time_ms": 4.448, "sample_time_ms": 16130.078}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1971968, "training_iteration": 49, "date": "2019-05-21_00-36-48", "timesteps_total": 1971968, "num_metric_batches_dropped": 0, "episode_reward_mean": 456.6143520984093, "timestamp": 1558399008, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.219773932212345, "cost2_max": -19.84040107162812, "outflow_rate_min": 963.0085508780674, "system_level_velocity_max": 18.07419181719003, "outflow_rate_mean": 1198.558332415691, "cost1_max": 220.4717036047584, "cost1_mean": 197.93232923535808, "cost2_min": -62.1808320026832, "system_level_velocity_min": 10.490341382596299, "outflow_rate_max": 1311.096729286982, "cost1_min": 129.06788795023257, "cost2_mean": -32.27138833679894}, "timesteps_this_iter": 37611, "iterations_since_restore": 50, "episode_reward_min": 370.3604928361597, "episode_len_mean": 325.0, "time_this_iter_s": 25.510521173477173, "episodes_total": 2303, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89569b0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956d68>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89560f0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1336.8133261203766, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1336.8133261203766, "episode_reward_max": 488.15457120432654, "info": {"num_steps_trained": 2009579, "grad_time_ms": 9447.819, "update_time_ms": 7.493, "num_steps_sampled": 2009579, "default": {"vf_explained_var": 0.8581418991088867, "policy_loss": -0.008655504323542118, "entropy": 1.2837095260620117, "vf_loss": 40.43646240234375, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22500000894069672, "kl": 0.01387277152389288, "total_loss": 40.430931091308594}, "load_time_ms": 4.369, "sample_time_ms": 16088.367}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2009579, "training_iteration": 50, "date": "2019-05-21_00-37-13", "timesteps_total": 2009579, "num_metric_batches_dropped": 0, "episode_reward_mean": 456.2883797392255, "timestamp": 1558399033, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.12061156406951, "cost2_max": -18.24868496012205, "outflow_rate_min": 963.0085508780674, "system_level_velocity_max": 18.07419181719003, "outflow_rate_mean": 1190.4539473671437, "cost1_max": 220.4717036047584, "cost1_mean": 196.58996513625362, "cost2_min": -59.56385571837771, "system_level_velocity_min": 12.284054898342642, "outflow_rate_max": 1311.096729286982, "cost1_min": 146.60445178085655, "cost2_mean": -32.9708108602182}, "timesteps_this_iter": 37847, "iterations_since_restore": 51, "episode_reward_min": 370.3604928361597, "episode_len_mean": 325.0, "time_this_iter_s": 24.97260546684265, "episodes_total": 2343, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942dd8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89566a0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956eb8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1361.7859315872192, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1361.7859315872192, "episode_reward_max": 486.16023856027147, "info": {"num_steps_trained": 2047426, "grad_time_ms": 9617.992, "update_time_ms": 7.449, "num_steps_sampled": 2047426, "default": {"vf_explained_var": 0.8691408038139343, "policy_loss": -0.009418423287570477, "entropy": 1.3064028024673462, "vf_loss": 34.36396408081055, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.2250000238418579, "kl": 0.014926723204553127, "total_loss": 34.357906341552734}, "load_time_ms": 4.581, "sample_time_ms": 15936.029}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2047426, "training_iteration": 51, "date": "2019-05-21_00-37-38", "timesteps_total": 2047426, "num_metric_batches_dropped": 0, "episode_reward_mean": 453.4756769984126, "timestamp": 1558399058, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.19466574504617, "cost2_max": -18.148737569909127, "outflow_rate_min": 969.7726873126874, "system_level_velocity_max": 18.070203100376204, "outflow_rate_mean": 1195.3201500389625, "cost1_max": 220.40043926898772, "cost1_mean": 197.8356542345956, "cost2_min": -58.26379019309809, "system_level_velocity_min": 12.06333528106836, "outflow_rate_max": 1292.60821958414, "cost1_min": 146.00369646180553, "cost2_mean": -32.5564098069855}, "timesteps_this_iter": 38422, "iterations_since_restore": 52, "episode_reward_min": 372.58254524013165, "episode_len_mean": 325.0, "time_this_iter_s": 27.22411274909973, "episodes_total": 2400, "hostname": "flow-main", "episodes_this_iter": 57, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953710>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953cc0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953668>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1389.010044336319, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1389.010044336319, "episode_reward_max": 488.67272201193197, "info": {"num_steps_trained": 2085848, "grad_time_ms": 9740.413, "update_time_ms": 7.799, "num_steps_sampled": 2085848, "default": {"vf_explained_var": 0.8526200652122498, "policy_loss": -0.009977240115404129, "entropy": 1.3068461418151855, "vf_loss": 45.556209564208984, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499999403953552, "kl": 0.016003862023353577, "total_loss": 45.549835205078125}, "load_time_ms": 4.689, "sample_time_ms": 16030.811}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2085848, "training_iteration": 52, "date": "2019-05-21_00-38-06", "timesteps_total": 2085848, "num_metric_batches_dropped": 0, "episode_reward_mean": 456.16078590493225, "timestamp": 1558399086, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.354439529166722, "cost2_max": -18.079699349571026, "outflow_rate_min": 969.7726873126874, "system_level_velocity_max": 18.037507277267903, "outflow_rate_mean": 1199.3615921113744, "cost1_max": 219.63828288864147, "cost1_mean": 199.76611858501522, "cost2_min": -58.26379019309809, "system_level_velocity_min": 12.06333528106836, "outflow_rate_max": 1289.2105802456156, "cost1_min": 146.00369646180553, "cost2_mean": -30.941356455219385}, "timesteps_this_iter": 36883, "iterations_since_restore": 53, "episode_reward_min": 383.96412140054076, "episode_len_mean": 325.0, "time_this_iter_s": 25.655883073806763, "episodes_total": 2443, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947940>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89477f0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89479e8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1414.6659274101257, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1414.6659274101257, "episode_reward_max": 488.67272201193197, "info": {"num_steps_trained": 2122731, "grad_time_ms": 9864.085, "update_time_ms": 7.937, "num_steps_sampled": 2122731, "default": {"vf_explained_var": 0.8667332530021667, "policy_loss": -0.009989844635128975, "entropy": 1.2789256572723389, "vf_loss": 37.39995574951172, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22500000894069672, "kl": 0.01337970606982708, "total_loss": 37.39297103881836}, "load_time_ms": 4.777, "sample_time_ms": 15864.212}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2122731, "training_iteration": 53, "date": "2019-05-21_00-38-31", "timesteps_total": 2122731, "num_metric_batches_dropped": 0, "episode_reward_mean": 458.1719233887795, "timestamp": 1558399111, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.487044323161097, "cost2_max": -18.079699349571026, "outflow_rate_min": 981.543481607312, "system_level_velocity_max": 18.108488632844594, "outflow_rate_mean": 1205.1594344817054, "cost1_max": 221.0574688486522, "cost1_mean": 201.38679371563023, "cost2_min": -55.44938208512234, "system_level_velocity_min": 12.492689871346526, "outflow_rate_max": 1297.8168053190684, "cost1_min": 150.04744156289706, "cost2_mean": -30.570141625958126}, "timesteps_this_iter": 36924, "iterations_since_restore": 54, "episode_reward_min": 383.96412140054076, "episode_len_mean": 325.0, "time_this_iter_s": 24.7971453666687, "episodes_total": 2483, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89475f8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956ac8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956588>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1439.4630727767944, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1439.4630727767944, "episode_reward_max": 487.96852713488283, "info": {"num_steps_trained": 2159655, "grad_time_ms": 9977.909, "update_time_ms": 8.055, "num_steps_sampled": 2159655, "default": {"vf_explained_var": 0.8597729802131653, "policy_loss": -0.00997954048216343, "entropy": 1.2765856981277466, "vf_loss": 34.92936706542969, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22500000894069672, "kl": 0.015860535204410553, "total_loss": 34.92295455932617}, "load_time_ms": 4.778, "sample_time_ms": 15843.065}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2159655, "training_iteration": 54, "date": "2019-05-21_00-38-56", "timesteps_total": 2159655, "num_metric_batches_dropped": 0, "episode_reward_mean": 460.47410191534766, "timestamp": 1558399136, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.608895928659226, "cost2_max": -18.079699349571026, "outflow_rate_min": 982.9905442916134, "system_level_velocity_max": 18.108488632844594, "outflow_rate_mean": 1214.0686111530797, "cost1_max": 221.0574688486522, "cost1_mean": 202.95036127866973, "cost2_min": -57.46958085395233, "system_level_velocity_min": 12.522546388669149, "outflow_rate_max": 1297.914839040118, "cost1_min": 150.04744156289706, "cost2_mean": -30.561360520989734}, "timesteps_this_iter": 37603, "iterations_since_restore": 55, "episode_reward_min": 384.9083630096874, "episode_len_mean": 325.0, "time_this_iter_s": 25.689857482910156, "episodes_total": 2523, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953f60>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953cf8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953cc0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1465.1529302597046, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1465.1529302597046, "episode_reward_max": 487.96852713488283, "info": {"num_steps_trained": 2197258, "grad_time_ms": 10005.883, "update_time_ms": 8.012, "num_steps_sampled": 2197258, "default": {"vf_explained_var": 0.852391242980957, "policy_loss": -0.010272649116814137, "entropy": 1.284934163093567, "vf_loss": 39.51457977294922, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22500000894069672, "kl": 0.01595265232026577, "total_loss": 39.507896423339844}, "load_time_ms": 4.812, "sample_time_ms": 15880.048}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2197258, "training_iteration": 55, "date": "2019-05-21_00-39-22", "timesteps_total": 2197258, "num_metric_batches_dropped": 0, "episode_reward_mean": 463.6082760906266, "timestamp": 1558399162, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.4148701878056, "cost2_max": -17.004247658805475, "outflow_rate_min": 982.9905442916134, "system_level_velocity_max": 18.066897540569265, "outflow_rate_mean": 1201.1357969377755, "cost1_max": 220.25558918081214, "cost1_mean": 200.35391602402728, "cost2_min": -57.46958085395233, "system_level_velocity_min": 12.655086786621206, "outflow_rate_max": 1297.914839040118, "cost1_min": 151.3165285130246, "cost2_mean": -31.861345026462615}, "timesteps_this_iter": 37299, "iterations_since_restore": 56, "episode_reward_min": 382.9502533391089, "episode_len_mean": 325.0, "time_this_iter_s": 26.782700538635254, "episodes_total": 2583, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947710>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947f60>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89472b0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1491.9356307983398, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1491.9356307983398, "episode_reward_max": 490.56565469527226, "info": {"num_steps_trained": 2234557, "grad_time_ms": 10014.014, "update_time_ms": 8.041, "num_steps_sampled": 2234557, "default": {"vf_explained_var": 0.8412373661994934, "policy_loss": -0.010488193482160568, "entropy": 1.2676773071289062, "vf_loss": 48.96046829223633, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.2250000238418579, "kl": 0.014353076927363873, "total_loss": 48.95320510864258}, "load_time_ms": 4.712, "sample_time_ms": 15915.58}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2234557, "training_iteration": 56, "date": "2019-05-21_00-39-49", "timesteps_total": 2234557, "num_metric_batches_dropped": 0, "episode_reward_mean": 457.68915610165675, "timestamp": 1558399189, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.278231854181534, "cost2_max": -17.004247658805475, "outflow_rate_min": 1004.740680127275, "system_level_velocity_max": 18.008564898954575, "outflow_rate_mean": 1189.509971905409, "cost1_max": 219.1141044791763, "cost1_mean": 198.550880823562, "cost2_min": -57.99123821017912, "system_level_velocity_min": 12.66947058436407, "outflow_rate_max": 1297.6730561577237, "cost1_min": 150.65521463614056, "cost2_mean": -32.389051023262034}, "timesteps_this_iter": 37266, "iterations_since_restore": 57, "episode_reward_min": 382.9502533391089, "episode_len_mean": 325.0, "time_this_iter_s": 24.271942377090454, "episodes_total": 2623, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953b38>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956ba8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89567f0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1516.2075731754303, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1516.2075731754303, "episode_reward_max": 490.56565469527226, "info": {"num_steps_trained": 2271823, "grad_time_ms": 9802.344, "update_time_ms": 8.126, "num_steps_sampled": 2271823, "default": {"vf_explained_var": 0.8303505778312683, "policy_loss": -0.010537819005548954, "entropy": 1.2700821161270142, "vf_loss": 45.78276824951172, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.2250000238418579, "kl": 0.01600765995681286, "total_loss": 45.77582931518555}, "load_time_ms": 4.574, "sample_time_ms": 15885.485}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2271823, "training_iteration": 57, "date": "2019-05-21_00-40-13", "timesteps_total": 2271823, "num_metric_batches_dropped": 0, "episode_reward_mean": 452.8440868072651, "timestamp": 1558399213, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.251336868220765, "cost2_max": -18.209672644662092, "outflow_rate_min": 994.8150830564784, "system_level_velocity_max": 18.008564898954575, "outflow_rate_mean": 1186.605313165769, "cost1_max": 219.61522932980816, "cost1_mean": 198.31555452826188, "cost2_min": -57.99123821017912, "system_level_velocity_min": 12.66947058436407, "outflow_rate_max": 1297.3939549918327, "cost1_min": 150.65521463614056, "cost2_mean": -32.42956066133203}, "timesteps_this_iter": 37679, "iterations_since_restore": 58, "episode_reward_min": 384.72692608807495, "episode_len_mean": 325.0, "time_this_iter_s": 24.03860855102539, "episodes_total": 2663, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89533c8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953f98>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953f60>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1540.2461817264557, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1540.2461817264557, "episode_reward_max": 490.56565469527226, "info": {"num_steps_trained": 2309502, "grad_time_ms": 9669.671, "update_time_ms": 8.024, "num_steps_sampled": 2309502, "default": {"vf_explained_var": 0.8471759557723999, "policy_loss": -0.011128675192594528, "entropy": 1.2805771827697754, "vf_loss": 41.27937698364258, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.2250000238418579, "kl": 0.016270682215690613, "total_loss": 41.271907806396484}, "load_time_ms": 4.811, "sample_time_ms": 15843.856}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2309502, "training_iteration": 58, "date": "2019-05-21_00-40-37", "timesteps_total": 2309502, "num_metric_batches_dropped": 0, "episode_reward_mean": 452.23631572342754, "timestamp": 1558399237, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.37731943361213, "cost2_max": -14.847753904882861, "outflow_rate_min": 485.3813657941049, "system_level_velocity_max": 18.543372787418196, "outflow_rate_mean": 1177.4400300982961, "cost1_max": 220.60228597044195, "cost1_mean": 197.72711947084358, "cost2_min": -62.257483750564155, "system_level_velocity_min": 12.558839815120031, "outflow_rate_max": 1276.923227040816, "cost1_min": 26.405127867766943, "cost2_mean": -31.477183605491856}, "timesteps_this_iter": 37010, "iterations_since_restore": 59, "episode_reward_min": 60.64927347324391, "episode_len_mean": 322.15, "time_this_iter_s": 28.648143529891968, "episodes_total": 2724, "hostname": "flow-main", "episodes_this_iter": 61, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947cf8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947978>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947748>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1568.8943252563477, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1568.8943252563477, "episode_reward_max": 484.74634940036253, "info": {"num_steps_trained": 2346512, "grad_time_ms": 9696.527, "update_time_ms": 8.05, "num_steps_sampled": 2346512, "default": {"vf_explained_var": 0.8056074380874634, "policy_loss": -0.011010096408426762, "entropy": 1.2644740343093872, "vf_loss": 60.15227127075195, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22500000894069672, "kl": 0.0165715254843235, "total_loss": 60.144989013671875}, "load_time_ms": 4.661, "sample_time_ms": 15975.915}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2346512, "training_iteration": 59, "date": "2019-05-21_00-41-06", "timesteps_total": 2346512, "num_metric_batches_dropped": 0, "episode_reward_mean": 448.3398778672492, "timestamp": 1558399266, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.51741069507269, "cost2_max": -14.847753904882861, "outflow_rate_min": 485.3813657941049, "system_level_velocity_max": 18.543372787418196, "outflow_rate_mean": 1180.3103213869665, "cost1_max": 220.60228597044195, "cost1_mean": 199.24087189549675, "cost2_min": -62.257483750564155, "system_level_velocity_min": 12.558839815120031, "outflow_rate_max": 1301.2634339866909, "cost1_min": 26.405127867766943, "cost2_mean": -30.66370046844401}, "timesteps_this_iter": 36120, "iterations_since_restore": 60, "episode_reward_min": 60.64927347324391, "episode_len_mean": 322.15, "time_this_iter_s": 24.571196794509888, "episodes_total": 2764, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953908>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953dd8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953e48>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1593.4655220508575, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1593.4655220508575, "episode_reward_max": 484.74634940036253, "info": {"num_steps_trained": 2382632, "grad_time_ms": 9659.019, "update_time_ms": 8.086, "num_steps_sampled": 2382632, "default": {"vf_explained_var": 0.8135930299758911, "policy_loss": -0.011930670589208603, "entropy": 1.2606934309005737, "vf_loss": 46.762977600097656, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22500000894069672, "kl": 0.01691870577633381, "total_loss": 46.754852294921875}, "load_time_ms": 4.682, "sample_time_ms": 15919.786}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2382632, "training_iteration": 60, "date": "2019-05-21_00-41-31", "timesteps_total": 2382632, "num_metric_batches_dropped": 0, "episode_reward_mean": 448.0597588661212, "timestamp": 1558399291, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.56192574655144, "cost2_max": -16.28780043699433, "outflow_rate_min": 973.47878768021, "system_level_velocity_max": 18.182256049606867, "outflow_rate_mean": 1190.5064760257064, "cost1_max": 221.2639037855712, "cost1_mean": 201.7405582652822, "cost2_min": -54.23813856283212, "system_level_velocity_min": 12.73746690458232, "outflow_rate_max": 1301.2634339866909, "cost1_min": 151.9466119442029, "cost2_mean": -30.436239238609105}, "timesteps_this_iter": 36298, "iterations_since_restore": 61, "episode_reward_min": 376.10463249753906, "episode_len_mean": 325.0, "time_this_iter_s": 24.681651830673218, "episodes_total": 2804, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942978>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947da0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89537f0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1618.1471738815308, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1618.1471738815308, "episode_reward_max": 484.74634940036253, "info": {"num_steps_trained": 2418930, "grad_time_ms": 9641.35, "update_time_ms": 8.151, "num_steps_sampled": 2418930, "default": {"vf_explained_var": 0.7810389995574951, "policy_loss": -0.009415222331881523, "entropy": 1.2610247135162354, "vf_loss": 53.1422119140625, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.2250000238418579, "kl": 0.015186919830739498, "total_loss": 53.13621520996094}, "load_time_ms": 4.553, "sample_time_ms": 15906.722}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2418930, "training_iteration": 61, "date": "2019-05-21_00-41-55", "timesteps_total": 2418930, "num_metric_batches_dropped": 0, "episode_reward_mean": 451.8160740939594, "timestamp": 1558399315, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.541475387241874, "cost2_max": -20.94121875536642, "outflow_rate_min": 973.47878768021, "system_level_velocity_max": 18.19534721838119, "outflow_rate_mean": 1190.0184995615011, "cost1_max": 221.2639037855712, "cost1_mean": 201.5109904389037, "cost2_min": -52.75331686547644, "system_level_velocity_min": 12.193964324683915, "outflow_rate_max": 1287.0349976651223, "cost1_min": 145.40922946632114, "cost2_mean": -31.76861704849862}, "timesteps_this_iter": 37202, "iterations_since_restore": 62, "episode_reward_min": 366.47481589598556, "episode_len_mean": 325.0, "time_this_iter_s": 26.577363967895508, "episodes_total": 2860, "hostname": "flow-main", "episodes_this_iter": 56, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89474e0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947f28>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89470b8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1644.7245378494263, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1644.7245378494263, "episode_reward_max": 483.6554426105579, "info": {"num_steps_trained": 2456132, "grad_time_ms": 9624.433, "update_time_ms": 7.935, "num_steps_sampled": 2456132, "default": {"vf_explained_var": 0.8230082988739014, "policy_loss": -0.009462110698223114, "entropy": 1.2664729356765747, "vf_loss": 53.27163314819336, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22499999403953552, "kl": 0.014378678984940052, "total_loss": 53.26540756225586}, "load_time_ms": 4.471, "sample_time_ms": 15859.843}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2456132, "training_iteration": 62, "date": "2019-05-21_00-42-22", "timesteps_total": 2456132, "num_metric_batches_dropped": 0, "episode_reward_mean": 451.44166477841725, "timestamp": 1558399342, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.545518588412264, "cost2_max": -21.03881774426323, "outflow_rate_min": 980.2989106415973, "system_level_velocity_max": 18.19534721838119, "outflow_rate_mean": 1189.5451828210419, "cost1_max": 220.75675515396088, "cost1_mean": 201.55682359294937, "cost2_min": -56.37196965163895, "system_level_velocity_min": 12.193964324683915, "outflow_rate_max": 1283.092630005977, "cost1_min": 145.40922946632114, "cost2_mean": -32.47030760531813}, "timesteps_this_iter": 35974, "iterations_since_restore": 63, "episode_reward_min": 366.47481589598556, "episode_len_mean": 325.0, "time_this_iter_s": 24.85994577407837, "episodes_total": 2904, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939588>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939dd8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939978>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1669.5844836235046, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1669.5844836235046, "episode_reward_max": 483.6554426105579, "info": {"num_steps_trained": 2492106, "grad_time_ms": 9582.375, "update_time_ms": 7.909, "num_steps_sampled": 2492106, "default": {"vf_explained_var": 0.8755002021789551, "policy_loss": -0.01183768454939127, "entropy": 1.2613041400909424, "vf_loss": 32.568477630615234, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22500000894069672, "kl": 0.016381410881876945, "total_loss": 32.560325622558594}, "load_time_ms": 4.389, "sample_time_ms": 15820.737}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2492106, "training_iteration": 63, "date": "2019-05-21_00-42-47", "timesteps_total": 2492106, "num_metric_batches_dropped": 0, "episode_reward_mean": 451.5159985576315, "timestamp": 1558399367, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.517697564082514, "cost2_max": -12.779698000574555, "outflow_rate_min": 497.90314561688984, "system_level_velocity_max": 18.41394041298487, "outflow_rate_mean": 1185.6118545331071, "cost1_max": 221.91765465830863, "cost1_mean": 199.22856192079323, "cost2_min": -56.44195186089307, "system_level_velocity_min": 12.605282758528878, "outflow_rate_max": 1288.1241926494351, "cost1_min": 24.215642508495687, "cost2_mean": -32.86516047687786}, "timesteps_this_iter": 37445, "iterations_since_restore": 64, "episode_reward_min": 55.193331848915484, "episode_len_mean": 322.12, "time_this_iter_s": 24.644774913787842, "episodes_total": 2945, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89399b0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89533c8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89537f0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1694.2292585372925, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1694.2292585372925, "episode_reward_max": 484.33120888124074, "info": {"num_steps_trained": 2529551, "grad_time_ms": 9508.845, "update_time_ms": 8.034, "num_steps_sampled": 2529551, "default": {"vf_explained_var": 0.8236340880393982, "policy_loss": -0.009903816506266594, "entropy": 1.2740997076034546, "vf_loss": 46.75442886352539, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22500000894069672, "kl": 0.016162456944584846, "total_loss": 46.74816131591797}, "load_time_ms": 4.628, "sample_time_ms": 15879.45}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2529551, "training_iteration": 64, "date": "2019-05-21_00-43-11", "timesteps_total": 2529551, "num_metric_batches_dropped": 0, "episode_reward_mean": 448.4812145939035, "timestamp": 1558399391, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.42770085953413, "cost2_max": -12.779698000574555, "outflow_rate_min": 497.90314561688984, "system_level_velocity_max": 18.41394041298487, "outflow_rate_mean": 1189.189645833801, "cost1_max": 221.91765465830863, "cost1_mean": 198.15727927061474, "cost2_min": -56.44195186089307, "system_level_velocity_min": 12.70885271597448, "outflow_rate_max": 1296.5520313441837, "cost1_min": 24.215642508495687, "cost2_mean": -33.23631686375339}, "timesteps_this_iter": 37432, "iterations_since_restore": 65, "episode_reward_min": 55.193331848915484, "episode_len_mean": 322.12, "time_this_iter_s": 25.453935623168945, "episodes_total": 3000, "hostname": "flow-main", "episodes_this_iter": 55, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89476d8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89472b0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947a20>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1719.6831941604614, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1719.6831941604614, "episode_reward_max": 487.33699659547733, "info": {"num_steps_trained": 2566983, "grad_time_ms": 9390.302, "update_time_ms": 8.183, "num_steps_sampled": 2566983, "default": {"vf_explained_var": 0.8470761775970459, "policy_loss": -0.009401530027389526, "entropy": 1.2770661115646362, "vf_loss": 45.7537956237793, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22500000894069672, "kl": 0.0164240263402462, "total_loss": 45.74808883666992}, "load_time_ms": 4.274, "sample_time_ms": 15974.164}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2566983, "training_iteration": 65, "date": "2019-05-21_00-43-37", "timesteps_total": 2566983, "num_metric_batches_dropped": 0, "episode_reward_mean": 449.9750224584989, "timestamp": 1558399417, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.51083817650047, "cost2_max": -20.774827630959194, "outflow_rate_min": 960.5692811219697, "system_level_velocity_max": 18.241356973910996, "outflow_rate_mean": 1200.652417933595, "cost1_max": 221.9238663970523, "cost1_mean": 201.27615979079422, "cost2_min": -57.23282280346763, "system_level_velocity_min": 12.287103486449887, "outflow_rate_max": 1296.5520313441837, "cost1_min": 146.29956859541915, "cost2_mean": -32.37131098324743}, "timesteps_this_iter": 36682, "iterations_since_restore": 66, "episode_reward_min": 362.00759958003096, "episode_len_mean": 325.0, "time_this_iter_s": 26.3284752368927, "episodes_total": 3045, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943e80>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943198>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942e10>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1746.0116693973541, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1746.0116693973541, "episode_reward_max": 487.33699659547733, "info": {"num_steps_trained": 2603665, "grad_time_ms": 9361.182, "update_time_ms": 8.198, "num_steps_sampled": 2603665, "default": {"vf_explained_var": 0.8712292313575745, "policy_loss": -0.011450912803411484, "entropy": 1.2701499462127686, "vf_loss": 38.013179779052734, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.2250000238418579, "kl": 0.0167497880756855, "total_loss": 38.005496978759766}, "load_time_ms": 4.236, "sample_time_ms": 15958.448}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2603665, "training_iteration": 66, "date": "2019-05-21_00-44-03", "timesteps_total": 2603665, "num_metric_batches_dropped": 0, "episode_reward_mean": 455.658678501255, "timestamp": 1558399443, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.60655708072344, "cost2_max": -12.823956293367972, "outflow_rate_min": 495.98695534419477, "system_level_velocity_max": 18.46388801139812, "outflow_rate_mean": 1196.5999961479447, "cost1_max": 221.9238663970523, "cost1_mean": 200.46011172393025, "cost2_min": -57.23282280346763, "system_level_velocity_min": 12.287103486449887, "outflow_rate_max": 1295.2672816190986, "cost1_min": 22.997985748726382, "cost2_mean": -31.87041092524136}, "timesteps_this_iter": 36647, "iterations_since_restore": 67, "episode_reward_min": 51.69383404064522, "episode_len_mean": 322.1, "time_this_iter_s": 23.849486827850342, "episodes_total": 3086, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942c18>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942320>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942e48>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1769.8611562252045, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1769.8611562252045, "episode_reward_max": 483.9858218169604, "info": {"num_steps_trained": 2640312, "grad_time_ms": 9365.879, "update_time_ms": 8.097, "num_steps_sampled": 2640312, "default": {"vf_explained_var": 0.8694230914115906, "policy_loss": -0.009285848587751389, "entropy": 1.2687485218048096, "vf_loss": 35.7514762878418, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.2250000238418579, "kl": 0.015528322197496891, "total_loss": 35.74568176269531}, "load_time_ms": 4.211, "sample_time_ms": 15912.053}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2640312, "training_iteration": 67, "date": "2019-05-21_00-44-27", "timesteps_total": 2640312, "num_metric_batches_dropped": 0, "episode_reward_mean": 452.44339107552616, "timestamp": 1558399467, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.662862567751674, "cost2_max": -12.823956293367972, "outflow_rate_min": 495.98695534419477, "system_level_velocity_max": 18.46388801139812, "outflow_rate_mean": 1197.4752885947967, "cost1_max": 221.31722172378838, "cost1_mean": 200.99642941382547, "cost2_min": -57.23282280346763, "system_level_velocity_min": 13.03347922704463, "outflow_rate_max": 1295.2672816190986, "cost1_min": 22.997985748726382, "cost2_mean": -31.407437871031643}, "timesteps_this_iter": 36672, "iterations_since_restore": 68, "episode_reward_min": 51.69383404064522, "episode_len_mean": 322.1, "time_this_iter_s": 23.427322387695312, "episodes_total": 3126, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89470f0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89477f0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89476a0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1793.2884786128998, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1793.2884786128998, "episode_reward_max": 484.2317960326348, "info": {"num_steps_trained": 2676984, "grad_time_ms": 9355.581, "update_time_ms": 8.162, "num_steps_sampled": 2676984, "default": {"vf_explained_var": 0.8532423973083496, "policy_loss": -0.009404237382113934, "entropy": 1.2813788652420044, "vf_loss": 39.506103515625, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.2250000238418579, "kl": 0.01605551689863205, "total_loss": 39.500308990478516}, "load_time_ms": 3.786, "sample_time_ms": 15863.005}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2676984, "training_iteration": 68, "date": "2019-05-21_00-44-51", "timesteps_total": 2676984, "num_metric_batches_dropped": 0, "episode_reward_mean": 452.17457460381223, "timestamp": 1558399491, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.6713600425568, "cost2_max": -20.050947819905844, "outflow_rate_min": 967.0612654668165, "system_level_velocity_max": 18.207184806310718, "outflow_rate_mean": 1206.504829535278, "cost1_max": 221.34420191830975, "cost1_mean": 203.10585292780937, "cost2_min": -58.084584529706746, "system_level_velocity_min": 12.395246617104883, "outflow_rate_max": 1292.0768546817762, "cost1_min": 147.19986384992794, "cost2_mean": -31.568677124289266}, "timesteps_this_iter": 36679, "iterations_since_restore": 69, "episode_reward_min": 367.39871250791214, "episode_len_mean": 325.0, "time_this_iter_s": 26.158169984817505, "episodes_total": 3186, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89430b8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943c88>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943198>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1819.4466485977173, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1819.4466485977173, "episode_reward_max": 484.2317960326348, "info": {"num_steps_trained": 2713663, "grad_time_ms": 9268.816, "update_time_ms": 8.098, "num_steps_sampled": 2713663, "default": {"vf_explained_var": 0.8566057682037354, "policy_loss": -0.010090462863445282, "entropy": 1.277707815170288, "vf_loss": 46.14738082885742, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.2250000238418579, "kl": 0.016066117212176323, "total_loss": 46.14090347290039}, "load_time_ms": 3.572, "sample_time_ms": 15700.951}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2713663, "training_iteration": 69, "date": "2019-05-21_00-45-17", "timesteps_total": 2713663, "num_metric_batches_dropped": 0, "episode_reward_mean": 457.03256487131165, "timestamp": 1558399517, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.638109390936116, "cost2_max": -19.92391726370707, "outflow_rate_min": 967.0612654668165, "system_level_velocity_max": 18.175151681427977, "outflow_rate_mean": 1205.3611711871133, "cost1_max": 221.70793036809522, "cost1_mean": 202.6595777635177, "cost2_min": -58.084584529706746, "system_level_velocity_min": 12.395246617104883, "outflow_rate_max": 1295.233826657744, "cost1_min": 147.19986384992794, "cost2_mean": -31.898095176444144}, "timesteps_this_iter": 36660, "iterations_since_restore": 70, "episode_reward_min": 367.39871250791214, "episode_len_mean": 325.0, "time_this_iter_s": 24.93052339553833, "episodes_total": 3226, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943cc0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943550>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943cf8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1844.3771719932556, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1844.3771719932556, "episode_reward_max": 484.60289441077396, "info": {"num_steps_trained": 2750323, "grad_time_ms": 9276.768, "update_time_ms": 8.018, "num_steps_sampled": 2750323, "default": {"vf_explained_var": 0.8636011481285095, "policy_loss": -0.010344339534640312, "entropy": 1.2708358764648438, "vf_loss": 39.520111083984375, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.2250000238418579, "kl": 0.016209129244089127, "total_loss": 39.51342010498047}, "load_time_ms": 3.381, "sample_time_ms": 15728.599}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2750323, "training_iteration": 70, "date": "2019-05-21_00-45-42", "timesteps_total": 2750323, "num_metric_batches_dropped": 0, "episode_reward_mean": 457.05662359854944, "timestamp": 1558399542, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.581507035056212, "cost2_max": -19.92391726370707, "outflow_rate_min": 967.0612654668165, "system_level_velocity_max": 18.30399982422267, "outflow_rate_mean": 1203.9312585570922, "cost1_max": 222.8977457524112, "cost1_mean": 201.78958860362818, "cost2_min": -58.084584529706746, "system_level_velocity_min": 12.395246617104883, "outflow_rate_max": 1295.233826657744, "cost1_min": 147.19986384992794, "cost2_mean": -32.57067620308}, "timesteps_this_iter": 37384, "iterations_since_restore": 71, "episode_reward_min": 367.39871250791214, "episode_len_mean": 325.0, "time_this_iter_s": 25.377099990844727, "episodes_total": 3266, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89530f0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953748>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953588>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1869.7542719841003, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1869.7542719841003, "episode_reward_max": 484.60289441077396, "info": {"num_steps_trained": 2787707, "grad_time_ms": 9309.563, "update_time_ms": 8.024, "num_steps_sampled": 2787707, "default": {"vf_explained_var": 0.865888237953186, "policy_loss": -0.009533554315567017, "entropy": 1.2827051877975464, "vf_loss": 39.74220275878906, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22500000894069672, "kl": 0.016637422144412994, "total_loss": 39.73641586303711}, "load_time_ms": 3.421, "sample_time_ms": 15765.67}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2787707, "training_iteration": 71, "date": "2019-05-21_00-46-07", "timesteps_total": 2787707, "num_metric_batches_dropped": 0, "episode_reward_mean": 455.09768296029034, "timestamp": 1558399567, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.40977779589712, "cost2_max": -20.125622307521184, "outflow_rate_min": 953.2781455089606, "system_level_velocity_max": 18.30399982422267, "outflow_rate_mean": 1197.931955408677, "cost1_max": 222.8977457524112, "cost1_mean": 199.4517218885901, "cost2_min": -57.09914842525114, "system_level_velocity_min": 11.519049110218047, "outflow_rate_max": 1300.293725135624, "cost1_min": 139.6016139329997, "cost2_mean": -33.664543903217975}, "timesteps_this_iter": 37790, "iterations_since_restore": 72, "episode_reward_min": 359.16935275983155, "episode_len_mean": 325.0, "time_this_iter_s": 28.230122804641724, "episodes_total": 3326, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89428d0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89539e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953b38>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1897.984394788742, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1897.984394788742, "episode_reward_max": 488.2975268330091, "info": {"num_steps_trained": 2825497, "grad_time_ms": 9325.856, "update_time_ms": 8.027, "num_steps_sampled": 2825497, "default": {"vf_explained_var": 0.8680197596549988, "policy_loss": -0.01081566046923399, "entropy": 1.2858226299285889, "vf_loss": 48.235225677490234, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.2250000238418579, "kl": 0.017992140725255013, "total_loss": 48.22845458984375}, "load_time_ms": 3.676, "sample_time_ms": 15913.973}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2825497, "training_iteration": 72, "date": "2019-05-21_00-46-36", "timesteps_total": 2825497, "num_metric_batches_dropped": 0, "episode_reward_mean": 451.27016687506875, "timestamp": 1558399596, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.424131093862773, "cost2_max": -20.807228959705338, "outflow_rate_min": 953.2781455089606, "system_level_velocity_max": 18.285128633685197, "outflow_rate_mean": 1197.7164047279468, "cost1_max": 222.22363132007666, "cost1_mean": 199.72083776122065, "cost2_min": -57.35396946974197, "system_level_velocity_min": 11.519049110218047, "outflow_rate_max": 1300.293725135624, "cost1_min": 139.6016139329997, "cost2_mean": -33.79241583026345}, "timesteps_this_iter": 36802, "iterations_since_restore": 73, "episode_reward_min": 359.16935275983155, "episode_len_mean": 325.0, "time_this_iter_s": 23.983766555786133, "episodes_total": 3366, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89436d8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943fd0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89432e8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1921.9681613445282, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1921.9681613445282, "episode_reward_max": 488.2975268330091, "info": {"num_steps_trained": 2862299, "grad_time_ms": 9316.656, "update_time_ms": 7.953, "num_steps_sampled": 2862299, "default": {"vf_explained_var": 0.8533822298049927, "policy_loss": -0.011428830213844776, "entropy": 1.292884111404419, "vf_loss": 38.87949752807617, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.2250000387430191, "kl": 0.0154662961140275, "total_loss": 38.871551513671875}, "load_time_ms": 3.801, "sample_time_ms": 15837.661}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2862299, "training_iteration": 73, "date": "2019-05-21_00-47-00", "timesteps_total": 2862299, "num_metric_batches_dropped": 0, "episode_reward_mean": 452.00994062644355, "timestamp": 1558399620, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.416515655251782, "cost2_max": -19.667612107945377, "outflow_rate_min": 1012.9846446740037, "system_level_velocity_max": 18.285128633685197, "outflow_rate_mean": 1197.7598222220922, "cost1_max": 222.22363132007666, "cost1_mean": 199.69851402349246, "cost2_min": -59.5796949140623, "system_level_velocity_min": 10.84199422488575, "outflow_rate_max": 1298.006642117521, "cost1_min": 131.18847896023146, "cost2_mean": -34.012854337879936}, "timesteps_this_iter": 37521, "iterations_since_restore": 74, "episode_reward_min": 394.0726526088017, "episode_len_mean": 325.0, "time_this_iter_s": 24.663400888442993, "episodes_total": 3406, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939940>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947b38>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947780>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1946.6315622329712, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1946.6315622329712, "episode_reward_max": 486.062543621233, "info": {"num_steps_trained": 2899820, "grad_time_ms": 9406.05, "update_time_ms": 7.809, "num_steps_sampled": 2899820, "default": {"vf_explained_var": 0.8406676650047302, "policy_loss": -0.011051293462514877, "entropy": 1.2961570024490356, "vf_loss": 45.385433197021484, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.22500000894069672, "kl": 0.016393758356571198, "total_loss": 45.37806701660156}, "load_time_ms": 3.948, "sample_time_ms": 15749.918}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2899820, "training_iteration": 74, "date": "2019-05-21_00-47-24", "timesteps_total": 2899820, "num_metric_batches_dropped": 0, "episode_reward_mean": 451.9537041217199, "timestamp": 1558399644, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.45564567927589, "cost2_max": -19.667612107945377, "outflow_rate_min": 996.7045899513038, "system_level_velocity_max": 18.25348345699057, "outflow_rate_mean": 1199.2546935876132, "cost1_max": 222.19548270608595, "cost1_mean": 200.1273077101523, "cost2_min": -59.5796949140623, "system_level_velocity_min": 10.84199422488575, "outflow_rate_max": 1307.2216667071814, "cost1_min": 131.18847896023146, "cost2_mean": -33.74935936340797}, "timesteps_this_iter": 37354, "iterations_since_restore": 75, "episode_reward_min": 386.84714395433076, "episode_len_mean": 325.0, "time_this_iter_s": 26.193395137786865, "episodes_total": 3460, "hostname": "flow-main", "episodes_this_iter": 54, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939d30>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947940>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953cf8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1972.824957370758, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1972.824957370758, "episode_reward_max": 486.062543621233, "info": {"num_steps_trained": 2937174, "grad_time_ms": 9509.232, "update_time_ms": 7.604, "num_steps_sampled": 2937174, "default": {"vf_explained_var": 0.8464224338531494, "policy_loss": -0.011697459034621716, "entropy": 1.2939422130584717, "vf_loss": 47.79462814331055, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.2250000238418579, "kl": 0.018071113154292107, "total_loss": 47.78699493408203}, "load_time_ms": 4.067, "sample_time_ms": 15721.158}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2937174, "training_iteration": 75, "date": "2019-05-21_00-47-51", "timesteps_total": 2937174, "num_metric_batches_dropped": 0, "episode_reward_mean": 452.2092437917719, "timestamp": 1558399671, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.557780620693006, "cost2_max": -19.448034250935354, "outflow_rate_min": 996.7045899513038, "system_level_velocity_max": 18.29565426997524, "outflow_rate_mean": 1201.056414294691, "cost1_max": 222.16718336482825, "cost1_mean": 201.4215359246637, "cost2_min": -57.64920853287159, "system_level_velocity_min": 12.700010817736004, "outflow_rate_max": 1307.2216667071814, "cost1_min": 151.65490126676298, "cost2_mean": -32.573096795951976}, "timesteps_this_iter": 35635, "iterations_since_restore": 76, "episode_reward_min": 371.8015404693335, "episode_len_mean": 325.0, "time_this_iter_s": 24.712103605270386, "episodes_total": 3506, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942780>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956278>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956f28>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 1997.5370609760284, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 1997.5370609760284, "episode_reward_max": 485.6616732868391, "info": {"num_steps_trained": 2972809, "grad_time_ms": 9478.32, "update_time_ms": 7.63, "num_steps_sampled": 2972809, "default": {"vf_explained_var": 0.790634036064148, "policy_loss": -0.011413414031267166, "entropy": 1.2771494388580322, "vf_loss": 50.098873138427734, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.2250000238418579, "kl": 0.020034128800034523, "total_loss": 50.09197235107422}, "load_time_ms": 4.259, "sample_time_ms": 15590.29}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2972809, "training_iteration": 76, "date": "2019-05-21_00-48-15", "timesteps_total": 2972809, "num_metric_batches_dropped": 0, "episode_reward_mean": 452.8163757649395, "timestamp": 1558399695, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.6355364260676, "cost2_max": -19.448034250935354, "outflow_rate_min": 999.0765685926974, "system_level_velocity_max": 18.29565426997524, "outflow_rate_mean": 1199.8816366997582, "cost1_max": 222.16718336482825, "cost1_mean": 202.40246537104488, "cost2_min": -54.42297316067875, "system_level_velocity_min": 12.74607770296295, "outflow_rate_max": 1307.2216667071814, "cost1_min": 152.23683782986762, "cost2_mean": -31.718885212221082}, "timesteps_this_iter": 36085, "iterations_since_restore": 77, "episode_reward_min": 371.8015404693335, "episode_len_mean": 325.0, "time_this_iter_s": 24.24239444732666, "episodes_total": 3546, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943198>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943710>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943978>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2021.779455423355, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2021.779455423355, "episode_reward_max": 485.6616732868391, "info": {"num_steps_trained": 3008894, "grad_time_ms": 9560.08, "update_time_ms": 7.585, "num_steps_sampled": 3008894, "default": {"vf_explained_var": 0.8403588533401489, "policy_loss": -0.011858672834932804, "entropy": 1.2797117233276367, "vf_loss": 41.34249496459961, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.014024934731423855, "total_loss": 41.33537292480469}, "load_time_ms": 4.506, "sample_time_ms": 15547.708}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3008894, "training_iteration": 77, "date": "2019-05-21_00-48-40", "timesteps_total": 3008894, "num_metric_batches_dropped": 0, "episode_reward_mean": 452.29085334349287, "timestamp": 1558399720, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.567095565888714, "cost2_max": -19.872288489513867, "outflow_rate_min": 963.3139716097857, "system_level_velocity_max": 18.34956875746308, "outflow_rate_mean": 1189.1883533822208, "cost1_max": 222.415609728491, "cost1_mean": 201.35398426388033, "cost2_min": -53.44159766501623, "system_level_velocity_min": 12.693821906486225, "outflow_rate_max": 1294.9938416240793, "cost1_min": 150.8059471195319, "cost2_mean": -32.03953952044836}, "timesteps_this_iter": 36771, "iterations_since_restore": 78, "episode_reward_min": 359.1571093489922, "episode_len_mean": 325.0, "time_this_iter_s": 26.071638822555542, "episodes_total": 3600, "hostname": "flow-main", "episodes_this_iter": 54, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953e80>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953438>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953470>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2047.8510942459106, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2047.8510942459106, "episode_reward_max": 482.5840861550073, "info": {"num_steps_trained": 3045665, "grad_time_ms": 9679.454, "update_time_ms": 7.57, "num_steps_sampled": 3045665, "default": {"vf_explained_var": 0.7816484570503235, "policy_loss": -0.011248367838561535, "entropy": 1.2928434610366821, "vf_loss": 62.83803939819336, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.3375000059604645, "kl": 0.014231170527637005, "total_loss": 62.83159637451172}, "load_time_ms": 4.848, "sample_time_ms": 15691.887}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3045665, "training_iteration": 78, "date": "2019-05-21_00-49-06", "timesteps_total": 3045665, "num_metric_batches_dropped": 0, "episode_reward_mean": 447.34454638225253, "timestamp": 1558399746, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.4718839661886, "cost2_max": -20.43314446023305, "outflow_rate_min": 963.3139716097857, "system_level_velocity_max": 18.34956875746308, "outflow_rate_mean": 1183.9149813408658, "cost1_max": 222.415609728491, "cost1_mean": 200.0500559502453, "cost2_min": -53.44159766501623, "system_level_velocity_min": 12.693821906486225, "outflow_rate_max": 1294.9938416240793, "cost1_min": 150.8059471195319, "cost2_mean": -31.982665273157778}, "timesteps_this_iter": 36195, "iterations_since_restore": 79, "episode_reward_min": 359.1571093489922, "episode_len_mean": 325.0, "time_this_iter_s": 25.687474489212036, "episodes_total": 3646, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89562b0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956550>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89564a8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2073.5385687351227, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2073.5385687351227, "episode_reward_max": 482.5840861550073, "info": {"num_steps_trained": 3081860, "grad_time_ms": 9675.954, "update_time_ms": 7.642, "num_steps_sampled": 3081860, "default": {"vf_explained_var": 0.812065839767456, "policy_loss": -0.00993911549448967, "entropy": 1.2702996730804443, "vf_loss": 47.56974792480469, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.012668168172240257, "total_loss": 47.5640869140625}, "load_time_ms": 4.979, "sample_time_ms": 15649.189}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3081860, "training_iteration": 79, "date": "2019-05-21_00-49-31", "timesteps_total": 3081860, "num_metric_batches_dropped": 0, "episode_reward_mean": 444.4765689086526, "timestamp": 1558399771, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.328684992250324, "cost2_max": -20.43314446023305, "outflow_rate_min": 976.064006436877, "system_level_velocity_max": 18.29853189168444, "outflow_rate_mean": 1177.0956252786245, "cost1_max": 222.24334475621532, "cost1_mean": 198.36583017135436, "cost2_min": -51.14681901244724, "system_level_velocity_min": 12.197795708004204, "outflow_rate_max": 1293.2446472871886, "cost1_min": 152.09720328677747, "cost2_mean": -32.604211654961084}, "timesteps_this_iter": 36093, "iterations_since_restore": 80, "episode_reward_min": 365.69238800613005, "episode_len_mean": 325.0, "time_this_iter_s": 22.837745904922485, "episodes_total": 3686, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943ba8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943c18>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943588>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2096.376314640045, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2096.376314640045, "episode_reward_max": 479.90708448303053, "info": {"num_steps_trained": 3117953, "grad_time_ms": 9551.031, "update_time_ms": 7.688, "num_steps_sampled": 3117953, "default": {"vf_explained_var": 0.8159305453300476, "policy_loss": -0.011616237461566925, "entropy": 1.2901644706726074, "vf_loss": 45.422306060791016, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.014028999954462051, "total_loss": 45.41542434692383}, "load_time_ms": 5.218, "sample_time_ms": 15564.66}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3117953, "training_iteration": 80, "date": "2019-05-21_00-49-54", "timesteps_total": 3117953, "num_metric_batches_dropped": 0, "episode_reward_mean": 441.6931990601144, "timestamp": 1558399794, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.476968859078514, "cost2_max": -17.282914020586844, "outflow_rate_min": 976.064006436877, "system_level_velocity_max": 18.316315066844762, "outflow_rate_mean": 1184.025289549687, "cost1_max": 223.03833488027658, "cost1_mean": 200.21524881030572, "cost2_min": -51.14681901244724, "system_level_velocity_min": 12.197795708004204, "outflow_rate_max": 1293.2446472871886, "cost1_min": 150.24763352255366, "cost2_mean": -31.80042163820717}, "timesteps_this_iter": 35334, "iterations_since_restore": 81, "episode_reward_min": 365.69238800613005, "episode_len_mean": 325.0, "time_this_iter_s": 23.793390035629272, "episodes_total": 3726, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953240>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953470>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953208>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2120.1697046756744, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2120.1697046756744, "episode_reward_max": 479.90708448303053, "info": {"num_steps_trained": 3153287, "grad_time_ms": 9478.539, "update_time_ms": 7.698, "num_steps_sampled": 3153287, "default": {"vf_explained_var": 0.7782506346702576, "policy_loss": -0.011627431027591228, "entropy": 1.3040587902069092, "vf_loss": 48.902713775634766, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.014479701407253742, "total_loss": 48.895973205566406}, "load_time_ms": 5.055, "sample_time_ms": 15480.226}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3153287, "training_iteration": 81, "date": "2019-05-21_00-50-18", "timesteps_total": 3153287, "num_metric_batches_dropped": 0, "episode_reward_mean": 444.4340591206262, "timestamp": 1558399818, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.713952446758675, "cost2_max": -17.282914020586844, "outflow_rate_min": 982.2221926910299, "system_level_velocity_max": 18.350997449006236, "outflow_rate_mean": 1192.9895256928776, "cost1_max": 223.03833488027658, "cost1_mean": 203.23442807577356, "cost2_min": -50.107833656341676, "system_level_velocity_min": 12.314505834270424, "outflow_rate_max": 1287.017445063761, "cost1_min": 150.24763352255366, "cost2_mean": -30.645436908310913}, "timesteps_this_iter": 36173, "iterations_since_restore": 82, "episode_reward_min": 372.2820178340813, "episode_len_mean": 325.0, "time_this_iter_s": 26.455029487609863, "episodes_total": 3786, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89562b0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956470>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89564a8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2146.6247341632843, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2146.6247341632843, "episode_reward_max": 480.7830106158091, "info": {"num_steps_trained": 3189460, "grad_time_ms": 9424.69, "update_time_ms": 7.714, "num_steps_sampled": 3189460, "default": {"vf_explained_var": 0.7722386717796326, "policy_loss": -0.009580206125974655, "entropy": 1.301839828491211, "vf_loss": 63.979007720947266, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.012009285390377045, "total_loss": 63.973480224609375}, "load_time_ms": 4.96, "sample_time_ms": 15355.389}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3189460, "training_iteration": 82, "date": "2019-05-21_00-50-45", "timesteps_total": 3189460, "num_metric_batches_dropped": 0, "episode_reward_mean": 448.9239867978286, "timestamp": 1558399845, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.73115368778488, "cost2_max": -14.173215105044418, "outflow_rate_min": 475.6851915157954, "system_level_velocity_max": 18.641528830922415, "outflow_rate_mean": 1178.9177020113548, "cost1_max": 222.20834451403522, "cost1_mean": 199.44852271761306, "cost2_min": -53.157591011654695, "system_level_velocity_min": 12.622755908570412, "outflow_rate_max": 1285.6033711666482, "cost1_min": 22.917655052798995, "cost2_mean": -30.378978830037468}, "timesteps_this_iter": 35649, "iterations_since_restore": 83, "episode_reward_min": 52.46209192647106, "episode_len_mean": 319.22, "time_this_iter_s": 23.33259677886963, "episodes_total": 3828, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943278>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943a20>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943588>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2169.957330942154, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2169.957330942154, "episode_reward_max": 482.0961893396503, "info": {"num_steps_trained": 3225109, "grad_time_ms": 9299.676, "update_time_ms": 7.792, "num_steps_sampled": 3225109, "default": {"vf_explained_var": 0.7606966495513916, "policy_loss": -0.011079749092459679, "entropy": 1.3127003908157349, "vf_loss": 54.79941940307617, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.013825478963553905, "total_loss": 54.79300308227539}, "load_time_ms": 4.971, "sample_time_ms": 15415.167}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3225109, "training_iteration": 83, "date": "2019-05-21_00-51-08", "timesteps_total": 3225109, "num_metric_batches_dropped": 0, "episode_reward_mean": 441.46138818464397, "timestamp": 1558399868, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.798387366738208, "cost2_max": -14.173215105044418, "outflow_rate_min": 475.6851915157954, "system_level_velocity_max": 18.641528830922415, "outflow_rate_mean": 1182.50856599159, "cost1_max": 221.87392031802113, "cost1_mean": 200.33760615942708, "cost2_min": -53.157591011654695, "system_level_velocity_min": 12.622755908570412, "outflow_rate_max": 1287.4517661311124, "cost1_min": 22.917655052798995, "cost2_mean": -30.43653014743289}, "timesteps_this_iter": 36426, "iterations_since_restore": 84, "episode_reward_min": 52.46209192647106, "episode_len_mean": 319.22, "time_this_iter_s": 24.76263165473938, "episodes_total": 3868, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89534e0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953390>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953470>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2194.7199625968933, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2194.7199625968933, "episode_reward_max": 482.0961893396503, "info": {"num_steps_trained": 3261535, "grad_time_ms": 9278.366, "update_time_ms": 7.762, "num_steps_sampled": 3261535, "default": {"vf_explained_var": 0.8181176781654358, "policy_loss": -0.013204062357544899, "entropy": 1.324277639389038, "vf_loss": 44.165794372558594, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01382187195122242, "total_loss": 44.157257080078125}, "load_time_ms": 4.698, "sample_time_ms": 15446.535}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3261535, "training_iteration": 84, "date": "2019-05-21_00-51-33", "timesteps_total": 3261535, "num_metric_batches_dropped": 0, "episode_reward_mean": 443.92983963878197, "timestamp": 1558399893, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.53430757130683, "cost2_max": -18.895234013406686, "outflow_rate_min": 979.1174735257476, "system_level_velocity_max": 18.23446960117776, "outflow_rate_mean": 1185.7922132620888, "cost1_max": 221.56861490309572, "cost1_mean": 200.89680102828967, "cost2_min": -54.495810977583126, "system_level_velocity_min": 12.94234197635573, "outflow_rate_max": 1287.4517661311124, "cost1_min": 154.68065267775899, "cost2_mean": -31.943535677526405}, "timesteps_this_iter": 36954, "iterations_since_restore": 85, "episode_reward_min": 375.67283382547515, "episode_len_mean": 325.0, "time_this_iter_s": 25.492250680923462, "episodes_total": 3928, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943198>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943cf8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943518>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2220.2122132778168, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2220.2122132778168, "episode_reward_max": 481.1070741096822, "info": {"num_steps_trained": 3298489, "grad_time_ms": 9161.309, "update_time_ms": 8.099, "num_steps_sampled": 3298489, "default": {"vf_explained_var": 0.81332927942276, "policy_loss": -0.010661633685231209, "entropy": 1.3221262693405151, "vf_loss": 56.704105377197266, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.012774978764355183, "total_loss": 56.69775390625}, "load_time_ms": 4.867, "sample_time_ms": 15493.506}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3298489, "training_iteration": 85, "date": "2019-05-21_00-51-58", "timesteps_total": 3298489, "num_metric_batches_dropped": 0, "episode_reward_mean": 448.9336075636612, "timestamp": 1558399918, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.32367982412024, "cost2_max": -20.375869066488963, "outflow_rate_min": 979.1174735257476, "system_level_velocity_max": 18.355906876585923, "outflow_rate_mean": 1178.4721661449362, "cost1_max": 221.56861490309572, "cost1_mean": 198.14728177301495, "cost2_min": -54.495810977583126, "system_level_velocity_min": 12.94234197635573, "outflow_rate_max": 1283.843431144301, "cost1_min": 154.68065267775899, "cost2_mean": -33.02493424782711}, "timesteps_this_iter": 36476, "iterations_since_restore": 86, "episode_reward_min": 375.67283382547515, "episode_len_mean": 325.0, "time_this_iter_s": 22.938170671463013, "episodes_total": 3968, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89436d8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943978>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943588>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2243.15038394928, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2243.15038394928, "episode_reward_max": 480.62446338867215, "info": {"num_steps_trained": 3334965, "grad_time_ms": 9081.138, "update_time_ms": 8.007, "num_steps_sampled": 3334965, "default": {"vf_explained_var": 0.8389081358909607, "policy_loss": -0.011884626001119614, "entropy": 1.3002568483352661, "vf_loss": 41.4090461730957, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.013724306598305702, "total_loss": 41.401790618896484}, "load_time_ms": 4.642, "sample_time_ms": 15396.291}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3334965, "training_iteration": 86, "date": "2019-05-21_00-52-21", "timesteps_total": 3334965, "num_metric_batches_dropped": 0, "episode_reward_mean": 445.7959935276021, "timestamp": 1558399941, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.520862028466794, "cost2_max": -18.312199341790812, "outflow_rate_min": 979.1174735257476, "system_level_velocity_max": 18.355906876585923, "outflow_rate_mean": 1189.3392317833554, "cost1_max": 221.3739924736964, "cost1_mean": 200.73274075669053, "cost2_min": -51.399884439327806, "system_level_velocity_min": 12.94234197635573, "outflow_rate_max": 1277.7190477092265, "cost1_min": 156.01358838810233, "cost2_mean": -32.140176238104274}, "timesteps_this_iter": 35685, "iterations_since_restore": 87, "episode_reward_min": 387.6981465675495, "episode_len_mean": 325.0, "time_this_iter_s": 23.92896294593811, "episodes_total": 4008, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89436a0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943470>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89438d0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2267.079346895218, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2267.079346895218, "episode_reward_max": 479.0020862004506, "info": {"num_steps_trained": 3370650, "grad_time_ms": 9073.168, "update_time_ms": 8.032, "num_steps_sampled": 3370650, "default": {"vf_explained_var": 0.7769641280174255, "policy_loss": -0.009957254864275455, "entropy": 1.3049685955047607, "vf_loss": 48.470069885253906, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.012749898247420788, "total_loss": 48.46441650390625}, "load_time_ms": 4.744, "sample_time_ms": 15372.17}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3370650, "training_iteration": 87, "date": "2019-05-21_00-52-45", "timesteps_total": 3370650, "num_metric_batches_dropped": 0, "episode_reward_mean": 449.87327708726565, "timestamp": 1558399965, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.70701236061944, "cost2_max": -15.033073342197701, "outflow_rate_min": 479.27864688977405, "system_level_velocity_max": 18.706983048338948, "outflow_rate_mean": 1187.6029256368906, "cost1_max": 222.1303414999847, "cost1_mean": 200.87362317462504, "cost2_min": -49.721667733969824, "system_level_velocity_min": 12.865079603343483, "outflow_rate_max": 1306.4882783882783, "cost1_min": 24.532415194527452, "cost2_mean": -30.328888923635844}, "timesteps_this_iter": 36116, "iterations_since_restore": 88, "episode_reward_min": 56.31148313917397, "episode_len_mean": 322.12, "time_this_iter_s": 25.778849840164185, "episodes_total": 4060, "hostname": "flow-main", "episodes_this_iter": 52, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942dd8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89423c8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942828>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2292.858196735382, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2292.858196735382, "episode_reward_max": 479.0020862004506, "info": {"num_steps_trained": 3406766, "grad_time_ms": 9072.264, "update_time_ms": 7.955, "num_steps_sampled": 3406766, "default": {"vf_explained_var": 0.7834503054618835, "policy_loss": -0.009958296082913876, "entropy": 1.3014061450958252, "vf_loss": 63.42201232910156, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.013512286357581615, "total_loss": 63.41661834716797}, "load_time_ms": 4.76, "sample_time_ms": 15343.828}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3406766, "training_iteration": 88, "date": "2019-05-21_00-53-11", "timesteps_total": 3406766, "num_metric_batches_dropped": 0, "episode_reward_mean": 446.8345945504882, "timestamp": 1558399991, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.80788627195641, "cost2_max": -14.43002869497062, "outflow_rate_min": 474.6847293557321, "system_level_velocity_max": 18.706983048338948, "outflow_rate_mean": 1181.342749934387, "cost1_max": 223.02186962255618, "cost1_mean": 199.8617158788199, "cost2_min": -48.009659203787166, "system_level_velocity_min": 12.865079603343483, "outflow_rate_max": 1306.4882783882783, "cost1_min": 23.08776397761607, "cost2_mean": -30.176358835319014}, "timesteps_this_iter": 35955, "iterations_since_restore": 89, "episode_reward_min": 53.51450746699179, "episode_len_mean": 319.22, "time_this_iter_s": 25.54031753540039, "episodes_total": 4110, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943a58>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943d68>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89435c0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2318.3985142707825, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2318.3985142707825, "episode_reward_max": 479.4856973090267, "info": {"num_steps_trained": 3442721, "grad_time_ms": 9066.11, "update_time_ms": 7.948, "num_steps_sampled": 3442721, "default": {"vf_explained_var": 0.8334558010101318, "policy_loss": -0.010552161373198032, "entropy": 1.2893069982528687, "vf_loss": 46.053306579589844, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.013867855072021484, "total_loss": 46.04743194580078}, "load_time_ms": 4.779, "sample_time_ms": 15334.673}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3442721, "training_iteration": 89, "date": "2019-05-21_00-53-37", "timesteps_total": 3442721, "num_metric_batches_dropped": 0, "episode_reward_mean": 442.03252036086684, "timestamp": 1558400017, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.696685506898312, "cost2_max": -14.43002869497062, "outflow_rate_min": 474.6847293557321, "system_level_velocity_max": 18.706983048338948, "outflow_rate_mean": 1177.0477098665544, "cost1_max": 223.02186962255618, "cost1_mean": 197.8905434451313, "cost2_min": -48.99816491922526, "system_level_velocity_min": 12.497465835532513, "outflow_rate_max": 1287.3722639225182, "cost1_min": 23.08776397761607, "cost2_mean": -31.021783404029954}, "timesteps_this_iter": 36563, "iterations_since_restore": 90, "episode_reward_min": 53.51450746699179, "episode_len_mean": 318.12, "time_this_iter_s": 23.376694917678833, "episodes_total": 4151, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89427b8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942b70>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942fd0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2341.7752091884613, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2341.7752091884613, "episode_reward_max": 479.4856973090267, "info": {"num_steps_trained": 3479284, "grad_time_ms": 9073.62, "update_time_ms": 7.866, "num_steps_sampled": 3479284, "default": {"vf_explained_var": 0.8363199830055237, "policy_loss": -0.010437142103910446, "entropy": 1.29496431350708, "vf_loss": 46.92036437988281, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.013522045686841011, "total_loss": 46.914485931396484}, "load_time_ms": 4.836, "sample_time_ms": 15380.553}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3479284, "training_iteration": 90, "date": "2019-05-21_00-54-00", "timesteps_total": 3479284, "num_metric_batches_dropped": 0, "episode_reward_mean": 439.93671328182006, "timestamp": 1558400040, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.818117539992333, "cost2_max": -14.43002869497062, "outflow_rate_min": 474.6847293557321, "system_level_velocity_max": 18.49915559617682, "outflow_rate_mean": 1194.9146801940033, "cost1_max": 223.02186962255618, "cost1_mean": 201.49972051059137, "cost2_min": -50.45342970054957, "system_level_velocity_min": 12.497465835532513, "outflow_rate_max": 1293.887075696295, "cost1_min": 23.08776397761607, "cost2_mean": -30.723934445215935}, "timesteps_this_iter": 36126, "iterations_since_restore": 91, "episode_reward_min": 53.51450746699179, "episode_len_mean": 321.0, "time_this_iter_s": 25.566474437713623, "episodes_total": 4200, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943438>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943cc0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943128>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2367.341683626175, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2367.341683626175, "episode_reward_max": 484.1308024422979, "info": {"num_steps_trained": 3515410, "grad_time_ms": 9103.065, "update_time_ms": 7.853, "num_steps_sampled": 3515410, "default": {"vf_explained_var": 0.7665785551071167, "policy_loss": -0.012212023138999939, "entropy": 1.292412519454956, "vf_loss": 61.405860900878906, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.015943696722388268, "total_loss": 61.39903259277344}, "load_time_ms": 4.895, "sample_time_ms": 15527.409}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3515410, "training_iteration": 91, "date": "2019-05-21_00-54-26", "timesteps_total": 3515410, "num_metric_batches_dropped": 0, "episode_reward_mean": 447.9541919130645, "timestamp": 1558400066, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.85365211118275, "cost2_max": -17.82188078020584, "outflow_rate_min": 1004.8176411960131, "system_level_velocity_max": 18.47709200573212, "outflow_rate_mean": 1207.0048647771885, "cost1_max": 223.2841115193046, "cost1_mean": 204.6899622416071, "cost2_min": -56.80354678821503, "system_level_velocity_min": 12.877422665404797, "outflow_rate_max": 1293.887075696295, "cost1_min": 153.77081604359097, "cost2_mean": -31.264823535876126}, "timesteps_this_iter": 36297, "iterations_since_restore": 92, "episode_reward_min": 376.491323462726, "episode_len_mean": 325.0, "time_this_iter_s": 24.1934552192688, "episodes_total": 4250, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89433c8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943dd8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943400>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2391.5351388454437, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2391.5351388454437, "episode_reward_max": 484.1308024422979, "info": {"num_steps_trained": 3551707, "grad_time_ms": 8988.752, "update_time_ms": 7.764, "num_steps_sampled": 3551707, "default": {"vf_explained_var": 0.8399689197540283, "policy_loss": -0.011150853708386421, "entropy": 1.2998558282852173, "vf_loss": 46.58134841918945, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.012797749601304531, "total_loss": 46.57452392578125}, "load_time_ms": 4.913, "sample_time_ms": 15417.425}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3551707, "training_iteration": 92, "date": "2019-05-21_00-54-50", "timesteps_total": 3551707, "num_metric_batches_dropped": 0, "episode_reward_mean": 454.8056511975816, "timestamp": 1558400090, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.647706499962425, "cost2_max": -20.704156871832055, "outflow_rate_min": 1014.413773584906, "system_level_velocity_max": 18.47709200573212, "outflow_rate_mean": 1193.9506543174707, "cost1_max": 223.2841115193046, "cost1_mean": 202.0558140233112, "cost2_min": -56.80354678821503, "system_level_velocity_min": 13.09909935384079, "outflow_rate_max": 1293.887075696295, "cost1_min": 157.29078952614785, "cost2_mean": -31.994915485325468}, "timesteps_this_iter": 36797, "iterations_since_restore": 93, "episode_reward_min": 384.1471014318857, "episode_len_mean": 325.0, "time_this_iter_s": 23.399088859558105, "episodes_total": 4290, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943828>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89438d0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943b70>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2414.934227705002, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2414.934227705002, "episode_reward_max": 484.1308024422979, "info": {"num_steps_trained": 3588504, "grad_time_ms": 9029.02, "update_time_ms": 7.722, "num_steps_sampled": 3588504, "default": {"vf_explained_var": 0.8407009243965149, "policy_loss": -0.009513096883893013, "entropy": 1.315429925918579, "vf_loss": 42.64369583129883, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.3375000059604645, "kl": 0.013765244744718075, "total_loss": 42.638824462890625}, "load_time_ms": 4.903, "sample_time_ms": 15383.498}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3588504, "training_iteration": 93, "date": "2019-05-21_00-55-14", "timesteps_total": 3588504, "num_metric_batches_dropped": 0, "episode_reward_mean": 449.7993062600546, "timestamp": 1558400114, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.451113690969294, "cost2_max": -19.670732662336746, "outflow_rate_min": 982.081096345515, "system_level_velocity_max": 18.335608130845056, "outflow_rate_mean": 1183.6089391253472, "cost1_max": 222.36619341013574, "cost1_mean": 199.6664906594308, "cost2_min": -56.80354678821503, "system_level_velocity_min": 12.979151310221143, "outflow_rate_max": 1283.1199347040847, "cost1_min": 155.64072764905927, "cost2_mean": -32.59341718380614}, "timesteps_this_iter": 36441, "iterations_since_restore": 94, "episode_reward_min": 380.4640239938473, "episode_len_mean": 325.0, "time_this_iter_s": 25.0473210811615, "episodes_total": 4331, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943198>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943978>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943f28>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2439.9815487861633, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2439.9815487861633, "episode_reward_max": 478.6063624005505, "info": {"num_steps_trained": 3624945, "grad_time_ms": 9030.469, "update_time_ms": 7.778, "num_steps_sampled": 3624945, "default": {"vf_explained_var": 0.858848512172699, "policy_loss": -0.01060307677835226, "entropy": 1.3154550790786743, "vf_loss": 40.36003494262695, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.013568737544119358, "total_loss": 40.35401153564453}, "load_time_ms": 4.981, "sample_time_ms": 15410.542}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3624945, "training_iteration": 94, "date": "2019-05-21_00-55-39", "timesteps_total": 3624945, "num_metric_batches_dropped": 0, "episode_reward_mean": 446.5134868623617, "timestamp": 1558400139, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.654710355794357, "cost2_max": -16.07185770833851, "outflow_rate_min": 467.21399731799954, "system_level_velocity_max": 18.335608130845056, "outflow_rate_mean": 1180.7050755857724, "cost1_max": 222.36619341013574, "cost1_mean": 200.2501970264333, "cost2_min": -54.83954555524774, "system_level_velocity_min": 12.979151310221143, "outflow_rate_max": 1294.1469234331582, "cost1_min": 22.723414868780576, "cost2_mean": -30.848214972120935}, "timesteps_this_iter": 36076, "iterations_since_restore": 95, "episode_reward_min": 52.43495032427844, "episode_len_mean": 322.1, "time_this_iter_s": 26.55860924720764, "episodes_total": 4391, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943eb8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943780>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89436d8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2466.540158033371, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2466.540158033371, "episode_reward_max": 483.6325225224757, "info": {"num_steps_trained": 3661021, "grad_time_ms": 9131.24, "update_time_ms": 7.451, "num_steps_sampled": 3661021, "default": {"vf_explained_var": 0.7984475493431091, "policy_loss": -0.010894808918237686, "entropy": 1.3010039329528809, "vf_loss": 64.18558502197266, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.013145978562533855, "total_loss": 64.17912292480469}, "load_time_ms": 5.05, "sample_time_ms": 15416.415}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3661021, "training_iteration": 95, "date": "2019-05-21_00-56-05", "timesteps_total": 3661021, "num_metric_batches_dropped": 0, "episode_reward_mean": 444.46897239522207, "timestamp": 1558400165, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.77498207782514, "cost2_max": -16.07185770833851, "outflow_rate_min": 467.21399731799954, "system_level_velocity_max": 18.346196503513248, "outflow_rate_mean": 1181.3608424477284, "cost1_max": 222.1715083800466, "cost1_mean": 201.70046728086905, "cost2_min": -51.43468573014693, "system_level_velocity_min": 12.558121889729405, "outflow_rate_max": 1294.1469234331582, "cost1_min": 22.723414868780576, "cost2_mean": -29.899919946284378}, "timesteps_this_iter": 35886, "iterations_since_restore": 96, "episode_reward_min": 52.43495032427844, "episode_len_mean": 322.1, "time_this_iter_s": 23.23939538002014, "episodes_total": 4431, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943fd0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943710>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89432e8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2489.779553413391, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2489.779553413391, "episode_reward_max": 483.6325225224757, "info": {"num_steps_trained": 3696907, "grad_time_ms": 9129.192, "update_time_ms": 7.462, "num_steps_sampled": 3696907, "default": {"vf_explained_var": 0.8320131897926331, "policy_loss": -0.012514864094555378, "entropy": 1.293729543685913, "vf_loss": 45.7529296875, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.015213440172374249, "total_loss": 45.745548248291016}, "load_time_ms": 5.251, "sample_time_ms": 15448.42}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3696907, "training_iteration": 96, "date": "2019-05-21_00-56-28", "timesteps_total": 3696907, "num_metric_batches_dropped": 0, "episode_reward_mean": 445.2133419251802, "timestamp": 1558400188, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.716236293758424, "cost2_max": -16.07185770833851, "outflow_rate_min": 467.21399731799954, "system_level_velocity_max": 18.346196503513248, "outflow_rate_mean": 1179.8569464753984, "cost1_max": 222.1715083800466, "cost1_mean": 201.01181109685302, "cost2_min": -53.669554805058695, "system_level_velocity_min": 11.197637561045857, "outflow_rate_max": 1294.1469234331582, "cost1_min": 22.723414868780576, "cost2_mean": -30.12364587955264}, "timesteps_this_iter": 36136, "iterations_since_restore": 97, "episode_reward_min": 52.43495032427844, "episode_len_mean": 322.1, "time_this_iter_s": 24.81014919281006, "episodes_total": 4472, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943898>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943198>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943978>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2514.589702606201, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2514.589702606201, "episode_reward_max": 483.6325225224757, "info": {"num_steps_trained": 3733043, "grad_time_ms": 9164.884, "update_time_ms": 7.619, "num_steps_sampled": 3733043, "default": {"vf_explained_var": 0.832815945148468, "policy_loss": -0.011765982955694199, "entropy": 1.3114299774169922, "vf_loss": 44.099388122558594, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.013704652898013592, "total_loss": 44.092247009277344}, "load_time_ms": 5.11, "sample_time_ms": 15501.585}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3733043, "training_iteration": 97, "date": "2019-05-21_00-56-53", "timesteps_total": 3733043, "num_metric_batches_dropped": 0, "episode_reward_mean": 445.09381539096916, "timestamp": 1558400213, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.664889636159938, "cost2_max": -18.818431148471024, "outflow_rate_min": 1009.2318071836021, "system_level_velocity_max": 18.42154751529471, "outflow_rate_mean": 1187.8501252295569, "cost1_max": 222.8614672717113, "cost1_mean": 202.2853521453297, "cost2_min": -53.669554805058695, "system_level_velocity_min": 11.197637561045857, "outflow_rate_max": 1279.8535853696321, "cost1_min": 138.4226258853119, "cost2_mean": -29.77154889788762}, "timesteps_this_iter": 35505, "iterations_since_restore": 98, "episode_reward_min": 394.83049703637573, "episode_len_mean": 325.0, "time_this_iter_s": 25.636875867843628, "episodes_total": 4530, "hostname": "flow-main", "episodes_this_iter": 58, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943c50>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943908>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89436d8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2540.226578474045, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2540.226578474045, "episode_reward_max": 476.9957149001626, "info": {"num_steps_trained": 3768548, "grad_time_ms": 9154.601, "update_time_ms": 7.629, "num_steps_sampled": 3768548, "default": {"vf_explained_var": 0.754616916179657, "policy_loss": -0.012215644121170044, "entropy": 1.3018624782562256, "vf_loss": 68.8570785522461, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.3375000059604645, "kl": 0.015379694290459156, "total_loss": 68.85005187988281}, "load_time_ms": 5.165, "sample_time_ms": 15497.602}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3768548, "training_iteration": 98, "date": "2019-05-21_00-57-19", "timesteps_total": 3768548, "num_metric_batches_dropped": 0, "episode_reward_mean": 447.51906709233896, "timestamp": 1558400239, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.540176458374546, "cost2_max": -14.083636419983394, "outflow_rate_min": 504.740621259614, "system_level_velocity_max": 18.52539705087088, "outflow_rate_mean": 1174.4438622241862, "cost1_max": 222.8614672717113, "cost1_mean": 198.7253087931761, "cost2_min": -48.4933348230001, "system_level_velocity_min": 12.466452151698002, "outflow_rate_max": 1279.8535853696321, "cost1_min": 23.07516763912427, "cost2_mean": -30.341555412206887}, "timesteps_this_iter": 36502, "iterations_since_restore": 99, "episode_reward_min": 50.35762160289304, "episode_len_mean": 322.1, "time_this_iter_s": 26.367068767547607, "episodes_total": 4572, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943fd0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943320>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943390>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2566.5936472415924, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2566.5936472415924, "episode_reward_max": 475.69225622800644, "info": {"num_steps_trained": 3805050, "grad_time_ms": 9187.78, "update_time_ms": 7.589, "num_steps_sampled": 3805050, "default": {"vf_explained_var": 0.8242400884628296, "policy_loss": -0.01142748910933733, "entropy": 1.3163425922393799, "vf_loss": 47.409339904785156, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.014468812383711338, "total_loss": 47.40279769897461}, "load_time_ms": 5.23, "sample_time_ms": 15546.647}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3805050, "training_iteration": 99, "date": "2019-05-21_00-57-45", "timesteps_total": 3805050, "num_metric_batches_dropped": 0, "episode_reward_mean": 440.23553686103276, "timestamp": 1558400265, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.55369262243366, "cost2_max": -14.083636419983394, "outflow_rate_min": 478.4154921806374, "system_level_velocity_max": 18.721830764426112, "outflow_rate_mean": 1165.4545652458924, "cost1_max": 223.4315519987648, "cost1_mean": 196.69291975452532, "cost2_min": -48.4933348230001, "system_level_velocity_min": 12.466452151698002, "outflow_rate_max": 1286.8196186440678, "cost1_min": 23.07516763912427, "cost2_mean": -30.767933187555695}, "timesteps_this_iter": 35351, "iterations_since_restore": 100, "episode_reward_min": 50.35762160289304, "episode_len_mean": 319.23, "time_this_iter_s": 23.751620769500732, "episodes_total": 4614, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943748>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943438>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943978>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2590.345268011093, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2590.345268011093, "episode_reward_max": 477.1971161752695, "info": {"num_steps_trained": 3840401, "grad_time_ms": 9177.395, "update_time_ms": 7.625, "num_steps_sampled": 3840401, "default": {"vf_explained_var": 0.7759625315666199, "policy_loss": -0.012839491479098797, "entropy": 1.2975456714630127, "vf_loss": 53.16031265258789, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.014971209689974785, "total_loss": 53.15252685546875}, "load_time_ms": 5.068, "sample_time_ms": 15595.208}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3840401, "training_iteration": 100, "date": "2019-05-21_00-58-09", "timesteps_total": 3840401, "num_metric_batches_dropped": 0, "episode_reward_mean": 435.39883776799724, "timestamp": 1558400289, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.578823905404295, "cost2_max": -12.636525350005572, "outflow_rate_min": 478.4154921806374, "system_level_velocity_max": 18.721830764426112, "outflow_rate_mean": 1165.9498106554954, "cost1_max": 223.4315519987648, "cost1_mean": 196.8873280928396, "cost2_min": -50.14536481037906, "system_level_velocity_min": 12.466452151698002, "outflow_rate_max": 1286.8196186440678, "cost1_min": 18.033752248656516, "cost2_mean": -31.008718335429265}, "timesteps_this_iter": 37026, "iterations_since_restore": 101, "episode_reward_min": 41.06551471947293, "episode_len_mean": 319.15, "time_this_iter_s": 26.46140193939209, "episodes_total": 4664, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943b38>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943048>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89430b8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2616.8066699504852, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2616.8066699504852, "episode_reward_max": 477.73856005303975, "info": {"num_steps_trained": 3877427, "grad_time_ms": 9193.659, "update_time_ms": 7.584, "num_steps_sampled": 3877427, "default": {"vf_explained_var": 0.7889868021011353, "policy_loss": -0.012221929617226124, "entropy": 1.3429144620895386, "vf_loss": 54.39255905151367, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.014325729571282864, "total_loss": 54.385169982910156}, "load_time_ms": 5.253, "sample_time_ms": 15668.866}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3877427, "training_iteration": 101, "date": "2019-05-21_00-58-36", "timesteps_total": 3877427, "num_metric_batches_dropped": 0, "episode_reward_mean": 434.95431148470016, "timestamp": 1558400316, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.502963181729168, "cost2_max": -12.636525350005572, "outflow_rate_min": 485.8629864444024, "system_level_velocity_max": 18.434080057900708, "outflow_rate_mean": 1173.625639538572, "cost1_max": 222.99287813684202, "cost1_mean": 198.13617986255554, "cost2_min": -50.14536481037906, "system_level_velocity_min": 12.607607619252875, "outflow_rate_max": 1282.1005696567215, "cost1_min": 18.033752248656516, "cost2_mean": -31.093167122138947}, "timesteps_this_iter": 35542, "iterations_since_restore": 102, "episode_reward_min": 41.06551471947293, "episode_len_mean": 322.02, "time_this_iter_s": 26.369592428207397, "episodes_total": 4714, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953e80>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89539b0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953ef0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2643.1762623786926, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2643.1762623786926, "episode_reward_max": 480.513699035679, "info": {"num_steps_trained": 3912969, "grad_time_ms": 9360.276, "update_time_ms": 7.834, "num_steps_sampled": 3912969, "default": {"vf_explained_var": 0.804882824420929, "policy_loss": -0.012956393882632256, "entropy": 1.3266957998275757, "vf_loss": 47.7668342590332, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.3375000059604645, "kl": 0.014462200924754143, "total_loss": 47.75876235961914}, "load_time_ms": 5.197, "sample_time_ms": 15720.19}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3912969, "training_iteration": 102, "date": "2019-05-21_00-59-02", "timesteps_total": 3912969, "num_metric_batches_dropped": 0, "episode_reward_mean": 439.7045490368878, "timestamp": 1558400342, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.626761360388944, "cost2_max": -19.39724246463302, "outflow_rate_min": 1005.9509988772834, "system_level_velocity_max": 18.488698244126716, "outflow_rate_mean": 1190.180696677395, "cost1_max": 222.3459130049929, "cost1_mean": 201.63198131697368, "cost2_min": -49.47630761840517, "system_level_velocity_min": 12.607607619252875, "outflow_rate_max": 1282.1005696567215, "cost1_min": 152.3570450050147, "cost2_mean": -30.019301591565437}, "timesteps_this_iter": 35795, "iterations_since_restore": 103, "episode_reward_min": 381.80039224885843, "episode_len_mean": 325.0, "time_this_iter_s": 22.8084876537323, "episodes_total": 4755, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966e10>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89660b8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966a90>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2665.984750032425, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2665.984750032425, "episode_reward_max": 480.513699035679, "info": {"num_steps_trained": 3948764, "grad_time_ms": 9335.31, "update_time_ms": 7.856, "num_steps_sampled": 3948764, "default": {"vf_explained_var": 0.7485697865486145, "policy_loss": -0.012478457763791084, "entropy": 1.3347558975219727, "vf_loss": 59.26644515991211, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.014543837867677212, "total_loss": 59.25887680053711}, "load_time_ms": 5.053, "sample_time_ms": 15686.222}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3948764, "training_iteration": 103, "date": "2019-05-21_00-59-25", "timesteps_total": 3948764, "num_metric_batches_dropped": 0, "episode_reward_mean": 447.5598544913079, "timestamp": 1558400365, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.49275844071657, "cost2_max": -19.39724246463302, "outflow_rate_min": 992.8816236545987, "system_level_velocity_max": 18.488698244126716, "outflow_rate_mean": 1180.606134246831, "cost1_max": 222.3459130049929, "cost1_mean": 200.0260661858286, "cost2_min": -50.31625490341135, "system_level_velocity_min": 12.51506225331822, "outflow_rate_max": 1280.9521426901367, "cost1_min": 150.50501618059283, "cost2_mean": -30.26836375633624}, "timesteps_this_iter": 36577, "iterations_since_restore": 104, "episode_reward_min": 365.5958592380593, "episode_len_mean": 325.0, "time_this_iter_s": 26.00184988975525, "episodes_total": 4804, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966e80>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966978>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89666a0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2691.98659992218, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2691.98659992218, "episode_reward_max": 476.6487198850931, "info": {"num_steps_trained": 3985341, "grad_time_ms": 9328.057, "update_time_ms": 7.875, "num_steps_sampled": 3985341, "default": {"vf_explained_var": 0.7879712581634521, "policy_loss": -0.012352130375802517, "entropy": 1.3387292623519897, "vf_loss": 57.456199645996094, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.014569276012480259, "total_loss": 57.44876480102539}, "load_time_ms": 5.082, "sample_time_ms": 15789.306}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3985341, "training_iteration": 104, "date": "2019-05-21_00-59-51", "timesteps_total": 3985341, "num_metric_batches_dropped": 0, "episode_reward_mean": 443.89600597385765, "timestamp": 1558400391, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.441686822110224, "cost2_max": -17.533229643581357, "outflow_rate_min": 992.8816236545987, "system_level_velocity_max": 18.42900207694422, "outflow_rate_mean": 1176.0072667910256, "cost1_max": 221.941751993318, "cost1_mean": 199.3829348706903, "cost2_min": -50.31625490341135, "system_level_velocity_min": 12.51506225331822, "outflow_rate_max": 1274.0060054105832, "cost1_min": 150.50501618059283, "cost2_mean": -30.348511345305248}, "timesteps_this_iter": 35641, "iterations_since_restore": 105, "episode_reward_min": 365.5958592380593, "episode_len_mean": 325.0, "time_this_iter_s": 25.363812923431396, "episodes_total": 4854, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953e48>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953a90>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953a20>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2717.3504128456116, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2717.3504128456116, "episode_reward_max": 473.9910820465055, "info": {"num_steps_trained": 4020982, "grad_time_ms": 9310.435, "update_time_ms": 8.081, "num_steps_sampled": 4020982, "default": {"vf_explained_var": 0.7550203800201416, "policy_loss": -0.010723542422056198, "entropy": 1.3337198495864868, "vf_loss": 60.11911392211914, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.013742703944444656, "total_loss": 60.11302947998047}, "load_time_ms": 5.028, "sample_time_ms": 15687.213}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4020982, "training_iteration": 105, "date": "2019-05-21_01-00-17", "timesteps_total": 4020982, "num_metric_batches_dropped": 0, "episode_reward_mean": 442.7518540302154, "timestamp": 1558400417, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.683820477383264, "cost2_max": -17.533229643581357, "outflow_rate_min": 1006.7870481955126, "system_level_velocity_max": 18.42900207694422, "outflow_rate_mean": 1185.2371882960786, "cost1_max": 221.941751993318, "cost1_mean": 202.25974491467068, "cost2_min": -46.63447000696859, "system_level_velocity_min": 12.91712958382949, "outflow_rate_max": 1274.0060054105832, "cost1_min": 154.48366484574393, "cost2_mean": -29.161336302068356}, "timesteps_this_iter": 35227, "iterations_since_restore": 106, "episode_reward_min": 386.9580339165299, "episode_len_mean": 325.0, "time_this_iter_s": 22.51470184326172, "episodes_total": 4894, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966128>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966d68>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966748>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2739.8651146888733, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2739.8651146888733, "episode_reward_max": 473.15329990103464, "info": {"num_steps_trained": 4056209, "grad_time_ms": 9304.951, "update_time_ms": 8.158, "num_steps_sampled": 4056209, "default": {"vf_explained_var": 0.7531281113624573, "policy_loss": -0.011546042747795582, "entropy": 1.32889986038208, "vf_loss": 52.661834716796875, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.014415185898542404, "total_loss": 52.655155181884766}, "load_time_ms": 4.841, "sample_time_ms": 15620.468}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4056209, "training_iteration": 106, "date": "2019-05-21_01-00-39", "timesteps_total": 4056209, "num_metric_batches_dropped": 0, "episode_reward_mean": 445.6994952081975, "timestamp": 1558400439, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.54476914092757, "cost2_max": -9.587109657522218, "outflow_rate_min": 477.24354782665716, "system_level_velocity_max": 18.478048058046276, "outflow_rate_mean": 1170.4395812116427, "cost1_max": 222.23932721577916, "cost1_mean": 198.48389650791003, "cost2_min": -46.63447000696859, "system_level_velocity_min": 12.904199860818196, "outflow_rate_max": 1277.376264964086, "cost1_min": 17.827851867610608, "cost2_mean": -29.39414832436513}, "timesteps_this_iter": 36127, "iterations_since_restore": 107, "episode_reward_min": 42.87706963215455, "episode_len_mean": 321.84, "time_this_iter_s": 25.815603256225586, "episodes_total": 4936, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966e80>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966940>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966cf8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2765.680717945099, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2765.680717945099, "episode_reward_max": 472.11439407580866, "info": {"num_steps_trained": 4092336, "grad_time_ms": 9289.955, "update_time_ms": 7.913, "num_steps_sampled": 4092336, "default": {"vf_explained_var": 0.7670707106590271, "policy_loss": -0.012078676372766495, "entropy": 1.3549565076828003, "vf_loss": 56.9759407043457, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.015599903650581837, "total_loss": 56.96912384033203}, "load_time_ms": 4.801, "sample_time_ms": 15734.923}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4092336, "training_iteration": 107, "date": "2019-05-21_01-01-05", "timesteps_total": 4092336, "num_metric_batches_dropped": 0, "episode_reward_mean": 438.59675349567465, "timestamp": 1558400465, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.499252365577135, "cost2_max": -9.587109657522218, "outflow_rate_min": 477.24354782665716, "system_level_velocity_max": 18.478048058046276, "outflow_rate_mean": 1161.607320691888, "cost1_max": 222.23932721577916, "cost1_mean": 197.7422238915456, "cost2_min": -46.508393161778415, "system_level_velocity_min": 12.50111770620798, "outflow_rate_max": 1277.376264964086, "cost1_min": 17.827851867610608, "cost2_mean": -28.970990664909973}, "timesteps_this_iter": 35822, "iterations_since_restore": 108, "episode_reward_min": 42.87706963215455, "episode_len_mean": 321.84, "time_this_iter_s": 25.36622905731201, "episodes_total": 4994, "hostname": "flow-main", "episodes_this_iter": 58, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89569e8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943c18>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943048>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2791.046947002411, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2791.046947002411, "episode_reward_max": 474.41528723139686, "info": {"num_steps_trained": 4128158, "grad_time_ms": 9281.045, "update_time_ms": 7.962, "num_steps_sampled": 4128158, "default": {"vf_explained_var": 0.7815039157867432, "policy_loss": -0.013904033228754997, "entropy": 1.3379729986190796, "vf_loss": 62.911067962646484, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.016459042206406593, "total_loss": 62.9027214050293}, "load_time_ms": 4.587, "sample_time_ms": 15716.973}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4128158, "training_iteration": 108, "date": "2019-05-21_01-01-30", "timesteps_total": 4128158, "num_metric_batches_dropped": 0, "episode_reward_mean": 435.22072825541824, "timestamp": 1558400490, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.59119857874836, "cost2_max": -19.043963978353844, "outflow_rate_min": 965.2475126730851, "system_level_velocity_max": 18.37893269094508, "outflow_rate_mean": 1167.5866522980818, "cost1_max": 220.8868411365354, "cost1_mean": 200.9107181746991, "cost2_min": -47.08365523957367, "system_level_velocity_min": 12.50111770620798, "outflow_rate_max": 1265.4365178571427, "cost1_min": 149.65506218375415, "cost2_mean": -28.538977139226827}, "timesteps_this_iter": 35284, "iterations_since_restore": 109, "episode_reward_min": 362.6330922063935, "episode_len_mean": 325.0, "time_this_iter_s": 23.645185232162476, "episodes_total": 5035, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966eb8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89668d0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966748>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2814.6921322345734, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2814.6921322345734, "episode_reward_max": 474.41528723139686, "info": {"num_steps_trained": 4163442, "grad_time_ms": 9217.736, "update_time_ms": 7.969, "num_steps_sampled": 4163442, "default": {"vf_explained_var": 0.7689778804779053, "policy_loss": -0.011354939080774784, "entropy": 1.347739338874817, "vf_loss": 50.25071334838867, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.013764346949756145, "total_loss": 50.2440071105957}, "load_time_ms": 4.52, "sample_time_ms": 15507.837}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4163442, "training_iteration": 109, "date": "2019-05-21_01-01-54", "timesteps_total": 4163442, "num_metric_batches_dropped": 0, "episode_reward_mean": 439.7719504854716, "timestamp": 1558400514, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.627802296473696, "cost2_max": -18.817020410211917, "outflow_rate_min": 933.2386776846866, "system_level_velocity_max": 18.381343483110943, "outflow_rate_mean": 1172.0779773310924, "cost1_max": 221.03155820075634, "cost1_mean": 201.40290127130942, "cost2_min": -47.08365523957367, "system_level_velocity_min": 12.356367228784562, "outflow_rate_max": 1265.4365178571427, "cost1_min": 145.67808015945354, "cost2_mean": -28.52373240026664}, "timesteps_this_iter": 35328, "iterations_since_restore": 110, "episode_reward_min": 351.1236512743923, "episode_len_mean": 325.0, "time_this_iter_s": 24.379643440246582, "episodes_total": 5076, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956518>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956978>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943f98>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2839.07177567482, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2839.07177567482, "episode_reward_max": 470.2579208937141, "info": {"num_steps_trained": 4198770, "grad_time_ms": 9313.649, "update_time_ms": 7.975, "num_steps_sampled": 4198770, "default": {"vf_explained_var": 0.7514842748641968, "policy_loss": -0.011440103873610497, "entropy": 1.3574110269546509, "vf_loss": 54.29352951049805, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01366466749459505, "total_loss": 54.286705017089844}, "load_time_ms": 4.41, "sample_time_ms": 15474.838}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4198770, "training_iteration": 110, "date": "2019-05-21_01-02-18", "timesteps_total": 4198770, "num_metric_batches_dropped": 0, "episode_reward_mean": 440.38866896758043, "timestamp": 1558400538, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.695861785937197, "cost2_max": -18.817020410211917, "outflow_rate_min": 933.2386776846866, "system_level_velocity_max": 18.521056453962686, "outflow_rate_mean": 1177.4859647843289, "cost1_max": 221.47849803234394, "cost1_mean": 202.119793324653, "cost2_min": -45.37922635524998, "system_level_velocity_min": 12.356367228784562, "outflow_rate_max": 1265.4365178571427, "cost1_min": 145.67808015945354, "cost2_mean": -28.65649594828151}, "timesteps_this_iter": 34708, "iterations_since_restore": 111, "episode_reward_min": 351.1236512743923, "episode_len_mean": 325.0, "time_this_iter_s": 25.24036455154419, "episodes_total": 5131, "hostname": "flow-main", "episodes_this_iter": 55, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953a90>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953e48>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89539b0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2864.312140226364, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2864.312140226364, "episode_reward_max": 470.2579208937141, "info": {"num_steps_trained": 4233478, "grad_time_ms": 9259.479, "update_time_ms": 7.967, "num_steps_sampled": 4233478, "default": {"vf_explained_var": 0.698810875415802, "policy_loss": -0.012256141752004623, "entropy": 1.3587357997894287, "vf_loss": 67.89283752441406, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.014443879015743732, "total_loss": 67.88545989990234}, "load_time_ms": 4.35, "sample_time_ms": 15407.372}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4233478, "training_iteration": 111, "date": "2019-05-21_01-02-44", "timesteps_total": 4233478, "num_metric_batches_dropped": 0, "episode_reward_mean": 440.563623214522, "timestamp": 1558400564, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.6963853905021, "cost2_max": -11.946835717339773, "outflow_rate_min": 468.16108553543756, "system_level_velocity_max": 18.565640935101808, "outflow_rate_mean": 1160.366983972078, "cost1_max": 221.47849803234394, "cost1_mean": 198.2569636719235, "cost2_min": -46.49620455788582, "system_level_velocity_min": 13.15817165899208, "outflow_rate_max": 1262.7550600590619, "cost1_min": 22.974327402150596, "cost2_mean": -28.48625333613284}, "timesteps_this_iter": 35203, "iterations_since_restore": 112, "episode_reward_min": 52.832390502137216, "episode_len_mean": 319.2, "time_this_iter_s": 26.373081922531128, "episodes_total": 5177, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966048>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966780>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89660b8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2890.6852221488953, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2890.6852221488953, "episode_reward_max": 469.9926429764565, "info": {"num_steps_trained": 4268681, "grad_time_ms": 9183.93, "update_time_ms": 7.759, "num_steps_sampled": 4268681, "default": {"vf_explained_var": 0.7290853261947632, "policy_loss": -0.011486642993986607, "entropy": 1.3709015846252441, "vf_loss": 58.986793518066406, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.01429583691060543, "total_loss": 58.980133056640625}, "load_time_ms": 4.163, "sample_time_ms": 15483.478}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4268681, "training_iteration": 112, "date": "2019-05-21_01-03-10", "timesteps_total": 4268681, "num_metric_batches_dropped": 0, "episode_reward_mean": 432.5114542768065, "timestamp": 1558400590, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.523435141666155, "cost2_max": -11.946835717339773, "outflow_rate_min": 468.16108553543756, "system_level_velocity_max": 18.565640935101808, "outflow_rate_mean": 1154.159262392528, "cost1_max": 221.2317655853053, "cost1_mean": 196.32262844705906, "cost2_min": -46.49620455788582, "system_level_velocity_min": 12.694759909883807, "outflow_rate_max": 1262.702548155613, "cost1_min": 22.974327402150596, "cost2_mean": -28.796462537408175}, "timesteps_this_iter": 35272, "iterations_since_restore": 113, "episode_reward_min": 52.832390502137216, "episode_len_mean": 319.2, "time_this_iter_s": 24.10773205757141, "episodes_total": 5218, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956470>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956978>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89560f0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2914.7929542064667, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2914.7929542064667, "episode_reward_max": 467.60380476957766, "info": {"num_steps_trained": 4303953, "grad_time_ms": 9269.709, "update_time_ms": 7.846, "num_steps_sampled": 4303953, "default": {"vf_explained_var": 0.7448971271514893, "policy_loss": -0.011232303455471992, "entropy": 1.3694733381271362, "vf_loss": 54.155757904052734, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.013870617374777794, "total_loss": 54.14920425415039}, "load_time_ms": 4.037, "sample_time_ms": 15527.863}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4303953, "training_iteration": 113, "date": "2019-05-21_01-03-34", "timesteps_total": 4303953, "num_metric_batches_dropped": 0, "episode_reward_mean": 431.4085914072685, "timestamp": 1558400614, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.551722905842315, "cost2_max": -11.946835717339773, "outflow_rate_min": 492.33289307517947, "system_level_velocity_max": 18.565640935101808, "outflow_rate_mean": 1158.836679589569, "cost1_max": 221.2317655853053, "cost1_mean": 198.29866446691358, "cost2_min": -51.00396491171355, "system_level_velocity_min": 12.694759909883807, "outflow_rate_max": 1262.702548155613, "cost1_min": 22.974327402150596, "cost2_mean": -28.584065054532935}, "timesteps_this_iter": 36519, "iterations_since_restore": 114, "episode_reward_min": 52.832390502137216, "episode_len_mean": 322.1, "time_this_iter_s": 25.620607376098633, "episodes_total": 5267, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89538d0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89537f0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953be0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2940.4135615825653, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2940.4135615825653, "episode_reward_max": 467.52763716842054, "info": {"num_steps_trained": 4340472, "grad_time_ms": 9290.36, "update_time_ms": 7.831, "num_steps_sampled": 4340472, "default": {"vf_explained_var": 0.7801010012626648, "policy_loss": -0.011009945534169674, "entropy": 1.3706785440444946, "vf_loss": 56.1666145324707, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.013954020105302334, "total_loss": 56.160316467285156}, "load_time_ms": 4.059, "sample_time_ms": 15467.581}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4340472, "training_iteration": 114, "date": "2019-05-21_01-04-00", "timesteps_total": 4340472, "num_metric_batches_dropped": 0, "episode_reward_mean": 434.1478231350097, "timestamp": 1558400640, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.37930658523434, "cost2_max": -18.743637243672463, "outflow_rate_min": 1004.0115668202766, "system_level_velocity_max": 18.39368602332906, "outflow_rate_mean": 1160.8251094158154, "cost1_max": 220.94148777733517, "cost1_mean": 198.21064223248158, "cost2_min": -54.22500198455376, "system_level_velocity_min": 11.438151975991282, "outflow_rate_max": 1253.2842520796662, "cost1_min": 141.11346264871912, "cost2_mean": -29.453954135157936}, "timesteps_this_iter": 35144, "iterations_since_restore": 115, "episode_reward_min": 373.14465639038605, "episode_len_mean": 325.0, "time_this_iter_s": 25.240913152694702, "episodes_total": 5317, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89661d0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89660b8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966048>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2965.65447473526, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2965.65447473526, "episode_reward_max": 472.0639105950081, "info": {"num_steps_trained": 4375616, "grad_time_ms": 9273.908, "update_time_ms": 7.881, "num_steps_sampled": 4375616, "default": {"vf_explained_var": 0.7375625371932983, "policy_loss": -0.010064607486128807, "entropy": 1.3767622709274292, "vf_loss": 57.52757263183594, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01640216074883938, "total_loss": 57.523048400878906}, "load_time_ms": 3.98, "sample_time_ms": 15471.029}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4375616, "training_iteration": 115, "date": "2019-05-21_01-04-25", "timesteps_total": 4375616, "num_metric_batches_dropped": 0, "episode_reward_mean": 435.9861473415318, "timestamp": 1558400665, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.49266166867911, "cost2_max": -16.559489858586083, "outflow_rate_min": 1008.0847670008525, "system_level_velocity_max": 18.39368602332906, "outflow_rate_mean": 1167.140163324756, "cost1_max": 220.94148777733517, "cost1_mean": 199.65242802485406, "cost2_min": -54.22500198455376, "system_level_velocity_min": 11.438151975991282, "outflow_rate_max": 1256.4971813567345, "cost1_min": 141.11346264871912, "cost2_mean": -28.93847240182588}, "timesteps_this_iter": 35094, "iterations_since_restore": 116, "episode_reward_min": 395.9674237658151, "episode_len_mean": 325.0, "time_this_iter_s": 23.628453969955444, "episodes_total": 5358, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943278>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943f98>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89433c8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 2989.2829287052155, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 2989.2829287052155, "episode_reward_max": 472.0639105950081, "info": {"num_steps_trained": 4410710, "grad_time_ms": 9360.726, "update_time_ms": 7.966, "num_steps_sampled": 4410710, "default": {"vf_explained_var": 0.692199170589447, "policy_loss": -0.012935022823512554, "entropy": 1.3977022171020508, "vf_loss": 55.05799102783203, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.014822575263679028, "total_loss": 55.0500602722168}, "load_time_ms": 3.929, "sample_time_ms": 15495.798}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4410710, "training_iteration": 116, "date": "2019-05-21_01-04-49", "timesteps_total": 4410710, "num_metric_batches_dropped": 0, "episode_reward_mean": 437.3147098542432, "timestamp": 1558400689, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.272015327145308, "cost2_max": -16.559489858586083, "outflow_rate_min": 1009.5964013021602, "system_level_velocity_max": 18.290708955219866, "outflow_rate_mean": 1158.5394293549566, "cost1_max": 220.644561595479, "cost1_mean": 197.11709475720517, "cost2_min": -51.91860626248686, "system_level_velocity_min": 12.67435004422731, "outflow_rate_max": 1261.5660702916707, "cost1_min": 152.2924749329817, "cost2_mean": -29.853106825690247}, "timesteps_this_iter": 36258, "iterations_since_restore": 117, "episode_reward_min": 364.1589504630509, "episode_len_mean": 325.0, "time_this_iter_s": 25.720391511917114, "episodes_total": 5406, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947358>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953b70>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953a90>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3015.0033202171326, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3015.0033202171326, "episode_reward_max": 472.0639105950081, "info": {"num_steps_trained": 4446968, "grad_time_ms": 9366.311, "update_time_ms": 7.987, "num_steps_sampled": 4446968, "default": {"vf_explained_var": 0.7378621697425842, "policy_loss": -0.010949193499982357, "entropy": 1.4172000885009766, "vf_loss": 57.264137268066406, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.014541523531079292, "total_loss": 57.25809097290039}, "load_time_ms": 3.906, "sample_time_ms": 15481.541}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4446968, "training_iteration": 117, "date": "2019-05-21_01-05-15", "timesteps_total": 4446968, "num_metric_batches_dropped": 0, "episode_reward_mean": 434.7165947306109, "timestamp": 1558400715, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.199678425455605, "cost2_max": -11.745460103851993, "outflow_rate_min": 485.8629864444024, "system_level_velocity_max": 18.468642143403294, "outflow_rate_mean": 1151.8326542134098, "cost1_max": 220.56470549483907, "cost1_mean": 194.03794596967097, "cost2_min": -49.45555719594178, "system_level_velocity_min": 12.52342024815413, "outflow_rate_max": 1273.237136902924, "cost1_min": 18.008777881913826, "cost2_mean": -30.402653468568783}, "timesteps_this_iter": 35550, "iterations_since_restore": 118, "episode_reward_min": 41.11930895387957, "episode_len_mean": 322.02, "time_this_iter_s": 26.34994602203369, "episodes_total": 5457, "hostname": "flow-main", "episodes_this_iter": 51, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966be0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966eb8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966048>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3041.3532662391663, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3041.3532662391663, "episode_reward_max": 470.70946716225984, "info": {"num_steps_trained": 4482518, "grad_time_ms": 9371.21, "update_time_ms": 8.024, "num_steps_sampled": 4482518, "default": {"vf_explained_var": 0.7612044811248779, "policy_loss": -0.01300841011106968, "entropy": 1.364977478981018, "vf_loss": 58.83479690551758, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.3375000059604645, "kl": 0.015329037792980671, "total_loss": 58.826961517333984}, "load_time_ms": 3.869, "sample_time_ms": 15574.686}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4482518, "training_iteration": 118, "date": "2019-05-21_01-05-41", "timesteps_total": 4482518, "num_metric_batches_dropped": 0, "episode_reward_mean": 429.86719024529424, "timestamp": 1558400741, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.605417222584503, "cost2_max": -11.745460103851993, "outflow_rate_min": 485.8629864444024, "system_level_velocity_max": 18.468642143403294, "outflow_rate_mean": 1165.539024070059, "cost1_max": 220.6419363854002, "cost1_mean": 198.5920310201769, "cost2_min": -49.45555719594178, "system_level_velocity_min": 12.52342024815413, "outflow_rate_max": 1273.237136902924, "cost1_min": 18.008777881913826, "cost2_mean": -28.921170153661073}, "timesteps_this_iter": 34531, "iterations_since_restore": 119, "episode_reward_min": 41.11930895387957, "episode_len_mean": 322.02, "time_this_iter_s": 22.45306420326233, "episodes_total": 5498, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953f60>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953be0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89534a8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3063.8063304424286, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3063.8063304424286, "episode_reward_max": 470.48143919483755, "info": {"num_steps_trained": 4517049, "grad_time_ms": 9254.021, "update_time_ms": 8.026, "num_steps_sampled": 4517049, "default": {"vf_explained_var": 0.7312650680541992, "policy_loss": -0.010396795347332954, "entropy": 1.3741081953048706, "vf_loss": 49.18372344970703, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.013839109800755978, "total_loss": 49.17799377441406}, "load_time_ms": 4.093, "sample_time_ms": 15573.236}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4517049, "training_iteration": 119, "date": "2019-05-21_01-06-04", "timesteps_total": 4517049, "num_metric_batches_dropped": 0, "episode_reward_mean": 433.1332961655221, "timestamp": 1558400764, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.64160736646724, "cost2_max": -16.318657466882293, "outflow_rate_min": 954.3000000000003, "system_level_velocity_max": 18.371747244327047, "outflow_rate_mean": 1175.8991936140023, "cost1_max": 221.47406910917584, "cost1_mean": 201.08737675031716, "cost2_min": -47.029453344039865, "system_level_velocity_min": 12.52342024815413, "outflow_rate_max": 1286.4545128060597, "cost1_min": 152.89614863172136, "cost2_mean": -28.782239799422786}, "timesteps_this_iter": 35581, "iterations_since_restore": 120, "episode_reward_min": 353.24312263005305, "episode_len_mean": 325.0, "time_this_iter_s": 23.69071316719055, "episodes_total": 5539, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966470>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966e80>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966940>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3087.497043609619, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3087.497043609619, "episode_reward_max": 470.48143919483755, "info": {"num_steps_trained": 4552630, "grad_time_ms": 9263.321, "update_time_ms": 8.118, "num_steps_sampled": 4552630, "default": {"vf_explained_var": 0.7282722592353821, "policy_loss": -0.01174753624945879, "entropy": 1.4081363677978516, "vf_loss": 54.077667236328125, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.3375000059604645, "kl": 0.015569397248327732, "total_loss": 54.07117462158203}, "load_time_ms": 4.29, "sample_time_ms": 15495.187}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4552630, "training_iteration": 120, "date": "2019-05-21_01-06-27", "timesteps_total": 4552630, "num_metric_batches_dropped": 0, "episode_reward_mean": 438.7777878214718, "timestamp": 1558400787, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.471112654554837, "cost2_max": -18.034559430130617, "outflow_rate_min": 1031.2634927965735, "system_level_velocity_max": 18.483946412617957, "outflow_rate_mean": 1172.988925895825, "cost1_max": 222.26705940309026, "cost1_mean": 199.16796970403593, "cost2_min": -47.029453344039865, "system_level_velocity_min": 12.983298413026333, "outflow_rate_max": 1286.4545128060597, "cost1_min": 159.61349242057224, "cost2_mean": -29.66751359733465}, "timesteps_this_iter": 35815, "iterations_since_restore": 121, "episode_reward_min": 393.5413373632451, "episode_len_mean": 325.0, "time_this_iter_s": 25.81624937057495, "episodes_total": 5596, "hostname": "flow-main", "episodes_this_iter": 57, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966588>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966630>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966668>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3113.313292980194, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3113.313292980194, "episode_reward_max": 468.83445452552456, "info": {"num_steps_trained": 4588445, "grad_time_ms": 9277.068, "update_time_ms": 8.155, "num_steps_sampled": 4588445, "default": {"vf_explained_var": 0.7521522641181946, "policy_loss": -0.012178651057183743, "entropy": 1.3907554149627686, "vf_loss": 60.27411651611328, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.014954925514757633, "total_loss": 60.266998291015625}, "load_time_ms": 4.163, "sample_time_ms": 15538.712}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4588445, "training_iteration": 121, "date": "2019-05-21_01-06-53", "timesteps_total": 4588445, "num_metric_batches_dropped": 0, "episode_reward_mean": 438.53021935978614, "timestamp": 1558400813, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.32763266136434, "cost2_max": -18.034559430130617, "outflow_rate_min": 947.7794805194807, "system_level_velocity_max": 18.483946412617957, "outflow_rate_mean": 1164.7576493172191, "cost1_max": 222.26705940309026, "cost1_mean": 197.45535643692617, "cost2_min": -50.77051456138474, "system_level_velocity_min": 12.412558617803372, "outflow_rate_max": 1279.4611951575957, "cost1_min": 149.81646505246408, "cost2_mean": -30.30316327831783}, "timesteps_this_iter": 35820, "iterations_since_restore": 122, "episode_reward_min": 339.6325993667292, "episode_len_mean": 325.0, "time_this_iter_s": 24.835601329803467, "episodes_total": 5638, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947c18>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953518>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89534a8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3138.1488943099976, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3138.1488943099976, "episode_reward_max": 466.8076285859525, "info": {"num_steps_trained": 4624265, "grad_time_ms": 9291.545, "update_time_ms": 8.104, "num_steps_sampled": 4624265, "default": {"vf_explained_var": 0.8027939796447754, "policy_loss": -0.012193987146019936, "entropy": 1.3749181032180786, "vf_loss": 46.92079162597656, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.015138342045247555, "total_loss": 46.91371154785156}, "load_time_ms": 4.27, "sample_time_ms": 15369.974}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4624265, "training_iteration": 122, "date": "2019-05-21_01-07-18", "timesteps_total": 4624265, "num_metric_batches_dropped": 0, "episode_reward_mean": 435.47890755486486, "timestamp": 1558400838, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.586884565551376, "cost2_max": -19.228861602069152, "outflow_rate_min": 947.7794805194807, "system_level_velocity_max": 18.530102964585648, "outflow_rate_mean": 1172.2135125930417, "cost1_max": 222.3454210904096, "cost1_mean": 199.55369839462688, "cost2_min": -50.77051456138474, "system_level_velocity_min": 12.412558617803372, "outflow_rate_max": 1290.175721288989, "cost1_min": 145.62890285467694, "cost2_mean": -29.467170699194558}, "timesteps_this_iter": 34767, "iterations_since_restore": 123, "episode_reward_min": 299.24438350869366, "episode_len_mean": 323.93, "time_this_iter_s": 25.42521858215332, "episodes_total": 5680, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966438>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966e80>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966940>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3163.574112892151, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3163.574112892151, "episode_reward_max": 469.8389666258702, "info": {"num_steps_trained": 4659032, "grad_time_ms": 9276.854, "update_time_ms": 7.954, "num_steps_sampled": 4659032, "default": {"vf_explained_var": 0.7149671912193298, "policy_loss": -0.01240905374288559, "entropy": 1.382724404335022, "vf_loss": 51.00071334838867, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01506456546485424, "total_loss": 50.993385314941406}, "load_time_ms": 4.647, "sample_time_ms": 15516.132}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4659032, "training_iteration": 123, "date": "2019-05-21_01-07-44", "timesteps_total": 4659032, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.91518561810693, "timestamp": 1558400864, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.676813789600615, "cost2_max": -19.33792146119156, "outflow_rate_min": 988.2287404851053, "system_level_velocity_max": 18.530102964585648, "outflow_rate_mean": 1176.9156027500512, "cost1_max": 222.3454210904096, "cost1_mean": 200.45301452740742, "cost2_min": -52.383648309734525, "system_level_velocity_min": 12.893921245608656, "outflow_rate_max": 1293.6911001327815, "cost1_min": 145.62890285467694, "cost2_mean": -29.819429740630135}, "timesteps_this_iter": 35766, "iterations_since_restore": 124, "episode_reward_min": 299.24438350869366, "episode_len_mean": 323.93, "time_this_iter_s": 25.070042371749878, "episodes_total": 5732, "hostname": "flow-main", "episodes_this_iter": 52, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966be0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89669e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89660b8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3188.6441552639008, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3188.6441552639008, "episode_reward_max": 469.8389666258702, "info": {"num_steps_trained": 4694798, "grad_time_ms": 9157.178, "update_time_ms": 8.261, "num_steps_sampled": 4694798, "default": {"vf_explained_var": 0.7533162832260132, "policy_loss": -0.01314147375524044, "entropy": 1.4071648120880127, "vf_loss": 54.824256896972656, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.015366797335445881, "total_loss": 54.8162956237793}, "load_time_ms": 4.647, "sample_time_ms": 15582.388}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4694798, "training_iteration": 124, "date": "2019-05-21_01-08-09", "timesteps_total": 4694798, "num_metric_batches_dropped": 0, "episode_reward_mean": 437.67070092447983, "timestamp": 1558400889, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.682909876607, "cost2_max": -12.581640901158975, "outflow_rate_min": 462.7169295230079, "system_level_velocity_max": 18.479672236688977, "outflow_rate_mean": 1169.8723954016118, "cost1_max": 221.89554918109062, "cost1_mean": 199.52136419203438, "cost2_min": -52.383648309734525, "system_level_velocity_min": 12.893921245608656, "outflow_rate_max": 1293.6911001327815, "cost1_min": 17.73696816721904, "cost2_mean": -29.215959254264412}, "timesteps_this_iter": 34455, "iterations_since_restore": 125, "episode_reward_min": 42.303909399065255, "episode_len_mean": 322.02, "time_this_iter_s": 24.157113313674927, "episodes_total": 5779, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947320>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89476d8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89477f0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3212.8012685775757, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3212.8012685775757, "episode_reward_max": 471.3135711687051, "info": {"num_steps_trained": 4729253, "grad_time_ms": 9059.311, "update_time_ms": 8.097, "num_steps_sampled": 4729253, "default": {"vf_explained_var": 0.6827044486999512, "policy_loss": -0.012465882115066051, "entropy": 1.3772404193878174, "vf_loss": 60.58428192138672, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.014637608081102371, "total_loss": 60.576759338378906}, "load_time_ms": 4.713, "sample_time_ms": 15573.146}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4729253, "training_iteration": 125, "date": "2019-05-21_01-08-33", "timesteps_total": 4729253, "num_metric_batches_dropped": 0, "episode_reward_mean": 434.4620888125115, "timestamp": 1558400913, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.870320525009834, "cost2_max": -12.581640901158975, "outflow_rate_min": 462.7169295230079, "system_level_velocity_max": 18.48638582017659, "outflow_rate_mean": 1177.4023781732164, "cost1_max": 221.26082620614017, "cost1_mean": 201.69199079755148, "cost2_min": -46.65645580765327, "system_level_velocity_min": 13.378587785064603, "outflow_rate_max": 1278.9905456114464, "cost1_min": 17.73696816721904, "cost2_mean": -28.475683571213484}, "timesteps_this_iter": 35471, "iterations_since_restore": 126, "episode_reward_min": 42.303909399065255, "episode_len_mean": 322.02, "time_this_iter_s": 24.06849431991577, "episodes_total": 5820, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947668>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956518>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956978>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3236.8697628974915, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3236.8697628974915, "episode_reward_max": 471.3135711687051, "info": {"num_steps_trained": 4764724, "grad_time_ms": 8944.173, "update_time_ms": 7.967, "num_steps_sampled": 4764724, "default": {"vf_explained_var": 0.7666792273521423, "policy_loss": -0.010939596220850945, "entropy": 1.3980385065078735, "vf_loss": 48.55247497558594, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.3375000059604645, "kl": 0.013768981210887432, "total_loss": 48.546180725097656}, "load_time_ms": 4.876, "sample_time_ms": 15732.157}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4764724, "training_iteration": 126, "date": "2019-05-21_01-08-57", "timesteps_total": 4764724, "num_metric_batches_dropped": 0, "episode_reward_mean": 437.6988264402719, "timestamp": 1558400937, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.582890298129442, "cost2_max": -12.581640901158975, "outflow_rate_min": 462.7169295230079, "system_level_velocity_max": 18.48638582017659, "outflow_rate_mean": 1172.8092455768463, "cost1_max": 221.35389643787482, "cost1_mean": 198.25467825146367, "cost2_min": -50.225239696218594, "system_level_velocity_min": 11.381158989537958, "outflow_rate_max": 1283.1942989251186, "cost1_min": 17.73696816721904, "cost2_mean": -30.798624517344006}, "timesteps_this_iter": 36220, "iterations_since_restore": 127, "episode_reward_min": 42.303909399065255, "episode_len_mean": 322.02, "time_this_iter_s": 26.08385443687439, "episodes_total": 5870, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966588>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966128>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966748>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3262.953617334366, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3262.953617334366, "episode_reward_max": 468.1144410041427, "info": {"num_steps_trained": 4800944, "grad_time_ms": 8803.426, "update_time_ms": 7.986, "num_steps_sampled": 4800944, "default": {"vf_explained_var": 0.8034728765487671, "policy_loss": -0.01403785590082407, "entropy": 1.4192286729812622, "vf_loss": 45.785491943359375, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.016581440344452858, "total_loss": 45.77705001831055}, "load_time_ms": 5.007, "sample_time_ms": 15909.536}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4800944, "training_iteration": 127, "date": "2019-05-21_01-09-23", "timesteps_total": 4800944, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.53781123227236, "timestamp": 1558400963, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.502776440414642, "cost2_max": -17.669408030158195, "outflow_rate_min": 995.0661488204388, "system_level_velocity_max": 18.55639149174867, "outflow_rate_mean": 1183.8285965764655, "cost1_max": 222.98760753847995, "cost1_mean": 199.44184591572633, "cost2_min": -50.225239696218594, "system_level_velocity_min": 11.381158989537958, "outflow_rate_max": 1287.2671710131306, "cost1_min": 139.2060472059772, "cost2_mean": -31.977607202512107}, "timesteps_this_iter": 35683, "iterations_since_restore": 128, "episode_reward_min": 368.59580534678275, "episode_len_mean": 325.0, "time_this_iter_s": 24.62135338783264, "episodes_total": 5919, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969320>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969c88>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89692b0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3287.5749707221985, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3287.5749707221985, "episode_reward_max": 476.28355812163, "info": {"num_steps_trained": 4836627, "grad_time_ms": 8655.967, "update_time_ms": 7.869, "num_steps_sampled": 4836627, "default": {"vf_explained_var": 0.8089704513549805, "policy_loss": -0.013012870214879513, "entropy": 1.3909474611282349, "vf_loss": 43.220149993896484, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.014676488935947418, "total_loss": 43.21208572387695}, "load_time_ms": 5.207, "sample_time_ms": 15884.025}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4836627, "training_iteration": 128, "date": "2019-05-21_01-09-48", "timesteps_total": 4836627, "num_metric_batches_dropped": 0, "episode_reward_mean": 441.7314218491314, "timestamp": 1558400988, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.930905827341345, "cost2_max": -17.669408030158195, "outflow_rate_min": 995.1555795148248, "system_level_velocity_max": 18.561586133873174, "outflow_rate_mean": 1197.983648130754, "cost1_max": 222.98760753847995, "cost1_mean": 203.80554567234685, "cost2_min": -48.18532844978797, "system_level_velocity_min": 13.360600985270391, "outflow_rate_max": 1287.2671710131306, "cost1_min": 146.29612426942205, "cost2_mean": -30.12888385690669}, "timesteps_this_iter": 35000, "iterations_since_restore": 129, "episode_reward_min": 306.30693111027716, "episode_len_mean": 323.9, "time_this_iter_s": 22.26019787788391, "episodes_total": 5959, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89661d0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89666a0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89660f0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3309.8351686000824, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3309.8351686000824, "episode_reward_max": 476.28355812163, "info": {"num_steps_trained": 4871627, "grad_time_ms": 8527.811, "update_time_ms": 7.902, "num_steps_sampled": 4871627, "default": {"vf_explained_var": 0.7814788222312927, "policy_loss": -0.013450770638883114, "entropy": 1.3791037797927856, "vf_loss": 44.257102966308594, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.015294174663722515, "total_loss": 44.248817443847656}, "load_time_ms": 5.19, "sample_time_ms": 15993.706}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4871627, "training_iteration": 129, "date": "2019-05-21_01-10-10", "timesteps_total": 4871627, "num_metric_batches_dropped": 0, "episode_reward_mean": 446.5690607708269, "timestamp": 1558401010, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.875277339326477, "cost2_max": -18.53387936472797, "outflow_rate_min": 995.1555795148248, "system_level_velocity_max": 18.570655334186064, "outflow_rate_mean": 1193.7613402101663, "cost1_max": 223.00311444569965, "cost1_mean": 203.14118007537746, "cost2_min": -47.420885311799836, "system_level_velocity_min": 13.367021687360612, "outflow_rate_max": 1288.8259046086005, "cost1_min": 146.29612426942205, "cost2_mean": -29.98637022209665}, "timesteps_this_iter": 35814, "iterations_since_restore": 130, "episode_reward_min": 306.30693111027716, "episode_len_mean": 323.9, "time_this_iter_s": 24.233140468597412, "episodes_total": 6010, "hostname": "flow-main", "episodes_this_iter": 51, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956278>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956d68>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956dd8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3334.06830906868, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3334.06830906868, "episode_reward_max": 480.2177222498076, "info": {"num_steps_trained": 4907441, "grad_time_ms": 8251.82, "update_time_ms": 7.737, "num_steps_sampled": 4907441, "default": {"vf_explained_var": 0.7742935419082642, "policy_loss": -0.013413514941930771, "entropy": 1.410643458366394, "vf_loss": 55.86264419555664, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01627304218709469, "total_loss": 55.8547248840332}, "load_time_ms": 4.989, "sample_time_ms": 16324.738}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4907441, "training_iteration": 130, "date": "2019-05-21_01-10-34", "timesteps_total": 4907441, "num_metric_batches_dropped": 0, "episode_reward_mean": 445.5341810860814, "timestamp": 1558401034, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.90114908961833, "cost2_max": -19.073644580064354, "outflow_rate_min": 1024.8958708414873, "system_level_velocity_max": 18.570655334186064, "outflow_rate_mean": 1195.9922830561115, "cost1_max": 223.00311444569965, "cost1_mean": 204.2478075326454, "cost2_min": -48.97595492828304, "system_level_velocity_min": 13.373949921755019, "outflow_rate_max": 1288.8259046086005, "cost1_min": 160.894197430764, "cost2_mean": -29.756664930228865}, "timesteps_this_iter": 35180, "iterations_since_restore": 131, "episode_reward_min": 383.80164426592444, "episode_len_mean": 325.0, "time_this_iter_s": 23.914876222610474, "episodes_total": 6058, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966940>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966da0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966470>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3357.9831852912903, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3357.9831852912903, "episode_reward_max": 480.2177222498076, "info": {"num_steps_trained": 4942621, "grad_time_ms": 7992.243, "update_time_ms": 7.661, "num_steps_sampled": 4942621, "default": {"vf_explained_var": 0.7604979276657104, "policy_loss": -0.011964645236730576, "entropy": 1.3938440084457397, "vf_loss": 54.761592864990234, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.014858674257993698, "total_loss": 54.75464630126953}, "load_time_ms": 5.001, "sample_time_ms": 16394.765}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4942621, "training_iteration": 131, "date": "2019-05-21_01-10-58", "timesteps_total": 4942621, "num_metric_batches_dropped": 0, "episode_reward_mean": 446.5637471412439, "timestamp": 1558401058, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.725074449993993, "cost2_max": -17.431104053490355, "outflow_rate_min": 978.1921529377879, "system_level_velocity_max": 18.533032263703582, "outflow_rate_mean": 1188.6758212726625, "cost1_max": 222.0580846572471, "cost1_mean": 202.29788666076536, "cost2_min": -48.97595492828304, "system_level_velocity_min": 12.956434922340863, "outflow_rate_max": 1278.4234090943398, "cost1_min": 155.95128291878885, "cost2_mean": -30.07877213315329}, "timesteps_this_iter": 35591, "iterations_since_restore": 132, "episode_reward_min": 322.2242126093295, "episode_len_mean": 325.0, "time_this_iter_s": 23.059043645858765, "episodes_total": 6099, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966dd8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966550>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966a20>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3381.042228937149, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3381.042228937149, "episode_reward_max": 471.94367869650495, "info": {"num_steps_trained": 4978212, "grad_time_ms": 7784.328, "update_time_ms": 7.686, "num_steps_sampled": 4978212, "default": {"vf_explained_var": 0.8006299734115601, "policy_loss": -0.010749145410954952, "entropy": 1.4359185695648193, "vf_loss": 43.392311096191406, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.014560330659151077, "total_loss": 43.386478424072266}, "load_time_ms": 4.938, "sample_time_ms": 16426.331}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4978212, "training_iteration": 132, "date": "2019-05-21_01-11-21", "timesteps_total": 4978212, "num_metric_batches_dropped": 0, "episode_reward_mean": 444.06027823354503, "timestamp": 1558401081, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.678509449264194, "cost2_max": -17.431104053490355, "outflow_rate_min": 953.569442508711, "system_level_velocity_max": 18.563222982164145, "outflow_rate_mean": 1186.9180424814847, "cost1_max": 222.96068002458526, "cost1_mean": 201.52688993366868, "cost2_min": -44.02836492382702, "system_level_velocity_min": 12.956434922340863, "outflow_rate_max": 1292.8026060373957, "cost1_min": 155.95128291878885, "cost2_mean": -30.29996515594522}, "timesteps_this_iter": 36007, "iterations_since_restore": 133, "episode_reward_min": 322.2242126093295, "episode_len_mean": 325.0, "time_this_iter_s": 23.617637634277344, "episodes_total": 6142, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89569b0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89564a8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956dd8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3404.6598665714264, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3404.6598665714264, "episode_reward_max": 471.94367869650495, "info": {"num_steps_trained": 5014219, "grad_time_ms": 7670.509, "update_time_ms": 7.645, "num_steps_sampled": 5014219, "default": {"vf_explained_var": 0.8067690134048462, "policy_loss": -0.012979203835129738, "entropy": 1.4385647773742676, "vf_loss": 48.252628326416016, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.015441390685737133, "total_loss": 48.24485778808594}, "load_time_ms": 4.846, "sample_time_ms": 16360.245}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5014219, "training_iteration": 133, "date": "2019-05-21_01-11-45", "timesteps_total": 5014219, "num_metric_batches_dropped": 0, "episode_reward_mean": 441.8730198981046, "timestamp": 1558401105, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.430977921668447, "cost2_max": -21.61128415760139, "outflow_rate_min": 953.569442508711, "system_level_velocity_max": 18.595796192395643, "outflow_rate_mean": 1174.779944192056, "cost1_max": 222.96068002458526, "cost1_mean": 198.40780110810945, "cost2_min": -49.229731601179125, "system_level_velocity_min": 12.904970417553509, "outflow_rate_max": 1294.271192377223, "cost1_min": 155.1987438425765, "cost2_mean": -31.459473608814932}, "timesteps_this_iter": 35456, "iterations_since_restore": 134, "episode_reward_min": 342.07365642902573, "episode_len_mean": 325.0, "time_this_iter_s": 25.74587655067444, "episodes_total": 6197, "hostname": "flow-main", "episodes_this_iter": 55, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966438>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966908>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89664a8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3430.405743122101, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3430.405743122101, "episode_reward_max": 472.50611108431843, "info": {"num_steps_trained": 5049675, "grad_time_ms": 7809.305, "update_time_ms": 7.228, "num_steps_sampled": 5049675, "default": {"vf_explained_var": 0.7410252094268799, "policy_loss": -0.014209514483809471, "entropy": 1.4623624086380005, "vf_loss": 58.64509201049805, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.3375000059604645, "kl": 0.01508365385234356, "total_loss": 58.63597106933594}, "load_time_ms": 4.671, "sample_time_ms": 16288.749}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5049675, "training_iteration": 134, "date": "2019-05-21_01-12-11", "timesteps_total": 5049675, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.25430141968087, "timestamp": 1558401131, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.53459545112034, "cost2_max": -11.912491354626802, "outflow_rate_min": 493.2509405449511, "system_level_velocity_max": 18.663818947825785, "outflow_rate_mean": 1164.9430968442691, "cost1_max": 222.71278379176397, "cost1_mean": 196.89435943758474, "cost2_min": -49.229731601179125, "system_level_velocity_min": 12.904970417553509, "outflow_rate_max": 1294.271192377223, "cost1_min": 22.88286543331769, "cost2_mean": -30.3851531076098}, "timesteps_this_iter": 34621, "iterations_since_restore": 135, "episode_reward_min": 52.63163035580841, "episode_len_mean": 320.92, "time_this_iter_s": 25.16667652130127, "episodes_total": 6241, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89667b8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966be0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966ac8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3455.572419643402, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3455.572419643402, "episode_reward_max": 472.50611108431843, "info": {"num_steps_trained": 5084296, "grad_time_ms": 7877.298, "update_time_ms": 7.326, "num_steps_sampled": 5084296, "default": {"vf_explained_var": 0.6991108655929565, "policy_loss": -0.01309658121317625, "entropy": 1.4369927644729614, "vf_loss": 57.43118667602539, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.014958868734538555, "total_loss": 57.42314147949219}, "load_time_ms": 4.634, "sample_time_ms": 16320.688}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5084296, "training_iteration": 135, "date": "2019-05-21_01-12-36", "timesteps_total": 5084296, "num_metric_batches_dropped": 0, "episode_reward_mean": 430.9534603067589, "timestamp": 1558401156, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.70590136651421, "cost2_max": -11.912491354626802, "outflow_rate_min": 493.2509405449511, "system_level_velocity_max": 18.663818947825785, "outflow_rate_mean": 1170.8729703795161, "cost1_max": 222.39470361646667, "cost1_mean": 199.01687240033343, "cost2_min": -45.96341135490226, "system_level_velocity_min": 13.591578035868576, "outflow_rate_max": 1276.3053598254037, "cost1_min": 22.88286543331769, "cost2_mean": -29.19810915244916}, "timesteps_this_iter": 35168, "iterations_since_restore": 136, "episode_reward_min": 52.63163035580841, "episode_len_mean": 320.92, "time_this_iter_s": 24.298388719558716, "episodes_total": 6283, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943be0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943b70>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89439b0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3479.870808362961, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3479.870808362961, "episode_reward_max": 470.41155886422223, "info": {"num_steps_trained": 5119464, "grad_time_ms": 7993.219, "update_time_ms": 7.379, "num_steps_sampled": 5119464, "default": {"vf_explained_var": 0.7469505071640015, "policy_loss": -0.011706331744790077, "entropy": 1.4708375930786133, "vf_loss": 49.210567474365234, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.013628263026475906, "total_loss": 49.203460693359375}, "load_time_ms": 4.671, "sample_time_ms": 16227.456}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5119464, "training_iteration": 136, "date": "2019-05-21_01-13-00", "timesteps_total": 5119464, "num_metric_batches_dropped": 0, "episode_reward_mean": 433.2262591971576, "timestamp": 1558401180, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.537274726371145, "cost2_max": -17.562804035676987, "outflow_rate_min": 960.3023120161228, "system_level_velocity_max": 18.55165178349424, "outflow_rate_mean": 1173.9337356850995, "cost1_max": 222.0229621655086, "cost1_mean": 199.0836958770211, "cost2_min": -46.557761338379386, "system_level_velocity_min": 13.119509049345773, "outflow_rate_max": 1272.83368685179, "cost1_min": 137.4872350030917, "cost2_mean": -29.98799796994383}, "timesteps_this_iter": 35395, "iterations_since_restore": 137, "episode_reward_min": 281.76367030494214, "episode_len_mean": 323.82, "time_this_iter_s": 25.042881965637207, "episodes_total": 6335, "hostname": "flow-main", "episodes_this_iter": 52, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966128>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89668d0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966e10>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3504.913690328598, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3504.913690328598, "episode_reward_max": 467.3898100924365, "info": {"num_steps_trained": 5154859, "grad_time_ms": 8098.117, "update_time_ms": 7.412, "num_steps_sampled": 5154859, "default": {"vf_explained_var": 0.7412471175193787, "policy_loss": -0.012178580276668072, "entropy": 1.460309624671936, "vf_loss": 60.770103454589844, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.015059160068631172, "total_loss": 60.76300811767578}, "load_time_ms": 4.61, "sample_time_ms": 16017.928}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5154859, "training_iteration": 137, "date": "2019-05-21_01-13-25", "timesteps_total": 5154859, "num_metric_batches_dropped": 0, "episode_reward_mean": 435.54651020989354, "timestamp": 1558401205, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.744100884996012, "cost2_max": -17.732320106163513, "outflow_rate_min": 1002.8830662716457, "system_level_velocity_max": 18.55165178349424, "outflow_rate_mean": 1179.441395009945, "cost1_max": 222.0229621655086, "cost1_mean": 201.31105806399998, "cost2_min": -46.557761338379386, "system_level_velocity_min": 13.119509049345773, "outflow_rate_max": 1272.83368685179, "cost1_min": 145.63243670532196, "cost2_mean": -29.076663353004495}, "timesteps_this_iter": 34416, "iterations_since_restore": 138, "episode_reward_min": 306.8357053408773, "episode_len_mean": 323.92, "time_this_iter_s": 24.237149477005005, "episodes_total": 6380, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966eb8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966668>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966518>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3529.150839805603, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3529.150839805603, "episode_reward_max": 468.90716311706, "info": {"num_steps_trained": 5189275, "grad_time_ms": 8160.449, "update_time_ms": 7.49, "num_steps_sampled": 5189275, "default": {"vf_explained_var": 0.7309044599533081, "policy_loss": -0.012677050195634365, "entropy": 1.4150381088256836, "vf_loss": 55.015953063964844, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01523242425173521, "total_loss": 55.008419036865234}, "load_time_ms": 4.406, "sample_time_ms": 15918.026}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5189275, "training_iteration": 138, "date": "2019-05-21_01-13-50", "timesteps_total": 5189275, "num_metric_batches_dropped": 0, "episode_reward_mean": 438.06477701402633, "timestamp": 1558401230, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.904854383857156, "cost2_max": -17.732320106163513, "outflow_rate_min": 988.9781830151416, "system_level_velocity_max": 18.615740741707, "outflow_rate_mean": 1189.009212205168, "cost1_max": 222.4113812215372, "cost1_mean": 203.34823640832047, "cost2_min": -46.42057458542871, "system_level_velocity_min": 13.121181974090899, "outflow_rate_max": 1278.6370816683318, "cost1_min": 145.63243670532196, "cost2_mean": -28.292345487210095}, "timesteps_this_iter": 34702, "iterations_since_restore": 139, "episode_reward_min": 306.8357053408773, "episode_len_mean": 323.92, "time_this_iter_s": 23.391809940338135, "episodes_total": 6423, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953a20>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953940>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956e48>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3552.542649745941, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3552.542649745941, "episode_reward_max": 470.72325767155627, "info": {"num_steps_trained": 5223977, "grad_time_ms": 8296.281, "update_time_ms": 7.875, "num_steps_sampled": 5223977, "default": {"vf_explained_var": 0.7391074895858765, "policy_loss": -0.012831626459956169, "entropy": 1.4337353706359863, "vf_loss": 55.36526870727539, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.015567702241241932, "total_loss": 55.357688903808594}, "load_time_ms": 4.295, "sample_time_ms": 15894.344}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5223977, "training_iteration": 139, "date": "2019-05-21_01-14-13", "timesteps_total": 5223977, "num_metric_batches_dropped": 0, "episode_reward_mean": 441.26945877951664, "timestamp": 1558401253, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.808362327932123, "cost2_max": -15.897529956053265, "outflow_rate_min": 988.9781830151416, "system_level_velocity_max": 18.615740741707, "outflow_rate_mean": 1188.0991066619695, "cost1_max": 222.4113812215372, "cost1_mean": 203.2055549093146, "cost2_min": -42.339897488321284, "system_level_velocity_min": 13.121181974090899, "outflow_rate_max": 1278.6370816683318, "cost1_min": 160.2555206182074, "cost2_mean": -28.78418356461504}, "timesteps_this_iter": 34909, "iterations_since_restore": 140, "episode_reward_min": 365.0229456276556, "episode_len_mean": 325.0, "time_this_iter_s": 24.506788969039917, "episodes_total": 6471, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966588>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89668d0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966128>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3577.049438714981, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3577.049438714981, "episode_reward_max": 470.72325767155627, "info": {"num_steps_trained": 5258886, "grad_time_ms": 8439.918, "update_time_ms": 7.897, "num_steps_sampled": 5258886, "default": {"vf_explained_var": 0.7328383326530457, "policy_loss": -0.012062577530741692, "entropy": 1.4668749570846558, "vf_loss": 54.450775146484375, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.016179505735635757, "total_loss": 54.44417190551758}, "load_time_ms": 4.438, "sample_time_ms": 15777.579}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5258886, "training_iteration": 140, "date": "2019-05-21_01-14-38", "timesteps_total": 5258886, "num_metric_batches_dropped": 0, "episode_reward_mean": 442.1316810615361, "timestamp": 1558401278, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.660322260072864, "cost2_max": -12.96322831836383, "outflow_rate_min": 464.5153158358298, "system_level_velocity_max": 18.580646313993032, "outflow_rate_mean": 1174.958499270002, "cost1_max": 222.33323142830847, "cost1_mean": 199.55377105387623, "cost2_min": -54.79284154936161, "system_level_velocity_min": 12.460535937982518, "outflow_rate_max": 1278.6370816683318, "cost1_min": 18.075630647756356, "cost2_mean": -29.076411874931523}, "timesteps_this_iter": 34887, "iterations_since_restore": 141, "episode_reward_min": 42.52734889113719, "episode_len_mean": 322.02, "time_this_iter_s": 24.315006732940674, "episodes_total": 6521, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956dd8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956278>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956978>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3601.3644454479218, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3601.3644454479218, "episode_reward_max": 469.909699802663, "info": {"num_steps_trained": 5293773, "grad_time_ms": 8473.149, "update_time_ms": 7.965, "num_steps_sampled": 5293773, "default": {"vf_explained_var": 0.6902252435684204, "policy_loss": -0.013228509575128555, "entropy": 1.4656203985214233, "vf_loss": 66.90692138671875, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01564367674291134, "total_loss": 66.89898681640625}, "load_time_ms": 4.305, "sample_time_ms": 15784.532}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5293773, "training_iteration": 141, "date": "2019-05-21_01-15-02", "timesteps_total": 5293773, "num_metric_batches_dropped": 0, "episode_reward_mean": 435.8065764216291, "timestamp": 1558401302, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.819181209726715, "cost2_max": -12.96322831836383, "outflow_rate_min": 464.5153158358298, "system_level_velocity_max": 18.55924894078417, "outflow_rate_mean": 1179.7448011780277, "cost1_max": 221.8882685707238, "cost1_mean": 201.2265998946909, "cost2_min": -54.79284154936161, "system_level_velocity_min": 12.460535937982518, "outflow_rate_max": 1270.930135611685, "cost1_min": 18.075630647756356, "cost2_mean": -28.667557661023462}, "timesteps_this_iter": 34248, "iterations_since_restore": 142, "episode_reward_min": 42.52734889113719, "episode_len_mean": 322.02, "time_this_iter_s": 23.36405372619629, "episodes_total": 6563, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969908>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969668>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89479e8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3624.728499174118, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3624.728499174118, "episode_reward_max": 467.1951777363969, "info": {"num_steps_trained": 5328021, "grad_time_ms": 8506.646, "update_time_ms": 7.902, "num_steps_sampled": 5328021, "default": {"vf_explained_var": 0.685406506061554, "policy_loss": -0.013260090723633766, "entropy": 1.4418739080429077, "vf_loss": 60.262386322021484, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.01579981856048107, "total_loss": 60.25445556640625}, "load_time_ms": 4.233, "sample_time_ms": 15781.532}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5328021, "training_iteration": 142, "date": "2019-05-21_01-15-26", "timesteps_total": 5328021, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.4186522936792, "timestamp": 1558401326, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.91641168240367, "cost2_max": -18.782693415304678, "outflow_rate_min": 994.4109090826771, "system_level_velocity_max": 18.6268855683192, "outflow_rate_mean": 1185.5204135405597, "cost1_max": 222.33959738948727, "cost1_mean": 203.3899337538648, "cost2_min": -54.79284154936161, "system_level_velocity_min": 12.460535937982518, "outflow_rate_max": 1275.6674648950961, "cost1_min": 146.41185562829287, "cost2_mean": -28.52121227126751}, "timesteps_this_iter": 34042, "iterations_since_restore": 143, "episode_reward_min": 304.9335436445841, "episode_len_mean": 323.9, "time_this_iter_s": 24.028231620788574, "episodes_total": 6611, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966390>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966da0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966860>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3648.7567307949066, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3648.7567307949066, "episode_reward_max": 467.1951777363969, "info": {"num_steps_trained": 5362063, "grad_time_ms": 8459.05, "update_time_ms": 7.887, "num_steps_sampled": 5362063, "default": {"vf_explained_var": 0.6682676076889038, "policy_loss": -0.012257875874638557, "entropy": 1.4420703649520874, "vf_loss": 69.82706451416016, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.01460231002420187, "total_loss": 69.81974029541016}, "load_time_ms": 4.267, "sample_time_ms": 15869.755}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5362063, "training_iteration": 143, "date": "2019-05-21_01-15-50", "timesteps_total": 5362063, "num_metric_batches_dropped": 0, "episode_reward_mean": 437.62524204707495, "timestamp": 1558401350, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.905738470569602, "cost2_max": -19.09999694370316, "outflow_rate_min": 966.2307619047616, "system_level_velocity_max": 18.6268855683192, "outflow_rate_mean": 1180.8213576610945, "cost1_max": 222.33959738948727, "cost1_mean": 203.10373024695338, "cost2_min": -41.22125281797551, "system_level_velocity_min": 13.038065526344639, "outflow_rate_max": 1275.6674648950961, "cost1_min": 146.41185562829287, "cost2_mean": -28.13888990087326}, "timesteps_this_iter": 34081, "iterations_since_restore": 144, "episode_reward_min": 304.9335436445841, "episode_len_mean": 323.9, "time_this_iter_s": 23.733175039291382, "episodes_total": 6660, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943ef0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943d30>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943be0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3672.489905834198, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3672.489905834198, "episode_reward_max": 467.8401077738874, "info": {"num_steps_trained": 5396144, "grad_time_ms": 8243.796, "update_time_ms": 7.867, "num_steps_sampled": 5396144, "default": {"vf_explained_var": 0.6889894008636475, "policy_loss": -0.013011452741920948, "entropy": 1.466762661933899, "vf_loss": 66.31092071533203, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.015420743264257908, "total_loss": 66.30311584472656}, "load_time_ms": 4.322, "sample_time_ms": 15884.843}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5396144, "training_iteration": 144, "date": "2019-05-21_01-16-13", "timesteps_total": 5396144, "num_metric_batches_dropped": 0, "episode_reward_mean": 434.7260941436596, "timestamp": 1558401373, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.80464825122801, "cost2_max": -13.016249883966209, "outflow_rate_min": 509.2633683444688, "system_level_velocity_max": 18.61400783990865, "outflow_rate_mean": 1167.9199487220121, "cost1_max": 222.00952280341735, "cost1_mean": 200.70042468971707, "cost2_min": -45.996514021433725, "system_level_velocity_min": 12.748380958606612, "outflow_rate_max": 1269.7693943557326, "cost1_min": 22.80527142025866, "cost2_mean": -28.336510736435812}, "timesteps_this_iter": 34247, "iterations_since_restore": 145, "episode_reward_min": 49.22066503076301, "episode_len_mean": 322.1, "time_this_iter_s": 23.10419225692749, "episodes_total": 6704, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89691d0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969dd8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969668>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3695.5940980911255, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3695.5940980911255, "episode_reward_max": 469.76427488720367, "info": {"num_steps_trained": 5430391, "grad_time_ms": 8154.943, "update_time_ms": 7.61, "num_steps_sampled": 5430391, "default": {"vf_explained_var": 0.7269811630249023, "policy_loss": -0.014352144673466682, "entropy": 1.4673423767089844, "vf_loss": 56.569068908691406, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.01587577350437641, "total_loss": 56.56007385253906}, "load_time_ms": 4.276, "sample_time_ms": 15768.794}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5430391, "training_iteration": 145, "date": "2019-05-21_01-16-37", "timesteps_total": 5430391, "num_metric_batches_dropped": 0, "episode_reward_mean": 428.58115214413937, "timestamp": 1558401397, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 17.027517601701543, "cost2_max": -13.016249883966209, "outflow_rate_min": 509.2633683444688, "system_level_velocity_max": 18.539700628192207, "outflow_rate_mean": 1179.0336729395904, "cost1_max": 221.64933424873675, "cost1_mean": 202.57751208231846, "cost2_min": -45.996514021433725, "system_level_velocity_min": 12.748380958606612, "outflow_rate_max": 1275.1004391889487, "cost1_min": 22.80527142025866, "cost2_mean": -27.91198481920427}, "timesteps_this_iter": 34372, "iterations_since_restore": 146, "episode_reward_min": 49.22066503076301, "episode_len_mean": 321.03, "time_this_iter_s": 24.448927640914917, "episodes_total": 6747, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966e10>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966748>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89664a8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3720.0430257320404, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3720.0430257320404, "episode_reward_max": 469.76427488720367, "info": {"num_steps_trained": 5464763, "grad_time_ms": 8127.441, "update_time_ms": 7.445, "num_steps_sampled": 5464763, "default": {"vf_explained_var": 0.6988705992698669, "policy_loss": -0.015335108153522015, "entropy": 1.4785819053649902, "vf_loss": 58.9759635925293, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01626855880022049, "total_loss": 58.966121673583984}, "load_time_ms": 4.295, "sample_time_ms": 15810.995}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5464763, "training_iteration": 146, "date": "2019-05-21_01-17-01", "timesteps_total": 5464763, "num_metric_batches_dropped": 0, "episode_reward_mean": 432.6937659530294, "timestamp": 1558401421, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.767120158326378, "cost2_max": -20.280337117376675, "outflow_rate_min": 1008.5168537339813, "system_level_velocity_max": 18.59018702992298, "outflow_rate_mean": 1183.9470127640707, "cost1_max": 222.06430939845436, "cost1_mean": 201.79241703649362, "cost2_min": -46.003344893435624, "system_level_velocity_min": 12.56039349959925, "outflow_rate_max": 1278.370716137795, "cost1_min": 147.46385433649624, "cost2_mean": -29.364190827603135}, "timesteps_this_iter": 35037, "iterations_since_restore": 147, "episode_reward_min": 304.72621249293763, "episode_len_mean": 323.93, "time_this_iter_s": 26.876062870025635, "episodes_total": 6800, "hostname": "flow-main", "episodes_this_iter": 53, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89438d0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943b70>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943ef0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3746.919088602066, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3746.919088602066, "episode_reward_max": 472.45319079208366, "info": {"num_steps_trained": 5499800, "grad_time_ms": 8309.199, "update_time_ms": 7.438, "num_steps_sampled": 5499800, "default": {"vf_explained_var": 0.6955921649932861, "policy_loss": -0.014582316391170025, "entropy": 1.488330602645874, "vf_loss": 66.2872314453125, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.016171269118785858, "total_loss": 66.27811431884766}, "load_time_ms": 4.436, "sample_time_ms": 15812.729}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5499800, "training_iteration": 147, "date": "2019-05-21_01-17-28", "timesteps_total": 5499800, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.838021822486, "timestamp": 1558401448, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.808144436207385, "cost2_max": -21.08772803406884, "outflow_rate_min": 1008.5168537339813, "system_level_velocity_max": 18.63046211361428, "outflow_rate_mean": 1189.594247133424, "cost1_max": 223.4820702130606, "cost1_mean": 202.33296249013543, "cost2_min": -46.003344893435624, "system_level_velocity_min": 12.56039349959925, "outflow_rate_max": 1278.370716137795, "cost1_min": 147.46385433649624, "cost2_mean": -29.882215569971113}, "timesteps_this_iter": 34170, "iterations_since_restore": 148, "episode_reward_min": 304.72621249293763, "episode_len_mean": 323.93, "time_this_iter_s": 23.029786109924316, "episodes_total": 6844, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969f98>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969240>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969eb8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3769.9488747119904, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3769.9488747119904, "episode_reward_max": 472.45319079208366, "info": {"num_steps_trained": 5533970, "grad_time_ms": 8238.639, "update_time_ms": 7.399, "num_steps_sampled": 5533970, "default": {"vf_explained_var": 0.709260106086731, "policy_loss": -0.013010546565055847, "entropy": 1.4396158456802368, "vf_loss": 52.82322692871094, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.015399886295199394, "total_loss": 52.81541442871094}, "load_time_ms": 4.411, "sample_time_ms": 15763.038}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5533970, "training_iteration": 148, "date": "2019-05-21_01-17-51", "timesteps_total": 5533970, "num_metric_batches_dropped": 0, "episode_reward_mean": 439.7604557826451, "timestamp": 1558401471, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 17.03866428399119, "cost2_max": -22.336859331091404, "outflow_rate_min": 1045.2891259367225, "system_level_velocity_max": 18.664083654923378, "outflow_rate_mean": 1200.683239683768, "cost1_max": 223.4820702130606, "cost1_mean": 205.56296700156608, "cost2_min": -48.81435618049877, "system_level_velocity_min": 13.510631339027565, "outflow_rate_max": 1287.0042915038355, "cost1_min": 161.40556970446767, "cost2_mean": -29.52159162758486}, "timesteps_this_iter": 34652, "iterations_since_restore": 149, "episode_reward_min": 399.5572621006117, "episode_len_mean": 325.0, "time_this_iter_s": 24.384328603744507, "episodes_total": 6886, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966470>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966b00>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89663c8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3794.333203315735, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3794.333203315735, "episode_reward_max": 471.71977051986715, "info": {"num_steps_trained": 5568622, "grad_time_ms": 8326.472, "update_time_ms": 6.991, "num_steps_sampled": 5568622, "default": {"vf_explained_var": 0.7192229628562927, "policy_loss": -0.01161511056125164, "entropy": 1.452812671661377, "vf_loss": 58.751129150390625, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.015286378562450409, "total_loss": 58.744667053222656}, "load_time_ms": 4.447, "sample_time_ms": 15775.007}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5568622, "training_iteration": 149, "date": "2019-05-21_01-18-15", "timesteps_total": 5568622, "num_metric_batches_dropped": 0, "episode_reward_mean": 445.2459361086774, "timestamp": 1558401495, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.917365905935153, "cost2_max": -22.336859331091404, "outflow_rate_min": 1023.177107634338, "system_level_velocity_max": 18.664083654923378, "outflow_rate_mean": 1197.29340035912, "cost1_max": 223.34210816389796, "cost1_mean": 204.03459603663126, "cost2_min": -48.81435618049877, "system_level_velocity_min": 13.0538613806086, "outflow_rate_max": 1301.6146273440866, "cost1_min": 157.74491232408346, "cost2_mean": -30.489503369959824}, "timesteps_this_iter": 35348, "iterations_since_restore": 150, "episode_reward_min": 372.98337179703157, "episode_len_mean": 325.0, "time_this_iter_s": 25.069696187973022, "episodes_total": 6937, "hostname": "flow-main", "episodes_this_iter": 51, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89665f8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966cc0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966550>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3819.402899503708, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3819.402899503708, "episode_reward_max": 471.71977051986715, "info": {"num_steps_trained": 5603970, "grad_time_ms": 8449.779, "update_time_ms": 7.006, "num_steps_sampled": 5603970, "default": {"vf_explained_var": 0.7583408355712891, "policy_loss": -0.013827605172991753, "entropy": 1.5061426162719727, "vf_loss": 53.41272735595703, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.015217607840895653, "total_loss": 53.40403747558594}, "load_time_ms": 4.357, "sample_time_ms": 15707.928}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5603970, "training_iteration": 150, "date": "2019-05-21_01-18-41", "timesteps_total": 5603970, "num_metric_batches_dropped": 0, "episode_reward_mean": 444.77530568529414, "timestamp": 1558401521, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.847483591867, "cost2_max": -21.19330620259746, "outflow_rate_min": 1023.177107634338, "system_level_velocity_max": 18.737037566943858, "outflow_rate_mean": 1192.5905579179878, "cost1_max": 223.15112942897915, "cost1_mean": 202.32262811340533, "cost2_min": -44.79406066070297, "system_level_velocity_min": 13.0538613806086, "outflow_rate_max": 1301.6146273440866, "cost1_min": 147.44017315619524, "cost2_mean": -30.64996177307489}, "timesteps_this_iter": 34762, "iterations_since_restore": 151, "episode_reward_min": 306.024302117354, "episode_len_mean": 323.9, "time_this_iter_s": 24.571334838867188, "episodes_total": 6983, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969908>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89691d0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89698d0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3843.974234342575, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3843.974234342575, "episode_reward_max": 471.24085677050147, "info": {"num_steps_trained": 5638732, "grad_time_ms": 8661.136, "update_time_ms": 6.938, "num_steps_sampled": 5638732, "default": {"vf_explained_var": 0.7727595567703247, "policy_loss": -0.013461055234074593, "entropy": 1.4512492418289185, "vf_loss": 52.28040313720703, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.015054861083626747, "total_loss": 52.27202224731445}, "load_time_ms": 4.672, "sample_time_ms": 15521.561}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5638732, "training_iteration": 151, "date": "2019-05-21_01-19-05", "timesteps_total": 5638732, "num_metric_batches_dropped": 0, "episode_reward_mean": 441.01565428090976, "timestamp": 1558401545, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.74156338177951, "cost2_max": -21.19330620259746, "outflow_rate_min": 1023.177107634338, "system_level_velocity_max": 18.737037566943858, "outflow_rate_mean": 1188.9709945489653, "cost1_max": 223.71218181436473, "cost1_mean": 201.0606317812401, "cost2_min": -49.30445970015086, "system_level_velocity_min": 13.0538613806086, "outflow_rate_max": 1301.6146273440866, "cost1_min": 147.44017315619524, "cost2_mean": -31.077538470151044}, "timesteps_this_iter": 35871, "iterations_since_restore": 152, "episode_reward_min": 306.024302117354, "episode_len_mean": 323.9, "time_this_iter_s": 24.710335969924927, "episodes_total": 7026, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953cc0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953ef0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89538d0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3868.6845703125, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3868.6845703125, "episode_reward_max": 473.5888282935687, "info": {"num_steps_trained": 5674603, "grad_time_ms": 8824.779, "update_time_ms": 7.141, "num_steps_sampled": 5674603, "default": {"vf_explained_var": 0.7657033801078796, "policy_loss": -0.013289254158735275, "entropy": 1.5048872232437134, "vf_loss": 52.54100799560547, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.017103642225265503, "total_loss": 52.53349304199219}, "load_time_ms": 4.753, "sample_time_ms": 15491.348}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5674603, "training_iteration": 152, "date": "2019-05-21_01-19-30", "timesteps_total": 5674603, "num_metric_batches_dropped": 0, "episode_reward_mean": 439.2908529304326, "timestamp": 1558401570, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.556113305312508, "cost2_max": -21.920359775207228, "outflow_rate_min": 1002.0507208387946, "system_level_velocity_max": 18.66869051083531, "outflow_rate_mean": 1179.4789248366503, "cost1_max": 223.71218181436473, "cost1_mean": 199.6642681657648, "cost2_min": -49.30445970015086, "system_level_velocity_min": 13.254517387994056, "outflow_rate_max": 1279.6055563566124, "cost1_min": 160.1131307941393, "cost2_mean": -31.667926228757537}, "timesteps_this_iter": 35362, "iterations_since_restore": 153, "episode_reward_min": 364.89593008912556, "episode_len_mean": 325.0, "time_this_iter_s": 24.631148099899292, "episodes_total": 7074, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89425c0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942780>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942978>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3893.3157184123993, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3893.3157184123993, "episode_reward_max": 473.5888282935687, "info": {"num_steps_trained": 5709965, "grad_time_ms": 8945.681, "update_time_ms": 7.253, "num_steps_sampled": 5709965, "default": {"vf_explained_var": 0.7955402135848999, "policy_loss": -0.014120451174676418, "entropy": 1.4813982248306274, "vf_loss": 48.5006217956543, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.015721481293439865, "total_loss": 48.4918098449707}, "load_time_ms": 4.633, "sample_time_ms": 15430.342}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5709965, "training_iteration": 153, "date": "2019-05-21_01-19-55", "timesteps_total": 5709965, "num_metric_batches_dropped": 0, "episode_reward_mean": 437.2698767620922, "timestamp": 1558401595, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.554881953847747, "cost2_max": -22.313887486098483, "outflow_rate_min": 1002.0507208387946, "system_level_velocity_max": 18.66869051083531, "outflow_rate_mean": 1178.6858053326466, "cost1_max": 223.32941911716935, "cost1_mean": 199.73544981738596, "cost2_min": -49.30445970015086, "system_level_velocity_min": 13.177592076646691, "outflow_rate_max": 1282.7130361396535, "cost1_min": 160.1131307941393, "cost2_mean": -31.497853861658683}, "timesteps_this_iter": 35472, "iterations_since_restore": 154, "episode_reward_min": 364.89593008912556, "episode_len_mean": 325.0, "time_this_iter_s": 25.065258741378784, "episodes_total": 7122, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89696a0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89696d8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969550>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3918.380977153778, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3918.380977153778, "episode_reward_max": 471.01691204744765, "info": {"num_steps_trained": 5745437, "grad_time_ms": 9048.917, "update_time_ms": 7.393, "num_steps_sampled": 5745437, "default": {"vf_explained_var": 0.7831574082374573, "policy_loss": -0.013842504471540451, "entropy": 1.5028623342514038, "vf_loss": 49.18339538574219, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.3375000059604645, "kl": 0.01886172592639923, "total_loss": 49.1759147644043}, "load_time_ms": 4.829, "sample_time_ms": 15459.158}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5745437, "training_iteration": 154, "date": "2019-05-21_01-20-20", "timesteps_total": 5745437, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.7492990925533, "timestamp": 1558401620, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.6885407838366, "cost2_max": -20.784170119664562, "outflow_rate_min": 972.4484496951222, "system_level_velocity_max": 18.7516439931134, "outflow_rate_mean": 1186.6361301090794, "cost1_max": 223.53672948016157, "cost1_mean": 201.55689851463208, "cost2_min": -48.5059257786821, "system_level_velocity_min": 13.177592076646691, "outflow_rate_max": 1284.9127045188673, "cost1_min": 161.45338498314868, "cost2_mean": -30.707951649316616}, "timesteps_this_iter": 35284, "iterations_since_restore": 155, "episode_reward_min": 330.3057373073594, "episode_len_mean": 325.0, "time_this_iter_s": 24.22201371192932, "episodes_total": 7165, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966160>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89664a8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966748>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3942.6029908657074, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3942.6029908657074, "episode_reward_max": 471.01691204744765, "info": {"num_steps_trained": 5780721, "grad_time_ms": 9099.621, "update_time_ms": 7.494, "num_steps_sampled": 5780721, "default": {"vf_explained_var": 0.7383324503898621, "policy_loss": -0.01405682135373354, "entropy": 1.5145471096038818, "vf_loss": 51.634246826171875, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.01586000621318817, "total_loss": 51.625545501708984}, "load_time_ms": 4.995, "sample_time_ms": 15519.136}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5780721, "training_iteration": 155, "date": "2019-05-21_01-20-44", "timesteps_total": 5780721, "num_metric_batches_dropped": 0, "episode_reward_mean": 440.0661559551739, "timestamp": 1558401644, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.54912021013699, "cost2_max": -20.784170119664562, "outflow_rate_min": 972.4484496951222, "system_level_velocity_max": 18.7516439931134, "outflow_rate_mean": 1182.11612993772, "cost1_max": 223.85631912024246, "cost1_mean": 199.9112081311957, "cost2_min": -42.81954105334394, "system_level_velocity_min": 13.320928388280965, "outflow_rate_max": 1288.4212981628764, "cost1_min": 160.55128756657086, "cost2_mean": -30.91210451449091}, "timesteps_this_iter": 36469, "iterations_since_restore": 156, "episode_reward_min": 330.3057373073594, "episode_len_mean": 325.0, "time_this_iter_s": 26.306670427322388, "episodes_total": 7213, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89425c0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942828>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942780>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3968.90966129303, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3968.90966129303, "episode_reward_max": 468.66365645906535, "info": {"num_steps_trained": 5817190, "grad_time_ms": 9099.978, "update_time_ms": 7.602, "num_steps_sampled": 5817190, "default": {"vf_explained_var": 0.802327573299408, "policy_loss": -0.014616724103689194, "entropy": 1.526283860206604, "vf_loss": 48.53848648071289, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.016941839829087257, "total_loss": 48.52959442138672}, "load_time_ms": 5.066, "sample_time_ms": 15703.081}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5817190, "training_iteration": 156, "date": "2019-05-21_01-21-10", "timesteps_total": 5817190, "num_metric_batches_dropped": 0, "episode_reward_mean": 439.40503023949185, "timestamp": 1558401670, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.214348408633462, "cost2_max": -14.060859482929033, "outflow_rate_min": 440.0050268646629, "system_level_velocity_max": 18.703735067918817, "outflow_rate_mean": 1161.5055277326642, "cost1_max": 223.85631912024246, "cost1_mean": 194.1246795371606, "cost2_min": -48.08518673730093, "system_level_velocity_min": 11.237643191293232, "outflow_rate_max": 1288.4212981628764, "cost1_min": 17.778648829857953, "cost2_mean": -31.451187422887124}, "timesteps_this_iter": 36596, "iterations_since_restore": 157, "episode_reward_min": 42.23970947918678, "episode_len_mean": 322.02, "time_this_iter_s": 26.430037021636963, "episodes_total": 7262, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89696a0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969e10>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969668>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 3995.3396983146667, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 3995.3396983146667, "episode_reward_max": 468.66365645906535, "info": {"num_steps_trained": 5853786, "grad_time_ms": 8917.56, "update_time_ms": 7.606, "num_steps_sampled": 5853786, "default": {"vf_explained_var": 0.7985267043113708, "policy_loss": -0.014031573198735714, "entropy": 1.5524221658706665, "vf_loss": 49.04405975341797, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.017221657559275627, "total_loss": 49.03583526611328}, "load_time_ms": 5.031, "sample_time_ms": 15840.973}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5853786, "training_iteration": 157, "date": "2019-05-21_01-21-37", "timesteps_total": 5853786, "num_metric_batches_dropped": 0, "episode_reward_mean": 433.000345735201, "timestamp": 1558401697, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.53655867165061, "cost2_max": -14.060859482929033, "outflow_rate_min": 440.0050268646629, "system_level_velocity_max": 18.703735067918817, "outflow_rate_mean": 1171.836503996324, "cost1_max": 223.85631912024246, "cost1_mean": 197.75052463642623, "cost2_min": -48.08518673730093, "system_level_velocity_min": 11.237643191293232, "outflow_rate_max": 1288.4212981628764, "cost1_min": 17.778648829857953, "cost2_mean": -30.054490608470793}, "timesteps_this_iter": 35180, "iterations_since_restore": 158, "episode_reward_min": 42.23970947918678, "episode_len_mean": 322.02, "time_this_iter_s": 24.57372498512268, "episodes_total": 7305, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943a90>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943358>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89538d0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4019.9134232997894, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4019.9134232997894, "episode_reward_max": 473.59890956384845, "info": {"num_steps_trained": 5888966, "grad_time_ms": 8976.019, "update_time_ms": 7.515, "num_steps_sampled": 5888966, "default": {"vf_explained_var": 0.7975094318389893, "policy_loss": -0.014901241287589073, "entropy": 1.5105723142623901, "vf_loss": 44.94005584716797, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01669309288263321, "total_loss": 44.93079376220703}, "load_time_ms": 5.135, "sample_time_ms": 15936.135}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5888966, "training_iteration": 158, "date": "2019-05-21_01-22-01", "timesteps_total": 5888966, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.16778564531074, "timestamp": 1558401721, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.708544407518843, "cost2_max": -15.032203946097885, "outflow_rate_min": 510.52450689204, "system_level_velocity_max": 18.688487092079445, "outflow_rate_mean": 1172.4972621214156, "cost1_max": 222.72161753417595, "cost1_mean": 198.82843696169806, "cost2_min": -48.08518673730093, "system_level_velocity_min": 12.069236028391026, "outflow_rate_max": 1277.043520028359, "cost1_min": 25.336533928694056, "cost2_mean": -28.648563097545544}, "timesteps_this_iter": 34989, "iterations_since_restore": 159, "episode_reward_min": 54.117390050365785, "episode_len_mean": 321.05, "time_this_iter_s": 26.477290391921997, "episodes_total": 7351, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969c88>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969860>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969198>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4046.3907136917114, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4046.3907136917114, "episode_reward_max": 474.3941698101372, "info": {"num_steps_trained": 5923955, "grad_time_ms": 8963.196, "update_time_ms": 7.58, "num_steps_sampled": 5923955, "default": {"vf_explained_var": 0.7385789155960083, "policy_loss": -0.014001443050801754, "entropy": 1.5111052989959717, "vf_loss": 57.04767608642578, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01686265505850315, "total_loss": 57.039363861083984}, "load_time_ms": 5.224, "sample_time_ms": 16158.565}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5923955, "training_iteration": 159, "date": "2019-05-21_01-22-28", "timesteps_total": 5923955, "num_metric_batches_dropped": 0, "episode_reward_mean": 433.0970634719817, "timestamp": 1558401748, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.673240132829502, "cost2_max": -15.032203946097885, "outflow_rate_min": 510.52450689204, "system_level_velocity_max": 18.663695175125742, "outflow_rate_mean": 1174.2231203631165, "cost1_max": 222.72161753417595, "cost1_mean": 198.46452338495612, "cost2_min": -39.55359363761706, "system_level_velocity_min": 12.069236028391026, "outflow_rate_max": 1277.0545906506463, "cost1_min": 25.336533928694056, "cost2_mean": -28.72019157612481}, "timesteps_this_iter": 35229, "iterations_since_restore": 160, "episode_reward_min": 54.117390050365785, "episode_len_mean": 321.05, "time_this_iter_s": 25.873059511184692, "episodes_total": 7402, "hostname": "flow-main", "episodes_this_iter": 51, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89435f8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943f98>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969ef0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4072.263773202896, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4072.263773202896, "episode_reward_max": 474.3941698101372, "info": {"num_steps_trained": 5959184, "grad_time_ms": 8913.478, "update_time_ms": 7.63, "num_steps_sampled": 5959184, "default": {"vf_explained_var": 0.7331031560897827, "policy_loss": -0.013724135234951973, "entropy": 1.5216326713562012, "vf_loss": 56.34267044067383, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.01596176251769066, "total_loss": 56.33433151245117}, "load_time_ms": 5.375, "sample_time_ms": 16288.011}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5959184, "training_iteration": 160, "date": "2019-05-21_01-22-54", "timesteps_total": 5959184, "num_metric_batches_dropped": 0, "episode_reward_mean": 433.66246802409535, "timestamp": 1558401774, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.784390981319262, "cost2_max": -17.66115580328178, "outflow_rate_min": 949.097849230964, "system_level_velocity_max": 18.709377969429628, "outflow_rate_mean": 1187.6992481323498, "cost1_max": 222.66475744106202, "cost1_mean": 202.40889844545404, "cost2_min": -39.40164589453727, "system_level_velocity_min": 12.967076068796066, "outflow_rate_max": 1283.373171173089, "cost1_min": 159.12894795720035, "cost2_mean": -28.73868791864406}, "timesteps_this_iter": 35433, "iterations_since_restore": 161, "episode_reward_min": 356.55281184432187, "episode_len_mean": 325.0, "time_this_iter_s": 25.48476004600525, "episodes_total": 7446, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943a20>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943a90>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943fd0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4097.748533248901, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4097.748533248901, "episode_reward_max": 465.17705655893394, "info": {"num_steps_trained": 5994617, "grad_time_ms": 8912.51, "update_time_ms": 7.806, "num_steps_sampled": 5994617, "default": {"vf_explained_var": 0.7613694667816162, "policy_loss": -0.015196679159998894, "entropy": 1.5526299476623535, "vf_loss": 49.33841323852539, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.016435444355010986, "total_loss": 49.32876968383789}, "load_time_ms": 5.307, "sample_time_ms": 16380.064}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5994617, "training_iteration": 161, "date": "2019-05-21_01-23-19", "timesteps_total": 5994617, "num_metric_batches_dropped": 0, "episode_reward_mean": 440.43161752445053, "timestamp": 1558401799, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.25948533850051, "cost2_max": -17.404682743694707, "outflow_rate_min": 909.75125, "system_level_velocity_max": 18.709377969429628, "outflow_rate_mean": 1162.61087514691, "cost1_max": 222.77654818740132, "cost1_mean": 195.00120253360313, "cost2_min": -43.118677540607, "system_level_velocity_min": 12.010044880584966, "outflow_rate_max": 1283.373171173089, "cost1_min": 143.69312902465225, "cost2_mean": -29.13346752185001}, "timesteps_this_iter": 35908, "iterations_since_restore": 162, "episode_reward_min": 300.5099950612434, "episode_len_mean": 322.8, "time_this_iter_s": 24.903136730194092, "episodes_total": 7491, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956668>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956748>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956240>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4122.6516699790955, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4122.6516699790955, "episode_reward_max": 467.9608265679307, "info": {"num_steps_trained": 6030525, "grad_time_ms": 8909.36, "update_time_ms": 7.737, "num_steps_sampled": 6030525, "default": {"vf_explained_var": 0.7690019607543945, "policy_loss": -0.015498602762818336, "entropy": 1.5789086818695068, "vf_loss": 50.038455963134766, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.017964119091629982, "total_loss": 50.02901840209961}, "load_time_ms": 5.388, "sample_time_ms": 16402.326}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6030525, "training_iteration": 162, "date": "2019-05-21_01-23-44", "timesteps_total": 6030525, "num_metric_batches_dropped": 0, "episode_reward_mean": 429.67745537210794, "timestamp": 1558401824, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.280194047793223, "cost2_max": -15.595783789162242, "outflow_rate_min": 474.5084323459513, "system_level_velocity_max": 18.71688437180279, "outflow_rate_mean": 1149.2342612016341, "cost1_max": 222.77654818740132, "cost1_mean": 193.2945999080864, "cost2_min": -43.118677540607, "system_level_velocity_min": 11.545241090516443, "outflow_rate_max": 1277.595122540515, "cost1_min": 23.17932253627801, "cost2_mean": -28.61974518526408}, "timesteps_this_iter": 35390, "iterations_since_restore": 163, "episode_reward_min": 52.899526630354146, "episode_len_mean": 319.9, "time_this_iter_s": 26.01491117477417, "episodes_total": 7541, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89699e8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969278>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969710>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4148.66658115387, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4148.66658115387, "episode_reward_max": 467.9608265679307, "info": {"num_steps_trained": 6065915, "grad_time_ms": 8971.506, "update_time_ms": 7.873, "num_steps_sampled": 6065915, "default": {"vf_explained_var": 0.7490358352661133, "policy_loss": -0.015275153331458569, "entropy": 1.5659632682800293, "vf_loss": 56.396141052246094, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.015560540370643139, "total_loss": 56.38611602783203}, "load_time_ms": 5.271, "sample_time_ms": 16478.622}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6065915, "training_iteration": 163, "date": "2019-05-21_01-24-10", "timesteps_total": 6065915, "num_metric_batches_dropped": 0, "episode_reward_mean": 426.26128330151835, "timestamp": 1558401850, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.582288498264205, "cost2_max": -15.595783789162242, "outflow_rate_min": 474.5084323459513, "system_level_velocity_max": 18.71688437180279, "outflow_rate_mean": 1161.2181959833533, "cost1_max": 222.77654818740132, "cost1_mean": 198.15647822534476, "cost2_min": -38.92911603512113, "system_level_velocity_min": 11.545241090516443, "outflow_rate_max": 1277.595122540515, "cost1_min": 23.17932253627801, "cost2_mean": -28.201900772909216}, "timesteps_this_iter": 35518, "iterations_since_restore": 164, "episode_reward_min": 52.899526630354146, "episode_len_mean": 322.1, "time_this_iter_s": 25.75907802581787, "episodes_total": 7585, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953b70>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953f60>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953a90>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4174.4256591796875, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4174.4256591796875, "episode_reward_max": 467.61965577314675, "info": {"num_steps_trained": 6101433, "grad_time_ms": 9021.746, "update_time_ms": 7.878, "num_steps_sampled": 6101433, "default": {"vf_explained_var": 0.7665801644325256, "policy_loss": -0.014754689298570156, "entropy": 1.5766081809997559, "vf_loss": 48.87584686279297, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.3375000059604645, "kl": 0.017558226361870766, "total_loss": 48.86701965332031}, "load_time_ms": 5.23, "sample_time_ms": 16497.734}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6101433, "training_iteration": 164, "date": "2019-05-21_01-24-36", "timesteps_total": 6101433, "num_metric_batches_dropped": 0, "episode_reward_mean": 433.5640734791226, "timestamp": 1558401876, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.48353563038392, "cost2_max": -15.595783789162242, "outflow_rate_min": 474.5084323459513, "system_level_velocity_max": 18.71688437180279, "outflow_rate_mean": 1158.6914410458658, "cost1_max": 222.69321483755215, "cost1_mean": 197.25126262604294, "cost2_min": -44.83064295224399, "system_level_velocity_min": 11.895415600622316, "outflow_rate_max": 1277.595122540515, "cost1_min": 23.17932253627801, "cost2_mean": -28.481972628161216}, "timesteps_this_iter": 35470, "iterations_since_restore": 165, "episode_reward_min": 52.899526630354146, "episode_len_mean": 322.1, "time_this_iter_s": 24.998960494995117, "episodes_total": 7630, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969978>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969a58>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969b38>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4199.424619674683, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4199.424619674683, "episode_reward_max": 469.7678120238188, "info": {"num_steps_trained": 6136903, "grad_time_ms": 9090.643, "update_time_ms": 7.816, "num_steps_sampled": 6136903, "default": {"vf_explained_var": 0.7831543684005737, "policy_loss": -0.015455304645001888, "entropy": 1.585997223854065, "vf_loss": 48.3123664855957, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.3375000059604645, "kl": 0.017124367877840996, "total_loss": 48.30269241333008}, "load_time_ms": 4.879, "sample_time_ms": 16507.004}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6136903, "training_iteration": 165, "date": "2019-05-21_01-25-01", "timesteps_total": 6136903, "num_metric_batches_dropped": 0, "episode_reward_mean": 431.8426170359058, "timestamp": 1558401901, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.500804037956392, "cost2_max": -14.289899639614065, "outflow_rate_min": 470.2862331151305, "system_level_velocity_max": 18.712288234805026, "outflow_rate_mean": 1154.3384383716786, "cost1_max": 222.25512257701467, "cost1_mean": 197.35197207796963, "cost2_min": -44.83064295224399, "system_level_velocity_min": 11.895415600622316, "outflow_rate_max": 1264.8335778682192, "cost1_min": 23.223851892830776, "cost2_mean": -28.325163975603047}, "timesteps_this_iter": 35441, "iterations_since_restore": 166, "episode_reward_min": 53.78247089661401, "episode_len_mean": 322.1, "time_this_iter_s": 26.780507564544678, "episodes_total": 7680, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969e10>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89695c0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969cf8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4226.205127239227, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4226.205127239227, "episode_reward_max": 469.7678120238188, "info": {"num_steps_trained": 6172344, "grad_time_ms": 9158.725, "update_time_ms": 8.026, "num_steps_sampled": 6172344, "default": {"vf_explained_var": 0.7678773403167725, "policy_loss": -0.01473716739565134, "entropy": 1.5858685970306396, "vf_loss": 52.081607818603516, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.015497644431889057, "total_loss": 52.07210159301758}, "load_time_ms": 4.743, "sample_time_ms": 16486.004}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6172344, "training_iteration": 166, "date": "2019-05-21_01-25-28", "timesteps_total": 6172344, "num_metric_batches_dropped": 0, "episode_reward_mean": 428.5021503124312, "timestamp": 1558401928, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.328814641523877, "cost2_max": -14.289899639614065, "outflow_rate_min": 470.2862331151305, "system_level_velocity_max": 18.712288234805026, "outflow_rate_mean": 1150.74647989807, "cost1_max": 222.2317880160528, "cost1_mean": 195.51050499910517, "cost2_min": -42.27221533236151, "system_level_velocity_min": 11.895415600622316, "outflow_rate_max": 1265.9025050229254, "cost1_min": 23.223851892830776, "cost2_mean": -29.020759781505387}, "timesteps_this_iter": 35752, "iterations_since_restore": 167, "episode_reward_min": 53.78247089661401, "episode_len_mean": 322.1, "time_this_iter_s": 27.08573341369629, "episodes_total": 7726, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953e10>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953be0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953a90>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4253.290860652924, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4253.290860652924, "episode_reward_max": 469.51512810497917, "info": {"num_steps_trained": 6208096, "grad_time_ms": 9250.464, "update_time_ms": 8.114, "num_steps_sampled": 6208096, "default": {"vf_explained_var": 0.7434799671173096, "policy_loss": -0.012764738872647285, "entropy": 1.5741983652114868, "vf_loss": 53.577457427978516, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.016203338280320168, "total_loss": 53.570159912109375}, "load_time_ms": 4.622, "sample_time_ms": 16459.451}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6208096, "training_iteration": 167, "date": "2019-05-21_01-25-55", "timesteps_total": 6208096, "num_metric_batches_dropped": 0, "episode_reward_mean": 429.03953099920165, "timestamp": 1558401955, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.523901578819174, "cost2_max": -18.41088494240703, "outflow_rate_min": 992.5582724252495, "system_level_velocity_max": 18.537489333286715, "outflow_rate_mean": 1171.3093015029726, "cost1_max": 222.2317880160528, "cost1_mean": 199.8233450970746, "cost2_min": -41.10826582619329, "system_level_velocity_min": 13.262615695774794, "outflow_rate_max": 1265.9025050229254, "cost1_min": 160.2477897929174, "cost2_mean": -28.79208453290253}, "timesteps_this_iter": 34326, "iterations_since_restore": 168, "episode_reward_min": 371.58851533142763, "episode_len_mean": 325.0, "time_this_iter_s": 25.227362871170044, "episodes_total": 7769, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943588>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943a90>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89430f0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4278.518223524094, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4278.518223524094, "episode_reward_max": 469.51512810497917, "info": {"num_steps_trained": 6242422, "grad_time_ms": 9348.197, "update_time_ms": 8.32, "num_steps_sampled": 6242422, "default": {"vf_explained_var": 0.6953815817832947, "policy_loss": -0.013608264736831188, "entropy": 1.543056607246399, "vf_loss": 59.87345886230469, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.016391878947615623, "total_loss": 59.86537551879883}, "load_time_ms": 4.819, "sample_time_ms": 16424.77}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6242422, "training_iteration": 168, "date": "2019-05-21_01-26-20", "timesteps_total": 6242422, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.9011223447101, "timestamp": 1558401980, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.712072284825858, "cost2_max": -17.908277850745307, "outflow_rate_min": 905.1117293233084, "system_level_velocity_max": 18.600981627118827, "outflow_rate_mean": 1174.5349052230576, "cost1_max": 222.3091238462548, "cost1_mean": 201.61926038889433, "cost2_min": -48.00992154038266, "system_level_velocity_min": 12.175387471455501, "outflow_rate_max": 1265.801960784314, "cost1_min": 143.6207726034384, "cost2_mean": -28.50849678589779}, "timesteps_this_iter": 34980, "iterations_since_restore": 169, "episode_reward_min": 343.50706969687866, "episode_len_mean": 325.0, "time_this_iter_s": 26.440462589263916, "episodes_total": 7819, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969cf8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969b00>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969710>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4304.9586861133575, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4304.9586861133575, "episode_reward_max": 465.09708198664947, "info": {"num_steps_trained": 6277402, "grad_time_ms": 9418.022, "update_time_ms": 8.25, "num_steps_sampled": 6277402, "default": {"vf_explained_var": 0.7231726050376892, "policy_loss": -0.015044890344142914, "entropy": 1.5596553087234497, "vf_loss": 65.58934020996094, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01635138876736164, "total_loss": 65.57981872558594}, "load_time_ms": 4.727, "sample_time_ms": 16350.842}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6277402, "training_iteration": 169, "date": "2019-05-21_01-26-47", "timesteps_total": 6277402, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.1058644366094, "timestamp": 1558402007, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.833513944173134, "cost2_max": -17.908277850745307, "outflow_rate_min": 905.1117293233084, "system_level_velocity_max": 18.71051879729348, "outflow_rate_mean": 1179.8400761584153, "cost1_max": 222.3091238462548, "cost1_mean": 203.05541961048004, "cost2_min": -48.00992154038266, "system_level_velocity_min": 12.175387471455501, "outflow_rate_max": 1270.6779946574848, "cost1_min": 143.6207726034384, "cost2_mean": -28.509751076851085}, "timesteps_this_iter": 34296, "iterations_since_restore": 170, "episode_reward_min": 343.50706969687866, "episode_len_mean": 325.0, "time_this_iter_s": 24.94259023666382, "episodes_total": 7865, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953e10>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953be0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953908>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4329.901276350021, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4329.901276350021, "episode_reward_max": 465.09708198664947, "info": {"num_steps_trained": 6311698, "grad_time_ms": 9411.968, "update_time_ms": 8.266, "num_steps_sampled": 6311698, "default": {"vf_explained_var": 0.6801744103431702, "policy_loss": -0.014231392182409763, "entropy": 1.5207297801971436, "vf_loss": 66.54080963134766, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.01776612177491188, "total_loss": 66.53258514404297}, "load_time_ms": 4.542, "sample_time_ms": 16263.886}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6311698, "training_iteration": 170, "date": "2019-05-21_01-27-12", "timesteps_total": 6311698, "num_metric_batches_dropped": 0, "episode_reward_mean": 437.72255033961846, "timestamp": 1558402032, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.797281838031864, "cost2_max": -14.698201966185023, "outflow_rate_min": 465.10626898076305, "system_level_velocity_max": 18.71051879729348, "outflow_rate_mean": 1174.792835504276, "cost1_max": 222.49324324465698, "cost1_mean": 200.7286894747707, "cost2_min": -47.28996683438116, "system_level_velocity_min": 13.605283599161533, "outflow_rate_max": 1270.6779946574848, "cost1_min": 23.107862107984882, "cost2_mean": -28.934771285853355}, "timesteps_this_iter": 34460, "iterations_since_restore": 171, "episode_reward_min": 53.46086305750338, "episode_len_mean": 322.1, "time_this_iter_s": 23.796990871429443, "episodes_total": 7909, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943198>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943438>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943588>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4353.698267221451, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4353.698267221451, "episode_reward_max": 466.48000933486117, "info": {"num_steps_trained": 6346158, "grad_time_ms": 9297.896, "update_time_ms": 8.34, "num_steps_sampled": 6346158, "default": {"vf_explained_var": 0.7146214842796326, "policy_loss": -0.012647481635212898, "entropy": 1.5177608728408813, "vf_loss": 57.699581146240234, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01540431473404169, "total_loss": 57.692134857177734}, "load_time_ms": 4.29, "sample_time_ms": 16208.697}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6346158, "training_iteration": 171, "date": "2019-05-21_01-27-36", "timesteps_total": 6346158, "num_metric_batches_dropped": 0, "episode_reward_mean": 434.289714477212, "timestamp": 1558402056, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.706518423905845, "cost2_max": -14.698201966185023, "outflow_rate_min": 465.10626898076305, "system_level_velocity_max": 18.750922533847074, "outflow_rate_mean": 1171.785821020329, "cost1_max": 222.49324324465698, "cost1_mean": 199.63393124535796, "cost2_min": -47.28996683438116, "system_level_velocity_min": 13.605283599161533, "outflow_rate_max": 1270.6779946574848, "cost1_min": 23.107862107984882, "cost2_mean": -29.108318090007366}, "timesteps_this_iter": 34001, "iterations_since_restore": 172, "episode_reward_min": 53.46086305750338, "episode_len_mean": 322.1, "time_this_iter_s": 24.43300700187683, "episodes_total": 7955, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969ac8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89690f0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89690b8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4378.131274223328, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4378.131274223328, "episode_reward_max": 466.48000933486117, "info": {"num_steps_trained": 6380159, "grad_time_ms": 9040.043, "update_time_ms": 8.489, "num_steps_sampled": 6380159, "default": {"vf_explained_var": 0.7096580862998962, "policy_loss": -0.01512926910072565, "entropy": 1.548557162284851, "vf_loss": 56.76202392578125, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.016786683350801468, "total_loss": 56.752559661865234}, "load_time_ms": 4.347, "sample_time_ms": 16419.834}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6380159, "training_iteration": 172, "date": "2019-05-21_01-28-00", "timesteps_total": 6380159, "num_metric_batches_dropped": 0, "episode_reward_mean": 431.3823676314361, "timestamp": 1558402080, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.83032316957864, "cost2_max": -13.255833948040959, "outflow_rate_min": 511.17688865063195, "system_level_velocity_max": 18.767241135338306, "outflow_rate_mean": 1170.5589477303465, "cost1_max": 222.42153163793432, "cost1_mean": 200.6382429688157, "cost2_min": -50.63386549840444, "system_level_velocity_min": 13.167845628904601, "outflow_rate_max": 1268.4876464522602, "cost1_min": 23.06676765818827, "cost2_mean": -28.80384587037255}, "timesteps_this_iter": 34514, "iterations_since_restore": 173, "episode_reward_min": 49.118340189898156, "episode_len_mean": 322.1, "time_this_iter_s": 24.4215567111969, "episodes_total": 8004, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947b00>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947358>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969438>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4402.5528309345245, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4402.5528309345245, "episode_reward_max": 462.8753141627249, "info": {"num_steps_trained": 6414673, "grad_time_ms": 8745.259, "update_time_ms": 8.615, "num_steps_sampled": 6414673, "default": {"vf_explained_var": 0.6894360780715942, "policy_loss": -0.013949491083621979, "entropy": 1.5495716333389282, "vf_loss": 63.71289825439453, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01625220850110054, "total_loss": 63.70444107055664}, "load_time_ms": 4.44, "sample_time_ms": 16555.853}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6414673, "training_iteration": 173, "date": "2019-05-21_01-28-25", "timesteps_total": 6414673, "num_metric_batches_dropped": 0, "episode_reward_mean": 430.0858642067019, "timestamp": 1558402105, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.78351500379939, "cost2_max": -13.255833948040959, "outflow_rate_min": 511.17688865063195, "system_level_velocity_max": 18.767241135338306, "outflow_rate_mean": 1164.9340619196, "cost1_max": 222.41950490938672, "cost1_mean": 199.91634395912274, "cost2_min": -50.63386549840444, "system_level_velocity_min": 12.769528740857238, "outflow_rate_max": 1270.8507321812046, "cost1_min": 23.06676765818827, "cost2_mean": -29.006037826305388}, "timesteps_this_iter": 34640, "iterations_since_restore": 174, "episode_reward_min": 49.118340189898156, "episode_len_mean": 322.1, "time_this_iter_s": 23.841232299804688, "episodes_total": 8050, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953e10>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953518>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89534e0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4426.394063234329, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4426.394063234329, "episode_reward_max": 461.90711425280386, "info": {"num_steps_trained": 6449313, "grad_time_ms": 8517.312, "update_time_ms": 8.461, "num_steps_sampled": 6449313, "default": {"vf_explained_var": 0.7209881544113159, "policy_loss": -0.01485762745141983, "entropy": 1.5502052307128906, "vf_loss": 58.2875862121582, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.016432808712124825, "total_loss": 58.27827453613281}, "load_time_ms": 4.216, "sample_time_ms": 16593.224}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6449313, "training_iteration": 174, "date": "2019-05-21_01-28-49", "timesteps_total": 6449313, "num_metric_batches_dropped": 0, "episode_reward_mean": 428.784072279421, "timestamp": 1558402129, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.83579686873911, "cost2_max": -16.969488746215962, "outflow_rate_min": 963.2608035714284, "system_level_velocity_max": 18.667775049492448, "outflow_rate_mean": 1174.630377975901, "cost1_max": 222.41950490938672, "cost1_mean": 202.36577651289943, "cost2_min": -50.63386549840444, "system_level_velocity_min": 12.769528740857238, "outflow_rate_max": 1270.8507321812046, "cost1_min": 152.39746387826432, "cost2_mean": -29.161783264944997}, "timesteps_this_iter": 33608, "iterations_since_restore": 175, "episode_reward_min": 367.78407373998937, "episode_len_mean": 325.0, "time_this_iter_s": 23.90246081352234, "episodes_total": 8095, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89696d8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969e80>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969278>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4450.296524047852, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4450.296524047852, "episode_reward_max": 461.90711425280386, "info": {"num_steps_trained": 6482921, "grad_time_ms": 8321.988, "update_time_ms": 8.425, "num_steps_sampled": 6482921, "default": {"vf_explained_var": 0.7197797894477844, "policy_loss": -0.016133029013872147, "entropy": 1.5020525455474854, "vf_loss": 57.55205535888672, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.017319468781352043, "total_loss": 57.54176712036133}, "load_time_ms": 4.289, "sample_time_ms": 16678.245}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6482921, "training_iteration": 175, "date": "2019-05-21_01-29-13", "timesteps_total": 6482921, "num_metric_batches_dropped": 0, "episode_reward_mean": 433.322234143402, "timestamp": 1558402153, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.862914909912718, "cost2_max": -21.234350513089986, "outflow_rate_min": 955.8053201119158, "system_level_velocity_max": 18.636452480966344, "outflow_rate_mean": 1178.6209770915439, "cost1_max": 221.8359504170182, "cost1_mean": 202.91736319569307, "cost2_min": -45.310597414298584, "system_level_velocity_min": 13.223206569099387, "outflow_rate_max": 1264.1234851583122, "cost1_min": 157.6558396559185, "cost2_mean": -29.184696754055086}, "timesteps_this_iter": 34501, "iterations_since_restore": 176, "episode_reward_min": 355.6789952746548, "episode_len_mean": 325.0, "time_this_iter_s": 24.520423650741577, "episodes_total": 8143, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89430f0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943c50>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943438>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4474.816947698593, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4474.816947698593, "episode_reward_max": 460.57618078407256, "info": {"num_steps_trained": 6517422, "grad_time_ms": 8088.391, "update_time_ms": 8.202, "num_steps_sampled": 6517422, "default": {"vf_explained_var": 0.6676318049430847, "policy_loss": -0.013820976950228214, "entropy": 1.547757625579834, "vf_loss": 66.64759826660156, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.017138725146651268, "total_loss": 66.63956451416016}, "load_time_ms": 4.288, "sample_time_ms": 16688.505}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6517422, "training_iteration": 176, "date": "2019-05-21_01-29-37", "timesteps_total": 6517422, "num_metric_batches_dropped": 0, "episode_reward_mean": 434.91525914096593, "timestamp": 1558402177, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.839571193794697, "cost2_max": -21.234350513089986, "outflow_rate_min": 927.7957666317695, "system_level_velocity_max": 18.64049600154775, "outflow_rate_mean": 1180.4771314480097, "cost1_max": 221.8359504170182, "cost1_mean": 202.65137148079637, "cost2_min": -45.310597414298584, "system_level_velocity_min": 11.375305769429218, "outflow_rate_max": 1267.1729632997303, "cost1_min": 137.0773495722451, "cost2_mean": -29.44843517152226}, "timesteps_this_iter": 34524, "iterations_since_restore": 177, "episode_reward_min": 355.6789952746548, "episode_len_mean": 325.0, "time_this_iter_s": 24.134098768234253, "episodes_total": 8188, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953e80>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89537f0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89534e0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4498.951046466827, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4498.951046466827, "episode_reward_max": 461.47361989190483, "info": {"num_steps_trained": 6551946, "grad_time_ms": 7895.69, "update_time_ms": 8.051, "num_steps_sampled": 6551946, "default": {"vf_explained_var": 0.7157137989997864, "policy_loss": -0.014000521041452885, "entropy": 1.534450888633728, "vf_loss": 60.82035446166992, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01723179593682289, "total_loss": 60.812171936035156}, "load_time_ms": 4.226, "sample_time_ms": 16586.337}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6551946, "training_iteration": 177, "date": "2019-05-21_01-30-01", "timesteps_total": 6551946, "num_metric_batches_dropped": 0, "episode_reward_mean": 435.8954134980006, "timestamp": 1558402201, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.727706432870246, "cost2_max": -20.669183242517665, "outflow_rate_min": 918.0115739516998, "system_level_velocity_max": 18.650806780617863, "outflow_rate_mean": 1182.6315264637578, "cost1_max": 222.40455869594007, "cost1_mean": 201.3723010326636, "cost2_min": -45.76617791001392, "system_level_velocity_min": 11.375305769429218, "outflow_rate_max": 1274.128609086786, "cost1_min": 137.0773495722451, "cost2_mean": -30.171203790432113}, "timesteps_this_iter": 35464, "iterations_since_restore": 178, "episode_reward_min": 340.2361910632735, "episode_len_mean": 325.0, "time_this_iter_s": 25.170469045639038, "episodes_total": 8233, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947b00>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947e80>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947320>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4524.121515512466, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4524.121515512466, "episode_reward_max": 470.76260830159015, "info": {"num_steps_trained": 6587410, "grad_time_ms": 7824.014, "update_time_ms": 7.921, "num_steps_sampled": 6587410, "default": {"vf_explained_var": 0.7551794052124023, "policy_loss": -0.01301963347941637, "entropy": 1.5578727722167969, "vf_loss": 52.87926483154297, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.3375000059604645, "kl": 0.016925686970353127, "total_loss": 52.87195587158203}, "load_time_ms": 3.96, "sample_time_ms": 16654.436}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6587410, "training_iteration": 178, "date": "2019-05-21_01-30-27", "timesteps_total": 6587410, "num_metric_batches_dropped": 0, "episode_reward_mean": 437.82984460570844, "timestamp": 1558402227, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.728805526444518, "cost2_max": -16.40355526896247, "outflow_rate_min": 466.74083028559994, "system_level_velocity_max": 18.74331869772425, "outflow_rate_mean": 1180.7989860898042, "cost1_max": 223.15542065071867, "cost1_mean": 199.58055463058622, "cost2_min": -45.76617791001392, "system_level_velocity_min": 12.02906778266659, "outflow_rate_max": 1281.9469991322328, "cost1_min": 22.87695274811059, "cost2_mean": -30.33629421280221}, "timesteps_this_iter": 35268, "iterations_since_restore": 179, "episode_reward_min": 52.09540211736038, "episode_len_mean": 322.1, "time_this_iter_s": 26.08140993118286, "episodes_total": 8282, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89665c0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966470>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89660b8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4550.202925443649, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4550.202925443649, "episode_reward_max": 470.76260830159015, "info": {"num_steps_trained": 6622678, "grad_time_ms": 7840.127, "update_time_ms": 8.037, "num_steps_sampled": 6622678, "default": {"vf_explained_var": 0.7401047348976135, "policy_loss": -0.013837923295795918, "entropy": 1.5494029521942139, "vf_loss": 58.7282829284668, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.016889210790395737, "total_loss": 58.720149993896484}, "load_time_ms": 3.867, "sample_time_ms": 16602.043}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6622678, "training_iteration": 179, "date": "2019-05-21_01-30-53", "timesteps_total": 6622678, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.1827007014961, "timestamp": 1558402253, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.889645969514707, "cost2_max": -13.63918010408424, "outflow_rate_min": 466.74083028559994, "system_level_velocity_max": 18.858703758427257, "outflow_rate_mean": 1178.1588074604522, "cost1_max": 223.15542065071867, "cost1_mean": 199.35076003954393, "cost2_min": -43.45079986144397, "system_level_velocity_min": 12.02906778266659, "outflow_rate_max": 1281.9469991322328, "cost1_min": 22.87695274811059, "cost2_mean": -29.920460236125788}, "timesteps_this_iter": 35038, "iterations_since_restore": 180, "episode_reward_min": 50.825254281083595, "episode_len_mean": 319.2, "time_this_iter_s": 26.03565764427185, "episodes_total": 8330, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973b00>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973a20>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973e48>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4576.238583087921, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4576.238583087921, "episode_reward_max": 464.3572824242177, "info": {"num_steps_trained": 6657716, "grad_time_ms": 7926.917, "update_time_ms": 8.021, "num_steps_sampled": 6657716, "default": {"vf_explained_var": 0.7602056860923767, "policy_loss": -0.013953846879303455, "entropy": 1.5390220880508423, "vf_loss": 53.12038803100586, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01695006527006626, "total_loss": 53.11215591430664}, "load_time_ms": 3.867, "sample_time_ms": 16624.005}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6657716, "training_iteration": 180, "date": "2019-05-21_01-31-19", "timesteps_total": 6657716, "num_metric_batches_dropped": 0, "episode_reward_mean": 433.50128979583593, "timestamp": 1558402279, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.676296403269472, "cost2_max": -13.63918010408424, "outflow_rate_min": 502.1133248918595, "system_level_velocity_max": 18.858703758427257, "outflow_rate_mean": 1174.0057700036753, "cost1_max": 222.94667460841202, "cost1_mean": 198.11216362719654, "cost2_min": -44.070287249445634, "system_level_velocity_min": 11.530072472851147, "outflow_rate_max": 1279.6913835559446, "cost1_min": 23.265683246658874, "cost2_mean": -30.51047897663739}, "timesteps_this_iter": 35956, "iterations_since_restore": 181, "episode_reward_min": 50.825254281083595, "episode_len_mean": 321.03, "time_this_iter_s": 25.208925247192383, "episodes_total": 8373, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943be0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943518>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943080>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4601.4475083351135, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4601.4475083351135, "episode_reward_max": 473.50615202878885, "info": {"num_steps_trained": 6693672, "grad_time_ms": 8101.875, "update_time_ms": 8.143, "num_steps_sampled": 6693672, "default": {"vf_explained_var": 0.7909833192825317, "policy_loss": -0.01375722885131836, "entropy": 1.5772547721862793, "vf_loss": 47.98125076293945, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.01773654855787754, "total_loss": 47.973480224609375}, "load_time_ms": 4.287, "sample_time_ms": 16590.51}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6693672, "training_iteration": 181, "date": "2019-05-21_01-31-44", "timesteps_total": 6693672, "num_metric_batches_dropped": 0, "episode_reward_mean": 434.0078343152464, "timestamp": 1558402304, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.520512459557537, "cost2_max": -13.63918010408424, "outflow_rate_min": 476.19572143481514, "system_level_velocity_max": 18.858703758427257, "outflow_rate_mean": 1163.9434007106966, "cost1_max": 223.34379420333818, "cost1_mean": 194.4243787347928, "cost2_min": -44.070287249445634, "system_level_velocity_min": 11.530072472851147, "outflow_rate_max": 1279.6913835559446, "cost1_min": 23.265683246658874, "cost2_mean": -30.559661876296303}, "timesteps_this_iter": 36595, "iterations_since_restore": 182, "episode_reward_min": 50.825254281083595, "episode_len_mean": 318.13, "time_this_iter_s": 26.48054599761963, "episodes_total": 8424, "hostname": "flow-main", "episodes_this_iter": 51, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966470>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966da0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89663c8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4627.928054332733, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4627.928054332733, "episode_reward_max": 473.50615202878885, "info": {"num_steps_trained": 6730267, "grad_time_ms": 8433.857, "update_time_ms": 7.975, "num_steps_sampled": 6730267, "default": {"vf_explained_var": 0.7830208539962769, "policy_loss": -0.014185035601258278, "entropy": 1.6215952634811401, "vf_loss": 53.25376892089844, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.018296722322702408, "total_loss": 53.245758056640625}, "load_time_ms": 4.137, "sample_time_ms": 16460.892}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6730267, "training_iteration": 182, "date": "2019-05-21_01-32-11", "timesteps_total": 6730267, "num_metric_batches_dropped": 0, "episode_reward_mean": 431.0758291027175, "timestamp": 1558402331, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.4207254694753, "cost2_max": -15.871358095160561, "outflow_rate_min": 476.19572143481514, "system_level_velocity_max": 18.72029164556198, "outflow_rate_mean": 1171.208708471294, "cost1_max": 223.34379420333818, "cost1_mean": 196.16564629811987, "cost2_min": -42.97872824911983, "system_level_velocity_min": 12.552056147936396, "outflow_rate_max": 1278.52155646347, "cost1_min": 23.317175076754896, "cost2_mean": -31.002801526659987}, "timesteps_this_iter": 36349, "iterations_since_restore": 183, "episode_reward_min": 52.04807646455827, "episode_len_mean": 322.1, "time_this_iter_s": 26.867638111114502, "episodes_total": 8470, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973ac8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973748>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973ba8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4654.795692443848, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4654.795692443848, "episode_reward_max": 469.60376299338213, "info": {"num_steps_trained": 6766616, "grad_time_ms": 8792.879, "update_time_ms": 7.744, "num_steps_sampled": 6766616, "default": {"vf_explained_var": 0.7952081561088562, "policy_loss": -0.015812890604138374, "entropy": 1.6045268774032593, "vf_loss": 48.464988708496094, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.017576701939105988, "total_loss": 48.455108642578125}, "load_time_ms": 4.313, "sample_time_ms": 16345.339}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6766616, "training_iteration": 183, "date": "2019-05-21_01-32-37", "timesteps_total": 6766616, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.7947997638428, "timestamp": 1558402357, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.535496101103544, "cost2_max": -21.64319711138916, "outflow_rate_min": 876.4313317191284, "system_level_velocity_max": 18.771120604940265, "outflow_rate_mean": 1179.7027496842327, "cost1_max": 223.36341630893497, "cost1_mean": 199.15447176128032, "cost2_min": -45.80998799659612, "system_level_velocity_min": 11.146531194169862, "outflow_rate_max": 1288.658304021162, "cost1_min": 131.44540333617675, "cost2_mean": -30.715748158136606}, "timesteps_this_iter": 36259, "iterations_since_restore": 184, "episode_reward_min": 334.46408349083873, "episode_len_mean": 325.0, "time_this_iter_s": 27.645301580429077, "episodes_total": 8513, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956d68>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956048>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89560f0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4682.440994024277, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4682.440994024277, "episode_reward_max": 473.52105749931644, "info": {"num_steps_trained": 6802875, "grad_time_ms": 9213.871, "update_time_ms": 7.919, "num_steps_sampled": 6802875, "default": {"vf_explained_var": 0.8353022336959839, "policy_loss": -0.014861508272588253, "entropy": 1.5901873111724854, "vf_loss": 46.51999282836914, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01929333060979843, "total_loss": 46.51164245605469}, "load_time_ms": 4.291, "sample_time_ms": 16301.4}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6802875, "training_iteration": 184, "date": "2019-05-21_01-33-05", "timesteps_total": 6802875, "num_metric_batches_dropped": 0, "episode_reward_mean": 440.340156681554, "timestamp": 1558402385, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.710318612434023, "cost2_max": -16.828539709104174, "outflow_rate_min": 483.2702740048214, "system_level_velocity_max": 19.03046544931841, "outflow_rate_mean": 1179.2777132173896, "cost1_max": 223.36341630893497, "cost1_mean": 199.0479869907635, "cost2_min": -45.80998799659612, "system_level_velocity_min": 11.146531194169862, "outflow_rate_max": 1288.658304021162, "cost1_min": 24.704565698670407, "cost2_mean": -30.252997817049152}, "timesteps_this_iter": 35926, "iterations_since_restore": 185, "episode_reward_min": 55.28423917626348, "episode_len_mean": 322.12, "time_this_iter_s": 25.653998374938965, "episodes_total": 8561, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966e10>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966278>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966908>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4708.094992399216, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4708.094992399216, "episode_reward_max": 473.52105749931644, "info": {"num_steps_trained": 6838801, "grad_time_ms": 9457.662, "update_time_ms": 8.016, "num_steps_sampled": 6838801, "default": {"vf_explained_var": 0.774602472782135, "policy_loss": -0.01521763764321804, "entropy": 1.6007543802261353, "vf_loss": 55.051090240478516, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.017819905653595924, "total_loss": 55.04188919067383}, "load_time_ms": 4.39, "sample_time_ms": 16232.115}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6838801, "training_iteration": 185, "date": "2019-05-21_01-33-31", "timesteps_total": 6838801, "num_metric_batches_dropped": 0, "episode_reward_mean": 437.67791557189094, "timestamp": 1558402411, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.67482052440503, "cost2_max": -16.828539709104174, "outflow_rate_min": 483.2702740048214, "system_level_velocity_max": 19.03046544931841, "outflow_rate_mean": 1180.9707166837234, "cost1_max": 223.05791380029032, "cost1_mean": 198.7379362728938, "cost2_min": -44.23575634684069, "system_level_velocity_min": 11.146531194169862, "outflow_rate_max": 1291.740767152825, "cost1_min": 24.704565698670407, "cost2_mean": -30.67392379922718}, "timesteps_this_iter": 35675, "iterations_since_restore": 186, "episode_reward_min": 55.28423917626348, "episode_len_mean": 322.12, "time_this_iter_s": 26.9463529586792, "episodes_total": 8608, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973e48>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89738d0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89735f8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4735.041345357895, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4735.041345357895, "episode_reward_max": 469.5875525625317, "info": {"num_steps_trained": 6874476, "grad_time_ms": 9734.344, "update_time_ms": 8.007, "num_steps_sampled": 6874476, "default": {"vf_explained_var": 0.7985357046127319, "policy_loss": -0.015085762366652489, "entropy": 1.5811502933502197, "vf_loss": 51.74043273925781, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.017799116671085358, "total_loss": 51.731353759765625}, "load_time_ms": 4.536, "sample_time_ms": 16195.645}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6874476, "training_iteration": 186, "date": "2019-05-21_01-33-58", "timesteps_total": 6874476, "num_metric_batches_dropped": 0, "episode_reward_mean": 437.3075645634308, "timestamp": 1558402438, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.45945900674742, "cost2_max": -19.35940795545932, "outflow_rate_min": 904.2741260363074, "system_level_velocity_max": 18.792057723074215, "outflow_rate_mean": 1179.4150853224032, "cost1_max": 222.99471227501158, "cost1_mean": 197.63613256107078, "cost2_min": -44.23575634684069, "system_level_velocity_min": 11.487782588921563, "outflow_rate_max": 1291.740767152825, "cost1_min": 138.04533546771842, "cost2_mean": -31.60883937806454}, "timesteps_this_iter": 36838, "iterations_since_restore": 187, "episode_reward_min": 307.435206433936, "episode_len_mean": 323.92, "time_this_iter_s": 26.750191926956177, "episodes_total": 8655, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943080>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943cf8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943518>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4761.791537284851, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4761.791537284851, "episode_reward_max": 470.3986406070682, "info": {"num_steps_trained": 6911314, "grad_time_ms": 9927.424, "update_time_ms": 8.117, "num_steps_sampled": 6911314, "default": {"vf_explained_var": 0.8284186124801636, "policy_loss": -0.014757199212908745, "entropy": 1.6436339616775513, "vf_loss": 41.89927673339844, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.3375000059604645, "kl": 0.018196186050772667, "total_loss": 41.89066696166992}, "load_time_ms": 4.781, "sample_time_ms": 16263.461}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6911314, "training_iteration": 187, "date": "2019-05-21_01-34-25", "timesteps_total": 6911314, "num_metric_batches_dropped": 0, "episode_reward_mean": 438.671149258709, "timestamp": 1558402465, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.444033495743135, "cost2_max": -14.504125528216656, "outflow_rate_min": 473.20973104725, "system_level_velocity_max": 18.792057723074215, "outflow_rate_mean": 1167.9515352571404, "cost1_max": 223.18033063430948, "cost1_mean": 195.47559729547763, "cost2_min": -43.75327069350938, "system_level_velocity_min": 11.487782588921563, "outflow_rate_max": 1302.9864806043543, "cost1_min": 23.072386614094434, "cost2_mean": -31.443433684932362}, "timesteps_this_iter": 36706, "iterations_since_restore": 188, "episode_reward_min": 52.760603841046205, "episode_len_mean": 321.02, "time_this_iter_s": 26.820785760879517, "episodes_total": 8700, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966518>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89667b8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966048>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4788.612323045731, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4788.612323045731, "episode_reward_max": 474.77211662838874, "info": {"num_steps_trained": 6948020, "grad_time_ms": 10048.802, "update_time_ms": 8.162, "num_steps_sampled": 6948020, "default": {"vf_explained_var": 0.8322502970695496, "policy_loss": -0.013751931488513947, "entropy": 1.6427688598632812, "vf_loss": 43.96528244018555, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.018507927656173706, "total_loss": 43.9577751159668}, "load_time_ms": 4.79, "sample_time_ms": 16307.566}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6948020, "training_iteration": 188, "date": "2019-05-21_01-34-52", "timesteps_total": 6948020, "num_metric_batches_dropped": 0, "episode_reward_mean": 434.11841480175957, "timestamp": 1558402492, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.46474961925084, "cost2_max": -14.504125528216656, "outflow_rate_min": 473.20973104725, "system_level_velocity_max": 18.724238334621454, "outflow_rate_mean": 1173.2355607511217, "cost1_max": 223.18033063430948, "cost1_mean": 196.64172834408188, "cost2_min": -47.26554453842916, "system_level_velocity_min": 12.190665691125513, "outflow_rate_max": 1302.9864806043543, "cost1_min": 23.072386614094434, "cost2_mean": -31.262437172488728}, "timesteps_this_iter": 36554, "iterations_since_restore": 189, "episode_reward_min": 52.760603841046205, "episode_len_mean": 322.1, "time_this_iter_s": 26.539464473724365, "episodes_total": 8748, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973e48>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973748>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89736a0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4815.151787519455, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4815.151787519455, "episode_reward_max": 474.77211662838874, "info": {"num_steps_trained": 6984574, "grad_time_ms": 10054.409, "update_time_ms": 8.05, "num_steps_sampled": 6984574, "default": {"vf_explained_var": 0.8278337717056274, "policy_loss": -0.014446521177887917, "entropy": 1.6212908029556274, "vf_loss": 44.01237487792969, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.01769438199698925, "total_loss": 44.0038948059082}, "load_time_ms": 4.903, "sample_time_ms": 16348.152}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6984574, "training_iteration": 189, "date": "2019-05-21_01-35-18", "timesteps_total": 6984574, "num_metric_batches_dropped": 0, "episode_reward_mean": 437.1674270141701, "timestamp": 1558402518, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.46117905593171, "cost2_max": -13.0154895256089, "outflow_rate_min": 501.62470491789117, "system_level_velocity_max": 18.765221163093308, "outflow_rate_mean": 1172.7000324985913, "cost1_max": 223.27286668321472, "cost1_mean": 195.75839087151405, "cost2_min": -47.8838849786584, "system_level_velocity_min": 12.660886118990732, "outflow_rate_max": 1295.0430005729224, "cost1_min": 23.06668036421195, "cost2_mean": -31.766030403343237}, "timesteps_this_iter": 36044, "iterations_since_restore": 190, "episode_reward_min": 51.121874589830426, "episode_len_mean": 320.92, "time_this_iter_s": 26.450936555862427, "episodes_total": 8794, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969320>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969780>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89695f8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4841.602724075317, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4841.602724075317, "episode_reward_max": 472.5282050655981, "info": {"num_steps_trained": 7020618, "grad_time_ms": 10103.935, "update_time_ms": 8.007, "num_steps_sampled": 7020618, "default": {"vf_explained_var": 0.8138734102249146, "policy_loss": -0.01226257998496294, "entropy": 1.59083092212677, "vf_loss": 48.67466354370117, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.016487987712025642, "total_loss": 48.66796112060547}, "load_time_ms": 5.085, "sample_time_ms": 16340.666}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7020618, "training_iteration": 190, "date": "2019-05-21_01-35-45", "timesteps_total": 7020618, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.8823421557239, "timestamp": 1558402545, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.87610847184288, "cost2_max": -13.0154895256089, "outflow_rate_min": 501.62470491789117, "system_level_velocity_max": 18.83393925031911, "outflow_rate_mean": 1184.0374879790188, "cost1_max": 223.66296531976798, "cost1_mean": 198.2991507176079, "cost2_min": -47.8838849786584, "system_level_velocity_min": 12.723147247517899, "outflow_rate_max": 1299.8587389402185, "cost1_min": 23.06668036421195, "cost2_mean": -30.62360012517425}, "timesteps_this_iter": 36064, "iterations_since_restore": 191, "episode_reward_min": 49.41531464323289, "episode_len_mean": 318.02, "time_this_iter_s": 25.556416749954224, "episodes_total": 8840, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966400>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89665c0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966c50>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4867.159140825272, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4867.159140825272, "episode_reward_max": 472.5282050655981, "info": {"num_steps_trained": 7056682, "grad_time_ms": 10018.92, "update_time_ms": 7.747, "num_steps_sampled": 7056682, "default": {"vf_explained_var": 0.8028621077537537, "policy_loss": -0.014071866869926453, "entropy": 1.6294994354248047, "vf_loss": 50.23534393310547, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01879085972905159, "total_loss": 50.22761917114258}, "load_time_ms": 4.593, "sample_time_ms": 16461.17}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7056682, "training_iteration": 191, "date": "2019-05-21_01-36-10", "timesteps_total": 7056682, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.6172796980095, "timestamp": 1558402570, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.704346291705868, "cost2_max": -13.920810554885787, "outflow_rate_min": 504.5827016154056, "system_level_velocity_max": 19.00852314301839, "outflow_rate_mean": 1178.7768709024454, "cost1_max": 223.66296531976798, "cost1_mean": 196.46527424001434, "cost2_min": -47.54059083204251, "system_level_velocity_min": 11.12319177868075, "outflow_rate_max": 1299.8587389402185, "cost1_min": 23.244881741758924, "cost2_mean": -30.897912395837192}, "timesteps_this_iter": 36797, "iterations_since_restore": 192, "episode_reward_min": 49.41531464323289, "episode_len_mean": 318.16, "time_this_iter_s": 25.315379858016968, "episodes_total": 8888, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973cc0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973da0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973860>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4892.474520683289, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4892.474520683289, "episode_reward_max": 470.2478467338555, "info": {"num_steps_trained": 7093479, "grad_time_ms": 9909.019, "update_time_ms": 7.751, "num_steps_sampled": 7093479, "default": {"vf_explained_var": 0.8379597663879395, "policy_loss": -0.013707446865737438, "entropy": 1.6401464939117432, "vf_loss": 47.39732360839844, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.3375000059604645, "kl": 0.0175928995013237, "total_loss": 47.389549255371094}, "load_time_ms": 4.699, "sample_time_ms": 16456.185}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7093479, "training_iteration": 192, "date": "2019-05-21_01-36-36", "timesteps_total": 7093479, "num_metric_batches_dropped": 0, "episode_reward_mean": 433.3298082725148, "timestamp": 1558402596, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.498685100921506, "cost2_max": -14.538543195547414, "outflow_rate_min": 887.5287461869995, "system_level_velocity_max": 19.00852314301839, "outflow_rate_mean": 1182.7626921300223, "cost1_max": 223.04663093563073, "cost1_mean": 196.9382560438253, "cost2_min": -44.86887426346091, "system_level_velocity_min": 11.12319177868075, "outflow_rate_max": 1314.9623414927767, "cost1_min": 133.42107597865663, "cost2_mean": -31.556775711706354}, "timesteps_this_iter": 36369, "iterations_since_restore": 193, "episode_reward_min": 305.30515631402943, "episode_len_mean": 322.24, "time_this_iter_s": 25.748767614364624, "episodes_total": 8934, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89428d0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969908>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969470>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4918.223288297653, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4918.223288297653, "episode_reward_max": 474.0776194036514, "info": {"num_steps_trained": 7129848, "grad_time_ms": 9922.007, "update_time_ms": 7.721, "num_steps_sampled": 7129848, "default": {"vf_explained_var": 0.7951405644416809, "policy_loss": -0.013330892659723759, "entropy": 1.6390206813812256, "vf_loss": 51.81290817260742, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.018620453774929047, "total_loss": 51.80586242675781}, "load_time_ms": 4.702, "sample_time_ms": 16331.559}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7129848, "training_iteration": 193, "date": "2019-05-21_01-37-01", "timesteps_total": 7129848, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.83883209963557, "timestamp": 1558402621, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.271271546566886, "cost2_max": -21.07905618135674, "outflow_rate_min": 887.5287461869995, "system_level_velocity_max": 18.81775415559931, "outflow_rate_mean": 1177.161978482433, "cost1_max": 223.85556366110063, "cost1_mean": 195.92335220576112, "cost2_min": -47.02899217028528, "system_level_velocity_min": 11.12319177868075, "outflow_rate_max": 1314.9623414927767, "cost1_min": 133.42107597865663, "cost2_mean": -32.07303587948586}, "timesteps_this_iter": 36973, "iterations_since_restore": 194, "episode_reward_min": 314.6139378064977, "episode_len_mean": 325.0, "time_this_iter_s": 24.90067434310913, "episodes_total": 8981, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973908>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973e80>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973550>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4943.123962640762, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4943.123962640762, "episode_reward_max": 474.43085322669685, "info": {"num_steps_trained": 7166821, "grad_time_ms": 9686.15, "update_time_ms": 7.909, "num_steps_sampled": 7166821, "default": {"vf_explained_var": 0.8421885967254639, "policy_loss": -0.013966040685772896, "entropy": 1.6565227508544922, "vf_loss": 43.67927551269531, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.019186530262231827, "total_loss": 43.67177963256836}, "load_time_ms": 4.856, "sample_time_ms": 16292.717}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7166821, "training_iteration": 194, "date": "2019-05-21_01-37-26", "timesteps_total": 7166821, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.8774859459258, "timestamp": 1558402646, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.58734119518111, "cost2_max": -18.512077692542654, "outflow_rate_min": 424.41818432384355, "system_level_velocity_max": 18.862082376158817, "outflow_rate_mean": 1181.2802101844309, "cost1_max": 223.85556366110063, "cost1_mean": 197.50085204695657, "cost2_min": -48.13405807212769, "system_level_velocity_min": 11.962002247246584, "outflow_rate_max": 1311.6556716293073, "cost1_min": 22.8130886741277, "cost2_mean": -31.84915660187999}, "timesteps_this_iter": 36038, "iterations_since_restore": 195, "episode_reward_min": 55.652417041228986, "episode_len_mean": 322.1, "time_this_iter_s": 26.22253394126892, "episodes_total": 9029, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973cc0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973e48>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973f28>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4969.346496582031, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4969.346496582031, "episode_reward_max": 474.43085322669685, "info": {"num_steps_trained": 7202859, "grad_time_ms": 9699.204, "update_time_ms": 7.91, "num_steps_sampled": 7202859, "default": {"vf_explained_var": 0.7834499478340149, "policy_loss": -0.015244826674461365, "entropy": 1.6232962608337402, "vf_loss": 55.05225372314453, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.018780840560793877, "total_loss": 55.04335021972656}, "load_time_ms": 4.788, "sample_time_ms": 16337.661}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7202859, "training_iteration": 195, "date": "2019-05-21_01-37-53", "timesteps_total": 7202859, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.33710620725907, "timestamp": 1558402673, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.426131827611357, "cost2_max": -18.512077692542654, "outflow_rate_min": 424.41818432384355, "system_level_velocity_max": 18.862082376158817, "outflow_rate_mean": 1176.3994747159338, "cost1_max": 223.24354860989996, "cost1_mean": 195.47589794431747, "cost2_min": -49.66149567865041, "system_level_velocity_min": 9.430370654925145, "outflow_rate_max": 1311.6556716293073, "cost1_min": 22.8130886741277, "cost2_mean": -33.66589678763139}, "timesteps_this_iter": 37598, "iterations_since_restore": 196, "episode_reward_min": 55.652417041228986, "episode_len_mean": 321.82, "time_this_iter_s": 27.732168912887573, "episodes_total": 9074, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943080>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943c50>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89430f0>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 4997.078665494919, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 4997.078665494919, "episode_reward_max": 471.33708765348973, "info": {"num_steps_trained": 7240457, "grad_time_ms": 9751.421, "update_time_ms": 7.965, "num_steps_sampled": 7240457, "default": {"vf_explained_var": 0.8442884683609009, "policy_loss": -0.015101977623999119, "entropy": 1.6832760572433472, "vf_loss": 42.33212661743164, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.017827924340963364, "total_loss": 42.32304382324219}, "load_time_ms": 4.77, "sample_time_ms": 16365.182}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7240457, "training_iteration": 196, "date": "2019-05-21_01-38-20", "timesteps_total": 7240457, "num_metric_batches_dropped": 0, "episode_reward_mean": 435.45413957724924, "timestamp": 1558402700, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.23626367432616, "cost2_max": -23.555959916690494, "outflow_rate_min": 841.0781467181467, "system_level_velocity_max": 18.8200281616036, "outflow_rate_mean": 1174.8430603827176, "cost1_max": 222.62376819874467, "cost1_mean": 193.85476261347983, "cost2_min": -49.66149567865041, "system_level_velocity_min": 9.430370654925145, "outflow_rate_max": 1301.686771097341, "cost1_min": 115.63258091256725, "cost2_mean": -33.814365197643724}, "timesteps_this_iter": 35922, "iterations_since_restore": 197, "episode_reward_min": 301.42785981326057, "episode_len_mean": 322.54, "time_this_iter_s": 24.617214918136597, "episodes_total": 9121, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973550>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973940>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973ba8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 5021.695880413055, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 5021.695880413055, "episode_reward_max": 471.33708765348973, "info": {"num_steps_trained": 7276379, "grad_time_ms": 9566.312, "update_time_ms": 7.892, "num_steps_sampled": 7276379, "default": {"vf_explained_var": 0.7815313935279846, "policy_loss": -0.015639837831258774, "entropy": 1.6690113544464111, "vf_loss": 53.54224395751953, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.01856868900358677, "total_loss": 53.532867431640625}, "load_time_ms": 4.613, "sample_time_ms": 16337.526}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7276379, "training_iteration": 197, "date": "2019-05-21_01-38-45", "timesteps_total": 7276379, "num_metric_batches_dropped": 0, "episode_reward_mean": 434.40011824108944, "timestamp": 1558402725, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.679002507934307, "cost2_max": -23.555959916690494, "outflow_rate_min": 952.257831010453, "system_level_velocity_max": 18.8200281616036, "outflow_rate_mean": 1188.8834694875536, "cost1_max": 222.7933180176499, "cost1_mean": 199.04599340695324, "cost2_min": -47.39664749910647, "system_level_velocity_min": 12.605558096648803, "outflow_rate_max": 1298.2437973899237, "cost1_min": 147.36508203780818, "cost2_mean": -31.83387598117633}, "timesteps_this_iter": 35070, "iterations_since_restore": 198, "episode_reward_min": 301.42785981326057, "episode_len_mean": 322.82, "time_this_iter_s": 23.70900869369507, "episodes_total": 9165, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973860>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973b70>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973828>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 5045.4048891067505, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 5045.4048891067505, "episode_reward_max": 468.15810018111983, "info": {"num_steps_trained": 7311449, "grad_time_ms": 9373.52, "update_time_ms": 7.862, "num_steps_sampled": 7311449, "default": {"vf_explained_var": 0.7689694166183472, "policy_loss": -0.017010752111673355, "entropy": 1.6355890035629272, "vf_loss": 48.72216033935547, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.018874268978834152, "total_loss": 48.711517333984375}, "load_time_ms": 4.629, "sample_time_ms": 16215.981}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7311449, "training_iteration": 198, "date": "2019-05-21_01-39-09", "timesteps_total": 7311449, "num_metric_batches_dropped": 0, "episode_reward_mean": 435.6809674002019, "timestamp": 1558402749, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.535552449891256, "cost2_max": -23.012814065579605, "outflow_rate_min": 824.7298167921774, "system_level_velocity_max": 18.783675803298376, "outflow_rate_mean": 1188.4158332966908, "cost1_max": 223.13247280835313, "cost1_mean": 199.09508753302075, "cost2_min": -46.93377700370215, "system_level_velocity_min": 10.621939182080832, "outflow_rate_max": 1298.2437973899237, "cost1_min": 127.69729539062035, "cost2_mean": -32.09662791635608}, "timesteps_this_iter": 35835, "iterations_since_restore": 199, "episode_reward_min": 257.00516978342745, "episode_len_mean": 325.0, "time_this_iter_s": 24.78311848640442, "episodes_total": 9214, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943d30>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943390>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943438>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 5070.188007593155, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 5070.188007593155, "episode_reward_max": 467.5811142599244, "info": {"num_steps_trained": 7347284, "grad_time_ms": 9339.013, "update_time_ms": 8.06, "num_steps_sampled": 7347284, "default": {"vf_explained_var": 0.7998852729797363, "policy_loss": -0.01748662069439888, "entropy": 1.6415352821350098, "vf_loss": 50.0176887512207, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750003576278687, "kl": 0.01880693808197975, "total_loss": 50.006553649902344}, "load_time_ms": 4.728, "sample_time_ms": 16074.395}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7347284, "training_iteration": 199, "date": "2019-05-21_01-39-34", "timesteps_total": 7347284, "num_metric_batches_dropped": 0, "episode_reward_mean": 437.31488368439136, "timestamp": 1558402774, "pid": 317, "done": false}
{"custom_metrics": {"system_level_velocity_mean": 16.308749772981916, "cost2_max": -21.66141952181511, "outflow_rate_min": 824.7298167921774, "system_level_velocity_max": 18.783675803298376, "outflow_rate_mean": 1181.2001727565657, "cost1_max": 223.94110300381362, "cost1_mean": 196.7350138479177, "cost2_min": -47.405181438642245, "system_level_velocity_min": 10.621939182080832, "outflow_rate_max": 1290.3856396661276, "cost1_min": 127.69729539062035, "cost2_mean": -32.70987835143316}, "timesteps_this_iter": 36567, "iterations_since_restore": 200, "episode_reward_min": 257.00516978342745, "episode_len_mean": 325.0, "time_this_iter_s": 25.231537342071533, "episodes_total": 9261, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "lambda": 0.97, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "output": null, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966e48>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89660b8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89737b8>"}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "lr": 0.0005, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "train_batch_size": 15000, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"custom_options": {}, "grayscale": false, "dim": 84, "conv_activation": "relu", "squash_to_range": false, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "time_since_restore": 5095.419544935226, "policy_reward_mean": {}, "experiment_id": "d7d8041073c64426b6bddd2e0cf164b0", "time_total_s": 5095.419544935226, "episode_reward_max": 473.59944165961593, "info": {"num_steps_trained": 7383851, "grad_time_ms": 9301.993, "update_time_ms": 8.132, "num_steps_sampled": 7383851, "default": {"vf_explained_var": 0.7718492150306702, "policy_loss": -0.01430512685328722, "entropy": 1.7055712938308716, "vf_loss": 53.10270690917969, "cur_lr": 0.0005000000237487257, "cur_kl_coeff": 0.33750006556510925, "kl": 0.01732064038515091, "total_loss": 53.09424591064453}, "load_time_ms": 4.837, "sample_time_ms": 15989.398}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7383851, "training_iteration": 200, "date": "2019-05-21_01-39-59", "timesteps_total": 7383851, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.71199713404513, "timestamp": 1558402799, "pid": 317, "done": true}
